Ùª­jAttributesÙ¯‚€öpExtended SummaryÙ¯‚Ù¹‚Ù§x¾The prominence of a peak measures how much a peak stands out from the surrounding baseline of the signal and is defined as the vertical distance between the peak and its lowest contour line.€ögMethodsÙ¯‚€öeNotesÙ¯‚„Ù¹‚Ù§x(Strategy to compute a peak's prominence:€ÙÇƒÙ¹‚ƒÙ§x}Extend a horizontal line from the current peak to the left and right    until the line either reaches the window border (see Ù¢„dwlenÙ „escipye1.8.0fmodulex0scipy.signal._peak_finding._arg_wlen_as_expectedfmoduleõÙ§x€) or    intersects the signal again at the slope of a higher peak. An    intersection with a peak of the same height is ignored.€Ù¹‚Ù§xsOn each side find the minimal signal value within the interval defined    above. These points are the peak's bases.€Ù¹‚Ù§xÉThe higher one of the two bases marks the peak's lowest contour line. The    prominence can then be calculated as the vertical difference between the    peaks height itself and its lowest contour line.€Ù¹‚‰Ù§x5Searching for the peak's bases can be slow for large Ù¢„axÙ „ööelocalaxelocalõÙ§x± with periodic behavior because large chunks or even the full signal need to be evaluated for the first algorithmic step. This evaluation area can be limited with the parameter Ù¢„dwlenÙ „escipye1.8.0fmodulex0scipy.signal._peak_finding._arg_wlen_as_expectedfmoduleõÙ§x• which restricts the algorithm to a window around the current peak and can shorten the calculation time if the window length is short in relation to Ù¢„axÙ „ööelocalaxelocalõÙ§y7. However, this may stop the algorithm from finding the true global contour line if the peak's true bases are outside this window. Instead, a higher contour line is found within the restricted window leading to a smaller calculated prominence. In practice, this is only relevant for the highest set of peaks in Ù¢„axÙ „ööelocalaxelocalõÙ§xP. This behavior may even be used intentionally to calculate "local" prominences.€ÙÆƒlversionaddeddTODOÙ¹‚Ù§f1.1.0 €öpOther ParametersÙ¯‚€öjParametersÙ¯‚ƒÙ°ƒaxhsequenceÙ¹‚Ù§tA signal with peaks.€Ù°ƒepeakshsequenceÙ¹‚ƒÙ§tIndices of peaks in Ù¢„axÙ „ööelocalaxelocalõÙ§a.€Ù°ƒdwlenmint, optionalÙ¹‚ƒÙ§xbA window length in samples that optionally limits the evaluated area for each peak to a subset of Ù¢„axÙ „ööelocalaxelocalõÙ§x². The peak is always placed in the middle of the window therefore the given length is rounded up to the next odd integer. This parameter can speed up the calculation (see Notes).€öfRaisesÙ¯‚Ù°ƒ`jValueErrorÙ¹‚…Ù§nIf a value in Ù¢„epeaksÙ „ööelocalepeakselocalõÙ§x is an invalid index for Ù¢„axÙ „ööelocalaxelocalõÙ§a.€öhReceivesÙ¯‚€ögReturnsÙ¯‚‚Ù°ƒkprominencesgndarrayÙ¹‚ƒÙ§x,The calculated prominences for each peak in Ù¢„epeaksÙ „ööelocalepeakselocalõÙ§a.€Ù°ƒwleft_bases, right_basesgndarrayÙ¹‚ƒÙ§xThe peaks' bases as indices in Ù¢„axÙ „ööelocalaxelocalõÙ§xb to the left and right of each peak. The higher base of each pair is a peak's lowest contour line.€ögSummaryÙ¯‚Ù¹‚Ù§x2Calculate the prominence of each peak in a signal.€öhWarningsÙ¯‚Ù¹‚Ù§xThis function may return unexpected results for data containing NaNs. To avoid this, NaNs should either be removed or replaced.€öeWarnsÙ¯‚Ù°ƒ`sPeakPropertyWarningÙ¹‚‡Ù§oFor indices in Ù¢„epeaksÙ „ööelocalepeakselocalõÙ§x+ that don't point to valid local maxima in Ù¢„axÙ „ööelocalaxelocalõÙ§xU, the returned prominence will be 0 and this warning is raised. This also happens if Ù¢„dwlenÙ „escipye1.8.0fmodulex0scipy.signal._peak_finding._arg_wlen_as_expectedfmoduleõÙ§x, is smaller than the plateau size of a peak.€öfYieldsÙ¯‚€ö‹gSummarypExtended SummaryjParametersgReturnsfRaiseseWarnshWarningshSee AlsoeNotesjReferenceshExamplesx/scipy/signal/_peak_finding.py?r<class 'function'>xscipy.signal.peak_prominencesÙ¯‚Ù´ƒ–Ù±‚bkndfromÙ±‚`a Ù±‚bnnÙ¢„escipyÙ „escipye1.8.0fmoduleescipyfmoduleõÙ±‚bnna.Ù±‚bnnÙ¢„fsignalÙ „escipye1.8.0fmodulelscipy.signalfmoduleõÙ±‚`a Ù±‚bknfimportÙ±‚`a Ù±‚`Ù¢„jfind_peaksÙ „escipye1.8.0fmodulex%scipy.signal._peak_finding.find_peaksfmoduleõÙ±‚`a,Ù±‚`a Ù±‚`Ù¢„ppeak_prominencesÙ „escipye1.8.0fmodulex+scipy.signal._peak_finding.peak_prominencesfmoduleõÙ±‚`a
Ù±‚bknfimportÙ±‚`a Ù±‚bnnÙ¢„jmatplotlibÙ „jmatplotlibe3.5.1fmodulejmatplotlibfmoduleõÙ±‚bnna.Ù±‚bnnÙ¢„fpyplotÙ „jmatplotlibe3.5.1fmoduleqmatplotlib.pyplotfmoduleõÙ±‚`a Ù±‚akbasÙ±‚`a Ù±‚bnnÙ¢„cpltÙ „jmatplotlibe3.5.1fmoduleqmatplotlib.pyplotfmoduleõ`fexecedÙ¹‚Ù§x1Create a test signal with two overlayed harmonics€Ù´ƒ˜2Ù±‚`axÙ±‚`a Ù±‚aoa=Ù±‚`a Ù±‚`Ù¢„bnpÙ „enumpyf1.22.3fmoduleenumpyfmoduleõÙ±‚aoa.Ù±‚`Ù¢„hlinspaceÙ „enumpyf1.22.3fmodulennumpy.linspacefmoduleõÙ±‚`a(Ù±‚bmia0Ù±‚`a,Ù±‚`a Ù±‚bmia6Ù±‚`a Ù±‚aoa*Ù±‚`a Ù±‚`Ù¢„bnpÙ „enumpyf1.22.3fmoduleenumpyfmoduleõÙ±‚aoa.Ù±‚`bpiÙ±‚`a,Ù±‚`a Ù±‚bmid1000Ù±‚`a)Ù±‚`a
Ù±‚`axÙ±‚`a Ù±‚aoa=Ù±‚`a Ù±‚`Ù¢„bnpÙ „enumpyf1.22.3fmoduleenumpyfmoduleõÙ±‚aoa.Ù±‚`csinÙ±‚`a(Ù±‚`axÙ±‚`a)Ù±‚`a Ù±‚aoa+Ù±‚`a Ù±‚bmfc0.6Ù±‚`a Ù±‚aoa*Ù±‚`a Ù±‚`Ù¢„bnpÙ „enumpyf1.22.3fmoduleenumpyfmoduleõÙ±‚aoa.Ù±‚`csinÙ±‚`a(Ù±‚bmfc2.6Ù±‚`a Ù±‚aoa*Ù±‚`a Ù±‚`axÙ±‚`a)`fexecedÙ¹‚Ù§x(Find all peaks and calculate prominences€Ù´ƒ˜Ù±‚`epeaksÙ±‚`a,Ù±‚`a Ù±‚`a_Ù±‚`a Ù±‚aoa=Ù±‚`a Ù±‚`Ù¢„jfind_peaksÙ „escipye1.8.0fmodulex%scipy.signal._peak_finding.find_peaksfmoduleõÙ±‚`a(Ù±‚`axÙ±‚`a)Ù±‚`a
Ù±‚`kprominencesÙ±‚`a Ù±‚aoa=Ù±‚`a Ù±‚`Ù¢„ppeak_prominencesÙ „escipye1.8.0fmodulex+scipy.signal._peak_finding.peak_prominencesfmoduleõÙ±‚`a(Ù±‚`axÙ±‚`a,Ù±‚`a Ù±‚`Ù¢„epeaksÙ „enumpyf1.22.3fmodulemnumpy.ndarrayfmoduleõÙ±‚`a)Ù±‚`a[Ù±‚bmia0Ù±‚`a]Ù±‚`a
Ù±‚`Ù¢„kprominencesÙ „enumpyf1.22.3fmodulemnumpy.ndarrayfmoduleõxnarray([1.24159486, 0.47840168, 0.28470524, 3.10716793, 0.284603  ,
       0.47822491, 2.48340261, 0.47822491])fexecedÙ¹‚Ù§xECalculate the height of each peak's contour line and plot the results€Ù´ƒ˜AÙ±‚`Ù¢„ocontour_heightsÙ „enumpyf1.22.3fmodulemnumpy.ndarrayfmoduleõÙ±‚`a Ù±‚aoa=Ù±‚`a Ù±‚`axÙ±‚`a[Ù±‚`Ù¢„epeaksÙ „enumpyf1.22.3fmodulemnumpy.ndarrayfmoduleõÙ±‚`a]Ù±‚`a Ù±‚aoa-Ù±‚`a Ù±‚`Ù¢„kprominencesÙ „enumpyf1.22.3fmodulemnumpy.ndarrayfmoduleõÙ±‚`a
Ù±‚`Ù¢„cpltÙ „jmatplotlibe3.5.1fmoduleqmatplotlib.pyplotfmoduleõÙ±‚aoa.Ù±‚`Ù¢„dplotÙ „jmatplotlibe3.5.1fmodulevmatplotlib.pyplot.plotfmoduleõÙ±‚`a(Ù±‚`axÙ±‚`a)Ù±‚`a
Ù±‚`Ù¢„cpltÙ „jmatplotlibe3.5.1fmoduleqmatplotlib.pyplotfmoduleõÙ±‚aoa.Ù±‚`Ù¢„dplotÙ „jmatplotlibe3.5.1fmodulevmatplotlib.pyplot.plotfmoduleõÙ±‚`a(Ù±‚`Ù¢„epeaksÙ „enumpyf1.22.3fmodulemnumpy.ndarrayfmoduleõÙ±‚`a,Ù±‚`a Ù±‚`axÙ±‚`a[Ù±‚`Ù¢„epeaksÙ „enumpyf1.22.3fmodulemnumpy.ndarrayfmoduleõÙ±‚`a]Ù±‚`a,Ù±‚`a Ù±‚bs2a"Ù±‚bs2axÙ±‚bs2a"Ù±‚`a)Ù±‚`a
Ù±‚`Ù¢„cpltÙ „jmatplotlibe3.5.1fmoduleqmatplotlib.pyplotfmoduleõÙ±‚aoa.Ù±‚`Ù¢„fvlinesÙ „jmatplotlibe3.5.1fmodulexmatplotlib.pyplot.vlinesfmoduleõÙ±‚`a(Ù±‚`axÙ±‚aoa=Ù±‚`Ù¢„epeaksÙ „enumpyf1.22.3fmodulemnumpy.ndarrayfmoduleõÙ±‚`a,Ù±‚`a Ù±‚`dyminÙ±‚aoa=Ù±‚`Ù¢„ocontour_heightsÙ „enumpyf1.22.3fmodulemnumpy.ndarrayfmoduleõÙ±‚`a,Ù±‚`a Ù±‚`dymaxÙ±‚aoa=Ù±‚`axÙ±‚`a[Ù±‚`Ù¢„epeaksÙ „enumpyf1.22.3fmodulemnumpy.ndarrayfmoduleõÙ±‚`a]Ù±‚`a)Ù±‚`a
Ù±‚`Ù¢„cpltÙ „jmatplotlibe3.5.1fmoduleqmatplotlib.pyplotfmoduleõÙ±‚aoa.Ù±‚`Ù¢„dshowÙ „jmatplotlibe3.5.1fmodulevmatplotlib.pyplot.showfmoduleõÙ±‚`a(Ù±‚`a)`fexecedÙ¸x5fig-scipy.signal._peak_finding.peak_prominences-0.pngÙ¹‚Ù§x]Let's evaluate a second example that demonstrates several edge cases for one peak at index 5.€Ù´ƒ˜ZÙ±‚`Ù¢„axÙ „enumpyf1.22.3fmodulemnumpy.ndarrayfmoduleõÙ±‚`a Ù±‚aoa=Ù±‚`a Ù±‚`Ù¢„bnpÙ „enumpyf1.22.3fmoduleenumpyfmoduleõÙ±‚aoa.Ù±‚`Ù¢„earrayÙ „enumpyf1.22.3fmoduleknumpy.arrayfmoduleõÙ±‚`a(Ù±‚`a[Ù±‚bmia0Ù±‚`a,Ù±‚`a Ù±‚bmia1Ù±‚`a,Ù±‚`a Ù±‚bmia0Ù±‚`a,Ù±‚`a Ù±‚bmia3Ù±‚`a,Ù±‚`a Ù±‚bmia1Ù±‚`a,Ù±‚`a Ù±‚bmia3Ù±‚`a,Ù±‚`a Ù±‚bmia0Ù±‚`a,Ù±‚`a Ù±‚bmia4Ù±‚`a,Ù±‚`a Ù±‚bmia0Ù±‚`a]Ù±‚`a)Ù±‚`a
Ù±‚`Ù¢„epeaksÙ „enumpyf1.22.3fmodulemnumpy.ndarrayfmoduleõÙ±‚`a Ù±‚aoa=Ù±‚`a Ù±‚`Ù¢„bnpÙ „enumpyf1.22.3fmoduleenumpyfmoduleõÙ±‚aoa.Ù±‚`Ù¢„earrayÙ „enumpyf1.22.3fmoduleknumpy.arrayfmoduleõÙ±‚`a(Ù±‚`a[Ù±‚bmia5Ù±‚`a]Ù±‚`a)Ù±‚`a
Ù±‚`Ù¢„cpltÙ „jmatplotlibe3.5.1fmoduleqmatplotlib.pyplotfmoduleõÙ±‚aoa.Ù±‚`Ù¢„dplotÙ „jmatplotlibe3.5.1fmodulevmatplotlib.pyplot.plotfmoduleõÙ±‚`a(Ù±‚`Ù¢„axÙ „enumpyf1.22.3fmodulemnumpy.ndarrayfmoduleõÙ±‚`a)Ù±‚`a
Ù±‚`Ù¢„cpltÙ „jmatplotlibe3.5.1fmoduleqmatplotlib.pyplotfmoduleõÙ±‚aoa.Ù±‚`Ù¢„dplotÙ „jmatplotlibe3.5.1fmodulevmatplotlib.pyplot.plotfmoduleõÙ±‚`a(Ù±‚`Ù¢„epeaksÙ „enumpyf1.22.3fmodulemnumpy.ndarrayfmoduleõÙ±‚`a,Ù±‚`a Ù±‚`Ù¢„axÙ „enumpyf1.22.3fmodulemnumpy.ndarrayfmoduleõÙ±‚`a[Ù±‚`Ù¢„epeaksÙ „enumpyf1.22.3fmodulemnumpy.ndarrayfmoduleõÙ±‚`a]Ù±‚`a,Ù±‚`a Ù±‚bs2a"Ù±‚bs2axÙ±‚bs2a"Ù±‚`a)Ù±‚`a
Ù±‚`Ù¢„cpltÙ „jmatplotlibe3.5.1fmoduleqmatplotlib.pyplotfmoduleõÙ±‚aoa.Ù±‚`Ù¢„dshowÙ „jmatplotlibe3.5.1fmodulevmatplotlib.pyplot.showfmoduleõÙ±‚`a(Ù±‚`a)Ù±‚`a
Ù±‚`Ù¢„ppeak_prominencesÙ „escipye1.8.0fmodulex+scipy.signal._peak_finding.peak_prominencesfmoduleõÙ±‚`a(Ù±‚`Ù¢„axÙ „enumpyf1.22.3fmodulemnumpy.ndarrayfmoduleõÙ±‚`a,Ù±‚`a Ù±‚`Ù¢„epeaksÙ „enumpyf1.22.3fmodulemnumpy.ndarrayfmoduleõÙ±‚`a)Ù±‚`b  Ù±‚bc1x+# -> (prominences, left_bases, right_bases)x%(array([3.]), array([2]), array([6]))fexecedÙ¸x5fig-scipy.signal._peak_finding.peak_prominences-1.pngÙ¹‚Ù§ybNote how the peak at index 3 of the same height is not considered as a border while searching for the left base. Instead, two minima at 0 and 2 are found in which case the one closer to the evaluated peak is always chosen. On the right side, however, the base must be placed at 6 because the higher peak represents the right border to the evaluated area.€Ù´ƒŒÙ±‚`Ù¢„ppeak_prominencesÙ „escipye1.8.0fmodulex+scipy.signal._peak_finding.peak_prominencesfmoduleõÙ±‚`a(Ù±‚`Ù¢„axÙ „enumpyf1.22.3fmodulemnumpy.ndarrayfmoduleõÙ±‚`a,Ù±‚`a Ù±‚`Ù¢„epeaksÙ „enumpyf1.22.3fmodulemnumpy.ndarrayfmoduleõÙ±‚`a,Ù±‚`a Ù±‚`Ù¢„dwlenÙ „escipye1.8.0fmodulex0scipy.signal._peak_finding._arg_wlen_as_expectedfmoduleõÙ±‚aoa=Ù±‚bmfc3.1Ù±‚`a)x%(array([2.]), array([4]), array([6]))fexecedÙ¹‚ƒÙ§x[Here, we restricted the algorithm to a window from 3 to 7 (the length is 5 samples because Ù¢„dwlenÙ „escipye1.8.0fmodulex0scipy.signal._peak_finding._arg_wlen_as_expectedfmoduleõÙ§x¥ was rounded up to the next odd integer). Thus, the only two candidates in the evaluated area are the two neighboring samples and a smaller prominence is calculated.€ö‚Ù¼ƒÙ»ƒjfind_peaksx%scipy.signal._peak_finding.find_peaksõÙ¹‚Ù§x4Find peaks inside a signal based on peak properties.€öÙ¼ƒÙ»ƒkpeak_widthsx&scipy.signal._peak_finding.peak_widthsõÙ¹‚Ù§xCalculate the width of peaks.€öe1.8.0Ù«x%peak_prominences(x, peaks, wlen=None)öx+scipy.signal._peak_finding.peak_prominences€