Ùª­jAttributesÙ¯‚€öpExtended SummaryÙ¯‚„Ù¹‚Ù§x¯The Lomb-Scargle periodogram was developed by Lomb  and further extended by Scargle  to find, and test the significance of weak periodic signals with uneven temporal sampling.€Ù¹‚…Ù§eWhen Ù¨Ù§inormalizeÙ§xQ is False (default) the computed periodogram is unnormalized, it takes the value Ù¡l(A**2) * N/4Ù§xA for a harmonic signal with amplitude A for sufficiently large N.€Ù¹‚ƒÙ§eWhen Ù¨Ù§inormalizeÙ§xy is True the computed periodogram is normalized by the residuals of the data around a constant reference model (at zero).€Ù¹‚Ù§x7Input arrays should be 1-D and will be cast to float64.€ögMethodsÙ¯‚€öeNotesÙ¯‚‚Ù¹‚Ù§xÓThis subroutine calculates the periodogram using a slightly modified algorithm due to Townsend  which allows the periodogram to be calculated using only a single pass through the input arrays for each frequency.€Ù¹‚Ù§xrThe algorithm running time scales roughly as O(x * freqs) or O(N^2) for a large number of samples and frequencies.€öpOther ParametersÙ¯‚€öjParametersÙ¯‚…Ù°ƒaxjarray_likeÙ¹‚Ù§mSample times.€Ù°ƒayjarray_likeÙ¹‚Ù§sMeasurement values.€Ù°ƒefreqsjarray_likeÙ¹‚Ù§x+Angular frequencies for output periodogram.€Ù°ƒiprecenternbool, optionalÙ¹‚Ù§x6Pre-center measurement values by subtracting the mean.€Ù°ƒinormalizenbool, optionalÙ¹‚Ù§xCompute normalized periodogram.€öfRaisesÙ¯‚Ù°ƒ`jValueErrorÙ¹‚…Ù§tIf the input arrays Ù¢„axÙ „ööelocalaxelocalõÙ§e and Ù¢„ayÙ „ööelocalayelocalõÙ§x do not have the same shape.€öhReceivesÙ¯‚€ögReturnsÙ¯‚Ù°ƒepgramjarray_likeÙ¹‚Ù§xLomb-Scargle periodogram.€ögSummaryÙ¯‚Ù¹‚Ù§x&Computes the Lomb-Scargle periodogram.€öhWarningsÙ¯‚€öeWarnsÙ¯‚€öfYieldsÙ¯‚€öŠiSignaturegSummarypExtended SummaryjParametersgReturnsfRaiseseNotesjReferenceshSee AlsohExamplesx/scipy/signal/_spectral_py.pyr<class 'function'>xscipy.signal.lombscargleÙ¯‚Ù´ƒ•Ù±‚bknfimportÙ±‚`a Ù±‚bnnÙ¢„jmatplotlibÙ „jmatplotlibe3.5.1fmodulejmatplotlibfmoduleõÙ±‚bnna.Ù±‚bnnÙ¢„fpyplotÙ „jmatplotlibe3.5.1fmoduleqmatplotlib.pyplotfmoduleõÙ±‚`a Ù±‚akbasÙ±‚`a Ù±‚bnnÙ¢„cpltÙ „jmatplotlibe3.5.1fmoduleqmatplotlib.pyplotfmoduleõÙ±‚`a
Ù±‚`Ù¢„crngÙ „enumpyf1.22.3fmodulex!numpy.random._generator.GeneratorfmoduleõÙ±‚`a Ù±‚aoa=Ù±‚`a Ù±‚`Ù¢„bnpÙ „enumpyf1.22.3fmoduleenumpyfmoduleõÙ±‚aoa.Ù±‚`Ù¢„frandomÙ „enumpyf1.22.3fmodulelnumpy.randomfmoduleõÙ±‚aoa.Ù±‚`Ù¢„kdefault_rngÙ „enumpyf1.22.3fmodulex#numpy.random._generator.default_rngfmoduleõÙ±‚`a(Ù±‚`a)`fexecedÙ¹‚Ù§x2First define some input parameters for the signal:€Ù´ƒ˜Ù±‚`aAÙ±‚`a Ù±‚aoa=Ù±‚`a Ù±‚bmfb2.Ù±‚`a
Ù±‚`bw0Ù±‚`a Ù±‚aoa=Ù±‚`a Ù±‚bmfb1.Ù±‚`b  Ù±‚bc1i# rad/secÙ±‚`a
Ù±‚`cninÙ±‚`a Ù±‚aoa=Ù±‚`a Ù±‚bmic150Ù±‚`a
Ù±‚`dnoutÙ±‚`a Ù±‚aoa=Ù±‚`a Ù±‚bmif100000`fexecedÙ¹‚Ù§xRandomly generate sample times:€Ù´ƒ”Ù±‚`axÙ±‚`a Ù±‚aoa=Ù±‚`a Ù±‚`Ù¢„crngÙ „enumpyf1.22.3fmodulex!numpy.random._generator.GeneratorfmoduleõÙ±‚aoa.Ù±‚`guniformÙ±‚`a(Ù±‚bmia0Ù±‚`a,Ù±‚`a Ù±‚bmib10Ù±‚aoa*Ù±‚`Ù¢„bnpÙ „enumpyf1.22.3fmoduleenumpyfmoduleõÙ±‚aoa.Ù±‚`bpiÙ±‚`a,Ù±‚`a Ù±‚`cninÙ±‚`a)`fexecedÙ¹‚Ù§x(Plot a sine wave for the selected times:€Ù´ƒÙ±‚`ayÙ±‚`a Ù±‚aoa=Ù±‚`a Ù±‚`aAÙ±‚`a Ù±‚aoa*Ù±‚`a Ù±‚`Ù¢„bnpÙ „enumpyf1.22.3fmoduleenumpyfmoduleõÙ±‚aoa.Ù±‚`Ù¢„ccosÙ „enumpyf1.22.3fmoduleknumpy.ufuncfmoduleõÙ±‚`a(Ù±‚`bw0Ù±‚aoa*Ù±‚`axÙ±‚`a)`fexecedÙ¹‚Ù§xEDefine the array of frequencies for which to compute the periodogram:€Ù´ƒÙ±‚`awÙ±‚`a Ù±‚aoa=Ù±‚`a Ù±‚`Ù¢„bnpÙ „enumpyf1.22.3fmoduleenumpyfmoduleõÙ±‚aoa.Ù±‚`Ù¢„hlinspaceÙ „enumpyf1.22.3fmodulennumpy.linspacefmoduleõÙ±‚`a(Ù±‚bmfd0.01Ù±‚`a,Ù±‚`a Ù±‚bmib10Ù±‚`a,Ù±‚`a Ù±‚`dnoutÙ±‚`a)`fexecedÙ¹‚Ù§x#Calculate Lomb-Scargle periodogram:€Ù´ƒ˜Ù±‚bknfimportÙ±‚`a Ù±‚bnnÙ¢„escipyÙ „escipye1.8.0fmoduleescipyfmoduleõÙ±‚bnna.Ù±‚bnnÙ¢„fsignalÙ „escipye1.8.0fmodulelscipy.signalfmoduleõÙ±‚`a Ù±‚akbasÙ±‚`a Ù±‚bnnÙ¢„fsignalÙ „escipye1.8.0fmodulelscipy.signalfmoduleõÙ±‚`a
Ù±‚`epgramÙ±‚`a Ù±‚aoa=Ù±‚`a Ù±‚`Ù¢„fsignalÙ „escipye1.8.0fmodulelscipy.signalfmoduleõÙ±‚aoa.Ù±‚`Ù¢„klombscargleÙ „escipye1.8.0fmodulex%scipy.signal._spectral_py.lombscarglefmoduleõÙ±‚`a(Ù±‚`axÙ±‚`a,Ù±‚`a Ù±‚`ayÙ±‚`a,Ù±‚`a Ù±‚`awÙ±‚`a,Ù±‚`a Ù±‚`Ù¢„inormalizeÙ „escipye1.8.0fmodulex%scipy.signal._filter_design.normalizefmoduleõÙ±‚aoa=Ù±‚bkcdTrueÙ±‚`a)`fexecedÙ¹‚Ù§x"Now make a plot of the input data:€Ù´ƒ˜2Ù±‚`cfigÙ±‚`a,Ù±‚`a Ù±‚`a(Ù±‚`dax_tÙ±‚`a,Ù±‚`a Ù±‚`dax_wÙ±‚`a)Ù±‚`a Ù±‚aoa=Ù±‚`a Ù±‚`Ù¢„cpltÙ „jmatplotlibe3.5.1fmoduleqmatplotlib.pyplotfmoduleõÙ±‚aoa.Ù±‚`Ù¢„hsubplotsÙ „jmatplotlibe3.5.1fmodulexmatplotlib.pyplot.subplotsfmoduleõÙ±‚`a(Ù±‚bmia2Ù±‚`a,Ù±‚`a Ù±‚bmia1Ù±‚`a,Ù±‚`a Ù±‚`rconstrained_layoutÙ±‚aoa=Ù±‚bkcdTrueÙ±‚`a)Ù±‚`a
Ù±‚`Ù¢„dax_tÙ „jmatplotlibe3.5.1fmodulex%matplotlib.axes._subplots.AxesSubplotfmoduleõÙ±‚aoa.Ù±‚`Ù¢„dplotÙ „jmatplotlibe3.5.1fmodulexmatplotlib.axes._axes.Axes.plotfmoduleõÙ±‚`a(Ù±‚`Ù¢„axÙ „enumpyf1.22.3fmodulemnumpy.ndarrayfmoduleõÙ±‚`a,Ù±‚`a Ù±‚`ayÙ±‚`a,Ù±‚`a Ù±‚bs1a'Ù±‚bs1bb+Ù±‚bs1a'Ù±‚`a)Ù±‚`a
Ù±‚`Ù¢„dax_tÙ „jmatplotlibe3.5.1fmodulex%matplotlib.axes._subplots.AxesSubplotfmoduleõÙ±‚aoa.Ù±‚`Ù¢„jset_xlabelÙ „jmatplotlibe3.5.1fmodulex*matplotlib.axes._base._AxesBase.set_xlabelfmoduleõÙ±‚`a(Ù±‚bs1a'Ù±‚bs1hTime [s]Ù±‚bs1a'Ù±‚`a)`fexecedÙ¹‚Ù§x%Then plot the normalized periodogram:€Ù´ƒ˜!Ù±‚`Ù¢„dax_wÙ „jmatplotlibe3.5.1fmodulex%matplotlib.axes._subplots.AxesSubplotfmoduleõÙ±‚aoa.Ù±‚`Ù¢„dplotÙ „jmatplotlibe3.5.1fmodulexmatplotlib.axes._axes.Axes.plotfmoduleõÙ±‚`a(Ù±‚`awÙ±‚`a,Ù±‚`a Ù±‚`epgramÙ±‚`a)Ù±‚`a
Ù±‚`Ù¢„dax_wÙ „jmatplotlibe3.5.1fmodulex%matplotlib.axes._subplots.AxesSubplotfmoduleõÙ±‚aoa.Ù±‚`Ù¢„jset_xlabelÙ „jmatplotlibe3.5.1fmodulex*matplotlib.axes._base._AxesBase.set_xlabelfmoduleõÙ±‚`a(Ù±‚bs1a'Ù±‚bs1xAngular frequency [rad/s]Ù±‚bs1a'Ù±‚`a)Ù±‚`a
Ù±‚`Ù¢„dax_wÙ „jmatplotlibe3.5.1fmodulex%matplotlib.axes._subplots.AxesSubplotfmoduleõÙ±‚aoa.Ù±‚`Ù¢„jset_ylabelÙ „jmatplotlibe3.5.1fmodulex*matplotlib.axes._base._AxesBase.set_ylabelfmoduleõÙ±‚`a(Ù±‚bs1a'Ù±‚bs1tNormalized amplitudeÙ±‚bs1a'Ù±‚`a)Ù±‚`a
Ù±‚`Ù¢„cpltÙ „jmatplotlibe3.5.1fmoduleqmatplotlib.pyplotfmoduleõÙ±‚aoa.Ù±‚`Ù¢„dshowÙ „jmatplotlibe3.5.1fmodulevmatplotlib.pyplot.showfmoduleõÙ±‚`a(Ù±‚`a)`fexecedÙ¸x/fig-scipy.signal._spectral_py.lombscargle-0.pngö…Ù¼ƒÙ»ƒjcheck_COLAx$scipy.signal._spectral_py.check_COLAõÙ¹‚Ù§x?Check whether the Constant OverLap Add (COLA) constraint is met€öÙ¼ƒÙ»ƒccsdxscipy.signal._spectral_py.csdõÙ¹‚Ù§x(Cross spectral density by Welch's method€öÙ¼ƒÙ»ƒeistftxscipy.signal._spectral_py.istftõÙ¹‚Ù§x$Inverse Short Time Fourier Transform€öÙ¼ƒÙ»ƒkspectrogramx%scipy.signal._spectral_py.spectrogramõÙ¹‚Ù§xSpectrogram by Welch's method€öÙ¼ƒÙ»ƒewelchxscipy.signal._spectral_py.welchõÙ¹‚Ù§x(Power spectral density by Welch's method€öe1.8.0Ù«xlombscargle(x, y, freqs)öx%scipy.signal._spectral_py.lombscargle€