Ùª­jAttributesÙ¯‚€öpExtended SummaryÙ¯‚‚Ù¹‚…Ù§xGiven the M-order numerator Ù¢„abÙ „ööelocalabelocalõÙ§x and N-order denominator Ù¢„aaÙ „ööelocalaaelocalõÙ§xE of a digital filter, compute its frequency response::               €ÙÀxÅjw                 -jw              -jwM
  )    b[0] + b[1]e    + ... + b[M]e
--- = -----------------------------------
jw                 -jw              -jwN
  )    a[0] + a[1]e    + ... + a[N]eögMethodsÙ¯‚€öeNotesÙ¯‚„Ù¹‚‡Ù§sUsing Matplotlib's Ù¢„vmatplotlib.pyplot.plotÙ „jmatplotliba*capivmatplotlib.pyplot.plotfmoduleõÙ§x function as the callable for Ù¢„dplotÙ „ööelocaldplotelocalõÙ§xs produces unexpected results, as this plots the real part of the complex transfer function, not the magnitude. Try Ù¡xlambda w, h: plot(w, np.abs(h))Ù§a.€Ù¹‚Ù§xpA direct computation via (R)FFT is used to compute the frequency response when the following conditions are met:€ÙÇ…Ù¹‚ƒÙ§xAn integer value is given for Ù¢„dworNÙ „ööelocaldworNelocalõÙ§a.€Ù¹‚†Ù¢„dworNÙ „ööelocaldworNelocalõÙ§x& is fast to compute via FFT (i.e.,    Ù£ƒx-next_fast_len(worN) <scipy.fft.next_fast_len>ööÙ§h equals Ù¢„dworNÙ „ööelocaldworNelocalõÙ§b).€Ù¹‚ƒÙ§x1The denominator coefficients are a single value (Ù¡oa.shape[0] == 1Ù§b).€Ù¹‚„Ù¢„dworNÙ „ööelocaldworNelocalõÙ§x7 is at least as long as the numerator coefficients    (Ù¡rworN >= b.shape[0]Ù§b).€Ù¹‚…Ù§cIf Ù¡jb.ndim > 1Ù§g, then Ù¡pb.shape[-1] == 1Ù§a.€Ù¹‚Ù§xFor long FIR filters, the FFT approach can have lower error and be much faster than the equivalent direct polynomial calculation.€öpOther ParametersÙ¯‚€öjParametersÙ¯‚‡Ù°ƒabjarray_likeÙ¹‚‡Ù§x!Numerator of a linear filter. If Ù¢„abÙ „ööelocalabelocalõÙ§xj has dimension greater than 1, it is assumed that the coefficients are stored in the first dimension, and Ù¡kb.shape[1:]Ù§b, Ù¡ka.shape[1:]Ù§xM, and the shape of the frequencies array must be compatible for broadcasting.€Ù°ƒaajarray_likeÙ¹‚‡Ù§x#Denominator of a linear filter. If Ù¢„abÙ „ööelocalabelocalõÙ§xj has dimension greater than 1, it is assumed that the coefficients are stored in the first dimension, and Ù¡kb.shape[1:]Ù§b, Ù¡ka.shape[1:]Ù§xM, and the shape of the frequencies array must be compatible for broadcasting.€Ù°ƒdworNx!{None, int, array_like}, optional„Ù¹‚Ù§xzIf a single integer, then compute at that many frequencies (default is N=512). This is a convenient alternative to::      €ÙÀxBnp.linspace(0, fs if whole else fs/2, N, endpoint=include_nyquist)Ù¹‚Ù§x_Using a number that is fast for FFT computations can result in faster computations (see Notes).€Ù¹‚ƒÙ§x`If an array_like, compute the response at the frequencies given. These are in the same units as Ù¢„bfsÙ „ööelocalbfselocalõÙ§a.€Ù°ƒewholenbool, optionalÙ¹‚ƒÙ§xiNormally, frequencies are computed from 0 to the Nyquist frequency, fs/2 (upper-half of unit-circle). If Ù¢„ewholeÙ „ööelocalewholeelocalõÙ§xJ is True, compute frequencies from 0 to fs. Ignored if worN is array_like.€Ù°ƒdplothcallableÙ¹‚‡Ù§xEA callable that takes two arguments. If given, the return parameters Ù¢„awÙ „ööelocalawelocalõÙ§e and Ù¢„ahÙ „ööelocalahelocalõÙ§xG are passed to plot. Useful for plotting the frequency response inside Ù¢„efreqzÙ „escipye1.8.0fmodulex!scipy.signal._filter_design.freqzfmoduleõÙ§a.€Ù°ƒbfsofloat, optional‚Ù¹‚Ù§xeThe sampling frequency of the digital system. Defaults to 2*pi radians/sample (so w is from 0 to pi).€ÙÆƒlversionaddeddTODOÙ¹‚Ù§f1.2.0 €Ù°ƒoinclude_nyquistnbool, optional‚Ù¹‚‡Ù§cIf Ù¢„ewholeÙ „ööelocalewholeelocalõÙ§n is False and Ù¢„dworNÙ „ööelocaldworNelocalõÙ§x is an integer, setting Ù¢„oinclude_nyquistÙ „ööelocaloinclude_nyquistelocalõÙ§xV to True will include the last frequency (Nyquist frequency) and is otherwise ignored.€ÙÆƒlversionaddeddTODOÙ¹‚Ù§f1.5.0 €öfRaisesÙ¯‚€öhReceivesÙ¯‚€ögReturnsÙ¯‚‚Ù°ƒawgndarrayÙ¹‚‡Ù§xThe frequencies at which Ù¢„ahÙ „ööelocalahelocalõÙ§x$ was computed, in the same units as Ù¢„bfsÙ „ööelocalbfselocalõÙ§n. By default, Ù¢„awÙ „ööelocalawelocalõÙ§x5 is normalized to the range [0, pi) (radians/sample).€Ù°ƒahgndarrayÙ¹‚Ù§x+The frequency response, as complex numbers.€ögSummaryÙ¯‚Ù¹‚Ù§x3Compute the frequency response of a digital filter.€öhWarningsÙ¯‚€öeWarnsÙ¯‚€öfYieldsÙ¯‚€ö‡gSummarypExtended SummaryjParametersgReturnshSee AlsoeNoteshExamplesx/scipy/signal/_filter_design.pyr<class 'function'>rscipy.signal.freqzÙ¯‚Ù´ƒ˜/Ù±‚bkndfromÙ±‚`a Ù±‚bnnÙ¢„escipyÙ „escipye1.8.0fmoduleescipyfmoduleõÙ±‚`a Ù±‚bknfimportÙ±‚`a Ù±‚`Ù¢„fsignalÙ „escipye1.8.0fmodulelscipy.signalfmoduleõÙ±‚`a
Ù±‚`abÙ±‚`a Ù±‚aoa=Ù±‚`a Ù±‚`Ù¢„fsignalÙ „escipye1.8.0fmodulelscipy.signalfmoduleõÙ±‚aoa.Ù±‚`Ù¢„ffirwinÙ „escipye1.8.0fmodulex&scipy.signal._fir_filter_design.firwinfmoduleõÙ±‚`a(Ù±‚bmib80Ù±‚`a,Ù±‚`a Ù±‚bmfc0.5Ù±‚`a,Ù±‚`a Ù±‚`fwindowÙ±‚aoa=Ù±‚`a(Ù±‚bs1a'Ù±‚bs1Ù¢„fkaiserÙ „escipye1.8.0fmodulesscipy.signal.kaiserfmoduleõÙ±‚bs1a'Ù±‚`a,Ù±‚`a Ù±‚bmia8Ù±‚`a)Ù±‚`a)Ù±‚`a
Ù±‚`awÙ±‚`a,Ù±‚`a Ù±‚`ahÙ±‚`a Ù±‚aoa=Ù±‚`a Ù±‚`Ù¢„fsignalÙ „escipye1.8.0fmodulelscipy.signalfmoduleõÙ±‚aoa.Ù±‚`Ù¢„efreqzÙ „escipye1.8.0fmodulex!scipy.signal._filter_design.freqzfmoduleõÙ±‚`a(Ù±‚`abÙ±‚`a)`fexecedÙ´ƒ˜Ù±‚bknfimportÙ±‚`a Ù±‚bnnÙ¢„jmatplotlibÙ „jmatplotlibe3.5.1fmodulejmatplotlibfmoduleõÙ±‚bnna.Ù±‚bnnÙ¢„fpyplotÙ „jmatplotlibe3.5.1fmoduleqmatplotlib.pyplotfmoduleõÙ±‚`a Ù±‚akbasÙ±‚`a Ù±‚bnnÙ¢„cpltÙ „jmatplotlibe3.5.1fmoduleqmatplotlib.pyplotfmoduleõÙ±‚`a
Ù±‚`cfigÙ±‚`a,Ù±‚`a Ù±‚`cax1Ù±‚`a Ù±‚aoa=Ù±‚`a Ù±‚`Ù¢„cpltÙ „jmatplotlibe3.5.1fmoduleqmatplotlib.pyplotfmoduleõÙ±‚aoa.Ù±‚`Ù¢„hsubplotsÙ „jmatplotlibe3.5.1fmodulexmatplotlib.pyplot.subplotsfmoduleõÙ±‚`a(Ù±‚`a)Ù±‚`a
Ù±‚`Ù¢„cax1Ù „jmatplotlibe3.5.1fmodulex%matplotlib.axes._subplots.AxesSubplotfmoduleõÙ±‚aoa.Ù±‚`Ù¢„iset_titleÙ „jmatplotlibe3.5.1fmodulex$matplotlib.axes._axes.Axes.set_titlefmoduleõÙ±‚`a(Ù±‚bs1a'Ù±‚bs1x!Digital filter frequency responseÙ±‚bs1a'Ù±‚`a)`fexecedÙ´ƒ˜3Ù±‚`Ù¢„cax1Ù „jmatplotlibe3.5.1fmodulex%matplotlib.axes._subplots.AxesSubplotfmoduleõÙ±‚aoa.Ù±‚`Ù¢„dplotÙ „jmatplotlibe3.5.1fmodulexmatplotlib.axes._axes.Axes.plotfmoduleõÙ±‚`a(Ù±‚`awÙ±‚`a,Ù±‚`a Ù±‚bmib20Ù±‚`a Ù±‚aoa*Ù±‚`a Ù±‚`Ù¢„bnpÙ „enumpyf1.22.3fmoduleenumpyfmoduleõÙ±‚aoa.Ù±‚`Ù¢„elog10Ù „enumpyf1.22.3fmoduleknumpy.ufuncfmoduleõÙ±‚`a(Ù±‚bnbcabsÙ±‚`a(Ù±‚`Ù¢„ahÙ „enumpyf1.22.3fmodulemnumpy.ndarrayfmoduleõÙ±‚`a)Ù±‚`a)Ù±‚`a,Ù±‚`a Ù±‚bs1a'Ù±‚bs1abÙ±‚bs1a'Ù±‚`a)Ù±‚`a
Ù±‚`Ù¢„cax1Ù „jmatplotlibe3.5.1fmodulex%matplotlib.axes._subplots.AxesSubplotfmoduleõÙ±‚aoa.Ù±‚`Ù¢„jset_ylabelÙ „jmatplotlibe3.5.1fmodulex*matplotlib.axes._base._AxesBase.set_ylabelfmoduleõÙ±‚`a(Ù±‚bs1a'Ù±‚bs1nAmplitude [dB]Ù±‚bs1a'Ù±‚`a,Ù±‚`a Ù±‚`ecolorÙ±‚aoa=Ù±‚bs1a'Ù±‚bs1abÙ±‚bs1a'Ù±‚`a)Ù±‚`a
Ù±‚`Ù¢„cax1Ù „jmatplotlibe3.5.1fmodulex%matplotlib.axes._subplots.AxesSubplotfmoduleõÙ±‚aoa.Ù±‚`Ù¢„jset_xlabelÙ „jmatplotlibe3.5.1fmodulex*matplotlib.axes._base._AxesBase.set_xlabelfmoduleõÙ±‚`a(Ù±‚bs1a'Ù±‚bs1vFrequency [rad/sample]Ù±‚bs1a'Ù±‚`a)`fexecedÙ´ƒ˜MÙ±‚`cax2Ù±‚`a Ù±‚aoa=Ù±‚`a Ù±‚`Ù¢„cax1Ù „jmatplotlibe3.5.1fmodulex%matplotlib.axes._subplots.AxesSubplotfmoduleõÙ±‚aoa.Ù±‚`Ù¢„etwinxÙ „jmatplotlibe3.5.1fmodulex%matplotlib.axes._base._AxesBase.twinxfmoduleõÙ±‚`a(Ù±‚`a)Ù±‚`a
Ù±‚`Ù¢„fanglesÙ „escipye1.8.0fmodulex(scipy.linalg._decomp_svd.subspace_anglesfmoduleõÙ±‚`a Ù±‚aoa=Ù±‚`a Ù±‚`Ù¢„bnpÙ „enumpyf1.22.3fmoduleenumpyfmoduleõÙ±‚aoa.Ù±‚`Ù¢„funwrapÙ „enumpyf1.22.3fmodulelnumpy.unwrapfmoduleõÙ±‚`a(Ù±‚`Ù¢„bnpÙ „enumpyf1.22.3fmoduleenumpyfmoduleõÙ±‚aoa.Ù±‚`Ù¢„eangleÙ „enumpyf1.22.3fmoduleknumpy.anglefmoduleõÙ±‚`a(Ù±‚`Ù¢„ahÙ „enumpyf1.22.3fmodulemnumpy.ndarrayfmoduleõÙ±‚`a)Ù±‚`a)Ù±‚`a
Ù±‚`Ù¢„cax2Ù „jmatplotlibe3.5.1fmodulex%matplotlib.axes._subplots.AxesSubplotfmoduleõÙ±‚aoa.Ù±‚`Ù¢„dplotÙ „jmatplotlibe3.5.1fmodulexmatplotlib.axes._axes.Axes.plotfmoduleõÙ±‚`a(Ù±‚`awÙ±‚`a,Ù±‚`a Ù±‚`Ù¢„fanglesÙ „enumpyf1.22.3fmodulemnumpy.ndarrayfmoduleõÙ±‚`a,Ù±‚`a Ù±‚bs1a'Ù±‚bs1agÙ±‚bs1a'Ù±‚`a)Ù±‚`a
Ù±‚`Ù¢„cax2Ù „jmatplotlibe3.5.1fmodulex%matplotlib.axes._subplots.AxesSubplotfmoduleõÙ±‚aoa.Ù±‚`Ù¢„jset_ylabelÙ „jmatplotlibe3.5.1fmodulex*matplotlib.axes._base._AxesBase.set_ylabelfmoduleõÙ±‚`a(Ù±‚bs1a'Ù±‚bs1oAngle (radians)Ù±‚bs1a'Ù±‚`a,Ù±‚`a Ù±‚`ecolorÙ±‚aoa=Ù±‚bs1a'Ù±‚bs1agÙ±‚bs1a'Ù±‚`a)Ù±‚`a
Ù±‚`Ù¢„cax2Ù „jmatplotlibe3.5.1fmodulex%matplotlib.axes._subplots.AxesSubplotfmoduleõÙ±‚aoa.Ù±‚`Ù¢„dgridÙ „jmatplotlibe3.5.1fmodulex$matplotlib.axes._base._AxesBase.gridfmoduleõÙ±‚`a(Ù±‚`a)Ù±‚`a
Ù±‚`Ù¢„cax2Ù „jmatplotlibe3.5.1fmodulex%matplotlib.axes._subplots.AxesSubplotfmoduleõÙ±‚aoa.Ù±‚`Ù¢„daxisÙ „jmatplotlibe3.5.1fmodulex$matplotlib.axes._base._AxesBase.axisfmoduleõÙ±‚`a(Ù±‚bs1a'Ù±‚bs1etightÙ±‚bs1a'Ù±‚`a)Ù±‚`a
Ù±‚`Ù¢„cpltÙ „jmatplotlibe3.5.1fmoduleqmatplotlib.pyplotfmoduleõÙ±‚aoa.Ù±‚`Ù¢„dshowÙ „jmatplotlibe3.5.1fmodulevmatplotlib.pyplot.showfmoduleõÙ±‚`a(Ù±‚`a)`fexecedÙ¸x+fig-scipy.signal._filter_design.freqz-0.pngÙ¹‚Ù§uBroadcasting Examples€Ù¹‚Ù§x˜Suppose we have two FIR filters whose coefficients are stored in the rows of an array with shape (2, 25). For this demonstration, we'll use random data:€Ù´ƒ˜Ù±‚`Ù¢„crngÙ „enumpyf1.22.3fmodulex!numpy.random._generator.GeneratorfmoduleõÙ±‚`a Ù±‚aoa=Ù±‚`a Ù±‚`Ù¢„bnpÙ „enumpyf1.22.3fmoduleenumpyfmoduleõÙ±‚aoa.Ù±‚`Ù¢„frandomÙ „enumpyf1.22.3fmodulelnumpy.randomfmoduleõÙ±‚aoa.Ù±‚`Ù¢„kdefault_rngÙ „enumpyf1.22.3fmodulex#numpy.random._generator.default_rngfmoduleõÙ±‚`a(Ù±‚`a)Ù±‚`a
Ù±‚`abÙ±‚`a Ù±‚aoa=Ù±‚`a Ù±‚`Ù¢„crngÙ „enumpyf1.22.3fmodulex!numpy.random._generator.GeneratorfmoduleõÙ±‚aoa.Ù±‚`Ù¢„frandomÙ „escipye1.8.0fmodulexscipy.sparse._construct.randomfmoduleõÙ±‚`a(Ù±‚`a(Ù±‚bmia2Ù±‚`a,Ù±‚`a Ù±‚bmib25Ù±‚`a)Ù±‚`a)`fexecedÙ¹‚‰Ù§xITo compute the frequency response for these two filters with one call to Ù¢„efreqzÙ „escipye1.8.0fmodulex!scipy.signal._filter_design.freqzfmoduleõÙ§r, we must pass in Ù¡cb.TÙ§j, because Ù¢„efreqzÙ „escipye1.8.0fmodulex!scipy.signal._filter_design.freqzfmoduleõÙ§x¿ expects the first axis to hold the coefficients. We must then extend the shape with a trivial dimension of length 1 to allow broadcasting with the array of frequencies.  That is, we pass in Ù¡tb.T[..., np.newaxis]Ù§x, which has shape (25, 2, 1):€Ù´ƒ˜"Ù±‚`awÙ±‚`a,Ù±‚`a Ù±‚`ahÙ±‚`a Ù±‚aoa=Ù±‚`a Ù±‚`Ù¢„fsignalÙ „escipye1.8.0fmodulelscipy.signalfmoduleõÙ±‚aoa.Ù±‚`Ù¢„efreqzÙ „escipye1.8.0fmodulex!scipy.signal._filter_design.freqzfmoduleõÙ±‚`a(Ù±‚`abÙ±‚aoa.Ù±‚`aTÙ±‚`a[Ù±‚aoa.Ù±‚aoa.Ù±‚aoa.Ù±‚`a,Ù±‚`a Ù±‚`Ù¢„bnpÙ „enumpyf1.22.3fmoduleenumpyfmoduleõÙ±‚aoa.Ù±‚`gnewaxisÙ±‚`a]Ù±‚`a,Ù±‚`a Ù±‚`dworNÙ±‚aoa=Ù±‚bmid1024Ù±‚`a)Ù±‚`a
Ù±‚`awÙ±‚aoa.Ù±‚`eshapeg(1024,)fexecedÙ´ƒƒÙ±‚`ahÙ±‚aoa.Ù±‚`eshapei(2, 1024)fexecedÙ·‚sa = [   1      1  ]s    [ -0.25, -0.5 ]Ù´ƒ˜+Ù±‚`Ù¢„abÙ „enumpyf1.22.3fmodulemnumpy.ndarrayfmoduleõÙ±‚`a Ù±‚aoa=Ù±‚`a Ù±‚`Ù¢„bnpÙ „enumpyf1.22.3fmoduleenumpyfmoduleõÙ±‚aoa.Ù±‚`Ù¢„earrayÙ „enumpyf1.22.3fmoduleknumpy.arrayfmoduleõÙ±‚`a(Ù±‚`a[Ù±‚bmfc0.5Ù±‚`a,Ù±‚`a Ù±‚bmfc0.5Ù±‚`a]Ù±‚`a)Ù±‚`a
Ù±‚`Ù¢„aaÙ „enumpyf1.22.3fmodulemnumpy.ndarrayfmoduleõÙ±‚`a Ù±‚aoa=Ù±‚`a Ù±‚`Ù¢„bnpÙ „enumpyf1.22.3fmoduleenumpyfmoduleõÙ±‚aoa.Ù±‚`Ù¢„earrayÙ „enumpyf1.22.3fmoduleknumpy.arrayfmoduleõÙ±‚`a(Ù±‚`a[Ù±‚`a[Ù±‚bmia1Ù±‚`a,Ù±‚`a Ù±‚bmia1Ù±‚`a]Ù±‚`a,Ù±‚`a Ù±‚`a[Ù±‚aoa-Ù±‚bmfd0.25Ù±‚`a,Ù±‚`a Ù±‚aoa-Ù±‚bmfc0.5Ù±‚`a]Ù±‚`a]Ù±‚`a)`fexecedÙ¹‚…Ù§eOnly Ù¢„aaÙ „ööelocalaaelocalõÙ§x… is more than 1-D. To make it compatible for broadcasting with the frequencies, we extend it with a trivial dimension in the call to Ù¢„efreqzÙ „escipye1.8.0fmodulex!scipy.signal._filter_design.freqzfmoduleõÙ§a:€Ù´ƒ˜#Ù±‚`awÙ±‚`a,Ù±‚`a Ù±‚`ahÙ±‚`a Ù±‚aoa=Ù±‚`a Ù±‚`Ù¢„fsignalÙ „escipye1.8.0fmodulelscipy.signalfmoduleõÙ±‚aoa.Ù±‚`Ù¢„efreqzÙ „escipye1.8.0fmodulex!scipy.signal._filter_design.freqzfmoduleõÙ±‚`a(Ù±‚`Ù¢„abÙ „enumpyf1.22.3fmodulemnumpy.ndarrayfmoduleõÙ±‚`a,Ù±‚`a Ù±‚`Ù¢„aaÙ „enumpyf1.22.3fmodulemnumpy.ndarrayfmoduleõÙ±‚`a[Ù±‚aoa.Ù±‚aoa.Ù±‚aoa.Ù±‚`a,Ù±‚`a Ù±‚`Ù¢„bnpÙ „enumpyf1.22.3fmoduleenumpyfmoduleõÙ±‚aoa.Ù±‚`gnewaxisÙ±‚`a]Ù±‚`a,Ù±‚`a Ù±‚`dworNÙ±‚aoa=Ù±‚bmid1024Ù±‚`a)Ù±‚`a
Ù±‚`awÙ±‚aoa.Ù±‚`eshapeg(1024,)fexecedÙ´ƒƒÙ±‚`ahÙ±‚aoa.Ù±‚`eshapei(2, 1024)fexecedö‚Ù¼ƒÙ»ƒifreqz_zpkx%scipy.signal._filter_design.freqz_zpkõ€öÙ¼ƒÙ»ƒhsosfreqzx$scipy.signal._filter_design.sosfreqzõ€öe1.8.0Ù«x\freqz(b, a=1, worN=512, whole=False, plot=None, fs=6.283185307179586, include_nyquist=False)öx!scipy.signal._filter_design.freqz€