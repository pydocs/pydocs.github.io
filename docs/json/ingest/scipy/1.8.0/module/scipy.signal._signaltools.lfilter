Ùª­jAttributesÙ¯‚€öpExtended SummaryÙ¯‚‚Ù¹‚ƒÙ§xFilter a data sequence, Ù¢„axÙ „ööelocalaxelocalõÙ§xÉ, using a digital filter.  This works for many fundamental data types (including Object type).  The filter is a direct form II transposed implementation of the standard difference equation (see Notes).€Ù¹‚‡Ù§mThe function Ù¢„gsosfiltÙ „escipye1.8.0fmodulex!scipy.signal._signaltools.sosfiltfmoduleõÙ§x (and filter design using Ù¡loutput='sos'Ù§x) should be preferred over Ù¢„glfilterÙ „escipye1.8.0fmodulex!scipy.signal._signaltools.lfilterfmoduleõÙ§xR for most filtering tasks, as second-order sections have fewer numerical problems.€ögMethodsÙ¯‚€öeNotesÙ¯‚‡Ù¹‚Ù§xtThe filter function is implemented as a direct II transposed structure. This means that the filter implements::     €ÙÀxoa[0]*y[n] = b[0]*x[n] + b[1]*x[n-1] + ... + b[M]*x[n-M]
                      - a[1]*y[n-1] - ... - a[N]*y[n-N]Ù¹‚‡Ù§fwhere Ù£ƒaMööÙ§x! is the degree of the numerator, Ù£ƒaNööÙ§x' is the degree of the denominator, and Ù£ƒanööÙ§xl is the sample number.  It is implemented using the following difference equations (assuming M = N)::       €ÙÀxóa[0]*y[n] = b[0] * x[n]               + d[0][n-1]
  d[0][n] = b[1] * x[n] - a[1] * y[n] + d[1][n-1]
  d[1][n] = b[2] * x[n] - a[2] * y[n] + d[2][n-1]
...
d[N-2][n] = b[N-1]*x[n] - a[N-1]*y[n] + d[N-1][n-1]
d[N-1][n] = b[N] * x[n] - a[N] * y[n]Ù¹‚ƒÙ§fwhere Ù¢„adÙ „escipye1.8.0fmodulex9scipy.sparse.linalg._expm_multiply.LazyOperatorNormInfo.dfmoduleõÙ§x are the state variables.€Ù¹‚Ù§xoThe rational transfer function describing this filter in the z-transform domain is::                           €ÙÀx`-1              -M
  + ... + b[M] z
------------------- X(z)
-1              -N
  + ... + a[N] zöpOther ParametersÙ¯‚€öjParametersÙ¯‚…Ù°ƒabjarray_likeÙ¹‚Ù§x3The numerator coefficient vector in a 1-D sequence.€Ù°ƒaajarray_likeÙ¹‚‰Ù§x:The denominator coefficient vector in a 1-D sequence.  If Ù¡da[0]Ù§u is not 1, then both Ù¢„aaÙ „ööelocalaaelocalõÙ§e and Ù¢„abÙ „ööelocalabelocalõÙ§s are normalized by Ù¡da[0]Ù§a.€Ù°ƒaxjarray_likeÙ¹‚Ù§xAn N-dimensional input array.€Ù°ƒdaxismint, optionalÙ¹‚Ù§xThe axis of the input data array along which to apply the linear filter. The filter is applied to each subarray along this axis.  Default is -1.€Ù°ƒbzitarray_like, optionalÙ¹‚‡Ù§xuInitial conditions for the filter delays.  It is a vector (or array of vectors for an N-dimensional input) of length Ù¡wmax(len(a), len(b)) - 1Ù§f.  If Ù¢„bziÙ „ööelocalbzielocalõÙ§x< is None or is not given then initial rest is assumed.  See Ù¢„glfilticÙ „escipye1.8.0fmodulex!scipy.signal._signaltools.lfilticfmoduleõÙ§v for more information.€öfRaisesÙ¯‚€öhReceivesÙ¯‚€ögReturnsÙ¯‚‚Ù°ƒayearrayÙ¹‚Ù§x!The output of the digital filter.€Ù°ƒbzfoarray, optionalÙ¹‚…Ù§cIf Ù¢„bziÙ „ööelocalbzielocalõÙ§x+ is None, this is not returned, otherwise, Ù¢„bzfÙ „ööelocalbzfelocalõÙ§x% holds the final filter delay values.€ögSummaryÙ¯‚Ù¹‚Ù§x:Filter data along one-dimension with an IIR or FIR filter.€öhWarningsÙ¯‚€öeWarnsÙ¯‚€öfYieldsÙ¯‚€ö‡gSummarypExtended SummaryjParametersgReturnshSee AlsoeNoteshExamplesx/scipy/signal/_signaltools.pyJr<class 'function'>tscipy.signal.lfilterÙ¯‚Ù¹‚Ù§x'Generate a noisy signal to be filtered:€Ù´ƒ˜Ù±‚bkndfromÙ±‚`a Ù±‚bnnÙ¢„escipyÙ „escipye1.8.0fmoduleescipyfmoduleõÙ±‚`a Ù±‚bknfimportÙ±‚`a Ù±‚`Ù¢„fsignalÙ „escipye1.8.0fmodulelscipy.signalfmoduleõÙ±‚`a
Ù±‚bknfimportÙ±‚`a Ù±‚bnnÙ¢„jmatplotlibÙ „jmatplotlibe3.5.1fmodulejmatplotlibfmoduleõÙ±‚bnna.Ù±‚bnnÙ¢„fpyplotÙ „jmatplotlibe3.5.1fmoduleqmatplotlib.pyplotfmoduleõÙ±‚`a Ù±‚akbasÙ±‚`a Ù±‚bnnÙ¢„cpltÙ „jmatplotlibe3.5.1fmoduleqmatplotlib.pyplotfmoduleõÙ±‚`a
Ù±‚`Ù¢„crngÙ „enumpyf1.22.3fmodulex!numpy.random._generator.GeneratorfmoduleõÙ±‚`a Ù±‚aoa=Ù±‚`a Ù±‚`Ù¢„bnpÙ „enumpyf1.22.3fmoduleenumpyfmoduleõÙ±‚aoa.Ù±‚`Ù¢„frandomÙ „enumpyf1.22.3fmodulelnumpy.randomfmoduleõÙ±‚aoa.Ù±‚`Ù¢„kdefault_rngÙ „enumpyf1.22.3fmodulex#numpy.random._generator.default_rngfmoduleõÙ±‚`a(Ù±‚`a)Ù±‚`a
Ù±‚`atÙ±‚`a Ù±‚aoa=Ù±‚`a Ù±‚`Ù¢„bnpÙ „enumpyf1.22.3fmoduleenumpyfmoduleõÙ±‚aoa.Ù±‚`Ù¢„hlinspaceÙ „enumpyf1.22.3fmodulennumpy.linspacefmoduleõÙ±‚`a(Ù±‚aoa-Ù±‚bmia1Ù±‚`a,Ù±‚`a Ù±‚bmia1Ù±‚`a,Ù±‚`a Ù±‚bmic201Ù±‚`a)Ù±‚`a
Ù±‚`axÙ±‚`a Ù±‚aoa=Ù±‚`a Ù±‚`a(Ù±‚`Ù¢„bnpÙ „enumpyf1.22.3fmoduleenumpyfmoduleõÙ±‚aoa.Ù±‚`csinÙ±‚`a(Ù±‚bmia2Ù±‚aoa*Ù±‚`Ù¢„bnpÙ „enumpyf1.22.3fmoduleenumpyfmoduleõÙ±‚aoa.Ù±‚`bpiÙ±‚aoa*Ù±‚bmfd0.75Ù±‚aoa*Ù±‚`atÙ±‚aoa*Ù±‚`a(Ù±‚bmia1Ù±‚aoa-Ù±‚`atÙ±‚`a)Ù±‚`a Ù±‚aoa+Ù±‚`a Ù±‚bmfc2.1Ù±‚`a)Ù±‚`a Ù±‚aoa+Ù±‚`a
Ù±‚`e     Ù±‚bmfc0.1Ù±‚aoa*Ù±‚`Ù¢„bnpÙ „enumpyf1.22.3fmoduleenumpyfmoduleõÙ±‚aoa.Ù±‚`csinÙ±‚`a(Ù±‚bmia2Ù±‚aoa*Ù±‚`Ù¢„bnpÙ „enumpyf1.22.3fmoduleenumpyfmoduleõÙ±‚aoa.Ù±‚`bpiÙ±‚aoa*Ù±‚bmfd1.25Ù±‚aoa*Ù±‚`atÙ±‚`a Ù±‚aoa+Ù±‚`a Ù±‚bmia1Ù±‚`a)Ù±‚`a Ù±‚aoa+Ù±‚`a
Ù±‚`e     Ù±‚bmfd0.18Ù±‚aoa*Ù±‚`Ù¢„bnpÙ „enumpyf1.22.3fmoduleenumpyfmoduleõÙ±‚aoa.Ù±‚`ccosÙ±‚`a(Ù±‚bmia2Ù±‚aoa*Ù±‚`Ù¢„bnpÙ „enumpyf1.22.3fmoduleenumpyfmoduleõÙ±‚aoa.Ù±‚`bpiÙ±‚aoa*Ù±‚bmfd3.85Ù±‚aoa*Ù±‚`atÙ±‚`a)Ù±‚`a)Ù±‚`a
Ù±‚`bxnÙ±‚`a Ù±‚aoa=Ù±‚`a Ù±‚`axÙ±‚`a Ù±‚aoa+Ù±‚`a Ù±‚`Ù¢„crngÙ „enumpyf1.22.3fmodulex!numpy.random._generator.GeneratorfmoduleõÙ±‚aoa.Ù±‚`ostandard_normalÙ±‚`a(Ù±‚bnbclenÙ±‚`a(Ù±‚`atÙ±‚`a)Ù±‚`a)Ù±‚`a Ù±‚aoa*Ù±‚`a Ù±‚bmfd0.08`fexecedÙ¹‚Ù§x-Create an order 3 lowpass butterworth filter:€Ù´ƒÙ±‚`Ù¢„abÙ „enumpyf1.22.3fmodulemnumpy.ndarrayfmoduleõÙ±‚`a,Ù±‚`a Ù±‚`aaÙ±‚`a Ù±‚aoa=Ù±‚`a Ù±‚`Ù¢„fsignalÙ „escipye1.8.0fmodulelscipy.signalfmoduleõÙ±‚aoa.Ù±‚`Ù¢„fbutterÙ „escipye1.8.0fmodulex"scipy.signal._filter_design.butterfmoduleõÙ±‚`a(Ù±‚bmia3Ù±‚`a,Ù±‚`a Ù±‚bmfd0.05Ù±‚`a)`fexecedÙ¹‚Ù§xVApply the filter to xn.  Use lfilter_zi to choose the initial condition of the filter:€Ù´ƒ˜+Ù±‚`bziÙ±‚`a Ù±‚aoa=Ù±‚`a Ù±‚`Ù¢„fsignalÙ „escipye1.8.0fmodulelscipy.signalfmoduleõÙ±‚aoa.Ù±‚`Ù¢„jlfilter_ziÙ „escipye1.8.0fmodulex$scipy.signal._signaltools.lfilter_zifmoduleõÙ±‚`a(Ù±‚`Ù¢„abÙ „enumpyf1.22.3fmodulemnumpy.ndarrayfmoduleõÙ±‚`a,Ù±‚`a Ù±‚`Ù¢„aaÙ „enumpyf1.22.3fmodulemnumpy.ndarrayfmoduleõÙ±‚`a)Ù±‚`a
Ù±‚`azÙ±‚`a,Ù±‚`a Ù±‚`a_Ù±‚`a Ù±‚aoa=Ù±‚`a Ù±‚`Ù¢„fsignalÙ „escipye1.8.0fmodulelscipy.signalfmoduleõÙ±‚aoa.Ù±‚`Ù¢„glfilterÙ „escipye1.8.0fmodulex!scipy.signal._signaltools.lfilterfmoduleõÙ±‚`a(Ù±‚`Ù¢„abÙ „enumpyf1.22.3fmodulemnumpy.ndarrayfmoduleõÙ±‚`a,Ù±‚`a Ù±‚`Ù¢„aaÙ „enumpyf1.22.3fmodulemnumpy.ndarrayfmoduleõÙ±‚`a,Ù±‚`a Ù±‚`bxnÙ±‚`a,Ù±‚`a Ù±‚`Ù¢„bziÙ „enumpyf1.22.3fmodulemnumpy.ndarrayfmoduleõÙ±‚aoa=Ù±‚`Ù¢„bziÙ „enumpyf1.22.3fmodulemnumpy.ndarrayfmoduleõÙ±‚aoa*Ù±‚`bxnÙ±‚`a[Ù±‚bmia0Ù±‚`a]Ù±‚`a)`fexecedÙ¹‚Ù§xSApply the filter again, to have a result filtered at an order the same as filtfilt:€Ù´ƒ˜Ù±‚`bz2Ù±‚`a,Ù±‚`a Ù±‚`a_Ù±‚`a Ù±‚aoa=Ù±‚`a Ù±‚`Ù¢„fsignalÙ „escipye1.8.0fmodulelscipy.signalfmoduleõÙ±‚aoa.Ù±‚`Ù¢„glfilterÙ „escipye1.8.0fmodulex!scipy.signal._signaltools.lfilterfmoduleõÙ±‚`a(Ù±‚`Ù¢„abÙ „enumpyf1.22.3fmodulemnumpy.ndarrayfmoduleõÙ±‚`a,Ù±‚`a Ù±‚`Ù¢„aaÙ „enumpyf1.22.3fmodulemnumpy.ndarrayfmoduleõÙ±‚`a,Ù±‚`a Ù±‚`Ù¢„azÙ „enumpyf1.22.3fmodulemnumpy.ndarrayfmoduleõÙ±‚`a,Ù±‚`a Ù±‚`Ù¢„bziÙ „enumpyf1.22.3fmodulemnumpy.ndarrayfmoduleõÙ±‚aoa=Ù±‚`Ù¢„bziÙ „enumpyf1.22.3fmodulemnumpy.ndarrayfmoduleõÙ±‚aoa*Ù±‚`Ù¢„azÙ „enumpyf1.22.3fmodulemnumpy.ndarrayfmoduleõÙ±‚`a[Ù±‚bmia0Ù±‚`a]Ù±‚`a)`fexecedÙ¹‚Ù§x!Use filtfilt to apply the filter:€Ù´ƒÙ±‚`ayÙ±‚`a Ù±‚aoa=Ù±‚`a Ù±‚`Ù¢„fsignalÙ „escipye1.8.0fmodulelscipy.signalfmoduleõÙ±‚aoa.Ù±‚`Ù¢„hfiltfiltÙ „escipye1.8.0fmodulex"scipy.signal._signaltools.filtfiltfmoduleõÙ±‚`a(Ù±‚`Ù¢„abÙ „enumpyf1.22.3fmodulemnumpy.ndarrayfmoduleõÙ±‚`a,Ù±‚`a Ù±‚`aaÙ±‚`a,Ù±‚`a Ù±‚`bxnÙ±‚`a)`fexecedÙ¹‚Ù§x;Plot the original signal and the various filtered versions:€Ù´ƒ˜kÙ±‚`Ù¢„cpltÙ „jmatplotlibe3.5.1fmoduleqmatplotlib.pyplotfmoduleõÙ±‚aoa.Ù±‚`Ù¢„ffigureÙ „jmatplotlibe3.5.1fmodulexmatplotlib.pyplot.figurefmoduleõÙ±‚`a
Ù±‚`Ù¢„cpltÙ „jmatplotlibe3.5.1fmoduleqmatplotlib.pyplotfmoduleõÙ±‚aoa.Ù±‚`Ù¢„dplotÙ „jmatplotlibe3.5.1fmodulevmatplotlib.pyplot.plotfmoduleõÙ±‚`a(Ù±‚`atÙ±‚`a,Ù±‚`a Ù±‚`bxnÙ±‚`a,Ù±‚`a Ù±‚bs1a'Ù±‚bs1abÙ±‚bs1a'Ù±‚`a,Ù±‚`a Ù±‚`Ù¢„ealphaÙ „escipye1.8.0fmodulex=scipy.sparse.linalg._expm_multiply.LazyOperatorNormInfo.alphafmoduleõÙ±‚aoa=Ù±‚bmfd0.75Ù±‚`a)Ù±‚`a
Ù±‚`Ù¢„cpltÙ „jmatplotlibe3.5.1fmoduleqmatplotlib.pyplotfmoduleõÙ±‚aoa.Ù±‚`Ù¢„dplotÙ „jmatplotlibe3.5.1fmodulevmatplotlib.pyplot.plotfmoduleõÙ±‚`a(Ù±‚`atÙ±‚`a,Ù±‚`a Ù±‚`Ù¢„azÙ „enumpyf1.22.3fmodulemnumpy.ndarrayfmoduleõÙ±‚`a,Ù±‚`a Ù±‚bs1a'Ù±‚bs1cr--Ù±‚bs1a'Ù±‚`a,Ù±‚`a Ù±‚`atÙ±‚`a,Ù±‚`a Ù±‚`Ù¢„bz2Ù „enumpyf1.22.3fmodulemnumpy.ndarrayfmoduleõÙ±‚`a,Ù±‚`a Ù±‚bs1a'Ù±‚bs1arÙ±‚bs1a'Ù±‚`a,Ù±‚`a Ù±‚`atÙ±‚`a,Ù±‚`a Ù±‚`ayÙ±‚`a,Ù±‚`a Ù±‚bs1a'Ù±‚bs1akÙ±‚bs1a'Ù±‚`a)Ù±‚`a
Ù±‚`Ù¢„cpltÙ „jmatplotlibe3.5.1fmoduleqmatplotlib.pyplotfmoduleõÙ±‚aoa.Ù±‚`Ù¢„flegendÙ „jmatplotlibe3.5.1fmodulexmatplotlib.pyplot.legendfmoduleõÙ±‚`a(Ù±‚`a(Ù±‚bs1a'Ù±‚bs1lnoisy signalÙ±‚bs1a'Ù±‚`a,Ù±‚`a Ù±‚bs1a'Ù±‚bs1mlfilter, onceÙ±‚bs1a'Ù±‚`a,Ù±‚`a Ù±‚bs1a'Ù±‚bs1nlfilter, twiceÙ±‚bs1a'Ù±‚`a,Ù±‚`a
Ù±‚`l            Ù±‚bs1a'Ù±‚bs1Ù¢„hfiltfiltÙ „escipye1.8.0fmodulex"scipy.signal._signaltools.filtfiltfmoduleõÙ±‚bs1a'Ù±‚`a)Ù±‚`a,Ù±‚`a Ù±‚`clocÙ±‚aoa=Ù±‚bs1a'Ù±‚bs1dbestÙ±‚bs1a'Ù±‚`a)Ù±‚`a
Ù±‚`Ù¢„cpltÙ „jmatplotlibe3.5.1fmoduleqmatplotlib.pyplotfmoduleõÙ±‚aoa.Ù±‚`Ù¢„dgridÙ „jmatplotlibe3.5.1fmodulevmatplotlib.pyplot.gridfmoduleõÙ±‚`a(Ù±‚bkcdTrueÙ±‚`a)Ù±‚`a
Ù±‚`Ù¢„cpltÙ „jmatplotlibe3.5.1fmoduleqmatplotlib.pyplotfmoduleõÙ±‚aoa.Ù±‚`Ù¢„dshowÙ „jmatplotlibe3.5.1fmodulevmatplotlib.pyplot.showfmoduleõÙ±‚`a(Ù±‚`a)`fexecedÙ¸x+fig-scipy.signal._signaltools.lfilter-0.pngö†Ù¼ƒÙ»ƒhfiltfiltx"scipy.signal._signaltools.filtfiltõÙ¹‚Ù§x@A forward-backward filter, to obtain a filter with linear phase.€öÙ¼ƒÙ»ƒjlfilter_zix$scipy.signal._signaltools.lfilter_ziõÙ¹‚ƒÙ§x:Compute initial state (steady state of step response) for Ù¢„glfilterÙ „escipye1.8.0fmodulex!scipy.signal._signaltools.lfilterfmoduleõÙ§a.€öÙ¼ƒÙ»ƒglfilticx!scipy.signal._signaltools.lfilticõÙ¹‚ƒÙ§x!Construct initial conditions for Ù¢„glfilterÙ „escipye1.8.0fmodulex!scipy.signal._signaltools.lfilterfmoduleõÙ§a.€öÙ¼ƒÙ»ƒmsavgol_filterx*scipy.signal._savitzky_golay.savgol_filterõÙ¹‚Ù§xA Savitzky-Golay filter.€öÙ¼ƒÙ»ƒgsosfiltx!scipy.signal._signaltools.sosfiltõÙ¹‚Ù§x1Filter data using cascaded second-order sections.€öÙ¼ƒÙ»ƒksosfiltfiltx%scipy.signal._signaltools.sosfiltfiltõÙ¹‚Ù§x6A forward-backward filter using second-order sections.€öe1.8.0Ù«x"lfilter(b, a, x, axis=-1, zi=None)öx!scipy.signal._signaltools.lfilter€