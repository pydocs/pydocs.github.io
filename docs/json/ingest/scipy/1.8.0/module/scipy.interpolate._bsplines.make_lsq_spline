Ùª­jAttributesÙ¯‚€öpExtended SummaryÙ¯‚„Ù¹‚Ù§x"The result is a linear combination€Ù¤x S ( x) = \sum_j c_j B_j ( x; t) Ù¹‚ƒÙ§x of the B-spline basis elements, Ù¥iB_j(x; t)Ù§q, which minimizes€Ù¤x:\sum_ { j} \left ( w_j \times ( S ( x_j) - y_j) \right)^2 ögMethodsÙ¯‚€öeNotesÙ¯‚‚Ù¹‚ƒÙ§x@The number of data points must be larger than the spline degree Ù¢„akÙ „ööelocalakelocalõÙ§a.€Ù¹‚‰Ù§fKnots Ù¢„atÙ „ööelocalatelocalõÙ§x] must satisfy the Schoenberg-Whitney conditions, i.e., there must be a subset of data points Ù¡dx[j]Ù§k such that Ù¡vt[j] < x[j] < t[j+k+1]Ù§f, for Ù¡pj=0, 1,...,n-k-2Ù§a.€öpOther ParametersÙ¯‚€öjParametersÙ¯‚‡Ù°ƒaxvarray_like, shape (m,)Ù¹‚Ù§jAbscissas.€Ù°ƒayxarray_like, shape (m, ...)Ù¹‚Ù§jOrdinates.€Ù°ƒatxarray_like, shape (n + k + 1,).Ù¹‚Ù§xHKnots. Knots and data points must satisfy Schoenberg-Whitney conditions.€Ù°ƒakmint, optionalÙ¹‚Ù§x'B-spline degree. Default is cubic, k=3.€Ù°ƒawx array_like, shape (n,), optionalÙ¹‚…Ù§x1Weights for spline fitting. Must be positive. If Ù¡dNoneÙ§x), then weights are all equal. Default is Ù¡dNoneÙ§a.€Ù°ƒdaxismint, optionalÙ¹‚Ù§x$Interpolation axis. Default is zero.€Ù°ƒlcheck_finitenbool, optionalÙ¹‚Ù§xŞWhether to check that the input arrays contain only finite numbers. Disabling may give a performance gain, but may result in problems (crashes, non-termination) if the inputs do contain infinities or NaNs. Default is True.€öfRaisesÙ¯‚€öhReceivesÙ¯‚€ögReturnsÙ¯‚Ù°ƒabx2a BSpline object of the degree `k` with knots `t`.€ögSummaryÙ¯‚Ù¹‚Ù§x.Compute the (coefficients of) an LSQ B-spline.€öhWarningsÙ¯‚€öeWarnsÙ¯‚€öfYieldsÙ¯‚€ö‡gSummarypExtended SummaryjParametersgReturnseNoteshExampleshSee Alsox/scipy/interpolate/_bsplines.pyTr<class 'function'>x0scipy.signal._ltisys.interpolate.make_lsq_splineÙ¯‚ŒÙ¹‚Ù§xGenerate some noisy data:€Ù´ƒ˜9Ù±‚`Ù¢„crngÙ „enumpyf1.22.3fmodulex!numpy.random._generator.GeneratorfmoduleõÙ±‚`a Ù±‚aoa=Ù±‚`a Ù±‚`Ù¢„bnpÙ „enumpyf1.22.3fmoduleenumpyfmoduleõÙ±‚aoa.Ù±‚`Ù¢„frandomÙ „enumpyf1.22.3fmodulelnumpy.randomfmoduleõÙ±‚aoa.Ù±‚`Ù¢„kdefault_rngÙ „enumpyf1.22.3fmodulex#numpy.random._generator.default_rngfmoduleõÙ±‚`a(Ù±‚`a)Ù±‚`a
Ù±‚`axÙ±‚`a Ù±‚aoa=Ù±‚`a Ù±‚`Ù¢„bnpÙ „enumpyf1.22.3fmoduleenumpyfmoduleõÙ±‚aoa.Ù±‚`Ù¢„hlinspaceÙ „enumpyf1.22.3fmodulennumpy.linspacefmoduleõÙ±‚`a(Ù±‚aoa-Ù±‚bmia3Ù±‚`a,Ù±‚`a Ù±‚bmia3Ù±‚`a,Ù±‚`a Ù±‚bmib50Ù±‚`a)Ù±‚`a
Ù±‚`ayÙ±‚`a Ù±‚aoa=Ù±‚`a Ù±‚`Ù¢„bnpÙ „enumpyf1.22.3fmoduleenumpyfmoduleõÙ±‚aoa.Ù±‚`cexpÙ±‚`a(Ù±‚aoa-Ù±‚`axÙ±‚aoa*Ù±‚aoa*Ù±‚bmia2Ù±‚`a)Ù±‚`a Ù±‚aoa+Ù±‚`a Ù±‚bmfc0.1Ù±‚`a Ù±‚aoa*Ù±‚`a Ù±‚`Ù¢„crngÙ „enumpyf1.22.3fmodulex!numpy.random._generator.GeneratorfmoduleõÙ±‚aoa.Ù±‚`ostandard_normalÙ±‚`a(Ù±‚bmib50Ù±‚`a)`fexecedÙ¹‚Ù§xˆNow fit a smoothing cubic spline with a pre-defined internal knots. Here we make the knot vector (k+1)-regular by adding boundary knots:€Ù´ƒ˜_Ù±‚bkndfromÙ±‚`a Ù±‚bnnÙ¢„escipyÙ „escipye1.8.0fmoduleescipyfmoduleõÙ±‚bnna.Ù±‚bnnÙ¢„kinterpolateÙ „escipye1.8.0fmoduleqscipy.interpolatefmoduleõÙ±‚`a Ù±‚bknfimportÙ±‚`a Ù±‚`Ù¢„omake_lsq_splineÙ „escipye1.8.0fmodulex+scipy.interpolate._bsplines.make_lsq_splinefmoduleõÙ±‚`a,Ù±‚`a Ù±‚`Ù¢„gBSplineÙ „escipye1.8.0fmodulex#scipy.interpolate._bsplines.BSplinefmoduleõÙ±‚`a
Ù±‚`atÙ±‚`a Ù±‚aoa=Ù±‚`a Ù±‚`a[Ù±‚aoa-Ù±‚bmia1Ù±‚`a,Ù±‚`a Ù±‚bmia0Ù±‚`a,Ù±‚`a Ù±‚bmia1Ù±‚`a]Ù±‚`a
Ù±‚`akÙ±‚`a Ù±‚aoa=Ù±‚`a Ù±‚bmia3Ù±‚`a
Ù±‚`atÙ±‚`a Ù±‚aoa=Ù±‚`a Ù±‚`Ù¢„bnpÙ „enumpyf1.22.3fmoduleenumpyfmoduleõÙ±‚aoa.Ù±‚`Ù¢„br_Ù „enumpyf1.22.3fmodulexnumpy.lib.index_tricks.RClassfmoduleõÙ±‚`a[Ù±‚`a(Ù±‚`axÙ±‚`a[Ù±‚bmia0Ù±‚`a]Ù±‚`a,Ù±‚`a)Ù±‚aoa*Ù±‚`a(Ù±‚`akÙ±‚aoa+Ù±‚bmia1Ù±‚`a)Ù±‚`a,Ù±‚`a
Ù±‚`j          Ù±‚`atÙ±‚`a,Ù±‚`a
Ù±‚`j          Ù±‚`a(Ù±‚`axÙ±‚`a[Ù±‚aoa-Ù±‚bmia1Ù±‚`a]Ù±‚`a,Ù±‚`a)Ù±‚aoa*Ù±‚`a(Ù±‚`akÙ±‚aoa+Ù±‚bmia1Ù±‚`a)Ù±‚`a]Ù±‚`a
Ù±‚`csplÙ±‚`a Ù±‚aoa=Ù±‚`a Ù±‚`Ù¢„omake_lsq_splineÙ „escipye1.8.0fmodulex+scipy.interpolate._bsplines.make_lsq_splinefmoduleõÙ±‚`a(Ù±‚`axÙ±‚`a,Ù±‚`a Ù±‚`ayÙ±‚`a,Ù±‚`a Ù±‚`atÙ±‚`a,Ù±‚`a Ù±‚`akÙ±‚`a)`fexecedÙ¹‚Ù§xSFor comparison, we also construct an interpolating spline for the same set of data:€Ù´ƒ•Ù±‚bkndfromÙ±‚`a Ù±‚bnnÙ¢„escipyÙ „escipye1.8.0fmoduleescipyfmoduleõÙ±‚bnna.Ù±‚bnnÙ¢„kinterpolateÙ „escipye1.8.0fmoduleqscipy.interpolatefmoduleõÙ±‚`a Ù±‚bknfimportÙ±‚`a Ù±‚`Ù¢„rmake_interp_splineÙ „escipye1.8.0fmodulex.scipy.interpolate._bsplines.make_interp_splinefmoduleõÙ±‚`a
Ù±‚`espl_iÙ±‚`a Ù±‚aoa=Ù±‚`a Ù±‚`Ù¢„rmake_interp_splineÙ „escipye1.8.0fmodulex.scipy.interpolate._bsplines.make_interp_splinefmoduleõÙ±‚`a(Ù±‚`axÙ±‚`a,Ù±‚`a Ù±‚`ayÙ±‚`a)`fexecedÙ¹‚Ù§jPlot both:€Ù´ƒ˜Ù±‚bknfimportÙ±‚`a Ù±‚bnnÙ¢„jmatplotlibÙ „jmatplotlibe3.5.1fmodulejmatplotlibfmoduleõÙ±‚bnna.Ù±‚bnnÙ¢„fpyplotÙ „jmatplotlibe3.5.1fmoduleqmatplotlib.pyplotfmoduleõÙ±‚`a Ù±‚akbasÙ±‚`a Ù±‚bnnÙ¢„cpltÙ „jmatplotlibe3.5.1fmoduleqmatplotlib.pyplotfmoduleõÙ±‚`a
Ù±‚`bxsÙ±‚`a Ù±‚aoa=Ù±‚`a Ù±‚`Ù¢„bnpÙ „enumpyf1.22.3fmoduleenumpyfmoduleõÙ±‚aoa.Ù±‚`Ù¢„hlinspaceÙ „enumpyf1.22.3fmodulennumpy.linspacefmoduleõÙ±‚`a(Ù±‚aoa-Ù±‚bmia3Ù±‚`a,Ù±‚`a Ù±‚bmia3Ù±‚`a,Ù±‚`a Ù±‚bmic100Ù±‚`a)Ù±‚`a
Ù±‚`Ù¢„cpltÙ „jmatplotlibe3.5.1fmoduleqmatplotlib.pyplotfmoduleõÙ±‚aoa.Ù±‚`Ù¢„dplotÙ „jmatplotlibe3.5.1fmodulevmatplotlib.pyplot.plotfmoduleõÙ±‚`a(Ù±‚`axÙ±‚`a,Ù±‚`a Ù±‚`ayÙ±‚`a,Ù±‚`a Ù±‚bs1a'Ù±‚bs1broÙ±‚bs1a'Ù±‚`a,Ù±‚`a Ù±‚`bmsÙ±‚aoa=Ù±‚bmia5Ù±‚`a)Ù±‚`a
Ù±‚`Ù¢„cpltÙ „jmatplotlibe3.5.1fmoduleqmatplotlib.pyplotfmoduleõÙ±‚aoa.Ù±‚`Ù¢„dplotÙ „jmatplotlibe3.5.1fmodulevmatplotlib.pyplot.plotfmoduleõÙ±‚`a(Ù±‚`bxsÙ±‚`a,Ù±‚`a Ù±‚`csplÙ±‚`a(Ù±‚`bxsÙ±‚`a)Ù±‚`a,Ù±‚`a Ù±‚bs1a'Ù±‚bs1bg-Ù±‚bs1a'Ù±‚`a,Ù±‚`a Ù±‚`Ù¢„blwÙ „escipye1.8.0fmodulex"scipy.linalg.lapack._compute_lworkfmoduleõÙ±‚aoa=Ù±‚bmia3Ù±‚`a,Ù±‚`a Ù±‚`elabelÙ±‚aoa=Ù±‚bs1a'Ù±‚bs1jLSQ splineÙ±‚bs1a'Ù±‚`a)Ù±‚`a
Ù±‚`Ù¢„cpltÙ „jmatplotlibe3.5.1fmoduleqmatplotlib.pyplotfmoduleõÙ±‚aoa.Ù±‚`Ù¢„dplotÙ „jmatplotlibe3.5.1fmodulevmatplotlib.pyplot.plotfmoduleõÙ±‚`a(Ù±‚`bxsÙ±‚`a,Ù±‚`a Ù±‚`espl_iÙ±‚`a(Ù±‚`bxsÙ±‚`a)Ù±‚`a,Ù±‚`a Ù±‚bs1a'Ù±‚bs1bb-Ù±‚bs1a'Ù±‚`a,Ù±‚`a Ù±‚`Ù¢„blwÙ „escipye1.8.0fmodulex"scipy.linalg.lapack._compute_lworkfmoduleõÙ±‚aoa=Ù±‚bmia3Ù±‚`a,Ù±‚`a Ù±‚`Ù¢„ealphaÙ „escipye1.8.0fmodulex=scipy.sparse.linalg._expm_multiply.LazyOperatorNormInfo.alphafmoduleõÙ±‚aoa=Ù±‚bmfc0.7Ù±‚`a,Ù±‚`a Ù±‚`elabelÙ±‚aoa=Ù±‚bs1a'Ù±‚bs1minterp splineÙ±‚bs1a'Ù±‚`a)Ù±‚`a
Ù±‚`Ù¢„cpltÙ „jmatplotlibe3.5.1fmoduleqmatplotlib.pyplotfmoduleõÙ±‚aoa.Ù±‚`Ù¢„flegendÙ „jmatplotlibe3.5.1fmodulexmatplotlib.pyplot.legendfmoduleõÙ±‚`a(Ù±‚`clocÙ±‚aoa=Ù±‚bs1a'Ù±‚bs1dbestÙ±‚bs1a'Ù±‚`a)Ù±‚`a
Ù±‚`Ù¢„cpltÙ „jmatplotlibe3.5.1fmoduleqmatplotlib.pyplotfmoduleõÙ±‚aoa.Ù±‚`Ù¢„dshowÙ „jmatplotlibe3.5.1fmodulevmatplotlib.pyplot.showfmoduleõÙ±‚`a(Ù±‚`a)`fexecedÙ¸x5fig-scipy.interpolate._bsplines.make_lsq_spline-0.pngÙ¹‚†Ù©Ù§lNaN handlingÙ§x: If the input arrays contain Ù¡cnanÙ§x` values, the result is not useful since the underlying spline fitting routines cannot deal with Ù¡cnanÙ§xC. A workaround is to use zero weights for not-a-number data points:€Ù´ƒ˜3Ù±‚`ayÙ±‚`a[Ù±‚bmia8Ù±‚`a]Ù±‚`a Ù±‚aoa=Ù±‚`a Ù±‚`Ù¢„bnpÙ „enumpyf1.22.3fmoduleenumpyfmoduleõÙ±‚aoa.Ù±‚`Ù¢„cnanÙ „escipye1.8.0fmodulex8scipy.interpolate._interpolate.interp1d._call_nan_splinefmoduleõÙ±‚`a
Ù±‚`awÙ±‚`a Ù±‚aoa=Ù±‚`a Ù±‚`Ù¢„bnpÙ „enumpyf1.22.3fmoduleenumpyfmoduleõÙ±‚aoa.Ù±‚`Ù¢„eisnanÙ „enumpyf1.22.3fmoduleknumpy.ufuncfmoduleõÙ±‚`a(Ù±‚`ayÙ±‚`a)Ù±‚`a
Ù±‚`ayÙ±‚`a[Ù±‚`Ù¢„awÙ „enumpyf1.22.3fmodulemnumpy.ndarrayfmoduleõÙ±‚`a]Ù±‚`a Ù±‚aoa=Ù±‚`a Ù±‚bmfb0.Ù±‚`a
Ù±‚`ctckÙ±‚`a Ù±‚aoa=Ù±‚`a Ù±‚`Ù¢„omake_lsq_splineÙ „escipye1.8.0fmodulex+scipy.interpolate._bsplines.make_lsq_splinefmoduleõÙ±‚`a(Ù±‚`axÙ±‚`a,Ù±‚`a Ù±‚`ayÙ±‚`a,Ù±‚`a Ù±‚`atÙ±‚`a,Ù±‚`a Ù±‚`Ù¢„awÙ „enumpyf1.22.3fmodulemnumpy.ndarrayfmoduleõÙ±‚aoa=Ù±‚aoa~Ù±‚`Ù¢„awÙ „enumpyf1.22.3fmodulemnumpy.ndarrayfmoduleõÙ±‚`a)`fexecedÙ¹‚ƒÙ§xNotice the need to replace a Ù¡cnanÙ§xb by a numerical value (precise value does not matter as long as the corresponding weight is zero.)€ö„Ù¼ƒÙ»ƒgBSplinex#scipy.interpolate._bsplines.BSplineõÙ¹‚Ù§x,base class representing the B-spline objects€öÙ¼ƒÙ»ƒsLSQUnivariateSplinex/scipy.interpolate._fitpack2.LSQUnivariateSplineõÙ¹‚Ù§x&a FITPACK-based spline fitting routine€öÙ¼ƒÙ»ƒrmake_interp_splinex.scipy.interpolate._bsplines.make_interp_splineõÙ¹‚Ù§x4a similar factory function for interpolating splines€öÙ¼ƒÙ»ƒfsplrepööÙ¹‚Ù§xa FITPACK-based fitting routine€öe1.8.0Ù«x@make_lsq_spline(x, y, t, k=3, w=None, axis=0, check_finite=True)öx+scipy.interpolate._bsplines.make_lsq_spline€