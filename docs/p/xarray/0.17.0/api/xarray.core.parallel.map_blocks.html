<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
    <link rel="stylesheet" href="https://fonts.xz.style/serve/inter.css">
	<link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.8.1/css/all.css" integrity="sha384-50oBUHEmvpQ+1lW4y57PTFmhCaXp0ML5d60M1M7uH2+nqUivzIebhndOJK28anvf" crossorigin="anonymous">
    
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@exampledev/new.css@1.1.2/new.min.css">
    <script type="text/x-mathjax-config">
        // this should process only math inside  span with tex2jax_process class
    MathJax.Hub.Config({
        extensions: ["tex2jax.js"],
        jax: ["input/TeX", "output/HTML-CSS"],
        tex2jax: {
        inlineMath: [ ['$','$'], ["\\(","\\)"] ],
        displayMath: [ ['$$','$$'], ["\\[","\\]"] ],
        processEscapes: true
        },
        "HTML-CSS": { fonts: ["TeX"] }
    });
    </script>
    <script type="text/javascript" async
        src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/MathJax.js">
    </script>
<style>
body{
    font-family: 'Roboto', 'Helvetica Neue', 'Helvetica', 'Arial', sans-serif;
    color: #606c76;
    font-weight: 350;
    line-height: 1.6;
    max-width: 1000px;
    margin-left:0;

}
          .graph{border: 1px gray solid;}
          .foo:hover{text-decoration:underline}
          .foo{font-weight:bold; color:#4e4e4e}
          .exists{font-weight:bold; color:#4e4e4e;text-decoration:none;}
          .local{font-weight:bold; color:#1e6f04;text-decoration:none;}
          .exists:hover{text-decoration:underline;color:black}
          .missing,.missing:hover{color:darkred;text-decoration:none;font-weight:normal}
          .signature {font-size:100%; margin-bottom: 2rem; display: block; border:none; background-color: #FFFFFF;
              font-weight:600;}
          h1, h2, h3 {color: #4e4e4e; font-weight:400;
              margin-bottom: 1rem;border-bottom: 1px solid var(--nc-bg-3);
          }
          pre{border-radius:0;
              padding:0.6rem;
          border-left: 3px solid #AAA}
          dt {font-weight: 400;}

          header{
              box-shadow: rgba(0, 0, 0, 0.24) 0px 3px 8px;
              
              padding-top:0rem;
              padding-bottom:0rem;
              z-index: 2;
              padding-left: 0;
              position: fixed;
              top: 30px;
              left:0; 
              width: 100%;
              height: 42px;
              backdrop-filter: blur(5px);
              background-color: rgba(255, 255, 255, .15);
          }
          dd::before {
            content: '';
          }
          header > brand, header>:first-child {
              border-right: 1px solid #ccc;
              border-left: 1px solid #ccc;
              padding: 16px;
              padding-top: 0.5rem;
              padding-bottom: 0.5rem;
              display: inline-block; 
              width: 167px;
              

          }
          brand > a {color:#606c76}
          brand > i {
              padding-right: 0.5rem;

        }
          nav{display:inline-block;
              padding: 10px;
              padding-left: 1rem;

          }

          dd {
              margin-left: 1rem;
              border-left:  solid #ddd;
              padding-left: 1rem;
          }
          summary > h2 { display: inline }

          .sidenav {
                height: 100%; /* Full-height: remove this if you want "auto" height */
                width: 200px; /* Set the width of the sidebar */
                position: fixed; /* Fixed Sidebar (stay in place on scroll) */
                z-index: 1; /* Stay on top */
                top: 0; /* Stay at the top */
                left: 0;
                background-color: var(--nc-bg-1);; /* Black */
                border-right: thin solid #ccc;
                overflow-x: hidden; /* Disable horizontal scroll */
                padding-top: 3rem;
 
                box-shadow: rgba(0, 0, 0, 0.24) 0px 3px 8px;
                
          }

          .sidenav a {
            padding: 6px 8px 6px 16px;
            text-decoration: none;
            color: #818181;
            display: block;
          }
          .sidenav img {
              width: 160px;
              padding-left:20px;
              padding-right:20px;
              border-bottom: solid thin #DDD; 
              padding-bottom: .5rem;
              max-width: 100%;
          }
          .sidenav i {
              font-size: 100;
              padding-left: 3.5rem;
              padding-right: 3.5rem;
              padding-bottom: .5rem;
              border-bottom: solid thin #DDD; 

          }
          .container {
              padding-left: 210px;
              
              padding-top: 30px;

          }

          ::selection {
	/* Set background color for selected text */
                background: #59b4fd;
                color: var(--nc-ac-tx);
          }

          img {max-width: 40%;}

          pre.highlight.execed, .admonition {
            border-left: 3px solid #0070f3;
          }
          .admonition {
            padding-left: 1em;
          }
          .admonition > div {
            background-color: rgba(0, 123, 255, 0.1);
            position: relative;
            margin: 0 -1rem;
            padding: 0.4rem 0.1rem 0.4rem 1.5rem;
            font-weight: bold;
            text-transform: capitalize;
        }
          .note {color: #7d77d2}
          .warning {color: #af7b1a}
          .error {color: #f44336}
          pre.highlight.compiled {
            border-left: 3px solid #7d77d2;
          }
          pre.highlight.syntax_error, pre.highlight.exception_in_exec {
            border-left: 3px solid #f44336;
          }

        /* Dropdown Button */
/* The container <div> - needed to position the dropdown content */
.dropdown {
  position: relative;
  display: inline-block;
  margin-left: -4px;
}

nav  a {
    color: #606c76;
    text-decoration: none;

}

/* Dropdown Content (Hidden by Default) */
.dropdown-content {
  display: none;
  position: absolute;
  background-color: #f1f1f1;
  min-width: 160px;
  box-shadow: 0px 8px 16px 0px rgba(0,0,0,0.2);
  z-index: 1;
}

/* Links inside the dropdown */
.dropdown-content a {
  color: black;
  padding: 12px 16px;
  text-decoration: none;
  display: block;
}

/* Change color of dropdown links on hover */
.dropdown-content a:hover {background-color: #ddd;}

/* Show the dropdown menu on hover */
.dropdown:hover .dropdown-content {display: block;
    max-height: 80vh;
    overflow: scroll;}

/* Change the background color of the dropdown button when the dropdown content is shown */
.dropdown:hover .dropbtn {}


pre { line-height: 125%; }
td.linenos .normal { color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px; }
span.linenos { color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px; }
td.linenos .special { color: #000000; background-color: #ffffc0; padding-left: 5px; padding-right: 5px; }
span.linenos.special { color: #000000; background-color: #ffffc0; padding-left: 5px; padding-right: 5px; }
.highlight .hll { background-color: #ffffcc }
.highlight { background: #ffffff; }
.highlight .c { color: #888888 } /* Comment */
.highlight .err { color: #a61717; background-color: #e3d2d2 } /* Error */
.highlight .k { color: #008800; font-weight: bold } /* Keyword */
.highlight .ch { color: #888888 } /* Comment.Hashbang */
.highlight .cm { color: #888888 } /* Comment.Multiline */
.highlight .cp { color: #cc0000; font-weight: bold } /* Comment.Preproc */
.highlight .cpf { color: #888888 } /* Comment.PreprocFile */
.highlight .c1 { color: #888888 } /* Comment.Single */
.highlight .cs { color: #cc0000; font-weight: bold; background-color: #fff0f0 } /* Comment.Special */
.highlight .gd { color: #000000; background-color: #ffdddd } /* Generic.Deleted */
.highlight .ge { font-style: italic } /* Generic.Emph */
.highlight .gr { color: #aa0000 } /* Generic.Error */
.highlight .gh { color: #333333 } /* Generic.Heading */
.highlight .gi { color: #000000; background-color: #ddffdd } /* Generic.Inserted */
.highlight .go { color: #888888 } /* Generic.Output */
.highlight .gp { color: #555555 } /* Generic.Prompt */
.highlight .gs { font-weight: bold } /* Generic.Strong */
.highlight .gu { color: #666666 } /* Generic.Subheading */
.highlight .gt { color: #aa0000 } /* Generic.Traceback */
.highlight .kc { color: #008800; font-weight: bold } /* Keyword.Constant */
.highlight .kd { color: #008800; font-weight: bold } /* Keyword.Declaration */
.highlight .kn { color: #008800; font-weight: bold } /* Keyword.Namespace */
.highlight .kp { color: #008800 } /* Keyword.Pseudo */
.highlight .kr { color: #008800; font-weight: bold } /* Keyword.Reserved */
.highlight .kt { color: #888888; font-weight: bold } /* Keyword.Type */
.highlight .m { color: #0000DD; font-weight: bold } /* Literal.Number */
.highlight .s { color: #dd2200; background-color: #fff0f0 } /* Literal.String */
.highlight .na { color: #336699 } /* Name.Attribute */
.highlight .nb { color: #003388 } /* Name.Builtin */
.highlight .nc { color: #bb0066; font-weight: bold } /* Name.Class */
.highlight .no { color: #003366; font-weight: bold } /* Name.Constant */
.highlight .nd { color: #555555 } /* Name.Decorator */
.highlight .ne { color: #bb0066; font-weight: bold } /* Name.Exception */
.highlight .nf { color: #0066bb; font-weight: bold } /* Name.Function */
.highlight .nl { color: #336699; font-style: italic } /* Name.Label */
.highlight .nn { color: #bb0066; font-weight: bold } /* Name.Namespace */
.highlight .py { color: #336699; font-weight: bold } /* Name.Property */
.highlight .nt { color: #bb0066; font-weight: bold } /* Name.Tag */
.highlight .nv { color: #336699 } /* Name.Variable */
.highlight .ow { color: #008800 } /* Operator.Word */
.highlight .w { color: #bbbbbb } /* Text.Whitespace */
.highlight .mb { color: #0000DD; font-weight: bold } /* Literal.Number.Bin */
.highlight .mf { color: #0000DD; font-weight: bold } /* Literal.Number.Float */
.highlight .mh { color: #0000DD; font-weight: bold } /* Literal.Number.Hex */
.highlight .mi { color: #0000DD; font-weight: bold } /* Literal.Number.Integer */
.highlight .mo { color: #0000DD; font-weight: bold } /* Literal.Number.Oct */
.highlight .sa { color: #dd2200; background-color: #fff0f0 } /* Literal.String.Affix */
.highlight .sb { color: #dd2200; background-color: #fff0f0 } /* Literal.String.Backtick */
.highlight .sc { color: #dd2200; background-color: #fff0f0 } /* Literal.String.Char */
.highlight .dl { color: #dd2200; background-color: #fff0f0 } /* Literal.String.Delimiter */
.highlight .sd { color: #dd2200; background-color: #fff0f0 } /* Literal.String.Doc */
.highlight .s2 { color: #dd2200; background-color: #fff0f0 } /* Literal.String.Double */
.highlight .se { color: #0044dd; background-color: #fff0f0 } /* Literal.String.Escape */
.highlight .sh { color: #dd2200; background-color: #fff0f0 } /* Literal.String.Heredoc */
.highlight .si { color: #3333bb; background-color: #fff0f0 } /* Literal.String.Interpol */
.highlight .sx { color: #22bb22; background-color: #f0fff0 } /* Literal.String.Other */
.highlight .sr { color: #008800; background-color: #fff0ff } /* Literal.String.Regex */
.highlight .s1 { color: #dd2200; background-color: #fff0f0 } /* Literal.String.Single */
.highlight .ss { color: #aa6600; background-color: #fff0f0 } /* Literal.String.Symbol */
.highlight .bp { color: #003388 } /* Name.Builtin.Pseudo */
.highlight .fm { color: #0066bb; font-weight: bold } /* Name.Function.Magic */
.highlight .vc { color: #336699 } /* Name.Variable.Class */
.highlight .vg { color: #dd7700 } /* Name.Variable.Global */
.highlight .vi { color: #3333bb } /* Name.Variable.Instance */
.highlight .vm { color: #336699 } /* Name.Variable.Magic */
.highlight .il { color: #0000DD; font-weight: bold } /* Literal.Number.Integer.Long */

.nsl {
-webkit-touch-callout: none;
-webkit-user-select: none;
-khtml-user-select: none;
-moz-user-select: none;
-ms-user-select: none;
user-select: none;
}


.block_directive{

    border-left: thin solid var(--nc-lk-1);
    padding-bottom: 8px;
    padding-left: 12px;
}

.block_directive.head{

    border: thin solid var(--nc-lk-1);
}


.block_directive > p{
    margin-left: 2em;
    margin-top: 1em;
}
.head {
    font-family: monospace;
    color: var(--nc-lk-1);
}
</style>
</head>
<body class="tex2jax_ignore">
    <header>
            <brand><i class="fab fa-python"></i><a href='/'>Home</a></brand>
        <nav> / <a href='/' >p</a>  &nbsp;/&nbsp; 
                <div class="dropdown">
                <a href=xarray>xarray</a>&nbsp;/&nbsp;
                    <div class="dropdown-content">
                            <a href="/p/IPython/8.0.0.dev/api/IPython.html">IPython</a>
                            <a href="/p/dask/2021.10.0/api/dask.html">dask</a>
                            <a href="/p/distributed/2021.01.1+9.g613b3c820/api/distributed.html">distributed</a>
                            <a href="/p/matplotlib/3.5.0/api/matplotlib.html">matplotlib</a>
                            <a href="/p/numpy/1.21.3/api/numpy.html">numpy</a>
                            <a href="/p/pandas/1.3.4/api/pandas.html">pandas</a>
                            <a href="/p/papyri/0.0.8/api/papyri.html">papyri</a>
                            <a href="/p/scipy/1.7.1/api/scipy.html">scipy</a>
                            <a href="/p/skimage/0.18.3/api/skimage.html">skimage</a>
                            <a href="/p/xarray/0.17.0/api/xarray.html">xarray</a>
                            
                     </div>
                </div>
                <div class="dropdown">
                <a href='/p/xarray/0.17.0/api/xarray.html'>0.17.0</a>&nbsp;/&nbsp;
                    <div class="dropdown-content">
                            <a href="/p/xarray/0.17.0/api/xarray.html">0.17.0</a>
                            
                    </div>
                </div>

                <div class="dropdown">
                    <a href='/p/xarray/0.17.0/api/xarray.html'>api</a>&nbsp;/&nbsp;
                    <div class="dropdown-content">
                        <a href="/p/xarray/0.17.0/api/xarray.html">API</a>
                        <a href="/p/xarray/0.17.0/gallery">Gallery</a>
                     </div>
                </div>

            
                
                    <div class="dropdown">
                        
                            <a class="dropbtn" href='xarray.html'>xarray</a>.
                        
                        
                    </div>
                
                
                    <div class="dropdown">
                        
                            <a class="dropbtn" href='xarray.core.html'>core</a>.
                        
                        
                            <div class="dropdown-content">
                            <a href="/p/xarray/0.17.0/api/xarray.backends.html">backends</a>
                            <a href="/p/xarray/0.17.0/api/xarray.coding.html">coding</a>
                            <a href="/p/xarray/0.17.0/api/xarray.conventions.html">conventions</a>
                            <a href="/p/xarray/0.17.0/api/xarray.core.html">core</a>
                            <a href="/p/xarray/0.17.0/api/xarray.plot.html">plot</a>
                            <a href="/p/xarray/0.17.0/api/xarray.testing.html">testing</a>
                            <a href="/p/xarray/0.17.0/api/xarray.tutorial.html">tutorial</a>
                            <a href="/p/xarray/0.17.0/api/xarray.ufuncs.html">ufuncs</a>
                            <a href="/p/xarray/0.17.0/api/xarray.util.html">util</a>
                            
                            </div>
                        
                    </div>
                
                
                    <div class="dropdown">
                        
                            <a class="dropbtn" href='xarray.core.parallel.html'>parallel</a>.
                        
                        
                            <div class="dropdown-content">
                            <a href="/p/xarray/0.17.0/api/xarray.core.accessor_dt.html">accessor_dt</a>
                            <a href="/p/xarray/0.17.0/api/xarray.core.accessor_str.html">accessor_str</a>
                            <a href="/p/xarray/0.17.0/api/xarray.core.alignment.html">alignment</a>
                            <a href="/p/xarray/0.17.0/api/xarray.core.arithmetic.html">arithmetic</a>
                            <a href="/p/xarray/0.17.0/api/xarray.core.combine.html">combine</a>
                            <a href="/p/xarray/0.17.0/api/xarray.core.common.html">common</a>
                            <a href="/p/xarray/0.17.0/api/xarray.core.computation.html">computation</a>
                            <a href="/p/xarray/0.17.0/api/xarray.core.concat.html">concat</a>
                            <a href="/p/xarray/0.17.0/api/xarray.core.coordinates.html">coordinates</a>
                            <a href="/p/xarray/0.17.0/api/xarray.core.dask_array_compat.html">dask_array_compat</a>
                            <a href="/p/xarray/0.17.0/api/xarray.core.dask_array_ops.html">dask_array_ops</a>
                            <a href="/p/xarray/0.17.0/api/xarray.core.dataarray.html">dataarray</a>
                            <a href="/p/xarray/0.17.0/api/xarray.core.dataset.html">dataset</a>
                            <a href="/p/xarray/0.17.0/api/xarray.core.dtypes.html">dtypes</a>
                            <a href="/p/xarray/0.17.0/api/xarray.core.duck_array_ops.html">duck_array_ops</a>
                            <a href="/p/xarray/0.17.0/api/xarray.core.extensions.html">extensions</a>
                            <a href="/p/xarray/0.17.0/api/xarray.core.formatting.html">formatting</a>
                            <a href="/p/xarray/0.17.0/api/xarray.core.formatting_html.html">formatting_html</a>
                            <a href="/p/xarray/0.17.0/api/xarray.core.groupby.html">groupby</a>
                            <a href="/p/xarray/0.17.0/api/xarray.core.indexes.html">indexes</a>
                            <a href="/p/xarray/0.17.0/api/xarray.core.indexing.html">indexing</a>
                            <a href="/p/xarray/0.17.0/api/xarray.core.merge.html">merge</a>
                            <a href="/p/xarray/0.17.0/api/xarray.core.missing.html">missing</a>
                            <a href="/p/xarray/0.17.0/api/xarray.core.nanops.html">nanops</a>
                            <a href="/p/xarray/0.17.0/api/xarray.core.npcompat.html">npcompat</a>
                            <a href="/p/xarray/0.17.0/api/xarray.core.nputils.html">nputils</a>
                            <a href="/p/xarray/0.17.0/api/xarray.core.ops.html">ops</a>
                            <a href="/p/xarray/0.17.0/api/xarray.core.options.html">options</a>
                            <a href="/p/xarray/0.17.0/api/xarray.core.parallel.html">parallel</a>
                            <a href="/p/xarray/0.17.0/api/xarray.core.pdcompat.html">pdcompat</a>
                            <a href="/p/xarray/0.17.0/api/xarray.core.pycompat.html">pycompat</a>
                            <a href="/p/xarray/0.17.0/api/xarray.core.resample.html">resample</a>
                            <a href="/p/xarray/0.17.0/api/xarray.core.rolling.html">rolling</a>
                            <a href="/p/xarray/0.17.0/api/xarray.core.rolling_exp.html">rolling_exp</a>
                            <a href="/p/xarray/0.17.0/api/xarray.core.utils.html">utils</a>
                            <a href="/p/xarray/0.17.0/api/xarray.core.variable.html">variable</a>
                            <a href="/p/xarray/0.17.0/api/xarray.core.weighted.html">weighted</a>
                            
                            </div>
                        
                    </div>
                
                
                    <div class="dropdown">
                        
                            <a class="dropbtn" href='xarray.core.parallel.map_blocks.html'>map_blocks</a>
                        
                        
                            <div class="dropdown-content">
                            <a href="/p/xarray/0.17.0/api/xarray.core.parallel.T_DSorDA.html">T_DSorDA</a>
                            <a href="/p/xarray/0.17.0/api/xarray.core.parallel.infer_template.html">infer_template</a>
                            <a href="/p/xarray/0.17.0/api/xarray.core.parallel.make_dict.html">make_dict</a>
                            <a href="/p/xarray/0.17.0/api/xarray.core.parallel.make_meta.html">make_meta</a>
                            <a href="/p/xarray/0.17.0/api/xarray.core.parallel.map_blocks.html">map_blocks</a>
                            
                            </div>
                        
                    </div>
                </nav>
    </header>
<div class='container'>
    <div class="sidenav">
    
        <img src="/p/xarray/0.17.0/img/logo.png"/>
    
    <a href="#">Library: xarray</a>
    <a href="#">Version: 0.17.0</a>
    <a href="#">Authors:</a>
    <a href="#">PyPI:</a>
    <a href="#">Source</a>
    <a href="#">Homepage</a>
    <a href="#">Fundings</a>
    <a href="#">Stars</a>
    <a href="#">Forks</a>
    <a href="#">Related</a>
    <hr/>
    <a>Narrative Docs</a>
    <hr/>
    <a href="#section-Parameters">Parameters</a>

    <a href="#section-Returns">Returns</a>

    <a href="#section-Notes">Notes</a>

    <a href="#section-backrefs">BackRef</a>
    

    </div>

    













    <code class='signature'>map_blocks(func: Callable[..., ~T_DSorDA], obj: Union[xarray.core.dataarray.DataArray, xarray.core.dataset.Dataset], args: Sequence[Any] = (), kwargs: Mapping[str, Any] = None, template: Union[xarray.core.dataarray.DataArray, xarray.core.dataset.Dataset] = None) -&gt; ~T_DSorDA</code>




    
    
        <!-- rendering Summary -->
        
           
               
        <p>Apply a function to each block of a DataArray or Dataset.</p>

    
           
       
    


    
    
        <!-- rendering Extended Summary -->
        
           
               
            <div class='admonition'>
    <div>warning</div>
    
        
        <p>This function is experimental and its signature may change.</p>

    
    
</div>

       
           
       
    


    
        <h3 id="section-Parameters">Parameters</h3>
    
    
       <dl>
           
            
                <dt><a id="func">func</a> : callable</dt>
            
        </dl>

        <dd>
            
                
        <p>User-provided function that accepts a DataArray or Dataset as its first parameter 
        <code class='verbatim'>obj</code>
    . The function will receive a subset or &#39;block&#39; of 
        <code class='verbatim'>obj</code>
     (see below), corresponding to one chunk along each chunked dimension. 
        <code class='verbatim'>func</code>
     will be executed as 
        <code class='verbatim'>func(subset_obj, *subset_args, **kwargs)</code>
    .</p>

    
            
                
        <p>This function must return either a single DataArray or a single Dataset.</p>

    
            
                
        <p>This function cannot add a new chunked dimension.</p>

    
            
        </dd>
       
            
                <dt><a id="obj">obj</a> : DataArray, Dataset</dt>
            
        </dl>

        <dd>
            
                
        <p>Passed to the function as its first argument, one block at a time.</p>

    
            
        </dd>
       
            
                <dt><a id="args">args</a> : sequence</dt>
            
        </dl>

        <dd>
            
                
        <p>Passed to func after unpacking and subsetting any xarray objects by blocks. xarray objects in args must be aligned with obj, otherwise an error is raised.</p>

    
            
        </dd>
       
            
                <dt><a id="kwargs">kwargs</a> : mapping</dt>
            
        </dl>

        <dd>
            
                
        <p>Passed verbatim to func after unpacking. xarray objects, if any, will not be subset to blocks. Passing dask collections in kwargs is not allowed.</p>

    
            
        </dd>
       
            
                <dt><a id="template">template</a> : DataArray or Dataset, optional</dt>
            
        </dl>

        <dd>
            
                
        <p>xarray object representing the final result after compute is called. If not provided, the function will be first run on mocked-up data, that looks like 
        <code class='verbatim'>obj</code>
     but has sizes 0, to determine properties of the returned object such as dtype, variable names, attributes, new dimensions and new indexes (if any). 
        <code class='verbatim'>template</code>
     must be provided if the function changes the size of existing dimensions. When provided, 
        <code class='verbatim'>attrs</code>
     on variables in <code><a link href="#template" class='local'>template</a></code> are copied over to the result. Any 
        <code class='verbatim'>attrs</code>
     set by 
        <code class='verbatim'>func</code>
     will be ignored.</p>

    
            
        </dd>
       

   </pre>
   


    
        <h3 id="section-Returns">Returns</h3>
    
    
       <dl>
           
            
                <dt>A single DataArray or Dataset with dask backend, reassembled from the outputs of the</dt>
            
        </dl>

        <dd>
            
        </dd>
       
            
                <dt>function.</dt>
            
        </dl>

        <dd>
            
        </dd>
       

   </pre>
   


    
    
       <dl>
           

   </pre>
   


    
    
       
   


    
    
       <dl>
           

   </pre>
   


    
    
       <dl>
           

   </pre>
   


    
    
       <dl>
           

   </pre>
   


    
    
       <dl>
           

   </pre>
   


    
    
       
   


    
        <h3 id="section-Notes">Notes</h3>
    
    
        <!-- rendering Notes -->
        
           
               
        <p>This function is designed for when 
        <code class='verbatim'>func</code>
     needs to manipulate a whole xarray object subset to each block. In the more common case where 
        <code class='verbatim'>func</code>
     can work on numpy arrays, it is recommended to use 
        <code class='verbatim'>apply_ufunc</code>
    .</p>

    
           
               
        <p>If none of the variables in 
        <code class='verbatim'>obj</code>
     is backed by dask arrays, calling this function is equivalent to calling 
        <code class='verbatim'>func(obj, *args, **kwargs)</code>
    .</p>

    
           
       
    


    
    
       
   



    <h3 id="section-Examples">Examples</h3>
        
                
        <p>Calculate an anomaly from climatology using 
        <code class='verbatim'>.groupby()</code>
    . Using 
        <code class='verbatim'>xr.map_blocks()</code>
     allows for parallel operations with knowledge of 
        <code class='verbatim'>xarray</code>
    , its indices, and its methods like 
        <code class='verbatim'>.groupby()</code>
    .</p>

    
            
            
         
                <span class='note'>This example is valid syntax, but we were not able to check execution</span><pre class='highlight compiled'><span class='nsl'>&gt;&gt;&gt; </span><a class="foo k", href="/p/xarray/0.17.0/api/xarray.core.indexes.default_indexes.html">def</a><span class=""> </span><span class="nf">calculate_anomaly</span><span class="">(</span><span class="">da</span><span class="">,</span><span class=""> </span><span class="">groupby_type</span><span class="o">=</span><span class="s2">&#34;</span><span class="s2">time.month</span><span class="s2">&#34;</span><span class="">)</span><span class="">:</span><br><span class='nsl'>...&nbsp;</span><span class="">    </span><span class="">gb</span><span class=""> </span><span class="o">=</span><span class=""> </span><span class="">da</span><span class="o">.</span><a class="foo ", href="/p/xarray/0.17.0/api/xarray.core.groupby.html">groupby</a><span class="">(</span><span class="">groupby_type</span><span class="">)</span><br><span class='nsl'>...&nbsp;</span><span class="">    </span><span class="">clim</span><span class=""> </span><span class="o">=</span><span class=""> </span><span class="">gb</span><span class="o">.</span><span class="">mean</span><span class="">(</span><span class="">dim</span><span class="o">=</span><span class="s2">&#34;</span><span class="s2">time</span><span class="s2">&#34;</span><span class="">)</span><br><span class='nsl'>...&nbsp;</span><span class="">    </span><span class="k">return</span><span class=""> </span><span class="">gb</span><span class=""> </span><span class="o">-</span><span class=""> </span><span class="">clim</span>
...</pre>
            
            
         
                <span class='note'>This example is valid syntax, but we were not able to check execution</span><pre class='highlight compiled'><span class='nsl'>&gt;&gt;&gt; </span><span class="">time</span><span class=""> </span><span class="o">=</span><span class=""> </span><span class="">xr</span><span class="o">.</span><a class="foo ", href="/p/xarray/0.17.0/api/xarray.coding.cftime_offsets.cftime_range.html">cftime_range</a><span class="">(</span><span class="s2">&#34;</span><span class="s2">1990-01</span><span class="s2">&#34;</span><span class="">,</span><span class=""> </span><span class="s2">&#34;</span><span class="s2">1992-01</span><span class="s2">&#34;</span><span class="">,</span><span class=""> </span><span class="">freq</span><span class="o">=</span><span class="s2">&#34;</span><span class="s2">M</span><span class="s2">&#34;</span><span class="">)</span><br><span class='nsl'>...&nbsp;</span><span class="">month</span><span class=""> </span><span class="o">=</span><span class=""> </span><span class="">xr</span><span class="o">.</span><a class="foo ", href="/p/xarray/0.17.0/api/xarray.core.dataarray.DataArray.html">DataArray</a><span class="">(</span><span class="">time</span><span class="o">.</span><span class="">month</span><span class="">,</span><span class=""> </span><span class="">coords</span><span class="o">=</span><span class="">{</span><span class="s2">&#34;</span><span class="s2">time</span><span class="s2">&#34;</span><span class="">:</span><span class=""> </span><span class="">time</span><span class="">}</span><span class="">,</span><span class=""> </span><span class="">dims</span><span class="o">=</span><span class="">[</span><span class="s2">&#34;</span><span class="s2">time</span><span class="s2">&#34;</span><span class="">]</span><span class="">)</span><br><span class='nsl'>...&nbsp;</span><a class="foo ", href="/p/numpy/1.21.3/api/numpy.html">np</a><span class="o">.</span><a class="foo ", href="/p/numpy/1.21.3/api/numpy.random.html">random</a><span class="o">.</span><span class="">seed</span><span class="">(</span><span class="mi">123</span><span class="">)</span><br><span class='nsl'>...&nbsp;</span><span class="">array</span><span class=""> </span><span class="o">=</span><span class=""> </span><span class="">xr</span><span class="o">.</span><a class="foo ", href="/p/xarray/0.17.0/api/xarray.core.dataarray.DataArray.html">DataArray</a><span class="">(</span><br><span class='nsl'>...&nbsp;</span><span class="">    </span><a class="foo ", href="/p/numpy/1.21.3/api/numpy.html">np</a><span class="o">.</span><a class="foo ", href="/p/numpy/1.21.3/api/numpy.random.html">random</a><span class="o">.</span><span class="">rand</span><span class="">(</span><a class="foo nb", href="/p/xarray/0.17.0/api/xarray.core.accessor_str.StringAccessor.len.html">len</a><span class="">(</span><span class="">time</span><span class="">)</span><span class="">)</span><span class="">,</span><br><span class='nsl'>...&nbsp;</span><span class="">    </span><span class="">dims</span><span class="o">=</span><span class="">[</span><span class="s2">&#34;</span><span class="s2">time</span><span class="s2">&#34;</span><span class="">]</span><span class="">,</span><br><span class='nsl'>...&nbsp;</span><span class="">    </span><span class="">coords</span><span class="o">=</span><span class="">{</span><span class="s2">&#34;</span><span class="s2">time</span><span class="s2">&#34;</span><span class="">:</span><span class=""> </span><span class="">time</span><span class="">,</span><span class=""> </span><span class="s2">&#34;</span><span class="s2">month</span><span class="s2">&#34;</span><span class="">:</span><span class=""> </span><span class="">month</span><span class="">}</span><span class="">,</span><br><span class='nsl'>...&nbsp;</span><span class="">)</span><span class="o">.</span><span class="">chunk</span><span class="">(</span><span class="">)</span><br><span class='nsl'>...&nbsp;</span><span class="">array</span><span class="o">.</span><a class="foo ", href="/p/xarray/0.17.0/api/xarray.core.parallel.map_blocks.html">map_blocks</a><span class="">(</span><span class="">calculate_anomaly</span><span class="">,</span><span class=""> </span><a class="foo ", href="/p/xarray/0.17.0/api/xarray.core.parallel.infer_template.html">template</a><span class="o">=</span><span class="">array</span><span class="">)</span><span class="o">.</span><span class="">compute</span><span class="">(</span><span class="">)</span>
&lt;xarray.DataArray (time: 24)&gt;
array([ 0.12894847,  0.11323072, -0.0855964 , -0.09334032,  0.26848862,
        0.12382735,  0.22460641,  0.07650108, -0.07673453, -0.22865714,
       -0.19063865,  0.0590131 , -0.12894847, -0.11323072,  0.0855964 ,
        0.09334032, -0.26848862, -0.12382735, -0.22460641, -0.07650108,
        0.07673453,  0.22865714,  0.19063865, -0.0590131 ])
Coordinates:
  * time     (time) object 1990-01-31 00:00:00 ... 1991-12-31 00:00:00
    month    (time) int64 1 2 3 4 5 6 7 8 9 10 11 12 1 2 3 4 5 6 7 8 9 10 11 12</pre>
            
            
         
                
        <p>Note that one must explicitly use 
        <code class='verbatim'>args=[]</code>
     and 
        <code class='verbatim'>kwargs={}</code>
     to pass arguments to the function being applied in 
        <code class='verbatim'>xr.map_blocks()</code>
    :</p>

    
            
            
         
                <span class='note'>This example is valid syntax, but we were not able to check execution</span><pre class='highlight compiled'><span class='nsl'>&gt;&gt;&gt; </span><span class="">array</span><span class="o">.</span><a class="foo ", href="/p/xarray/0.17.0/api/xarray.core.parallel.map_blocks.html">map_blocks</a><span class="">(</span><br><span class='nsl'>...&nbsp;</span><span class="">    </span><span class="">calculate_anomaly</span><span class="">,</span><br><span class='nsl'>...&nbsp;</span><span class="">    </span><a class="foo ", href="/p/xarray/0.17.0/api/xarray.plot.utils._process_cmap_cbar_kwargs.html">kwargs</a><span class="o">=</span><span class="">{</span><span class="s2">&#34;</span><span class="s2">groupby_type</span><span class="s2">&#34;</span><span class="">:</span><span class=""> </span><span class="s2">&#34;</span><span class="s2">time.year</span><span class="s2">&#34;</span><span class="">}</span><span class="">,</span><br><span class='nsl'>...&nbsp;</span><span class="">    </span><a class="foo ", href="/p/xarray/0.17.0/api/xarray.core.parallel.infer_template.html">template</a><span class="o">=</span><span class="">array</span><span class="">,</span><br><span class='nsl'>...&nbsp;</span><span class="">)</span><span class="">  </span><span class="c1"># doctest: +ELLIPSIS</span>
&lt;xarray.DataArray (time: 24)&gt;
dask.array&lt;calculate_anomaly-...-&lt;this, shape=(24,), dtype=float64, chunksize=(24,), chunktype=numpy.ndarray&gt;
Coordinates:
  * time     (time) object 1990-01-31 00:00:00 ... 1991-12-31 00:00:00
    month    (time) int64 dask.array&lt;chunksize=(24,), meta=np.ndarray&gt;</pre>
            
            
         
         See :
         
             <code><a link href="/p/xarray/0.17.0/api/xarray.core.parallel.infer_template.html" class='exists'>xarray.core.parallel.infer_template</a></code>
        
         
             <code><a link href="/p/xarray/0.17.0/api/xarray.core.parallel.map_blocks.html" class='exists'>xarray.core.parallel.map_blocks</a></code>
        
         
             <code><a link href="/p/xarray/0.17.0/api/xarray.plot.utils._process_cmap_cbar_kwargs.html" class='exists'>xarray.plot.utils._process_cmap_cbar_kwargs</a></code>
        
         
             <code><a link href="/p/xarray/0.17.0/api/xarray.core.accessor_str.StringAccessor.len.html" class='exists'>xarray.core.accessor_str.StringAccessor.len</a></code>
        
         
             <code><a link href="/p/xarray/0.17.0/api/xarray.core.indexes.default_indexes.html" class='exists'>xarray.core.indexes.default_indexes</a></code>
        
         
             <code><a link href="/p/xarray/0.17.0/api/xarray.core.dataarray.DataArray.html" class='exists'>xarray.core.dataarray.DataArray</a></code>
        
         
             <code><a link href="/p/numpy/1.21.3/api/numpy.html" class='exists'>numpy</a></code>
        
         
             <code><a link href="/p/xarray/0.17.0/api/xarray.coding.cftime_offsets.cftime_range.html" class='exists'>xarray.coding.cftime_offsets.cftime_range</a></code>
        
         
             <code><a link href="/p/xarray/0.17.0/api/xarray.core.groupby.html" class='exists'>xarray.core.groupby</a></code>
        
         
             <code><a link href="/p/numpy/1.21.3/api/numpy.random.html" class='exists'>numpy.random</a></code>
        
         
     
    


    <h3 id='section-backrefs'>Back References</h3>
    <p>The following pages refer to to this document either explicitly or contain code examples using this.</p>

    
    
        <code><a link href="/p/xarray/0.17.0/api/xarray.core.parallel.map_blocks.html" class='exists'>xarray.core.parallel.map_blocks</a></code>
        
    
    
    



<h3>Local connectivity graph</h3>
<p>Hover to see nodes names; edges to Self not shown, Caped at 50 nodes.</p>

<p> Using a canvas is more power efficient and can get hundred of nodes ; but does not allow hyperlinks; , arrows
or text (beyond on hover) </p> 
<canvas class='graph' width="800" height="500"></canvas>
<p> SVG is more flexible but power hungry; and does not scale well to 50 + nodes. </p> 

<svg class='graph' width="600" height="500"></svg>

<p>All aboves nodes referred to, (or are referred from) current nodes; Edges from Self to other have been omitted
(or all nodes would be connected to the central node "self" which is not useful). Nodes are colored by the library
they belong to, and scaled with the number of references pointing them</p>


<hr>

To Be Done: </br>

File: /Users/bussonniermatthias/miniconda3/lib/python3.8/site-packages/xarray/core/parallel.py </br>
Line: 163 </br>
type: &lt;class &#39;function&#39;&gt; </br>
Commit: </br>
Tag: </br>
Link to the right github gitalab repository, file and line (maybe range?)</br>
</div>


    
    <script src="https://d3js.org/d3.v4.min.js"></script>
    <script src="https://d3js.org/d3-selection-multi.v1.js"></script>
        <style type="text/css">
        .node {}

        .link { stroke: #999; stroke-opacity: .6; stroke-width: 1px; }
    </style>
<script>

var canvas = document.querySelector("canvas"),
    context = canvas.getContext("2d"),
    width = canvas.width,
    height = canvas.height;
var searchRadius = 40;



var color = d3.scaleOrdinal()
    .range(d3.schemeCategory10);

var canvas_simulation = d3.forceSimulation()
    .force("charge", d3.forceManyBody().strength(-100))
    .force("link", d3.forceLink().distance(30).strength(0.1).iterations(1).id(function(d) { return d.id; }))
    .force("x", d3.forceX().strength(0.1))
    .force("y", d3.forceY().strength(0.2));


var canvas_graph = {"nodes": [{"id": 1, "val": 10.449489742783179, "label": "xarray.core.indexes.default_indexes", "mod": "xarray", "url": "/p/xarray/0.17.0/api/xarray.core.indexes.default_indexes"}, {"id": 2, "val": 45.26929030716845, "label": "numpy", "mod": "numpy", "url": "/p/numpy/1.21.3/api/numpy"}, {"id": 3, "val": 10.23606797749979, "label": "xarray.plot.utils._process_cmap_cbar_kwargs", "mod": "xarray", "url": "/p/xarray/0.17.0/api/xarray.plot.utils._process_cmap_cbar_kwargs"}, {"id": 4, "val": 20.409673645990857, "label": "numpy.random", "mod": "numpy", "url": "/p/numpy/1.21.3/api/numpy.random"}, {"id": 5, "val": 10.64575131106459, "label": "xarray.coding.cftime_offsets.cftime_range", "mod": "xarray", "url": "/p/xarray/0.17.0/api/xarray.coding.cftime_offsets.cftime_range"}, {"id": 6, "val": 9.732050807568877, "label": "xarray.core.parallel.infer_template", "mod": "xarray", "url": "/p/xarray/0.17.0/api/xarray.core.parallel.infer_template"}, {"id": 7, "val": 11.0, "label": "xarray.core.groupby", "mod": "xarray", "url": "/p/xarray/0.17.0/api/xarray.core.groupby"}, {"id": 8, "val": 9.732050807568877, "label": "xarray.core.accessor_str.StringAccessor.len", "mod": "xarray", "url": "/p/xarray/0.17.0/api/xarray.core.accessor_str.StringAccessor.len"}, {"id": 9, "val": 16.0, "label": "xarray.core.dataarray.DataArray", "mod": "xarray", "url": "/p/xarray/0.17.0/api/xarray.core.dataarray.DataArray"}], "links": [{"source": 2, "target": 9, "id": 1373}, {"source": 4, "target": 9, "id": 1630}]};

(function() {

  var pages = d3.nest()
      .key(function(d) { return d.mod; })
      .entries(canvas_graph.nodes)
      .sort(function(a, b) { return b.values.length - a.values.length; });

  var c = color.domain(pages.map(function(d) { return d.key; }));

    

  canvas_simulation
      .nodes(canvas_graph.nodes)
      .on("tick", ticked);

  canvas_simulation.force("link")
      .links(canvas_graph.links);

  d3.select(canvas)
      .on("mousemove", mousemoved)
      .call(d3.drag()
          .container(canvas)
          .subject(dragsubject)
          .on("start", dragstarted)
          .on("drag", dragged)
          .on("end", dragended));

  function ticked() {
    context.clearRect(0, 0, width, height);
    context.save();
    context.translate(width / 2, height / 2);

    context.beginPath();
    canvas_graph.links.forEach(drawLink);
    context.strokeStyle = "#aaa";
    context.stroke();
    var margin = 10; 
    
    pages.forEach(function(page) {
      context.beginPath();
      page.values.forEach(drawNode);
      context.fillStyle = color(page.key);
      context.fill();
    });

    context.restore();

  }

  function dragsubject() {
    return canvas_simulation.find(d3.event.x - width / 2, d3.event.y - height / 2, searchRadius);
  }

  function mousemoved() {
    var a = this.parentNode, m = d3.mouse(this), d = canvas_simulation.find(m[0] - width / 2, m[1] - height / 2, searchRadius);
    if (!d) return a.removeAttribute("href"), a.removeAttribute("title");
    //a.setAttribute("href", "http://bl.ocks.org/" + (d.user ? d.user + "/" : "") + d.id);
    a.setAttribute("title", d.label );
  }
})();

function dragstarted() {
  if (!d3.event.active) canvas_simulation.alphaTarget(0.3).restart();
  d3.event.subject.fx = d3.event.subject.x;
  d3.event.subject.fy = d3.event.subject.y;
}

function dragged() {
  d3.event.subject.fx = d3.event.x;
  d3.event.subject.fy = d3.event.y;
}

function dragended() {
  if (!d3.event.active) canvas_simulation.alphaTarget(0);
  d3.event.subject.fx = null;
  d3.event.subject.fy = null;
}

function drawLink(d) {
  context.moveTo(d.source.x, d.source.y);
  context.lineTo(d.target.x, d.target.y);
   //context.moveTo(d.x + 3, d.y);
  //context.arc((d.target.x*9+d.source.x)/10, (d.target.y*9+d.source.y)/10, 2, 0, 2 * Math.PI);
}

function drawNode(d) {
  context.moveTo(d.x + 5, d.y);
  context.arc(d.x, d.y, d.val, 0, 2 * Math.PI);
}

</script>
<script type="text/javascript">
    var colors = d3.scaleOrdinal(d3.schemeCategory10);

    var svg = d3.select("svg");
    var width = svg.attr("width");
    var height = svg.attr("height");
    var node;
    var link;

    // syle for arrow head in the svg...
    svg.append('defs').append('marker')
        .attrs({'id':'arrowhead',
            'viewBox':'-0 -5 10 10',
            'refX':13,
            'refY':0,
            'orient':'auto',
            'markerWidth':13,
            'markerHeight':13,
            'xoverflow':'visible'})
        .append('svg:path')
        .attr('d', 'M 0,-5 L 10 ,0 L 0,5')
        .attr('fill', '#999')
        .style('stroke','none');


    var svg_simulation = d3.forceSimulation()
        .force("charge", d3.forceManyBody().strength(-100))
        .force("link", d3.forceLink().distance(80).strength(0.01).iterations(10).id(function(d) { return d.id; }))
        .force("x", d3.forceX(width/2).strength(0.04))
        .force("y", d3.forceY(height/2).strength(0.06));





    var svg_graph = {"nodes": [{"id": 1, "val": 10.449489742783179, "label": "xarray.core.indexes.default_indexes", "mod": "xarray", "url": "/p/xarray/0.17.0/api/xarray.core.indexes.default_indexes"}, {"id": 2, "val": 45.26929030716845, "label": "numpy", "mod": "numpy", "url": "/p/numpy/1.21.3/api/numpy"}, {"id": 3, "val": 10.23606797749979, "label": "xarray.plot.utils._process_cmap_cbar_kwargs", "mod": "xarray", "url": "/p/xarray/0.17.0/api/xarray.plot.utils._process_cmap_cbar_kwargs"}, {"id": 4, "val": 20.409673645990857, "label": "numpy.random", "mod": "numpy", "url": "/p/numpy/1.21.3/api/numpy.random"}, {"id": 5, "val": 10.64575131106459, "label": "xarray.coding.cftime_offsets.cftime_range", "mod": "xarray", "url": "/p/xarray/0.17.0/api/xarray.coding.cftime_offsets.cftime_range"}, {"id": 6, "val": 9.732050807568877, "label": "xarray.core.parallel.infer_template", "mod": "xarray", "url": "/p/xarray/0.17.0/api/xarray.core.parallel.infer_template"}, {"id": 7, "val": 11.0, "label": "xarray.core.groupby", "mod": "xarray", "url": "/p/xarray/0.17.0/api/xarray.core.groupby"}, {"id": 8, "val": 9.732050807568877, "label": "xarray.core.accessor_str.StringAccessor.len", "mod": "xarray", "url": "/p/xarray/0.17.0/api/xarray.core.accessor_str.StringAccessor.len"}, {"id": 9, "val": 16.0, "label": "xarray.core.dataarray.DataArray", "mod": "xarray", "url": "/p/xarray/0.17.0/api/xarray.core.dataarray.DataArray"}], "links": [{"source": 2, "target": 9, "id": 1373}, {"source": 4, "target": 9, "id": 1630}]};
    (function (error, graph) {
            if (error) throw error;
        graph.nodes.forEach(function(d) { d.x = width*Math.random(); d.y = height*Math.random()});
        update(graph.links, graph.nodes);
        })(null, svg_graph);

    var edgelabels;

    function update(links, nodes) {
        link = svg.selectAll(".link")
            .data(links)
            .enter()
            .append("line")
            .attr("class", "link")
            .attr('marker-end','url(#arrowhead)');

        //link.append("title")
        //    .text(function (d) {return d.type;});

        edgepaths = svg.selectAll(".edgepath")
            .data(links)
            .enter()
            .append('path')
            .attrs({
                'class': 'edgepath',
                'fill-opacity': 0,
                'stroke-opacity': 0,
                'id': function (d, i) {return 'edgepath' + i}
            })
            .style("pointer-events", "none");

        edgelabels = svg.selectAll(".edgelabel")
            .data(links)
            .enter()
            .append('text')
            .style("pointer-events", "none")
            .attrs({
                'class': 'edgelabel',
                'id': function (d, i) {return 'edgelabel' + i},
                'font-size': 10,
                'fill': '#aaa'
            });

        edgelabels.append('textPath')
            .attr('xlink:href', function (d, i) {return '#edgepath' + i})
            .style("text-anchor", "middle")
            .style("pointer-events", "none")
            .attr("startOffset", "50%")
            .text(function (d) {return d.type});

        node = svg.selectAll(".node")
            .data(nodes)
            .enter()
            .append("g")
            .attr("class", "node")
            .call(d3.drag()
                    .on("start", dragstarted)
                    .on("drag", dragged)
                    .on("end", dragended)
            );

        node.append("a")
                .attr("xlink:href", function(node){return node.url})
            .append("circle")
                .attr("r", function(node){return node.val})
                .style("fill", function (d, i) {return colors(d.mod);})
                .style("stroke", "#FFF")

        node.append("title")
            .text(function (d) {return d.label;});

        node.append("text")
                //.attr("dx", function(node){return node.val+1})
                .attr("dy", +10)
                .attr("opacity", "0.5")
            .text(function (d) {arr = d.label.split('.'); return arr[arr.length-1]});

        svg_simulation
            .nodes(nodes)
            .on("tick", ticked);

        svg_simulation.force("link")
                .links(links)

    }

    function ticked() {
        link
            .attr("x1", function (d) {return d.source.x;})
            .attr("y1", function (d) {return d.source.y;})
            .attr("x2", function (d) {return d.target.x;})
            .attr("y2", function (d) {return d.target.y;});

        node
            .attr("transform", function (d) {return "translate(" + d.x + ", " + d.y + ")";});

        edgepaths.attr('d', function (d) {
            return 'M ' + d.source.x + ' ' + d.source.y + ' L ' + d.target.x + ' ' + d.target.y;
        });

        edgelabels.attr('transform', function (d) {
            if (d.target.x < d.source.x) {
                var bbox = this.getBBox();

                rx = bbox.x + bbox.width / 2;
                ry = bbox.y + bbox.height / 2;
                return 'rotate(180 ' + rx + ' ' + ry + ')';
            }
            else {
                return 'rotate(0)';
            }
        });
    }

    function dragstarted(d) {
        if (!d3.event.active) svg_simulation.alphaTarget(0.3).restart()
        d.fx = d.x;
        d.fy = d.y;
    }

    function dragged(d) {
        d.fx = d3.event.x;
        d.fy = d3.event.y;
    }

    function dragended(d) {
        if (!d3.event.active) svg_simulation.alphaTarget(0);
        d.fx = null;
        d.fy = null;
    }

</script>




</div>
</body>
</html>