<!doctypehtml><html lang=en><meta charset=UTF-8><meta content=width=device-width,initial-scale=1.0 name=viewport><title>Document</title><link href=https://fonts.xz.style/serve/inter.css rel=stylesheet><link crossorigin=anonymous href=https://use.fontawesome.com/releases/v5.8.1/css/all.css integrity=sha384-50oBUHEmvpQ+1lW4y57PTFmhCaXp0ML5d60M1M7uH2+nqUivzIebhndOJK28anvf rel=stylesheet><link href=https://cdn.jsdelivr.net/npm/@exampledev/new.css@1.1.2/new.min.css rel=stylesheet><script type=text/x-mathjax-config>
        // this should process only math inside  span with tex2jax_process class
    MathJax.Hub.Config({
        extensions: ["tex2jax.js"],
        jax: ["input/TeX", "output/HTML-CSS"],
        tex2jax: {
        inlineMath: [ ['$','$'], ["\\(","\\)"] ],
        displayMath: [ ['$$','$$'], ["\\[","\\]"] ],
        processEscapes: true
        },
        "HTML-CSS": { fonts: ["TeX"] }
    });
    </script><script async src=https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/MathJax.js></script><link href=/papyri.css rel=stylesheet><style>header > brand, header>:first-child {
        border-right: 1px solid #ccc;
        border-left: 1px solid #ccc;
        padding: 16px;
        padding-top: 0.5rem;
        padding-bottom: 0.5rem;
        display: inline-block; 
        width: 167px;
    }
    pre { line-height: 125%; }
td.linenos .normal { color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px; }
span.linenos { color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px; }
td.linenos .special { color: #000000; background-color: #ffffc0; padding-left: 5px; padding-right: 5px; }
span.linenos.special { color: #000000; background-color: #ffffc0; padding-left: 5px; padding-right: 5px; }
.highlight .hll { background-color: #ffffcc }
.highlight { background: #ffffff; }
.highlight .c { color: #888888 } /* Comment */
.highlight .err { color: #a61717; background-color: #e3d2d2 } /* Error */
.highlight .k { color: #008800; font-weight: bold } /* Keyword */
.highlight .ch { color: #888888 } /* Comment.Hashbang */
.highlight .cm { color: #888888 } /* Comment.Multiline */
.highlight .cp { color: #cc0000; font-weight: bold } /* Comment.Preproc */
.highlight .cpf { color: #888888 } /* Comment.PreprocFile */
.highlight .c1 { color: #888888 } /* Comment.Single */
.highlight .cs { color: #cc0000; font-weight: bold; background-color: #fff0f0 } /* Comment.Special */
.highlight .gd { color: #000000; background-color: #ffdddd } /* Generic.Deleted */
.highlight .ge { font-style: italic } /* Generic.Emph */
.highlight .gr { color: #aa0000 } /* Generic.Error */
.highlight .gh { color: #333333 } /* Generic.Heading */
.highlight .gi { color: #000000; background-color: #ddffdd } /* Generic.Inserted */
.highlight .go { color: #888888 } /* Generic.Output */
.highlight .gp { color: #555555 } /* Generic.Prompt */
.highlight .gs { font-weight: bold } /* Generic.Strong */
.highlight .gu { color: #666666 } /* Generic.Subheading */
.highlight .gt { color: #aa0000 } /* Generic.Traceback */
.highlight .kc { color: #008800; font-weight: bold } /* Keyword.Constant */
.highlight .kd { color: #008800; font-weight: bold } /* Keyword.Declaration */
.highlight .kn { color: #008800; font-weight: bold } /* Keyword.Namespace */
.highlight .kp { color: #008800 } /* Keyword.Pseudo */
.highlight .kr { color: #008800; font-weight: bold } /* Keyword.Reserved */
.highlight .kt { color: #888888; font-weight: bold } /* Keyword.Type */
.highlight .m { color: #0000DD; font-weight: bold } /* Literal.Number */
.highlight .s { color: #dd2200; background-color: #fff0f0 } /* Literal.String */
.highlight .na { color: #336699 } /* Name.Attribute */
.highlight .nb { color: #003388 } /* Name.Builtin */
.highlight .nc { color: #bb0066; font-weight: bold } /* Name.Class */
.highlight .no { color: #003366; font-weight: bold } /* Name.Constant */
.highlight .nd { color: #555555 } /* Name.Decorator */
.highlight .ne { color: #bb0066; font-weight: bold } /* Name.Exception */
.highlight .nf { color: #0066bb; font-weight: bold } /* Name.Function */
.highlight .nl { color: #336699; font-style: italic } /* Name.Label */
.highlight .nn { color: #bb0066; font-weight: bold } /* Name.Namespace */
.highlight .py { color: #336699; font-weight: bold } /* Name.Property */
.highlight .nt { color: #bb0066; font-weight: bold } /* Name.Tag */
.highlight .nv { color: #336699 } /* Name.Variable */
.highlight .ow { color: #008800 } /* Operator.Word */
.highlight .w { color: #bbbbbb } /* Text.Whitespace */
.highlight .mb { color: #0000DD; font-weight: bold } /* Literal.Number.Bin */
.highlight .mf { color: #0000DD; font-weight: bold } /* Literal.Number.Float */
.highlight .mh { color: #0000DD; font-weight: bold } /* Literal.Number.Hex */
.highlight .mi { color: #0000DD; font-weight: bold } /* Literal.Number.Integer */
.highlight .mo { color: #0000DD; font-weight: bold } /* Literal.Number.Oct */
.highlight .sa { color: #dd2200; background-color: #fff0f0 } /* Literal.String.Affix */
.highlight .sb { color: #dd2200; background-color: #fff0f0 } /* Literal.String.Backtick */
.highlight .sc { color: #dd2200; background-color: #fff0f0 } /* Literal.String.Char */
.highlight .dl { color: #dd2200; background-color: #fff0f0 } /* Literal.String.Delimiter */
.highlight .sd { color: #dd2200; background-color: #fff0f0 } /* Literal.String.Doc */
.highlight .s2 { color: #dd2200; background-color: #fff0f0 } /* Literal.String.Double */
.highlight .se { color: #0044dd; background-color: #fff0f0 } /* Literal.String.Escape */
.highlight .sh { color: #dd2200; background-color: #fff0f0 } /* Literal.String.Heredoc */
.highlight .si { color: #3333bb; background-color: #fff0f0 } /* Literal.String.Interpol */
.highlight .sx { color: #22bb22; background-color: #f0fff0 } /* Literal.String.Other */
.highlight .sr { color: #008800; background-color: #fff0ff } /* Literal.String.Regex */
.highlight .s1 { color: #dd2200; background-color: #fff0f0 } /* Literal.String.Single */
.highlight .ss { color: #aa6600; background-color: #fff0f0 } /* Literal.String.Symbol */
.highlight .bp { color: #003388 } /* Name.Builtin.Pseudo */
.highlight .fm { color: #0066bb; font-weight: bold } /* Name.Function.Magic */
.highlight .vc { color: #336699 } /* Name.Variable.Class */
.highlight .vg { color: #dd7700 } /* Name.Variable.Global */
.highlight .vi { color: #3333bb } /* Name.Variable.Instance */
.highlight .vm { color: #336699 } /* Name.Variable.Magic */
.highlight .il { color: #0000DD; font-weight: bold } /* Literal.Number.Integer.Long */</style></head><body class=tex2jax_ignore><header><brand><i class="fab fa-python"></i><a href=/>Home</a></brand><nav>/ <a href=/>p</a>  /  <div class=dropdown><a href=pandas>pandas</a> /  <div class=dropdown-content><a href=/p/IPython/8.2.0.dev/api/IPython.html>IPython</a><a href=/p/astropy/5.0/api/astropy.html>astropy</a><a href=/p/dask/2021.10.0/api/dask.html>dask</a><a href=/p/distributed/2021.10.0/api/distributed.html>distributed</a><a href=/p/matplotlib/3.5.1/api/matplotlib.html>matplotlib</a><a href=/p/networkx/2.7.2rc1.dev0/api/networkx.html>networkx</a><a href=/p/numpy/1.22.3/api/numpy.html>numpy</a><a href=/p/pandas/1.4.1/api/pandas.html>pandas</a><a href=/p/papyri/0.0.8/api/papyri.html>papyri</a><a href=/p/scipy/1.8.0/api/scipy.html>scipy</a><a href=/p/skimage/0.17.2/api/skimage.html>skimage</a></div></div><div class=dropdown><a href=/p/pandas/1.4.1/api/pandas.html>1.4.1</a> /  <div class=dropdown-content><a href=/p/pandas/1.4.1/api/pandas.html>1.4.1</a></div></div><div class=dropdown><a href=/p/pandas/1.4.1/api/pandas.html>api</a> /  <div class=dropdown-content><a href=/p/pandas/1.4.1/api/pandas.html>API</a><a href=/p/pandas/1.4.1/gallery>Gallery</a><a href=/p/pandas/1.4.1/examples>Examples</a></div></div><div class=dropdown><a class=dropbtn href=pandas.html>pandas</a>.</div><div class=dropdown><a class=dropbtn href=pandas.io.html>io</a>. <div class=dropdown-content><a href=/p/pandas/1.4.1/api/pandas.__dir__.html>__dir__</a><a href=/p/pandas/1.4.1/api/pandas.__getattr__.html>__getattr__</a><a href=/p/pandas/1.4.1/api/pandas._config.html>_config</a><a href=/p/pandas/1.4.1/api/pandas._libs.html>_libs</a><a href=/p/pandas/1.4.1/api/pandas._testing.html>_testing</a><a href=/p/pandas/1.4.1/api/pandas._typing.html>_typing</a><a href=/p/pandas/1.4.1/api/pandas._version.html>_version</a><a href=/p/pandas/1.4.1/api/pandas.api.html>api</a><a href=/p/pandas/1.4.1/api/pandas.arrays.html>arrays</a><a href=/p/pandas/1.4.1/api/pandas.compat.html>compat</a><a href=/p/pandas/1.4.1/api/pandas.core.html>core</a><a href=/p/pandas/1.4.1/api/pandas.errors.html>errors</a><a href=/p/pandas/1.4.1/api/pandas.io.html>io</a><a href=/p/pandas/1.4.1/api/pandas.plotting.html>plotting</a><a href=/p/pandas/1.4.1/api/pandas.testing.html>testing</a><a href=/p/pandas/1.4.1/api/pandas.tseries.html>tseries</a><a href=/p/pandas/1.4.1/api/pandas.util.html>util</a></div></div><div class=dropdown><a class=dropbtn href=pandas.io.excel.html>excel</a>. <div class=dropdown-content><a href=/p/pandas/1.4.1/api/pandas.io.api.html>api</a><a href=/p/pandas/1.4.1/api/pandas.io.clipboards.html>clipboards</a><a href=/p/pandas/1.4.1/api/pandas.io.common.html>common</a><a href=/p/pandas/1.4.1/api/pandas.io.date_converters.html>date_converters</a><a href=/p/pandas/1.4.1/api/pandas.io.excel.html>excel</a><a href=/p/pandas/1.4.1/api/pandas.io.feather_format.html>feather_format</a><a href=/p/pandas/1.4.1/api/pandas.io.formats.html>formats</a><a href=/p/pandas/1.4.1/api/pandas.io.gbq.html>gbq</a><a href=/p/pandas/1.4.1/api/pandas.io.html.html>html</a><a href=/p/pandas/1.4.1/api/pandas.io.json.html>json</a><a href=/p/pandas/1.4.1/api/pandas.io.orc.html>orc</a><a href=/p/pandas/1.4.1/api/pandas.io.parquet.html>parquet</a><a href=/p/pandas/1.4.1/api/pandas.io.parsers.html>parsers</a><a href=/p/pandas/1.4.1/api/pandas.io.pickle.html>pickle</a><a href=/p/pandas/1.4.1/api/pandas.io.pytables.html>pytables</a><a href=/p/pandas/1.4.1/api/pandas.io.sas.html>sas</a><a href=/p/pandas/1.4.1/api/pandas.io.spss.html>spss</a><a href=/p/pandas/1.4.1/api/pandas.io.sql.html>sql</a><a href=/p/pandas/1.4.1/api/pandas.io.stata.html>stata</a><a href=/p/pandas/1.4.1/api/pandas.io.xml.html>xml</a></div></div><div class=dropdown><a class=dropbtn href=pandas.io.excel._base.html>_base</a>. <div class=dropdown-content><a href=/p/pandas/1.4.1/api/pandas.io.excel._base.html>_base</a><a href=/p/pandas/1.4.1/api/pandas.io.excel._odfreader.html>_odfreader</a><a href=/p/pandas/1.4.1/api/pandas.io.excel._odswriter.html>_odswriter</a><a href=/p/pandas/1.4.1/api/pandas.io.excel._openpyxl.html>_openpyxl</a><a href=/p/pandas/1.4.1/api/pandas.io.excel._pyxlsb.html>_pyxlsb</a><a href=/p/pandas/1.4.1/api/pandas.io.excel._util.html>_util</a><a href=/p/pandas/1.4.1/api/pandas.io.excel._xlrd.html>_xlrd</a><a href=/p/pandas/1.4.1/api/pandas.io.excel._xlsxwriter.html>_xlsxwriter</a><a href=/p/pandas/1.4.1/api/pandas.io.excel._xlwt.html>_xlwt</a></div></div><div class=dropdown><a class=dropbtn href=pandas.io.excel._base.ExcelWriter.html>ExcelWriter</a>. <div class=dropdown-content><a href=/p/pandas/1.4.1/api/pandas.io.excel._base.BaseExcelReader.html>BaseExcelReader</a><a href=/p/pandas/1.4.1/api/pandas.io.excel._base.ExcelFile.html>ExcelFile</a><a href=/p/pandas/1.4.1/api/pandas.io.excel._base.ExcelWriter.html>ExcelWriter</a><a href=/p/pandas/1.4.1/api/pandas.io.excel._base.inspect_excel_format.html>inspect_excel_format</a><a href=/p/pandas/1.4.1/api/pandas.io.excel._base.read_excel.html>read_excel</a></div></div><div class=dropdown><a class=dropbtn>+</a><div class=dropdown-content><a href=/p/pandas/1.4.1/api/pandas.io.excel._base.ExcelWriter.__enter__.html>__enter__</a><a href=/p/pandas/1.4.1/api/pandas.io.excel._base.ExcelWriter.__exit__.html>__exit__</a><a href=/p/pandas/1.4.1/api/pandas.io.excel._base.ExcelWriter.__fspath__.html>__fspath__</a><a href=/p/pandas/1.4.1/api/pandas.io.excel._base.ExcelWriter.__init__.html>__init__</a><a href=/p/pandas/1.4.1/api/pandas.io.excel._base.ExcelWriter._get_sheet_name.html>_get_sheet_name</a><a href=/p/pandas/1.4.1/api/pandas.io.excel._base.ExcelWriter._value_with_fmt.html>_value_with_fmt</a><a href=/p/pandas/1.4.1/api/pandas.io.excel._base.ExcelWriter.close.html>close</a><a href=/p/pandas/1.4.1/api/pandas.io.excel._base.ExcelWriter.save.html>save</a><a href=/p/pandas/1.4.1/api/pandas.io.excel._base.ExcelWriter.write_cells.html>write_cells</a></div></div></nav></header><div class=container><div class=sidenav><img src=/p/pandas/1.4.1/img/logo.png><a href=#>pandas</a><a href=#>1.4.1</a><hr><hr><a href=#section-Attributes>Attributes</a><a href=#section-Methods>Methods</a><a href=#section-Notes>Notes</a><a href=#section-Parameters>Parameters</a><a href=#section-backrefs>BackRef</a></div><h3 id=section-Attributes>Attributes</h3><dl><dt><a id=None>None</a> :</dt><dd></dd></dl><p>Default is to use : * xlwt for xls * xlsxwriter for xlsx if xlsxwriter is installed otherwise openpyxl * odf for ods. See DataFrame.to_excel for typical usage.</p><p>The writer should be used as a context manager. Otherwise, call <code>:None:None:`close()`</code> to save and close any opened file handles.</p><h3 id=section-Methods>Methods</h3><h3 id=section-Notes>Notes</h3><p>None of the methods and properties are considered public.</p><p>For compatibility with CSV writers, ExcelWriter serializes lists and dicts to strings before writing.</p><h3 id=section-Parameters>Parameters</h3><dl><dt><a id=path>path</a> : str or typing.BinaryIO</dt><dd><p>Path to xls or xlsx or ods file.</p></dd><dt><a id=engine>engine</a> : str (optional)</dt><dd><p>Engine to use for writing. If None, defaults to <code class=verbatim>io.excel.&LTextension>.writer</code> . NOTE: can only be passed as a keyword argument.</p> <div class=admonition><div>deprecated</div><p>As the `xlwt < https : / / pypi.org / project / xlwt / >`__ package is no longer maintained, the ``xlwt`` engine will be removed in a future version of pandas.</p></div></dd><dt><a id=date_format>date_format</a> : str, default None</dt><dd><p>Format string for dates written into Excel files (e.g. 'YYYY-MM-DD').</p></dd><dt><a id=datetime_format>datetime_format</a> : str, default None</dt><dd><p>Format string for datetime objects written into Excel files. (e.g. 'YYYY-MM-DD HH:MM:SS').</p></dd><dt><a id=mode>mode</a> : {'w', 'a'}, default 'w'</dt><dd><p>File mode to use (write or append). Append does not work with fsspec URLs.</p></dd><dt><a id=storage_options>storage_options</a> : dict, optional</dt><dd><p>Extra options that make sense for a particular storage connection, e.g. host, port, username, password, etc., if using a URL that will be parsed by <code class=verbatim>fsspec</code> , e.g., starting "s3://", "gcs://".</p> <div class=admonition><div>versionadded</div><p>1.2.0</p></div></dd><dt><a id=if_sheet_exists>if_sheet_exists</a> : {'error', 'new', 'replace', 'overlay'}, default 'error'</dt><dd><p>How to behave when trying to write to a sheet that already exists (append mode only).</p> <ul><li><p>error: raise a ValueError.</p></li><li><p>new: Create a new sheet, with a name determined by the engine.</p></li><li><p>replace: Delete the contents of the sheet before writing to it.</p></li><li><p>overlay: Write contents to the existing sheet without removing the old contents.</p></li></ul> <div class=admonition><div>versionadded</div><p>1.3.0</p></div> <div class=admonition><div>versionchanged</div><p>Added ``overlay`` option</p></div></dd><dt><a id=engine_kwargs>engine_kwargs</a> : dict, optional</dt><dd><p>Keyword arguments to be passed into the engine. These will be passed to the following functions of the respective engines:</p> <ul><li><p>xlsxwriter: <code class=verbatim>xlsxwriter.Workbook(file, **engine_kwargs)</code></p></li><li><p>openpyxl (write mode): <code class=verbatim>openpyxl.Workbook(**engine_kwargs)</code></p></li><li><p>openpyxl (append mode): <code class=verbatim>openpyxl.load_workbook(file, **engine_kwargs)</code></p></li><li><p>odswriter: <code class=verbatim>odf.opendocument.OpenDocumentSpreadsheet(**engine_kwargs)</code></p></li></ul> <div class=admonition><div>versionadded</div><p>1.3.0</p></div></dd><dt><a id=**kwargs>**kwargs</a> : dict, optional</dt><dd><p>Keyword arguments to be passed into the engine.</p> <div class=admonition><div>deprecated</div><p>Use engine_kwargs instead.</p></div></dd></dl><p>Class for writing DataFrame objects into excel sheets.</p><h3 id=section-Examples>Examples</h3><p>Default usage:</p><span class=note>This example is valid syntax, but we were not able to check execution</span><pre class="highlight compiled"><span class=nsl>>>> </span><span>df</span><span> </span><span class=o>=</span><span> </span><span>pd</span><span class=o>.</span><a class=foo href=/p/pandas/1.4.1/api/pandas.core.frame.DataFrame.html>DataFrame</a><span>(</span><span>[</span><span>[</span><span class=s2>"</span><span class=s2>ABC</span><span class=s2>"</span><span>,</span><span> </span><span class=s2>"</span><span class=s2>XYZ</span><span class=s2>"</span><span>]</span><span>]</span><span>,</span><span> </span><span>columns</span><span class=o>=</span><span>[</span><span class=s2>"</span><span class=s2>Foo</span><span class=s2>"</span><span>,</span><span> </span><span class=s2>"</span><span class=s2>Bar</span><span class=s2>"</span><span>]</span><span>)</span><span>  </span><span class=c1># doctest: +SKIP</span><br><span class=nsl>... </span><span class=k>with</span><span> </span><span>pd</span><span class=o>.</span><a class=foo href=/p/pandas/1.4.1/api/pandas.io.excel._base.ExcelWriter.html>ExcelWriter</a><span>(</span><span class=s2>"</span><span class=s2>path_to_file.xlsx</span><span class=s2>"</span><span>)</span><span> </span><span class=k>as</span><span> </span><span>writer</span><span>:</span><br><span class=nsl>... </span><span>    </span><span>df</span><span class=o>.</span><a class=foo href=/p/pandas/1.4.1/api/pandas.core.generic.NDFrame.to_excel.html>to_excel</a><span>(</span><span>writer</span><span>)</span><span>  </span><span class=c1># doctest: +SKIP</span>
</pre><p>To write to separate sheets in a single file:</p><span class=note>This example is valid syntax, but we were not able to check execution</span><pre class="highlight compiled"><span class=nsl>>>> </span><span>df1</span><span> </span><span class=o>=</span><span> </span><span>pd</span><span class=o>.</span><a class=foo href=/p/pandas/1.4.1/api/pandas.core.frame.DataFrame.html>DataFrame</a><span>(</span><span>[</span><span>[</span><span class=s2>"</span><span class=s2>AAA</span><span class=s2>"</span><span>,</span><span> </span><span class=s2>"</span><span class=s2>BBB</span><span class=s2>"</span><span>]</span><span>]</span><span>,</span><span> </span><span>columns</span><span class=o>=</span><span>[</span><span class=s2>"</span><span class=s2>Spam</span><span class=s2>"</span><span>,</span><span> </span><span class=s2>"</span><span class=s2>Egg</span><span class=s2>"</span><span>]</span><span>)</span><span>  </span><span class=c1># doctest: +SKIP</span><br><span class=nsl>... </span><span>df2</span><span> </span><span class=o>=</span><span> </span><span>pd</span><span class=o>.</span><a class=foo href=/p/pandas/1.4.1/api/pandas.core.frame.DataFrame.html>DataFrame</a><span>(</span><span>[</span><span>[</span><span class=s2>"</span><span class=s2>ABC</span><span class=s2>"</span><span>,</span><span> </span><span class=s2>"</span><span class=s2>XYZ</span><span class=s2>"</span><span>]</span><span>]</span><span>,</span><span> </span><span>columns</span><span class=o>=</span><span>[</span><span class=s2>"</span><span class=s2>Foo</span><span class=s2>"</span><span>,</span><span> </span><span class=s2>"</span><span class=s2>Bar</span><span class=s2>"</span><span>]</span><span>)</span><span>  </span><span class=c1># doctest: +SKIP</span><br><span class=nsl>... </span><span class=k>with</span><span> </span><span>pd</span><span class=o>.</span><a class=foo href=/p/pandas/1.4.1/api/pandas.io.excel._base.ExcelWriter.html>ExcelWriter</a><span>(</span><span class=s2>"</span><span class=s2>path_to_file.xlsx</span><span class=s2>"</span><span>)</span><span> </span><span class=k>as</span><span> </span><span>writer</span><span>:</span><br><span class=nsl>... </span><span>    </span><span>df1</span><span class=o>.</span><a class=foo href=/p/pandas/1.4.1/api/pandas.core.generic.NDFrame.to_excel.html>to_excel</a><span>(</span><span>writer</span><span>,</span><span> </span><a class=foo href=/p/pandas/1.4.1/api/pandas.io.excel._base.ExcelWriter._get_sheet_name.html>sheet_name</a><span class=o>=</span><span class=s2>"</span><span class=s2>Sheet1</span><span class=s2>"</span><span>)</span><span>  </span><span class=c1># doctest: +SKIP</span><br><span class=nsl>... </span><span>    </span><span>df2</span><span class=o>.</span><a class=foo href=/p/pandas/1.4.1/api/pandas.core.generic.NDFrame.to_excel.html>to_excel</a><span>(</span><span>writer</span><span>,</span><span> </span><a class=foo href=/p/pandas/1.4.1/api/pandas.io.excel._base.ExcelWriter._get_sheet_name.html>sheet_name</a><span class=o>=</span><span class=s2>"</span><span class=s2>Sheet2</span><span class=s2>"</span><span>)</span><span>  </span><span class=c1># doctest: +SKIP</span>
</pre><p>You can set the date format or datetime format:</p><span class=note>This example is valid syntax, but we were not able to check execution</span><pre class="highlight compiled"><span class=nsl>>>> </span><span class=kn>from</span><span> </span><span class=nn>datetime</span><span> </span><span class=kn>import</span><span> </span><span>date</span><span>,</span><span> </span><span>datetime</span><span>  </span><span class=c1># doctest: +SKIP</span><br><span class=nsl>... </span><span>df</span><span> </span><span class=o>=</span><span> </span><span>pd</span><span class=o>.</span><a class=foo href=/p/pandas/1.4.1/api/pandas.core.frame.DataFrame.html>DataFrame</a><span>(</span><br><span class=nsl>... </span><span>    </span><span>[</span><br><span class=nsl>... </span><span>        </span><span>[</span><span>date</span><span>(</span><span class=mi>2014</span><span>,</span><span> </span><span class=mi>1</span><span>,</span><span> </span><span class=mi>31</span><span>)</span><span>,</span><span> </span><span>date</span><span>(</span><span class=mi>1999</span><span>,</span><span> </span><span class=mi>9</span><span>,</span><span> </span><span class=mi>24</span><span>)</span><span>]</span><span>,</span><br><span class=nsl>... </span><span>        </span><span>[</span><span>datetime</span><span>(</span><span class=mi>1998</span><span>,</span><span> </span><span class=mi>5</span><span>,</span><span> </span><span class=mi>26</span><span>,</span><span> </span><span class=mi>23</span><span>,</span><span> </span><span class=mi>33</span><span>,</span><span> </span><span class=mi>4</span><span>)</span><span>,</span><span> </span><span>datetime</span><span>(</span><span class=mi>2014</span><span>,</span><span> </span><span class=mi>2</span><span>,</span><span> </span><span class=mi>28</span><span>,</span><span> </span><span class=mi>13</span><span>,</span><span> </span><span class=mi>5</span><span>,</span><span> </span><span class=mi>13</span><span>)</span><span>]</span><span>,</span><br><span class=nsl>... </span><span>    </span><span>]</span><span>,</span><br><span class=nsl>... </span><span>    </span><span>index</span><span class=o>=</span><span>[</span><span class=s2>"</span><span class=s2>Date</span><span class=s2>"</span><span>,</span><span> </span><span class=s2>"</span><span class=s2>Datetime</span><span class=s2>"</span><span>]</span><span>,</span><br><span class=nsl>... </span><span>    </span><span>columns</span><span class=o>=</span><span>[</span><span class=s2>"</span><span class=s2>X</span><span class=s2>"</span><span>,</span><span> </span><span class=s2>"</span><span class=s2>Y</span><span class=s2>"</span><span>]</span><span>,</span><br><span class=nsl>... </span><span>)</span><span>  </span><span class=c1># doctest: +SKIP</span><br><span class=nsl>... </span><span class=k>with</span><span> </span><span>pd</span><span class=o>.</span><a class=foo href=/p/pandas/1.4.1/api/pandas.io.excel._base.ExcelWriter.html>ExcelWriter</a><span>(</span><br><span class=nsl>... </span><span>    </span><span class=s2>"</span><span class=s2>path_to_file.xlsx</span><span class=s2>"</span><span>,</span><br><span class=nsl>... </span><span>    </span><a class=foo href=/p/pandas/1.4.1/api/pandas.io.pytables.HDFStore._validate_format.html>date_format</a><span class=o>=</span><span class=s2>"</span><span class=s2>YYYY-MM-DD</span><span class=s2>"</span><span>,</span><br><span class=nsl>... </span><span>    </span><span>datetime_format</span><span class=o>=</span><span class=s2>"</span><span class=s2>YYYY-MM-DD HH:MM:SS</span><span class=s2>"</span><br><span class=nsl>... </span><span>)</span><span> </span><span class=k>as</span><span> </span><span>writer</span><span>:</span><br><span class=nsl>... </span><span>    </span><span>df</span><span class=o>.</span><a class=foo href=/p/pandas/1.4.1/api/pandas.core.generic.NDFrame.to_excel.html>to_excel</a><span>(</span><span>writer</span><span>)</span><span>  </span><span class=c1># doctest: +SKIP</span>
</pre><p>You can also append to an existing Excel file:</p><span class=note>This example is valid syntax, but we were not able to check execution</span><pre class="highlight compiled"><span class=nsl>>>> </span><span class=k>with</span><span> </span><span>pd</span><span class=o>.</span><a class=foo href=/p/pandas/1.4.1/api/pandas.io.excel._base.ExcelWriter.html>ExcelWriter</a><span>(</span><span class=s2>"</span><span class=s2>path_to_file.xlsx</span><span class=s2>"</span><span>,</span><span> </span><span>mode</span><span class=o>=</span><span class=s2>"</span><span class=s2>a</span><span class=s2>"</span><span>,</span><span> </span><span>engine</span><span class=o>=</span><span class=s2>"</span><span class=s2>openpyxl</span><span class=s2>"</span><span>)</span><span> </span><span class=k>as</span><span> </span><span>writer</span><span>:</span><br><span class=nsl>... </span><span>    </span><span>df</span><span class=o>.</span><a class=foo href=/p/pandas/1.4.1/api/pandas.core.generic.NDFrame.to_excel.html>to_excel</a><span>(</span><span>writer</span><span>,</span><span> </span><a class=foo href=/p/pandas/1.4.1/api/pandas.io.excel._base.ExcelWriter._get_sheet_name.html>sheet_name</a><span class=o>=</span><span class=s2>"</span><span class=s2>Sheet3</span><span class=s2>"</span><span>)</span><span>  </span><span class=c1># doctest: +SKIP</span>
</pre><p>Here, the <code><a class=local href=#if_sheet_exists link>if_sheet_exists</a></code> parameter can be set to replace a sheet if it already exists:</p><span class=note>This example is valid syntax, but we were not able to check execution</span><pre class="highlight compiled"><span class=nsl>>>> </span><span class=k>with</span><span> </span><a class=foo href=/p/pandas/1.4.1/api/pandas.io.excel._base.ExcelWriter.html>ExcelWriter</a><span>(</span><br><span class=nsl>... </span><span>    </span><span class=s2>"</span><span class=s2>path_to_file.xlsx</span><span class=s2>"</span><span>,</span><br><span class=nsl>... </span><span>    </span><span>mode</span><span class=o>=</span><span class=s2>"</span><span class=s2>a</span><span class=s2>"</span><span>,</span><br><span class=nsl>... </span><span>    </span><span>engine</span><span class=o>=</span><span class=s2>"</span><span class=s2>openpyxl</span><span class=s2>"</span><span>,</span><br><span class=nsl>... </span><span>    </span><span>if_sheet_exists</span><span class=o>=</span><span class=s2>"</span><span class=s2>replace</span><span class=s2>"</span><span>,</span><br><span class=nsl>... </span><span>)</span><span> </span><span class=k>as</span><span> </span><span>writer</span><span>:</span><br><span class=nsl>... </span><span>    </span><span>df</span><span class=o>.</span><a class=foo href=/p/pandas/1.4.1/api/pandas.core.generic.NDFrame.to_excel.html>to_excel</a><span>(</span><span>writer</span><span>,</span><span> </span><a class=foo href=/p/pandas/1.4.1/api/pandas.io.excel._base.ExcelWriter._get_sheet_name.html>sheet_name</a><span class=o>=</span><span class=s2>"</span><span class=s2>Sheet1</span><span class=s2>"</span><span>)</span><span>  </span><span class=c1># doctest: +SKIP</span>
</pre><p>You can also write multiple DataFrames to a single sheet. Note that the <code class=verbatim>if_sheet_exists</code> parameter needs to be set to <code class=verbatim>overlay</code> :</p><span class=note>This example is valid syntax, but we were not able to check execution</span><pre class="highlight compiled"><span class=nsl>>>> </span><span class=k>with</span><span> </span><a class=foo href=/p/pandas/1.4.1/api/pandas.io.excel._base.ExcelWriter.html>ExcelWriter</a><span>(</span><span class=s2>"</span><span class=s2>path_to_file.xlsx</span><span class=s2>"</span><span>,</span><br><span class=nsl>... </span><span>    </span><span>mode</span><span class=o>=</span><span class=s2>"</span><span class=s2>a</span><span class=s2>"</span><span>,</span><br><span class=nsl>... </span><span>    </span><span>engine</span><span class=o>=</span><span class=s2>"</span><span class=s2>openpyxl</span><span class=s2>"</span><span>,</span><br><span class=nsl>... </span><span>    </span><span>if_sheet_exists</span><span class=o>=</span><span class=s2>"</span><span class=s2>overlay</span><span class=s2>"</span><span>,</span><br><span class=nsl>... </span><span>)</span><span> </span><span class=k>as</span><span> </span><span>writer</span><span>:</span><br><span class=nsl>... </span><span>    </span><span>df1</span><span class=o>.</span><a class=foo href=/p/pandas/1.4.1/api/pandas.core.generic.NDFrame.to_excel.html>to_excel</a><span>(</span><span>writer</span><span>,</span><span> </span><a class=foo href=/p/pandas/1.4.1/api/pandas.io.excel._base.ExcelWriter._get_sheet_name.html>sheet_name</a><span class=o>=</span><span class=s2>"</span><span class=s2>Sheet1</span><span class=s2>"</span><span>)</span><br><span class=nsl>... </span><span>    </span><span>df2</span><span class=o>.</span><a class=foo href=/p/pandas/1.4.1/api/pandas.core.generic.NDFrame.to_excel.html>to_excel</a><span>(</span><span>writer</span><span>,</span><span> </span><a class=foo href=/p/pandas/1.4.1/api/pandas.io.excel._base.ExcelWriter._get_sheet_name.html>sheet_name</a><span class=o>=</span><span class=s2>"</span><span class=s2>Sheet1</span><span class=s2>"</span><span>,</span><span> </span><span>startcol</span><span class=o>=</span><span class=mi>3</span><span>)</span><span>  </span><span class=c1># doctest: +SKIP</span>
</pre><p>You can store Excel file in RAM:</p><span class=note>This example is valid syntax, but we were not able to check execution</span><pre class="highlight compiled"><span class=nsl>>>> </span><span class=kn>import</span><span> </span><a class="foo nn"href=/p/pandas/1.4.1/api/pandas.io.html>io</a><br><span class=nsl>... </span><span>df</span><span> </span><span class=o>=</span><span> </span><span>pd</span><span class=o>.</span><a class=foo href=/p/pandas/1.4.1/api/pandas.core.frame.DataFrame.html>DataFrame</a><span>(</span><span>[</span><span>[</span><span class=s2>"</span><span class=s2>ABC</span><span class=s2>"</span><span>,</span><span> </span><span class=s2>"</span><span class=s2>XYZ</span><span class=s2>"</span><span>]</span><span>]</span><span>,</span><span> </span><span>columns</span><span class=o>=</span><span>[</span><span class=s2>"</span><span class=s2>Foo</span><span class=s2>"</span><span>,</span><span> </span><span class=s2>"</span><span class=s2>Bar</span><span class=s2>"</span><span>]</span><span>)</span><br><span class=nsl>... </span><span>buffer</span><span> </span><span class=o>=</span><span> </span><a class=foo href=/p/pandas/1.4.1/api/pandas.io.html>io</a><span class=o>.</span><span>BytesIO</span><span>(</span><span>)</span><br><span class=nsl>... </span><span class=k>with</span><span> </span><span>pd</span><span class=o>.</span><a class=foo href=/p/pandas/1.4.1/api/pandas.io.excel._base.ExcelWriter.html>ExcelWriter</a><span>(</span><span>buffer</span><span>)</span><span> </span><span class=k>as</span><span> </span><span>writer</span><span>:</span><br><span class=nsl>... </span><span>    </span><span>df</span><span class=o>.</span><a class=foo href=/p/pandas/1.4.1/api/pandas.core.generic.NDFrame.to_excel.html>to_excel</a><span>(</span><span>writer</span><span>)</span>
</pre><p>You can pack Excel file into zip archive:</p><span class=note>This example is valid syntax, but we were not able to check execution</span><pre class="highlight compiled"><span class=nsl>>>> </span><span class=kn>import</span><span> </span><span class=nn>zipfile</span><span>  </span><span class=c1># doctest: +SKIP</span><br><span class=nsl>... </span><span>df</span><span> </span><span class=o>=</span><span> </span><span>pd</span><span class=o>.</span><a class=foo href=/p/pandas/1.4.1/api/pandas.core.frame.DataFrame.html>DataFrame</a><span>(</span><span>[</span><span>[</span><span class=s2>"</span><span class=s2>ABC</span><span class=s2>"</span><span>,</span><span> </span><span class=s2>"</span><span class=s2>XYZ</span><span class=s2>"</span><span>]</span><span>]</span><span>,</span><span> </span><span>columns</span><span class=o>=</span><span>[</span><span class=s2>"</span><span class=s2>Foo</span><span class=s2>"</span><span>,</span><span> </span><span class=s2>"</span><span class=s2>Bar</span><span class=s2>"</span><span>]</span><span>)</span><span>  </span><span class=c1># doctest: +SKIP</span><br><span class=nsl>... </span><span class=k>with</span><span> </span><span>zipfile</span><span class=o>.</span><span>ZipFile</span><span>(</span><span class=s2>"</span><span class=s2>path_to_file.zip</span><span class=s2>"</span><span>,</span><span> </span><span class=s2>"</span><span class=s2>w</span><span class=s2>"</span><span>)</span><span> </span><span class=k>as</span><span> </span><a class=foo href=/p/pandas/1.4.1/api/pandas.core.strings.accessor.StringMethods.zfill.html>zf</a><span>:</span><br><span class=nsl>... </span><span>    </span><span class=k>with</span><span> </span><a class=foo href=/p/pandas/1.4.1/api/pandas.core.strings.accessor.StringMethods.zfill.html>zf</a><span class=o>.</span><a class=foo href=/p/pandas/1.4.1/api/pandas.io.pytables.HDFStore.open.html>open</a><span>(</span><span class=s2>"</span><span class=s2>filename.xlsx</span><span class=s2>"</span><span>,</span><span> </span><span class=s2>"</span><span class=s2>w</span><span class=s2>"</span><span>)</span><span> </span><span class=k>as</span><span> </span><span>buffer</span><span>:</span><br><span class=nsl>... </span><span>        </span><span class=k>with</span><span> </span><span>pd</span><span class=o>.</span><a class=foo href=/p/pandas/1.4.1/api/pandas.io.excel._base.ExcelWriter.html>ExcelWriter</a><span>(</span><span>buffer</span><span>)</span><span> </span><span class=k>as</span><span> </span><span>writer</span><span>:</span><br><span class=nsl>... </span><span>            </span><span>df</span><span class=o>.</span><a class=foo href=/p/pandas/1.4.1/api/pandas.core.generic.NDFrame.to_excel.html>to_excel</a><span>(</span><span>writer</span><span>)</span><span>  </span><span class=c1># doctest: +SKIP</span>
</pre><p>You can specify additional arguments to the underlying engine:</p><span class=note>This example is valid syntax, but we were not able to check execution</span><pre class="highlight compiled"><span class=nsl>>>> </span><span class=k>with</span><span> </span><span>pd</span><span class=o>.</span><a class=foo href=/p/pandas/1.4.1/api/pandas.io.excel._base.ExcelWriter.html>ExcelWriter</a><span>(</span><br><span class=nsl>... </span><span>    </span><span class=s2>"</span><span class=s2>path_to_file.xlsx</span><span class=s2>"</span><span>,</span><br><span class=nsl>... </span><span>    </span><span>engine</span><span class=o>=</span><span class=s2>"</span><span class=s2>xlsxwriter</span><span class=s2>"</span><span>,</span><br><span class=nsl>... </span><span>    </span><span>engine_kwargs</span><span class=o>=</span><span>{</span><span class=s2>"</span><span class=s2>options</span><span class=s2>"</span><span>:</span><span> </span><span>{</span><span class=s2>"</span><span class=s2>nan_inf_to_errors</span><span class=s2>"</span><span>:</span><span> </span><span class=kc>True</span><span>}</span><span>}</span><br><span class=nsl>... </span><span>)</span><span> </span><span class=k>as</span><span> </span><span>writer</span><span>:</span><br><span class=nsl>... </span><span>    </span><span>df</span><span class=o>.</span><a class=foo href=/p/pandas/1.4.1/api/pandas.core.generic.NDFrame.to_excel.html>to_excel</a><span>(</span><span>writer</span><span>)</span><span>  </span><span class=c1># doctest: +SKIP</span>
</pre><p>In append mode, <code class=verbatim>engine_kwargs</code> are passed through to openpyxl's <code class=verbatim>load_workbook</code> :</p><span class=note>This example is valid syntax, but we were not able to check execution</span><pre class="highlight compiled"><span class=nsl>>>> </span><span class=k>with</span><span> </span><span>pd</span><span class=o>.</span><a class=foo href=/p/pandas/1.4.1/api/pandas.io.excel._base.ExcelWriter.html>ExcelWriter</a><span>(</span><br><span class=nsl>... </span><span>    </span><span class=s2>"</span><span class=s2>path_to_file.xlsx</span><span class=s2>"</span><span>,</span><br><span class=nsl>... </span><span>    </span><span>engine</span><span class=o>=</span><span class=s2>"</span><span class=s2>openpyxl</span><span class=s2>"</span><span>,</span><br><span class=nsl>... </span><span>    </span><span>mode</span><span class=o>=</span><span class=s2>"</span><span class=s2>a</span><span class=s2>"</span><span>,</span><br><span class=nsl>... </span><span>    </span><span>engine_kwargs</span><span class=o>=</span><span>{</span><span class=s2>"</span><span class=s2>keep_vba</span><span class=s2>"</span><span>:</span><span> </span><span class=kc>True</span><span>}</span><br><span class=nsl>... </span><span>)</span><span> </span><span class=k>as</span><span> </span><span>writer</span><span>:</span><br><span class=nsl>... </span><span>    </span><span>df</span><span class=o>.</span><a class=foo href=/p/pandas/1.4.1/api/pandas.core.generic.NDFrame.to_excel.html>to_excel</a><span>(</span><span>writer</span><span>,</span><span> </span><a class=foo href=/p/pandas/1.4.1/api/pandas.io.excel._base.ExcelWriter._get_sheet_name.html>sheet_name</a><span class=o>=</span><span class=s2>"</span><span class=s2>Sheet2</span><span class=s2>"</span><span>)</span><span>  </span><span class=c1># doctest: +SKIP</span>
</pre> See : <h3 id=section-backrefs>Back References</h3><p>The following pages refer to to this document either explicitly or contain code examples using this.</p><code><a class=exists href=/p/pandas/1.4.1/api/pandas.io.excel._base.ExcelWriter.html link>pandas.io.excel._base.ExcelWriter</a></code><code><a class=exists href=/p/pandas/1.4.1/api/pandas.core.generic.NDFrame.to_excel.html link>pandas.core.generic.NDFrame.to_excel</a></code><h3>Local connectivity graph</h3><p>Hover to see nodes names; edges to Self not shown, Caped at 50 nodes.</p><p>Using a canvas is more power efficient and can get hundred of nodes ; but does not allow hyperlinks; , arrows or text (beyond on hover)</p><canvas class=graph height=500 width=800></canvas><p>SVG is more flexible but power hungry; and does not scale well to 50 + nodes.</p><svg class=graph height=500 width=600></svg><p>All aboves nodes referred to, (or are referred from) current nodes; Edges from Self to other have been omitted (or all nodes would be connected to the central node "self" which is not useful). Nodes are colored by the library they belong to, and scaled with the number of references pointing them</p><hr> File: /pandas/io/excel/_base.py#758 <br> type: &LTclass 'abc.ABCMeta'> <br> Commit: <br><script src=https://d3js.org/d3.v4.min.js></script><script src=https://d3js.org/d3-selection-multi.v1.js></script><style>.node {};
        .link { stroke: #999; stroke-opacity: .6; stroke-width: 1px; };</style><script>window._data_graph={nodes:[{id:2,val:9.732050807568877,label:"pandas.io.excel._base.ExcelWriter._get_sheet_name",mod:"pandas",url:"/p/pandas/1.4.1/api/pandas.io.excel._base.ExcelWriter._get_sheet_name"},{id:3,val:11.3166247903554,label:"pandas.io",mod:"pandas",url:"/p/pandas/1.4.1/api/pandas.io"},{id:4,val:10.82842712474619,label:"pandas.io.pytables.HDFStore.open",mod:"pandas",url:"/p/pandas/1.4.1/api/pandas.io.pytables.HDFStore.open"},{id:5,val:9.414213562373096,label:"pandas.core.strings.accessor.StringMethods.zfill",mod:"pandas",url:"/p/pandas/1.4.1/api/pandas.core.strings.accessor.StringMethods.zfill"},{id:6,val:9,label:"pandas.io.pytables.HDFStore._validate_format",mod:"pandas",url:"/p/pandas/1.4.1/api/pandas.io.pytables.HDFStore._validate_format"},{id:7,val:23.13274595042156,label:"pandas.core.frame.DataFrame",mod:"pandas",url:"/p/pandas/1.4.1/api/pandas.core.frame.DataFrame"},{id:8,val:9.414213562373096,label:"pandas.core.generic.NDFrame.to_excel",mod:"pandas",url:"/p/pandas/1.4.1/api/pandas.core.generic.NDFrame.to_excel"}],links:[{source:7,target:8,id:48},{source:2,target:8,id:254}]};</script><script src=/graph_canvas.js></script><script src=/graph_svg.js></script></div></body></html>