<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <link rel="icon" href="/favicon.ico" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
    <link rel="stylesheet"
          href="https://use.fontawesome.com/releases/v5.8.1/css/all.css"
          integrity="sha384-50oBUHEmvpQ+1lW4y57PTFmhCaXp0ML5d60M1M7uH2+nqUivzIebhndOJK28anvf"
          crossorigin="anonymous">
    
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@exampledev/new.css@1.1.2/new.min.css">
    <script type="text/x-mathjax-config">
      // this should process only math inside  span with tex2jax_process class
      MathJax.Hub.Config({
          extensions: ["tex2jax.js"],
          jax: ["input/TeX", "output/HTML-CSS"],
          tex2jax: {
          inlineMath: [ ['$','$'], ["\\(","\\)"] ],
          displayMath: [ ['$$','$$'], ["\\[","\\]"] ],
          processEscapes: true
          },
          "HTML-CSS": { fonts: ["TeX"] }
      });
    </script>
    <script async
        src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/MathJax.js">
    </script>
    <link rel="stylesheet" href="/papyri.css">
    <link rel="stylesheet" href="/pygments.css">
<style>

    header > brand {
        /*border-right: 1px solid #ccc;
          border-left: 1px solid #ccc;*/
        margin-left: 15px;
        padding: 0px;
        display: inline-block; 
        width: 67px;
    }

    brand > a {
        text-decoration: None;

    }
    brand >a> img {
            display: inline-block;
    margin: 0;
    padding: 0;
    position: relative;
    bottom: -10px;

   }
    .container {
       max-width: 800px;
       padding-left: 210px;
       padding-top: 30px;
    }
</style>
</head><body class="tex2jax_ignore">
    <header>
        <brand><a href='/'><img src='/favicon.ico'/></a></brand>
        <nav> / <a href='/' >p</a>  &nbsp;/&nbsp; 
                <div class="dropdown">
                <a href=numpy>numpy</a>&nbsp;/&nbsp;
                    <div class="dropdown-content">
                     </div>
                </div>
                <div class="dropdown">
                <a href='/p/numpy/1.22.4/api/numpy'>1.22.4</a>&nbsp;/&nbsp;
                    <div class="dropdown-content">
<a href="/p/numpy/1.22.4/api/numpy">1.22.4</a>
                    </div>
                </div>

                <div class="dropdown">
                    <a href='/p/numpy/1.22.4/api/numpy'>docs</a>&nbsp;/&nbsp;
                    <div class="dropdown-content">
                        <a href="/p/numpy/1.22.4/api/numpy">API</a>
                        <a href="/p/numpy/1.22.4/gallery">Gallery</a>
                        <a href="/p/numpy/1.22.4/examples">Examples</a>
                        <a href="/p/numpy/1.22.4/docs">Narrative</a>
                     </div>
                </div>

</nav>
    </header>
    <div class='container'>

    <div class="sidenav">
        <img src="/p/numpy/1.22.4/img/numpy_logo.png"/>
    <a href="#">numpy</a>
    <a href="#">1.22.4</a>
        <a class='external'  href="https://pypi.org/project/numpy">Pypi</a>
        <a class='external' href="https://github.com/numpy/numpy">GitHub</a>
        <a class='external' href="https://numpy.org/">Homepage</a>
    <hr/>
        <a class='external' href="https://numpy.org/doc/1.22/">Other Docs</a>
    <hr/>
    </div><!--end sidenav-->







               <pre class='not-implemented'>
.. currentmodule:: numpy.random
    </pre>


                          <pre class='not-implemented'>
            &lt;Unimplemented &#39;target&#39; &#39;.. _extending:&#39;&gt;
           </pre>


<h1>Extending</h1>
               <p>The BitGenerators have been designed to be extendable using standard tools for high-performance Python -- numba and Cython.  The <code class='not-implemented'>:None:None:`~Generator`</code> object can also be used with user-provided BitGenerators as long as these export a small set of required functions.</p>


<h2>Numba</h2>
               <p>Numba can be used with either CTypes or CFFI.  The current iteration of the BitGenerators all export a small set of functions through both interfaces.</p>

               <p>This example shows how numba can be used to produce gaussian samples using a pure Python implementation which is then compiled.  The random numbers are provided by         <code class='verbatim'>ctypes.next_double</code>
.</p>

               <pre class='not-implemented'>
.. literalinclude:: ../../../../numpy/random/_examples/numba/extending.py
    (&#39;language&#39;, &#39;python&#39;)
    (&#39;end-before&#39;, &#39;example 2&#39;)
    </pre>


               <p>Both CTypes and CFFI allow the more complicated distributions to be used directly in Numba after compiling the file distributions.c into a         <code class='verbatim'>DLL</code>
 or         <code class='verbatim'>so</code>
.  An example showing the use of a more complicated distribution is in the <code><a href="/p/examples/*/api/examples.html" class='exists'>examples</a></code>
 section below.</p>

                          <pre class='not-implemented'>
            &lt;Unimplemented &#39;target&#39; &#39;.. _random_cython:&#39;&gt;
           </pre>


<h2>Cython</h2>
               <p>Cython can be used to unpack the         <code class='verbatim'>PyCapsule</code>
 provided by a BitGenerator. This example uses <code class='not-implemented'>:None:None:`PCG64`</code> and the example from above.  The usual caveats for writing high-performance code using Cython -- removing bounds checks and wrap around, providing array alignment information -- still apply.</p>

               <pre class='not-implemented'>
.. literalinclude:: ../../../../numpy/random/_examples/cython/extending_distributions.pyx
    (&#39;language&#39;, &#39;cython&#39;)
    (&#39;end-before&#39;, &#39;example 2&#39;)
    </pre>


               <p>The BitGenerator can also be directly accessed using the members of the         <code class='verbatim'>bitgen_t</code>
 struct.</p>

               <pre class='not-implemented'>
.. literalinclude:: ../../../../numpy/random/_examples/cython/extending_distributions.pyx
    (&#39;language&#39;, &#39;cython&#39;)
    (&#39;start-after&#39;, &#39;example 2&#39;)
    (&#39;end-before&#39;, &#39;example 3&#39;)
    </pre>


               <p>Cython can be used to directly access the functions in         <code class='verbatim'>numpy/random/c_distributions.pxd</code>
. This requires linking with the         <code class='verbatim'>npyrandom</code>
 library located in         <code class='verbatim'>numpy/random/lib</code>
.</p>

               <pre class='not-implemented'>
.. literalinclude:: ../../../../numpy/random/_examples/cython/extending_distributions.pyx
    (&#39;language&#39;, &#39;cython&#39;)
    (&#39;start-after&#39;, &#39;example 3&#39;)
    </pre>


               <p>See         <code class='verbatim'>extending_cython_example</code>
 for the complete listings of these examples and a minimal         <code class='verbatim'>setup.py</code>
 to build the c-extension modules.</p>


<h2>CFFI</h2>
               <p>CFFI can be used to directly access the functions in         <code class='verbatim'>include/numpy/random/distributions.h</code>
. Some &#34;massaging&#34; of the header file is required:</p>

               <pre class='not-implemented'>
.. literalinclude:: ../../../../numpy/random/_examples/cffi/extending.py
    (&#39;language&#39;, &#39;python&#39;)
    (&#39;end-before&#39;, &#39;dlopen&#39;)
    </pre>


               <p>Once the header is parsed by         <code class='verbatim'>ffi.cdef</code>
, the functions can be accessed directly from the         <code class='verbatim'>_generator</code>
 shared object, using the <code class='not-implemented'>:None:None:`BitGenerator.cffi`</code> interface.</p>

               <pre class='not-implemented'>
.. literalinclude:: ../../../../numpy/random/_examples/cffi/extending.py
    (&#39;language&#39;, &#39;python&#39;)
    (&#39;start-after&#39;, &#39;dlopen&#39;)
    </pre>



<h2>New Bit Generators</h2>
               <p><code class='not-implemented'>:None:None:`~Generator`</code> can be used with user-provided <code class='not-implemented'>:None:None:`~BitGenerator`</code>\ s. The simplest way to write a new BitGenerator is to examine the pyx file of one of the existing BitGenerators. The key structure that must be provided is the         <code class='verbatim'>capsule</code>
 which contains a         <code class='verbatim'>PyCapsule</code>
 to a struct pointer of type         <code class='verbatim'>bitgen_t</code>
,</p>

               <pre class='not-implemented'>
.. code-block:: c
    typedef struct bitgen {
      void *state;
      uint64_t (*next_uint64)(void *st);
      uint32_t (*next_uint32)(void *st);
      double (*next_double)(void *st);
      uint64_t (*next_raw)(void *st);
    } bitgen_t;</pre>


               <p>which provides 5 pointers. The first is an opaque pointer to the data structure used by the BitGenerators.  The next three are function pointers which return the next 64- and 32-bit unsigned integers, the next random double and the next raw value.  This final function is used for testing and so can be set to the next 64-bit unsigned integer function if not needed. Functions inside         <code class='verbatim'>Generator</code>
 use this structure as in</p>

               <pre class='not-implemented'>
.. code-block:: c
    bitgen_state-&gt;next_uint64(bitgen_state-&gt;state)</pre>



<h2>Examples</h2>
               <pre class='not-implemented'>
.. toctree:: 
    Numba &lt;examples/numba&gt;
    CFFI + Numba &lt;examples/numba_cffi&gt; 
    Cython &lt;examples/cython/index&gt;
    CFFI &lt;examples/cffi&gt;</pre>



<h3 id="section-Examples">Examples</h3>
         See :
    


<h3>Local connectivity graph</h3>
<p>Hover to see nodes names; edges to Self not shown, Caped at 50 nodes.</p>

<p> Using a canvas is more power efficient and can get hundred of nodes ; but does not allow hyperlinks; , arrows
or text (beyond on hover) </p> 
<canvas class='graph' width="800" height="500"></canvas>
<p> SVG is more flexible but power hungry; and does not scale well to 50 + nodes. </p> 

<svg class='graph' width="600" height="500"></svg>

<p>All aboves nodes referred to, (or are referred from) current nodes; Edges from Self to other have been omitted
(or all nodes would be connected to the central node "self" which is not useful). Nodes are colored by the library
they belong to, and scaled with the number of references pointing them</p>

<hr>

    GitHub : <a class='external' href='https://github.com/numpy/numpy/blob/v1.22.3/None#LNone'>None#None</a>
<br/>

type: None <br/>
Commit: <br/>

        <script src="https://d3js.org/d3.v4.min.js"></script>
    <script src="https://d3js.org/d3-selection-multi.v1.js"></script>
    <style type="text/css">
        .node {};
        .link { stroke: #999; stroke-opacity: .6; stroke-width: 1px; };
    </style>
<script>
    window._data_graph = {};
</script>
<script type="text/javascript" src='/graph_canvas.js'></script>
<script type="text/javascript" src='/graph_svg.js'></script>


</div>
</body>
</html>