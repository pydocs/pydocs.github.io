<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <link rel="icon" href="/favicon.ico" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
    <link rel="stylesheet"
          href="https://use.fontawesome.com/releases/v5.8.1/css/all.css"
          integrity="sha384-50oBUHEmvpQ+1lW4y57PTFmhCaXp0ML5d60M1M7uH2+nqUivzIebhndOJK28anvf"
          crossorigin="anonymous">
    
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@exampledev/new.css@1.1.2/new.min.css">
    <script type="text/x-mathjax-config">
      // this should process only math inside  span with tex2jax_process class
      MathJax.Hub.Config({
          extensions: ["tex2jax.js"],
          jax: ["input/TeX", "output/HTML-CSS"],
          tex2jax: {
          inlineMath: [ ['$','$'], ["\\(","\\)"] ],
          displayMath: [ ['$$','$$'], ["\\[","\\]"] ],
          processEscapes: true
          },
          "HTML-CSS": { fonts: ["TeX"] }
      });
    </script>
    <script async
        src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/MathJax.js">
    </script>
    <link rel="stylesheet" href="/papyri.css">
    <link rel="stylesheet" href="/pygments.css">
<style>

    header > brand {
        /*border-right: 1px solid #ccc;
          border-left: 1px solid #ccc;*/
        margin-left: 15px;
        padding: 0px;
        display: inline-block; 
        width: 67px;
    }

    brand > a {
        text-decoration: None;

    }
    brand >a> img {
            display: inline-block;
    margin: 0;
    padding: 0;
    position: relative;
    bottom: -10px;

   }
    .container {
       max-width: 800px;
       padding-left: 210px;
       padding-top: 30px;
    }
</style>
</head><body class="tex2jax_ignore">
    <header>
        <brand><a href='/'><img src='/favicon.ico'/></a></brand>
        <nav> / <a href='/' >p</a>  &nbsp;/&nbsp; 
                <div class="dropdown">
                <a href=scipy>scipy</a>&nbsp;/&nbsp;
                    <div class="dropdown-content">
<a href="/p/IPython/8.4.0/api/IPython.html">IPython</a>
<a href="/p/astropy/5.0/api/astropy.html">astropy</a>
<a href="/p/dask/2021.10.0/api/dask.html">dask</a>
<a href="/p/distributed/2021.10.0/api/distributed.html">distributed</a>
<a href="/p/matplotlib/3.5.1/api/matplotlib.html">matplotlib</a>
<a href="/p/networkx/2.8.2/api/networkx.html">networkx</a>
<a href="/p/numpy/1.22.4/api/numpy.html">numpy</a>
<a href="/p/pandas/1.4.2/api/pandas.html">pandas</a>
<a href="/p/papyri/0.0.8/api/papyri.html">papyri</a>
<a href="/p/readthedocs/8.1.1/api/readthedocs.html">readthedocs</a>
<a href="/p/scipy/1.8.0/api/scipy.html">scipy</a>
<a href="/p/skimage/0.17.2/api/skimage.html">skimage</a>
                     </div>
                </div>
                <div class="dropdown">
                <a href='/p/scipy/1.8.0/api/scipy.html'>1.8.0</a>&nbsp;/&nbsp;
                    <div class="dropdown-content">
<a href="/p/scipy/1.8.0/api/scipy.html">1.8.0</a>
                    </div>
                </div>

                <div class="dropdown">
                    <a href='/p/scipy/1.8.0/api/scipy.html'>API</a>&nbsp;/&nbsp;
                    <div class="dropdown-content">
                        <a href="/p/scipy/1.8.0/api/scipy.html">API</a>
                        <a href="/p/scipy/1.8.0/gallery">Gallery</a>
                        <a href="/p/scipy/1.8.0/examples">Examples</a>
                        <a href="/p/scipy/1.8.0/docs">Narrative</a>
                     </div>
                </div>

                    <div class="dropdown">
                            <a class="dropbtn" href='scipy.html'>scipy</a>.                    </div><!--end dropdown-->
                    <div class="dropdown">
                            <a class="dropbtn" href='scipy.sparse.html'>sparse</a>.                            <div class="dropdown-content">
<a href="/p/?/?/?/scipy._lib.html.html">_lib</a>
<a href="/p/scipy/1.8.0/api/scipy.fft.html">fft</a>
<a href="/p/scipy/1.8.0/api/scipy.integrate.html">integrate</a>
<a href="/p/scipy/1.8.0/api/scipy.interpolate.html">interpolate</a>
<a href="/p/scipy/1.8.0/api/scipy.linalg.html">linalg</a>
<a href="/p/scipy/1.8.0/api/scipy.misc.html">misc</a>
<a href="/p/?/?/?/scipy.ndimage.html.html">ndimage</a>
<a href="/p/scipy/1.8.0/api/scipy.optimize.html">optimize</a>
<a href="/p/scipy/1.8.0/api/scipy.signal.html">signal</a>
<a href="/p/scipy/1.8.0/api/scipy.sparse.html">sparse</a>
<a href="/p/scipy/1.8.0/api/scipy.spatial.html">spatial</a>
<a href="/p/scipy/1.8.0/api/scipy.special.html">special</a>
<a href="/p/?/?/?/scipy.stats.html.html">stats</a>
                            </div>
                    </div><!--end dropdown-->
                    <div class="dropdown">
                            <a class="dropbtn" href='scipy.sparse.linalg.html'>linalg</a>.                            <div class="dropdown-content">
<a href="/p/scipy/1.8.0/api/scipy.sparse._arrays.html">_arrays</a>
<a href="/p/scipy/1.8.0/api/scipy.sparse._base.html">_base</a>
<a href="/p/scipy/1.8.0/api/scipy.sparse._bsr.html">_bsr</a>
<a href="/p/scipy/1.8.0/api/scipy.sparse._compressed.html">_compressed</a>
<a href="/p/scipy/1.8.0/api/scipy.sparse._construct.html">_construct</a>
<a href="/p/scipy/1.8.0/api/scipy.sparse._coo.html">_coo</a>
<a href="/p/scipy/1.8.0/api/scipy.sparse._csc.html">_csc</a>
<a href="/p/scipy/1.8.0/api/scipy.sparse._csparsetools.html">_csparsetools</a>
<a href="/p/scipy/1.8.0/api/scipy.sparse._csr.html">_csr</a>
<a href="/p/scipy/1.8.0/api/scipy.sparse._data.html">_data</a>
<a href="/p/scipy/1.8.0/api/scipy.sparse._dia.html">_dia</a>
<a href="/p/scipy/1.8.0/api/scipy.sparse._dok.html">_dok</a>
<a href="/p/scipy/1.8.0/api/scipy.sparse._extract.html">_extract</a>
<a href="/p/scipy/1.8.0/api/scipy.sparse._index.html">_index</a>
<a href="/p/scipy/1.8.0/api/scipy.sparse._lil.html">_lil</a>
<a href="/p/scipy/1.8.0/api/scipy.sparse._matrix_io.html">_matrix_io</a>
<a href="/p/scipy/1.8.0/api/scipy.sparse._sparsetools.html">_sparsetools</a>
<a href="/p/scipy/1.8.0/api/scipy.sparse._sputils.html">_sputils</a>
<a href="/p/scipy/1.8.0/api/scipy.sparse.base.html">base</a>
<a href="/p/scipy/1.8.0/api/scipy.sparse.bsr.html">bsr</a>
<a href="/p/scipy/1.8.0/api/scipy.sparse.compressed.html">compressed</a>
<a href="/p/scipy/1.8.0/api/scipy.sparse.construct.html">construct</a>
<a href="/p/scipy/1.8.0/api/scipy.sparse.coo.html">coo</a>
<a href="/p/scipy/1.8.0/api/scipy.sparse.csc.html">csc</a>
<a href="/p/scipy/1.8.0/api/scipy.sparse.csgraph.html">csgraph</a>
<a href="/p/scipy/1.8.0/api/scipy.sparse.csr.html">csr</a>
<a href="/p/scipy/1.8.0/api/scipy.sparse.data.html">data</a>
<a href="/p/scipy/1.8.0/api/scipy.sparse.dia.html">dia</a>
<a href="/p/scipy/1.8.0/api/scipy.sparse.dok.html">dok</a>
<a href="/p/scipy/1.8.0/api/scipy.sparse.extract.html">extract</a>
<a href="/p/scipy/1.8.0/api/scipy.sparse.lil.html">lil</a>
<a href="/p/scipy/1.8.0/api/scipy.sparse.linalg.html">linalg</a>
<a href="/p/scipy/1.8.0/api/scipy.sparse.sparsetools.html">sparsetools</a>
<a href="/p/scipy/1.8.0/api/scipy.sparse.sputils.html">sputils</a>
                            </div>
                    </div><!--end dropdown-->
                    <div class="dropdown">
                            <a class="dropbtn" href='scipy.sparse.linalg._eigen.html'>_eigen</a>.                            <div class="dropdown-content">
<a href="/p/scipy/1.8.0/api/scipy.sparse.linalg._dsolve.html">_dsolve</a>
<a href="/p/scipy/1.8.0/api/scipy.sparse.linalg._eigen.html">_eigen</a>
<a href="/p/scipy/1.8.0/api/scipy.sparse.linalg._expm_multiply.html">_expm_multiply</a>
<a href="/p/scipy/1.8.0/api/scipy.sparse.linalg._interface.html">_interface</a>
<a href="/p/scipy/1.8.0/api/scipy.sparse.linalg._isolve.html">_isolve</a>
<a href="/p/scipy/1.8.0/api/scipy.sparse.linalg._matfuncs.html">_matfuncs</a>
<a href="/p/scipy/1.8.0/api/scipy.sparse.linalg._norm.html">_norm</a>
<a href="/p/scipy/1.8.0/api/scipy.sparse.linalg._onenormest.html">_onenormest</a>
<a href="/p/scipy/1.8.0/api/scipy.sparse.linalg.dsolve.html">dsolve</a>
<a href="/p/scipy/1.8.0/api/scipy.sparse.linalg.eigen.html">eigen</a>
<a href="/p/scipy/1.8.0/api/scipy.sparse.linalg.interface.html">interface</a>
<a href="/p/scipy/1.8.0/api/scipy.sparse.linalg.isolve.html">isolve</a>
<a href="/p/scipy/1.8.0/api/scipy.sparse.linalg.matfuncs.html">matfuncs</a>
                            </div>
                    </div><!--end dropdown-->
                    <div class="dropdown">
                            <a class="dropbtn" href='scipy.sparse.linalg._eigen.lobpcg.html'>lobpcg</a>                            <div class="dropdown-content">
<a href="/p/scipy/1.8.0/api/scipy.sparse.linalg._eigen.lobpcg.lobpcg.lobpcg.html">lobpcg</a>
                            </div>
                    </div><!--end dropdown-->
</nav>
    </header>
    <div class='container'>

    <div class="sidenav">
        <img src="/p/scipy/1.8.0/img/scipy_logo.png"/>
    <a href="#">scipy</a>
    <a href="#">1.8.0</a>
        <a class='external'  href="https://pypi.org/project/scipy">Pypi</a>
        <a class='external' href="https://github.com/scipy/scipy">GitHub</a>
        <a class='external' href="https://scipy.org/">Homepage</a>
    <hr/>
        <a class='external' href="https://docs.scipy.org/doc/scipy/">Other Docs</a>
    <hr/>
<a href="#section-Notes">Notes</a><a href="#section-Parameters">Parameters</a><a href="#section-Returns">Returns</a><a href="#section-backrefs">BackRef</a>
    </div><!--end sidenav-->







<code class='signature'>lobpcg(A, X, B=None, M=None, Y=None, tol=None, maxiter=None, largest=True, verbosityLevel=0, retLambdaHistory=False, retResidualNormsHistory=False)</code><!-- rendering Extended Summary -->
                       <p>LOBPCG is a preconditioned eigensolver for large symmetric positive definite (SPD) generalized eigenproblems.</p>

<h3 id="section-Notes">Notes</h3>
<!-- rendering Notes -->
                       <p>If both         <code class='verbatim'>retLambdaHistory</code>
 and         <code class='verbatim'>retResidualNormsHistory</code>
 are True, the return tuple has the following format         <code class='verbatim'>(lambda, V, lambda history, residual norms history)</code>
.</p>

               <p>In the following         <code class='verbatim'>n</code>
 denotes the matrix size and         <code class='verbatim'>m</code>
 the number of required eigenvalues (smallest or largest).</p>

               <p>The LOBPCG code internally solves eigenproblems of the size         <code class='verbatim'>3m</code>
 on every iteration by calling the &#34;standard&#34; dense eigensolver, so if         <code class='verbatim'>m</code>
 is not small enough compared to         <code class='verbatim'>n</code>
, it does not make sense to call the LOBPCG code, but rather one should use the &#34;standard&#34; eigensolver, e.g. numpy or scipy function in this case. If one calls the LOBPCG algorithm for         <code class='verbatim'>5m &gt; n</code>
, it will most likely break internally, so the code tries to call the standard function instead.</p>

               <p>It is not that         <code class='verbatim'>n</code>
 should be large for the LOBPCG to work, but rather the ratio         <code class='verbatim'>n / m</code>
 should be large. It you call LOBPCG with         <code class='verbatim'>m=1</code>
 and         <code class='verbatim'>n=10</code>
, it works though         <code class='verbatim'>n</code>
 is small. The method is intended for extremely large         <code class='verbatim'>n / m</code>
.</p>

               <p>The convergence speed depends basically on two factors:</p>

                          <ol>               <li>               <p>How well relatively separated the seeking eigenvalues are from the rest    of the eigenvalues. One can try to vary         <code class='verbatim'>m</code>
 to make this better.</p>

</li>
               <li>               <p>How well conditioned the problem is. This can be changed by using proper    preconditioning. For example, a rod vibration test problem (under tests    directory) is ill-conditioned for large         <code class='verbatim'>n</code>
, so convergence will be    slow, unless efficient preconditioning is used. For this specific    problem, a good simple preconditioner function would be a linear solve    for <code><a href="#A" class='local'>A</a></code>, which is easy to code since A is tridiagonal.</p>

</li>
            </ol>

<h3 id="section-Parameters">Parameters</h3>
<dl>
<dt><a id="A">A</a> : {sparse matrix, dense matrix, LinearOperator}</dt>
<dd>
<p>The symmetric linear operator of the problem, usually a sparse matrix.  Often called the &#34;stiffness matrix&#34;.</p>

</dd>
<dt><a id="X">X</a> : ndarray, float32 or float64</dt>
<dd>
<p>Initial approximation to the         <code class='verbatim'>k</code>
 eigenvectors (non-sparse). If <code><a href="#A" class='local'>A</a></code> has         <code class='verbatim'>shape=(n,n)</code>
 then <code><a href="#X" class='local'>X</a></code> should have shape         <code class='verbatim'>shape=(n,k)</code>
.</p>

</dd>
<dt><a id="B">B</a> : {dense matrix, sparse matrix, LinearOperator}, optional</dt>
<dd>
<p>The right hand side operator in a generalized eigenproblem. By default,         <code class='verbatim'>B = Identity</code>
.  Often called the &#34;mass matrix&#34;.</p>

</dd>
<dt><a id="M">M</a> : {dense matrix, sparse matrix, LinearOperator}, optional</dt>
<dd>
<p>Preconditioner to <code><a href="#A" class='local'>A</a></code>; by default         <code class='verbatim'>M = Identity</code>
. <code><a href="#M" class='local'>M</a></code> should approximate the inverse of <code><a href="#A" class='local'>A</a></code>.</p>

</dd>
<dt><a id="Y">Y</a> : ndarray, float32 or float64, optional</dt>
<dd>
<p>n-by-sizeY matrix of constraints (non-sparse), sizeY &lt; n The iterations will be performed in the B-orthogonal complement of the column-space of Y. Y must be full rank.</p>

</dd>
<dt><a id="tol">tol</a> : scalar, optional</dt>
<dd>
<p>Solver tolerance (stopping criterion). The default is         <code class='verbatim'>tol=n*sqrt(eps)</code>
.</p>

</dd>
<dt><a id="maxiter">maxiter</a> : int, optional</dt>
<dd>
<p>Maximum number of iterations.  The default is         <code class='verbatim'>maxiter = 20</code>
.</p>

</dd>
<dt><a id="largest">largest</a> : bool, optional</dt>
<dd>
<p>When True, solve for the largest eigenvalues, otherwise the smallest.</p>

</dd>
<dt><a id="verbosityLevel">verbosityLevel</a> : int, optional</dt>
<dd>
<p>Controls solver output.  The default is         <code class='verbatim'>verbosityLevel=0</code>
.</p>

</dd>
<dt><a id="retLambdaHistory">retLambdaHistory</a> : bool, optional</dt>
<dd>
<p>Whether to return eigenvalue history.  Default is False.</p>

</dd>
<dt><a id="retResidualNormsHistory">retResidualNormsHistory</a> : bool, optional</dt>
<dd>
<p>Whether to return history of residual norms.  Default is False.</p>

</dd>
</dl>

<h3 id="section-Returns">Returns</h3>
<dl>
<dt><a id="w">w</a> : ndarray</dt>
<dd>
<p>Array of         <code class='verbatim'>k</code>
 eigenvalues</p>

</dd>
<dt><a id="v">v</a> : ndarray</dt>
<dd>
<p>An array of         <code class='verbatim'>k</code>
 eigenvectors.  <code><a href="#v" class='local'>v</a></code> has the same shape as <code><a href="#X" class='local'>X</a></code>.</p>

</dd>
<dt><a id="lambdas">lambdas</a> : list of ndarray, optional</dt>
<dd>
<p>The eigenvalue history, if <code class='not-implemented'>:None:None:`retLambdaHistory`</code> is True.</p>

</dd>
<dt><a id="rnorms">rnorms</a> : list of ndarray, optional</dt>
<dd>
<p>The history of residual norms, if <code class='not-implemented'>:None:None:`retResidualNormsHistory`</code> is True.</p>

</dd>
</dl>

<!-- rendering Summary -->
                       <p>Locally Optimal Block Preconditioned Conjugate Gradient Method (LOBPCG)</p>

<h3 id="section-Examples">Examples</h3>
                <p>Solve         <code class='verbatim'>A x = lambda x</code>
 with constraints and preconditioning.</p>

            
<pre class='highlight execed'><span class='nsl'>&gt;&gt;&gt; </span><span class="kn">import</span><span class=""> </span><a class="foo nn" href="/p/numpy/*/api/numpy.html">numpy</a><span class=""> </span><span class="k">as</span><span class=""> </span><a class="foo nn" href="/p/numpy/*/api/numpy.html">np</a><br><span class='nsl'>...&nbsp;</span><span class="kn">from</span><span class=""> </span><a class="foo nn" href="/p/scipy/1.8.0/api/scipy.html">scipy</a><span class="nn">.</span><a class="foo nn" href="/p/scipy/1.8.0/api/scipy.sparse.html">sparse</a><span class=""> </span><span class="kn">import</span><span class=""> </span><a class="foo " href="/p/scipy/1.8.0/api/scipy.sparse._construct.spdiags.html">spdiags</a><span class="">,</span><span class=""> </span><a class="foo " href="/p/scipy/1.8.0/api/scipy.sparse._base.isspmatrix.html">issparse</a><br><span class='nsl'>...&nbsp;</span><span class="kn">from</span><span class=""> </span><a class="foo nn" href="/p/scipy/1.8.0/api/scipy.html">scipy</a><span class="nn">.</span><a class="foo nn" href="/p/scipy/1.8.0/api/scipy.sparse.html">sparse</a><span class="nn">.</span><a class="foo nn" href="/p/scipy/1.8.0/api/scipy.sparse.linalg.html">linalg</a><span class=""> </span><span class="kn">import</span><span class=""> </span><a class="foo " href="/p/scipy/1.8.0/api/scipy.sparse.linalg._eigen.lobpcg.lobpcg.lobpcg.html">lobpcg</a><span class="">,</span><span class=""> </span><a class="foo " href="/p/scipy/1.8.0/api/scipy.sparse.linalg._interface.LinearOperator.html">LinearOperator</a><br><span class='nsl'>...&nbsp;</span><a class="foo " href="/p/builtins/*/api/builtins.int.html">n</a><span class=""> </span><span class="o">=</span><span class=""> </span><span class="mi">100</span><br><span class='nsl'>...&nbsp;</span><a class="foo " href="/p/numpy/*/api/numpy.ndarray.html">vals</a><span class=""> </span><span class="o">=</span><span class=""> </span><a class="foo " href="/p/numpy/*/api/numpy.html">np</a><span class="o">.</span><a class="foo " href="/p/numpy/*/api/numpy.arange.html">arange</a><span class="">(</span><span class="mi">1</span><span class="">,</span><span class=""> </span><a class="foo " href="/p/builtins/*/api/builtins.int.html">n</a><span class=""> </span><span class="o">+</span><span class=""> </span><span class="mi">1</span><span class="">)</span><br><span class='nsl'>...&nbsp;</span><a class="foo " href="/p/scipy/1.8.0/api/scipy.sparse._dia.dia_matrix.html">A</a><span class=""> </span><span class="o">=</span><span class=""> </span><a class="foo " href="/p/scipy/1.8.0/api/scipy.sparse._construct.spdiags.html">spdiags</a><span class="">(</span><a class="foo " href="/p/numpy/*/api/numpy.ndarray.html">vals</a><span class="">,</span><span class=""> </span><span class="mi">0</span><span class="">,</span><span class=""> </span><a class="foo " href="/p/builtins/*/api/builtins.int.html">n</a><span class="">,</span><span class=""> </span><a class="foo " href="/p/builtins/*/api/builtins.int.html">n</a><span class="">)</span><br><span class='nsl'>...&nbsp;</span><a class="foo " href="/p/scipy/1.8.0/api/scipy.sparse._dia.dia_matrix.html">A</a><span class="o">.</span><a class="foo " href="/p/scipy/1.8.0/api/scipy.sparse._base.spmatrix.toarray.html">toarray</a><span class="">(</span><span class="">)</span>
array([[  1.,   0.,   0., ...,   0.,   0.,   0.],
       [  0.,   2.,   0., ...,   0.,   0.,   0.],
       [  0.,   0.,   3., ...,   0.,   0.,   0.],
       ...,
       [  0.,   0.,   0., ...,  98.,   0.,   0.],
       [  0.,   0.,   0., ...,   0.,  99.,   0.],
       [  0.,   0.,   0., ...,   0.,   0., 100.]])</pre>
            
                <p>Constraints:</p>

            
<pre class='highlight execed'><span class='nsl'>&gt;&gt;&gt; </span><a class="foo " href="/p/numpy/*/api/numpy.ndarray.html">Y</a><span class=""> </span><span class="o">=</span><span class=""> </span><a class="foo " href="/p/numpy/*/api/numpy.html">np</a><span class="o">.</span><a class="foo " href="/p/numpy/*/api/numpy.lib.twodim_base.eye.html">eye</a><span class="">(</span><a class="foo " href="/p/builtins/*/api/builtins.int.html">n</a><span class="">,</span><span class=""> </span><span class="mi">3</span><span class="">)</span>
</pre>
            
                <p>Initial guess for eigenvectors, should have linearly independent columns. Column dimension = number of requested eigenvalues.</p>

            
<pre class='highlight execed'><span class='nsl'>&gt;&gt;&gt; </span><a class="foo " href="/p/numpy/*/api/numpy.random._generator.Generator.html">rng</a><span class=""> </span><span class="o">=</span><span class=""> </span><a class="foo " href="/p/numpy/*/api/numpy.html">np</a><span class="o">.</span><a class="foo " href="/p/numpy/*/api/numpy.random.html">random</a><span class="o">.</span><a class="foo " href="/p/numpy/*/api/numpy.random._generator.default_rng.html">default_rng</a><span class="">(</span><span class="">)</span><br><span class='nsl'>...&nbsp;</span><a class="foo " href="/p/builtins/*/api/builtins.float.html">X</a><span class=""> </span><span class="o">=</span><span class=""> </span><a class="foo " href="/p/numpy/*/api/numpy.random._generator.Generator.html">rng</a><span class="o">.</span><a class="foo " href="/p/numpy/*/api/numpy.random._generator.Generator.random.html">random</a><span class="">(</span><span class="">(</span><a class="foo " href="/p/builtins/*/api/builtins.int.html">n</a><span class="">,</span><span class=""> </span><span class="mi">3</span><span class="">)</span><span class="">)</span>
</pre>
            
                <p>Preconditioner in the inverse of A in this example:</p>

            
<pre class='highlight execed'><span class='nsl'>&gt;&gt;&gt; </span><a class="foo " href="/p/scipy/1.8.0/api/scipy.sparse._dia.dia_matrix.html">invA</a><span class=""> </span><span class="o">=</span><span class=""> </span><a class="foo " href="/p/scipy/1.8.0/api/scipy.sparse._construct.spdiags.html">spdiags</a><span class="">(</span><span class="">[</span><span class="mf">1.</span><span class="o">/</span><a class="foo " href="/p/numpy/*/api/numpy.ndarray.html">vals</a><span class="">]</span><span class="">,</span><span class=""> </span><span class="mi">0</span><span class="">,</span><span class=""> </span><a class="foo " href="/p/builtins/*/api/builtins.int.html">n</a><span class="">,</span><span class=""> </span><a class="foo " href="/p/builtins/*/api/builtins.int.html">n</a><span class="">)</span>
</pre>
            
                <p>The preconditiner must be defined by a function:</p>

            
<pre class='highlight execed'><span class='nsl'>&gt;&gt;&gt; </span><span class="k">def</span><span class=""> </span><a class="foo nf" href="/p/__main__/*/api/__main__.precond.html">precond</a><span class="">(</span><span class=""> </span><span class="">x</span><span class=""> </span><span class="">)</span><span class="">:</span><br><span class='nsl'>...&nbsp;</span><span class="">    </span><span class="k">return</span><span class=""> </span><a class="foo " href="/p/scipy/1.8.0/api/scipy.sparse._dia.dia_matrix.html">invA</a><span class=""> </span><span class="o">@</span><span class=""> </span><span class="">x</span>
</pre>
            
                <p>The argument x of the preconditioner function is a matrix inside <code><a href="/p/scipy/1.8.0/api/scipy.sparse.linalg._eigen.lobpcg.lobpcg.lobpcg.html" class='exists'>lobpcg</a></code>
, thus the use of matrix-matrix product         <code class='verbatim'>@</code>
.</p>

            
                <p>The preconditioner function is passed to lobpcg as a <code><a href="/p/scipy/1.8.0/api/scipy.sparse.linalg._interface.LinearOperator.html" class='exists'>LinearOperator</a></code>
:</p>

            
<pre class='highlight execed'><span class='nsl'>&gt;&gt;&gt; </span><a class="foo " href="/p/scipy/1.8.0/api/scipy.sparse.linalg._interface.LinearOperator.html">M</a><span class=""> </span><span class="o">=</span><span class=""> </span><a class="foo " href="/p/scipy/1.8.0/api/scipy.sparse.linalg._interface.LinearOperator.html">LinearOperator</a><span class="">(</span><span class="">matvec</span><span class="o">=</span><a class="foo " href="/p/__main__/*/api/__main__.precond.html">precond</a><span class="">,</span><span class=""> </span><span class="">matmat</span><span class="o">=</span><a class="foo " href="/p/__main__/*/api/__main__.precond.html">precond</a><span class="">,</span><br><span class='nsl'>...&nbsp;</span><span class="">                   </span><span class="">shape</span><span class="o">=</span><span class="">(</span><a class="foo " href="/p/builtins/*/api/builtins.int.html">n</a><span class="">,</span><span class=""> </span><a class="foo " href="/p/builtins/*/api/builtins.int.html">n</a><span class="">)</span><span class="">,</span><span class=""> </span><span class="">dtype</span><span class="o">=</span><a class="foo " href="/p/numpy/*/api/numpy.html">np</a><span class="o">.</span><a class="foo " href="/p/numpy/*/api/numpy.floating.html">float64</a><span class="">)</span>
</pre>
            
                <p>Let us now solve the eigenvalue problem for the matrix A:</p>

            
<pre class='highlight execed'><span class='nsl'>&gt;&gt;&gt; </span><span class="">eigenvalues</span><span class="">,</span><span class=""> </span><span class="">_</span><span class=""> </span><span class="o">=</span><span class=""> </span><a class="foo " href="/p/scipy/1.8.0/api/scipy.sparse.linalg._eigen.lobpcg.lobpcg.lobpcg.html">lobpcg</a><span class="">(</span><a class="foo " href="/p/scipy/1.8.0/api/scipy.sparse._dia.dia_matrix.html">A</a><span class="">,</span><span class=""> </span><a class="foo " href="/p/builtins/*/api/builtins.float.html">X</a><span class="">,</span><span class=""> </span><a class="foo " href="/p/numpy/*/api/numpy.ndarray.html">Y</a><span class="o">=</span><a class="foo " href="/p/numpy/*/api/numpy.ndarray.html">Y</a><span class="">,</span><span class=""> </span><a class="foo " href="/p/scipy/1.8.0/api/scipy.sparse.linalg._interface.LinearOperator.html">M</a><span class="o">=</span><a class="foo " href="/p/scipy/1.8.0/api/scipy.sparse.linalg._interface.LinearOperator.html">M</a><span class="">,</span><span class=""> </span><span class="">largest</span><span class="o">=</span><span class="kc">False</span><span class="">)</span><br><span class='nsl'>...&nbsp;</span><a class="foo " href="/p/numpy/*/api/numpy.ndarray.html">eigenvalues</a>
array([4., 5., 6.])</pre>
            
                <p>Note that the vectors passed in Y are the eigenvectors of the 3 smallest eigenvalues. The results returned are orthogonal to those.</p>

            
         See :
    

    <h3 id='section-backrefs'>Back References</h3>
    <p>The following pages refer to to this document either explicitly or contain code examples using this.</p>

        <code><a link href="/p/scipy/1.8.0/api/scipy.sparse.linalg._eigen.lobpcg.lobpcg.lobpcg.html" class='exists'>scipy.sparse.linalg._eigen.lobpcg.lobpcg.lobpcg</a></code>

<h3>Local connectivity graph</h3>
<p>Hover to see nodes names; edges to Self not shown, Caped at 50 nodes.</p>

<p> Using a canvas is more power efficient and can get hundred of nodes ; but does not allow hyperlinks; , arrows
or text (beyond on hover) </p> 
<canvas class='graph' width="800" height="500"></canvas>
<p> SVG is more flexible but power hungry; and does not scale well to 50 + nodes. </p> 

<svg class='graph' width="600" height="500"></svg>

<p>All aboves nodes referred to, (or are referred from) current nodes; Edges from Self to other have been omitted
(or all nodes would be connected to the central node "self" which is not useful). Nodes are colored by the library
they belong to, and scaled with the number of references pointing them</p>

<hr>

    GitHub : <a class='external' href='https://github.com/scipy/scipy/blob/v1.8.0//scipy/sparse/linalg/_eigen/lobpcg/lobpcg.py#L128'>/scipy/sparse/linalg/_eigen/lobpcg/lobpcg.py#128</a>
<br/>

type: &lt;class &#39;function&#39;&gt; <br/>
Commit: <br/>

        <script src="https://d3js.org/d3.v4.min.js"></script>
    <script src="https://d3js.org/d3-selection-multi.v1.js"></script>
    <style type="text/css">
        .node {};
        .link { stroke: #999; stroke-opacity: .6; stroke-width: 1px; };
    </style>
<script>
    window._data_graph = {"nodes": [{"id": 1, "val": 32.515301344262525, "label": "scipy", "mod": "scipy", "url": "/p/scipy/1.8.0/api/scipy"}, {"id": 2, "val": 13.0, "label": "scipy.sparse.linalg", "mod": "scipy", "url": "/p/scipy/1.8.0/api/scipy.sparse.linalg"}, {"id": 3, "val": 10.0, "label": "scipy.sparse._dia.dia_matrix", "mod": "scipy", "url": "/p/scipy/1.8.0/api/scipy.sparse._dia.dia_matrix"}, {"id": 4, "val": 19.874342087037917, "label": "numpy.random", "mod": "numpy", "url": "/p/numpy/1.22.4/api/numpy.random"}, {"id": 5, "val": 10.64575131106459, "label": "scipy.sparse.linalg._interface.LinearOperator", "mod": "scipy", "url": "/p/scipy/1.8.0/api/scipy.sparse.linalg._interface.LinearOperator"}, {"id": 6, "val": 16.831760866327848, "label": "numpy.random._generator.Generator", "mod": "numpy", "url": "/p/numpy/1.22.4/api/numpy.random._generator.Generator"}, {"id": 7, "val": 35.80287754891569, "label": "numpy.ndarray", "mod": "numpy", "url": "/p/numpy/1.22.4/api/numpy.ndarray"}, {"id": 8, "val": 9.0, "label": "__main__.precond", "mod": "__main__", "url": "/p/__main__/*/api/__main__.precond"}, {"id": 9, "val": 13.567764362830022, "label": "numpy.floating", "mod": "numpy", "url": "/p/numpy/*/api/numpy.floating"}, {"id": 10, "val": 17.74679434480896, "label": "scipy.sparse", "mod": "scipy", "url": "/p/scipy/1.8.0/api/scipy.sparse"}, {"id": 11, "val": 28.29778313018444, "label": "builtins.int", "mod": "builtins", "url": "/p/builtins/*/api/builtins.int"}, {"id": 13, "val": 37.01723625709381, "label": "numpy", "mod": "numpy", "url": "/p/numpy/1.22.4/api/numpy"}, {"id": 14, "val": 29.97726097583591, "label": "builtins.float", "mod": "builtins", "url": "/p/builtins/*/api/builtins.float"}, {"id": 15, "val": 10.64575131106459, "label": "scipy.sparse._base.spmatrix.toarray", "mod": "scipy", "url": "/p/scipy/1.8.0/api/scipy.sparse._base.spmatrix.toarray"}, {"id": 16, "val": 20.884098726725128, "label": "numpy.arange", "mod": "numpy", "url": "/p/numpy/*/api/numpy.arange"}, {"id": 17, "val": 11.0, "label": "numpy.random._generator.Generator.random", "mod": "numpy", "url": "/p/numpy/*/api/numpy.random._generator.Generator.random"}, {"id": 18, "val": 16.544003745317532, "label": "numpy.random._generator.default_rng", "mod": "numpy", "url": "/p/numpy/1.22.4/api/numpy.random._generator.default_rng"}, {"id": 19, "val": 9.732050807568877, "label": "scipy.sparse._construct.spdiags", "mod": "scipy", "url": "/p/scipy/1.8.0/api/scipy.sparse._construct.spdiags"}, {"id": 20, "val": 9.414213562373096, "label": "numpy.lib.twodim_base.eye", "mod": "numpy", "url": "/p/numpy/*/api/numpy.lib.twodim_base.eye"}, {"id": 21, "val": 9.414213562373096, "label": "scipy.sparse._base.isspmatrix", "mod": "scipy", "url": "/p/scipy/1.8.0/api/scipy.sparse._base.isspmatrix"}], "links": [{"source": 6, "target": 4, "id": 13}, {"source": 6, "target": 18, "id": 32}, {"source": 18, "target": 6, "id": 97}, {"source": 2, "target": 5, "id": 157}, {"source": 4, "target": 6, "id": 185}, {"source": 15, "target": 19, "id": 322}, {"source": 15, "target": 3, "id": 324}, {"source": 1, "target": 5, "id": 336}, {"source": 1, "target": 21, "id": 417}, {"source": 1, "target": 3, "id": 663}, {"source": 1, "target": 19, "id": 842}, {"source": 3, "target": 19, "id": 930}, {"source": 11, "target": 3, "id": 1187}, {"source": 7, "target": 3, "id": 1809}, {"source": 7, "target": 19, "id": 2020}, {"source": 10, "target": 5, "id": 2135}, {"source": 10, "target": 3, "id": 2158}, {"source": 10, "target": 19, "id": 2168}, {"source": 10, "target": 21, "id": 2195}, {"source": 13, "target": 5, "id": 2439}, {"source": 13, "target": 7, "id": 2785}, {"source": 13, "target": 3, "id": 2924}, {"source": 13, "target": 19, "id": 3154}]};
</script>
<script type="text/javascript" src='/graph_canvas.js'></script>
<script type="text/javascript" src='/graph_svg.js'></script>


</div>
</body>
</html>