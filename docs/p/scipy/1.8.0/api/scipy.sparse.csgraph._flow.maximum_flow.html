<!doctypehtml><html lang=en><meta charset=UTF-8><meta content=width=device-width,initial-scale=1.0 name=viewport><title>Document</title><link href=https://fonts.xz.style/serve/inter.css rel=stylesheet><link crossorigin=anonymous href=https://use.fontawesome.com/releases/v5.8.1/css/all.css integrity=sha384-50oBUHEmvpQ+1lW4y57PTFmhCaXp0ML5d60M1M7uH2+nqUivzIebhndOJK28anvf rel=stylesheet><link href=https://cdn.jsdelivr.net/npm/@exampledev/new.css@1.1.2/new.min.css rel=stylesheet><script type=text/x-mathjax-config>
        // this should process only math inside  span with tex2jax_process class
    MathJax.Hub.Config({
        extensions: ["tex2jax.js"],
        jax: ["input/TeX", "output/HTML-CSS"],
        tex2jax: {
        inlineMath: [ ['$','$'], ["\\(","\\)"] ],
        displayMath: [ ['$$','$$'], ["\\[","\\]"] ],
        processEscapes: true
        },
        "HTML-CSS": { fonts: ["TeX"] }
    });
    </script><script async src=https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/MathJax.js></script><link href=/papyri.css rel=stylesheet><style>header > brand, header>:first-child {
        border-right: 1px solid #ccc;
        border-left: 1px solid #ccc;
        padding: 16px;
        padding-top: 0.5rem;
        padding-bottom: 0.5rem;
        display: inline-block; 
        width: 167px;
    }
    pre { line-height: 125%; }
td.linenos .normal { color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px; }
span.linenos { color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px; }
td.linenos .special { color: #000000; background-color: #ffffc0; padding-left: 5px; padding-right: 5px; }
span.linenos.special { color: #000000; background-color: #ffffc0; padding-left: 5px; padding-right: 5px; }
.highlight .hll { background-color: #ffffcc }
.highlight { background: #ffffff; }
.highlight .c { color: #888888 } /* Comment */
.highlight .err { color: #a61717; background-color: #e3d2d2 } /* Error */
.highlight .k { color: #008800; font-weight: bold } /* Keyword */
.highlight .ch { color: #888888 } /* Comment.Hashbang */
.highlight .cm { color: #888888 } /* Comment.Multiline */
.highlight .cp { color: #cc0000; font-weight: bold } /* Comment.Preproc */
.highlight .cpf { color: #888888 } /* Comment.PreprocFile */
.highlight .c1 { color: #888888 } /* Comment.Single */
.highlight .cs { color: #cc0000; font-weight: bold; background-color: #fff0f0 } /* Comment.Special */
.highlight .gd { color: #000000; background-color: #ffdddd } /* Generic.Deleted */
.highlight .ge { font-style: italic } /* Generic.Emph */
.highlight .gr { color: #aa0000 } /* Generic.Error */
.highlight .gh { color: #333333 } /* Generic.Heading */
.highlight .gi { color: #000000; background-color: #ddffdd } /* Generic.Inserted */
.highlight .go { color: #888888 } /* Generic.Output */
.highlight .gp { color: #555555 } /* Generic.Prompt */
.highlight .gs { font-weight: bold } /* Generic.Strong */
.highlight .gu { color: #666666 } /* Generic.Subheading */
.highlight .gt { color: #aa0000 } /* Generic.Traceback */
.highlight .kc { color: #008800; font-weight: bold } /* Keyword.Constant */
.highlight .kd { color: #008800; font-weight: bold } /* Keyword.Declaration */
.highlight .kn { color: #008800; font-weight: bold } /* Keyword.Namespace */
.highlight .kp { color: #008800 } /* Keyword.Pseudo */
.highlight .kr { color: #008800; font-weight: bold } /* Keyword.Reserved */
.highlight .kt { color: #888888; font-weight: bold } /* Keyword.Type */
.highlight .m { color: #0000DD; font-weight: bold } /* Literal.Number */
.highlight .s { color: #dd2200; background-color: #fff0f0 } /* Literal.String */
.highlight .na { color: #336699 } /* Name.Attribute */
.highlight .nb { color: #003388 } /* Name.Builtin */
.highlight .nc { color: #bb0066; font-weight: bold } /* Name.Class */
.highlight .no { color: #003366; font-weight: bold } /* Name.Constant */
.highlight .nd { color: #555555 } /* Name.Decorator */
.highlight .ne { color: #bb0066; font-weight: bold } /* Name.Exception */
.highlight .nf { color: #0066bb; font-weight: bold } /* Name.Function */
.highlight .nl { color: #336699; font-style: italic } /* Name.Label */
.highlight .nn { color: #bb0066; font-weight: bold } /* Name.Namespace */
.highlight .py { color: #336699; font-weight: bold } /* Name.Property */
.highlight .nt { color: #bb0066; font-weight: bold } /* Name.Tag */
.highlight .nv { color: #336699 } /* Name.Variable */
.highlight .ow { color: #008800 } /* Operator.Word */
.highlight .w { color: #bbbbbb } /* Text.Whitespace */
.highlight .mb { color: #0000DD; font-weight: bold } /* Literal.Number.Bin */
.highlight .mf { color: #0000DD; font-weight: bold } /* Literal.Number.Float */
.highlight .mh { color: #0000DD; font-weight: bold } /* Literal.Number.Hex */
.highlight .mi { color: #0000DD; font-weight: bold } /* Literal.Number.Integer */
.highlight .mo { color: #0000DD; font-weight: bold } /* Literal.Number.Oct */
.highlight .sa { color: #dd2200; background-color: #fff0f0 } /* Literal.String.Affix */
.highlight .sb { color: #dd2200; background-color: #fff0f0 } /* Literal.String.Backtick */
.highlight .sc { color: #dd2200; background-color: #fff0f0 } /* Literal.String.Char */
.highlight .dl { color: #dd2200; background-color: #fff0f0 } /* Literal.String.Delimiter */
.highlight .sd { color: #dd2200; background-color: #fff0f0 } /* Literal.String.Doc */
.highlight .s2 { color: #dd2200; background-color: #fff0f0 } /* Literal.String.Double */
.highlight .se { color: #0044dd; background-color: #fff0f0 } /* Literal.String.Escape */
.highlight .sh { color: #dd2200; background-color: #fff0f0 } /* Literal.String.Heredoc */
.highlight .si { color: #3333bb; background-color: #fff0f0 } /* Literal.String.Interpol */
.highlight .sx { color: #22bb22; background-color: #f0fff0 } /* Literal.String.Other */
.highlight .sr { color: #008800; background-color: #fff0ff } /* Literal.String.Regex */
.highlight .s1 { color: #dd2200; background-color: #fff0f0 } /* Literal.String.Single */
.highlight .ss { color: #aa6600; background-color: #fff0f0 } /* Literal.String.Symbol */
.highlight .bp { color: #003388 } /* Name.Builtin.Pseudo */
.highlight .fm { color: #0066bb; font-weight: bold } /* Name.Function.Magic */
.highlight .vc { color: #336699 } /* Name.Variable.Class */
.highlight .vg { color: #dd7700 } /* Name.Variable.Global */
.highlight .vi { color: #3333bb } /* Name.Variable.Instance */
.highlight .vm { color: #336699 } /* Name.Variable.Magic */
.highlight .il { color: #0000DD; font-weight: bold } /* Literal.Number.Integer.Long */</style></head><body class=tex2jax_ignore><header><brand><i class="fab fa-python"></i><a href=/>Home</a></brand><nav>/ <a href=/>p</a>  /  <div class=dropdown><a href=scipy>scipy</a> /  <div class=dropdown-content><a href=/p/IPython/8.2.0.dev/api/IPython.html>IPython</a><a href=/p/astropy/5.0/api/astropy.html>astropy</a><a href=/p/dask/2021.10.0/api/dask.html>dask</a><a href=/p/distributed/2021.10.0/api/distributed.html>distributed</a><a href=/p/matplotlib/3.5.1/api/matplotlib.html>matplotlib</a><a href=/p/networkx/2.7.2rc1.dev0/api/networkx.html>networkx</a><a href=/p/numpy/1.22.3/api/numpy.html>numpy</a><a href=/p/pandas/1.4.1/api/pandas.html>pandas</a><a href=/p/papyri/0.0.8/api/papyri.html>papyri</a><a href=/p/scipy/1.8.0/api/scipy.html>scipy</a><a href=/p/skimage/0.17.2/api/skimage.html>skimage</a></div></div><div class=dropdown><a href=/p/scipy/1.8.0/api/scipy.html>1.8.0</a> /  <div class=dropdown-content><a href=/p/scipy/1.8.0/api/scipy.html>1.8.0</a></div></div><div class=dropdown><a href=/p/scipy/1.8.0/api/scipy.html>api</a> /  <div class=dropdown-content><a href=/p/scipy/1.8.0/api/scipy.html>API</a><a href=/p/scipy/1.8.0/gallery>Gallery</a><a href=/p/scipy/1.8.0/examples>Examples</a></div></div><div class=dropdown><a class=dropbtn href=scipy.html>scipy</a>.</div><div class=dropdown><a class=dropbtn href=scipy.sparse.html>sparse</a>. <div class=dropdown-content><a href=/p/?/?/api/scipy._lib.html>_lib</a><a href=/p/scipy/1.8.0/api/scipy.fft.html>fft</a><a href=/p/scipy/1.8.0/api/scipy.integrate.html>integrate</a><a href=/p/scipy/1.8.0/api/scipy.interpolate.html>interpolate</a><a href=/p/scipy/1.8.0/api/scipy.linalg.html>linalg</a><a href=/p/?/?/api/scipy.ndimage.html>ndimage</a><a href=/p/scipy/1.8.0/api/scipy.optimize.html>optimize</a><a href=/p/scipy/1.8.0/api/scipy.signal.html>signal</a><a href=/p/scipy/1.8.0/api/scipy.sparse.html>sparse</a><a href=/p/scipy/1.8.0/api/scipy.spatial.html>spatial</a><a href=/p/scipy/1.8.0/api/scipy.special.html>special</a><a href=/p/?/?/api/scipy.stats.html>stats</a></div></div><div class=dropdown><a class=dropbtn href=scipy.sparse.csgraph.html>csgraph</a>. <div class=dropdown-content><a href=/p/scipy/1.8.0/api/scipy.sparse._arrays.html>_arrays</a><a href=/p/scipy/1.8.0/api/scipy.sparse._base.html>_base</a><a href=/p/scipy/1.8.0/api/scipy.sparse._bsr.html>_bsr</a><a href=/p/scipy/1.8.0/api/scipy.sparse._compressed.html>_compressed</a><a href=/p/scipy/1.8.0/api/scipy.sparse._construct.html>_construct</a><a href=/p/scipy/1.8.0/api/scipy.sparse._coo.html>_coo</a><a href=/p/scipy/1.8.0/api/scipy.sparse._csc.html>_csc</a><a href=/p/scipy/1.8.0/api/scipy.sparse._csparsetools.html>_csparsetools</a><a href=/p/scipy/1.8.0/api/scipy.sparse._csr.html>_csr</a><a href=/p/scipy/1.8.0/api/scipy.sparse._data.html>_data</a><a href=/p/scipy/1.8.0/api/scipy.sparse._dia.html>_dia</a><a href=/p/scipy/1.8.0/api/scipy.sparse._dok.html>_dok</a><a href=/p/scipy/1.8.0/api/scipy.sparse._extract.html>_extract</a><a href=/p/scipy/1.8.0/api/scipy.sparse._index.html>_index</a><a href=/p/scipy/1.8.0/api/scipy.sparse._lil.html>_lil</a><a href=/p/scipy/1.8.0/api/scipy.sparse._matrix_io.html>_matrix_io</a><a href=/p/scipy/1.8.0/api/scipy.sparse._sparsetools.html>_sparsetools</a><a href=/p/scipy/1.8.0/api/scipy.sparse._sputils.html>_sputils</a><a href=/p/scipy/1.8.0/api/scipy.sparse.base.html>base</a><a href=/p/scipy/1.8.0/api/scipy.sparse.bsr.html>bsr</a><a href=/p/scipy/1.8.0/api/scipy.sparse.compressed.html>compressed</a><a href=/p/scipy/1.8.0/api/scipy.sparse.construct.html>construct</a><a href=/p/scipy/1.8.0/api/scipy.sparse.coo.html>coo</a><a href=/p/scipy/1.8.0/api/scipy.sparse.csc.html>csc</a><a href=/p/scipy/1.8.0/api/scipy.sparse.csgraph.html>csgraph</a><a href=/p/scipy/1.8.0/api/scipy.sparse.csr.html>csr</a><a href=/p/scipy/1.8.0/api/scipy.sparse.data.html>data</a><a href=/p/scipy/1.8.0/api/scipy.sparse.dia.html>dia</a><a href=/p/scipy/1.8.0/api/scipy.sparse.dok.html>dok</a><a href=/p/scipy/1.8.0/api/scipy.sparse.extract.html>extract</a><a href=/p/scipy/1.8.0/api/scipy.sparse.lil.html>lil</a><a href=/p/scipy/1.8.0/api/scipy.sparse.linalg.html>linalg</a><a href=/p/scipy/1.8.0/api/scipy.sparse.sparsetools.html>sparsetools</a><a href=/p/scipy/1.8.0/api/scipy.sparse.sputils.html>sputils</a></div></div><div class=dropdown><a class=dropbtn href=scipy.sparse.csgraph._flow.html>_flow</a>. <div class=dropdown-content><a href=/p/scipy/1.8.0/api/scipy.sparse.csgraph._flow.html>_flow</a><a href=/p/scipy/1.8.0/api/scipy.sparse.csgraph._laplacian.html>_laplacian</a><a href=/p/scipy/1.8.0/api/scipy.sparse.csgraph._matching.html>_matching</a><a href=/p/scipy/1.8.0/api/scipy.sparse.csgraph._min_spanning_tree.html>_min_spanning_tree</a><a href=/p/scipy/1.8.0/api/scipy.sparse.csgraph._reordering.html>_reordering</a><a href=/p/scipy/1.8.0/api/scipy.sparse.csgraph._shortest_path.html>_shortest_path</a><a href=/p/scipy/1.8.0/api/scipy.sparse.csgraph._tools.html>_tools</a><a href=/p/scipy/1.8.0/api/scipy.sparse.csgraph._traversal.html>_traversal</a><a href=/p/scipy/1.8.0/api/scipy.sparse.csgraph._validation.html>_validation</a></div></div><div class=dropdown><a class=dropbtn href=scipy.sparse.csgraph._flow.maximum_flow.html>maximum_flow</a><div class=dropdown-content><a href=/p/scipy/1.8.0/api/scipy.sparse.csgraph._flow.MaximumFlowResult.html>MaximumFlowResult</a><a href=/p/scipy/1.8.0/api/scipy.sparse.csgraph._flow._add_reverse_edges.html>_add_reverse_edges</a><a href=/p/scipy/1.8.0/api/scipy.sparse.csgraph._flow._make_edge_pointers.html>_make_edge_pointers</a><a href=/p/scipy/1.8.0/api/scipy.sparse.csgraph._flow._make_tails.html>_make_tails</a><a href=/p/scipy/1.8.0/api/scipy.sparse.csgraph._flow.maximum_flow.html>maximum_flow</a></div></div></nav></header><div class=container><div class=sidenav><img src=/p/scipy/1.8.0/img/logo.png><a href=#>scipy</a><a href=#>1.8.0</a><a class=external href=https://pypi.org/project/scipy>Pypi</a><a class=external href=https://github.com/scipy/scipy>GitHub</a><a class=external href=https://scipy.org/>Homepage</a><hr><a class=external href=https://docs.scipy.org/doc/scipy/>Other Docs</a><hr><a href=#section-Notes>Notes</a><a href=#section-Parameters>Parameters</a><a href=#section-Raises>Raises</a><a href=#section-Returns>Returns</a><a href=#section-backrefs>BackRef</a></div><code class=signature>maximum_flow(csgraph, source, sink)</code><div class=admonition><div>versionadded</div><p>1.4.0</p></div><h3 id=section-Notes>Notes</h3><p>This solves the maximum flow problem on a given directed weighted graph: A flow associates to every edge a value, also called a flow, less than the capacity of the edge, so that for every vertex (apart from the source and the sink vertices), the total incoming flow is equal to the total outgoing flow. The value of a flow is the sum of the flow of all edges leaving the source vertex, and the maximum flow problem consists of finding a flow whose value is maximal.</p><p>By the max-flow min-cut theorem, the maximal value of the flow is also the total weight of the edges in a minimum cut.</p><p>To solve the problem, we provide Edmonds--Karp and Dinic's algorithm . The implementation of both algorithms strive to exploit sparsity. The time complexity of the former <span class=tex2jax_process>$O(|V|\,|E|^2)$</span> and its space complexity is <span class=tex2jax_process>$O(|E|)$</span> . The latter achieves its performance by building level graphs and finding blocking flows in them. Its time complexity is <span class=tex2jax_process>$O(|V|^2\,|E|)$</span> and its space complexity is <span class=tex2jax_process>$O(|E|)$</span> .</p><p>The maximum flow problem is usually defined with real valued capacities, but we require that all capacities are integral to ensure convergence. When dealing with rational capacities, or capacities belonging to <span class=tex2jax_process>$x\mathbb{Q}$</span> for some fixed <span class=tex2jax_process>$x \in \mathbb{R}$</span> , it is possible to reduce the problem to the integral case by scaling all capacities accordingly.</p><p>Solving a maximum-flow problem can be used for example for graph cuts optimization in computer vision .</p><h3 id=section-Parameters>Parameters</h3><dl><dt><a id=csgraph>csgraph</a> : csr_matrix</dt><dd><p>The square matrix representing a directed graph whose (i, j)'th entry is an integer representing the capacity of the edge between vertices i and j.</p></dd><dt><a id=source>source</a> : int</dt><dd><p>The source vertex from which the flow flows.</p></dd><dt><a id=sink>sink</a> : int</dt><dd><p>The sink vertex to which the flow flows.</p></dd><dt><a id="method: {'edmonds_karp', 'dinic'}, optional">method: {'edmonds_karp', 'dinic'}, optional</a> :</dt><dd><p>The method/algorithm to be used for computing the maximum flow. Following methods are supported,</p> <pre>* 'edmonds_karp': Edmonds Karp algorithm in [1]_.
* 'dinic': Dinic's algorithm in [4]_.
</pre> <p>Default is 'dinic'.</p> <div class=admonition><div>versionadded</div><p>1.8.0</p></div></dd></dl><h3 id=section-Raises>Raises</h3><dl><dt>TypeError:</dt><dd><p>if the input graph is not in CSR format.</p></dd><dt>ValueError:</dt><dd><p>if the capacity values are not integers, or the source or sink are out of bounds.</p></dd></dl><h3 id=section-Returns>Returns</h3><dl><dt><a id=res>res</a> : MaximumFlowResult</dt><dd><p>A maximum flow represented by a <code class=verbatim>MaximumFlowResult</code> which includes the value of the flow in <code class=verbatim>flow_value</code> , and the residual graph in <code class=verbatim>residual</code> .</p></dd></dl><p>Maximize the flow between two vertices in a graph.</p><h3 id=section-Examples>Examples</h3><pre>(0) --5--> (1)
</pre><p>Here, the maximum flow is simply the capacity of the edge:</p><pre class="highlight execed"><span class=nsl>>>> </span><span class=kn>from</span><span> </span><a class="foo nn"href=/p/scipy/1.8.0/api/scipy.html>scipy</a><span class=nn>.</span><a class="foo nn"href=/p/scipy/1.8.0/api/scipy.sparse.html>sparse</a><span> </span><span class=kn>import</span><span> </span><a class=foo href=/p/scipy/1.8.0/api/scipy.sparse._csr.csr_matrix.html>csr_matrix</a><br><span class=nsl>... </span><span class=kn>from</span><span> </span><a class="foo nn"href=/p/scipy/1.8.0/api/scipy.html>scipy</a><span class=nn>.</span><a class="foo nn"href=/p/scipy/1.8.0/api/scipy.sparse.html>sparse</a><span class=nn>.</span><a class="foo nn"href=/p/scipy/1.8.0/api/scipy.sparse.csgraph.html>csgraph</a><span> </span><span class=kn>import</span><span> </span><a class=foo href=/p/scipy/1.8.0/api/scipy.sparse.csgraph._flow.maximum_flow.html>maximum_flow</a><br><span class=nsl>... </span><span>graph</span><span> </span><span class=o>=</span><span> </span><a class=foo href=/p/scipy/1.8.0/api/scipy.sparse._csr.csr_matrix.html>csr_matrix</a><span>(</span><span>[</span><span>[</span><span class=mi>0</span><span>,</span><span> </span><span class=mi>5</span><span>]</span><span>,</span><span> </span><span>[</span><span class=mi>0</span><span>,</span><span> </span><span class=mi>0</span><span>]</span><span>]</span><span>)</span><br><span class=nsl>... </span><a class=foo href=/p/scipy/1.8.0/api/scipy.sparse.csgraph._flow.maximum_flow.html>maximum_flow</a><span>(</span><span>graph</span><span>,</span><span> </span><span class=mi>0</span><span>,</span><span> </span><span class=mi>1</span><span>)</span><span class=o>.</span><span>flow_value</span>
5</pre><pre class="highlight execed"><span class=nsl>>>> </span><a class=foo href=/p/scipy/1.8.0/api/scipy.sparse.csgraph._flow.maximum_flow.html>maximum_flow</a><span>(</span><span>graph</span><span>,</span><span> </span><span class=mi>0</span><span>,</span><span> </span><span class=mi>1</span><span>,</span><span> </span><a href="/p/scipy/1.8.0/api/scipy.sparse._data._create_method.<locals>.method.html"class=foo>method</a><span class=o>=</span><span class=s1>'</span><span class=s1>edmonds_karp</span><span class=s1>'</span><span>)</span><span class=o>.</span><span>flow_value</span>
5</pre><pre>(0) --5--> (1) --3--> (2)
</pre><pre class="highlight execed"><span class=nsl>>>> </span><span>graph</span><span> </span><span class=o>=</span><span> </span><a class=foo href=/p/scipy/1.8.0/api/scipy.sparse._csr.csr_matrix.html>csr_matrix</a><span>(</span><span>[</span><span>[</span><span class=mi>0</span><span>,</span><span> </span><span class=mi>5</span><span>,</span><span> </span><span class=mi>0</span><span>]</span><span>,</span><span> </span><span>[</span><span class=mi>0</span><span>,</span><span> </span><span class=mi>0</span><span>,</span><span> </span><span class=mi>3</span><span>]</span><span>,</span><span> </span><span>[</span><span class=mi>0</span><span>,</span><span> </span><span class=mi>0</span><span>,</span><span> </span><span class=mi>0</span><span>]</span><span>]</span><span>)</span><br><span class=nsl>... </span><a class=foo href=/p/scipy/1.8.0/api/scipy.sparse.csgraph._flow.maximum_flow.html>maximum_flow</a><span>(</span><span>graph</span><span>,</span><span> </span><span class=mi>0</span><span>,</span><span> </span><span class=mi>2</span><span>)</span><span class=o>.</span><span>flow_value</span>
3</pre><p>A less trivial example is given in , Chapter 26.1:</p><pre class="highlight execed"><span class=nsl>>>> </span><span>graph</span><span> </span><span class=o>=</span><span> </span><a class=foo href=/p/scipy/1.8.0/api/scipy.sparse._csr.csr_matrix.html>csr_matrix</a><span>(</span><span>[</span><span>[</span><span class=mi>0</span><span>,</span><span> </span><span class=mi>16</span><span>,</span><span> </span><span class=mi>13</span><span>,</span><span>  </span><span class=mi>0</span><span>,</span><span>  </span><span class=mi>0</span><span>,</span><span>  </span><span class=mi>0</span><span>]</span><span>,</span><br><span class=nsl>... </span><span>                    </span><span>[</span><span class=mi>0</span><span>,</span><span>  </span><span class=mi>0</span><span>,</span><span> </span><span class=mi>10</span><span>,</span><span> </span><span class=mi>12</span><span>,</span><span>  </span><span class=mi>0</span><span>,</span><span>  </span><span class=mi>0</span><span>]</span><span>,</span><br><span class=nsl>... </span><span>                    </span><span>[</span><span class=mi>0</span><span>,</span><span>  </span><span class=mi>4</span><span>,</span><span>  </span><span class=mi>0</span><span>,</span><span>  </span><span class=mi>0</span><span>,</span><span> </span><span class=mi>14</span><span>,</span><span>  </span><span class=mi>0</span><span>]</span><span>,</span><br><span class=nsl>... </span><span>                    </span><span>[</span><span class=mi>0</span><span>,</span><span>  </span><span class=mi>0</span><span>,</span><span>  </span><span class=mi>9</span><span>,</span><span>  </span><span class=mi>0</span><span>,</span><span>  </span><span class=mi>0</span><span>,</span><span> </span><span class=mi>20</span><span>]</span><span>,</span><br><span class=nsl>... </span><span>                    </span><span>[</span><span class=mi>0</span><span>,</span><span>  </span><span class=mi>0</span><span>,</span><span>  </span><span class=mi>0</span><span>,</span><span>  </span><span class=mi>7</span><span>,</span><span>  </span><span class=mi>0</span><span>,</span><span>  </span><span class=mi>4</span><span>]</span><span>,</span><br><span class=nsl>... </span><span>                    </span><span>[</span><span class=mi>0</span><span>,</span><span>  </span><span class=mi>0</span><span>,</span><span>  </span><span class=mi>0</span><span>,</span><span>  </span><span class=mi>0</span><span>,</span><span>  </span><span class=mi>0</span><span>,</span><span>  </span><span class=mi>0</span><span>]</span><span>]</span><span>)</span><br><span class=nsl>... </span><a class=foo href=/p/scipy/1.8.0/api/scipy.sparse.csgraph._flow.maximum_flow.html>maximum_flow</a><span>(</span><span>graph</span><span>,</span><span> </span><span class=mi>0</span><span>,</span><span> </span><span class=mi>5</span><span>)</span><span class=o>.</span><span>flow_value</span>
23</pre><p>It is possible to reduce the problem of finding a maximum matching in a bipartite graph to a maximum flow problem: Let <span class=tex2jax_process>$G = ((U, V), E)$</span> be a bipartite graph. Then, add to the graph a source vertex with edges to every vertex in <span class=tex2jax_process>$U$</span> and a sink vertex with edges from every vertex in <span class=tex2jax_process>$V$</span> . Finally, give every edge in the resulting graph a capacity of 1. Then, a maximum flow in the new graph gives a maximum matching in the original graph consisting of the edges in <span class=tex2jax_process>$E$</span> whose flow is positive.</p><p>Assume that the edges are represented by a <span class=tex2jax_process>$\lvert U \rvert \times \lvert V \rvert$</span> matrix in CSR format whose <span class=tex2jax_process>$(i, j)$</span> 'th entry is 1 if there is an edge from <span class=tex2jax_process>$i \in U$</span> to <span class=tex2jax_process>$j \in V$</span> and 0 otherwise; that is, the input is of the form required by <code><a class=exists href=/p/scipy/1.8.0/api/scipy.sparse.csgraph._matching.maximum_bipartite_matching.html link>maximum_bipartite_matching</a></code> . Then the CSR representation of the graph constructed above contains this matrix as a block. Here's an example:</p><pre class="highlight execed"><span class=nsl>>>> </span><span>graph</span><span> </span><span class=o>=</span><span> </span><a class=foo href=/p/scipy/1.8.0/api/scipy.sparse._csr.csr_matrix.html>csr_matrix</a><span>(</span><span>[</span><span>[</span><span class=mi>0</span><span>,</span><span> </span><span class=mi>1</span><span>,</span><span> </span><span class=mi>0</span><span>,</span><span> </span><span class=mi>1</span><span>]</span><span>,</span><span> </span><span>[</span><span class=mi>1</span><span>,</span><span> </span><span class=mi>0</span><span>,</span><span> </span><span class=mi>1</span><span>,</span><span> </span><span class=mi>0</span><span>]</span><span>,</span><span> </span><span>[</span><span class=mi>0</span><span>,</span><span> </span><span class=mi>1</span><span>,</span><span> </span><span class=mi>1</span><span>,</span><span> </span><span class=mi>0</span><span>]</span><span>]</span><span>)</span><br><span class=nsl>... </span><span class=nb>print</span><span>(</span><span>graph</span><span class=o>.</span><span>toarray</span><span>(</span><span>)</span><span>)</span>
[[0 1 0 1]
 [1 0 1 0]
 [0 1 1 0]]</pre><pre class="highlight execed"><span class=nsl>>>> </span><span>i</span><span>,</span><span> </span><span>j</span><span> </span><span class=o>=</span><span> </span><span>graph</span><span class=o>.</span><span>shape</span><br><span class=nsl>... </span><span>n</span><span> </span><span class=o>=</span><span> </span><span>graph</span><span class=o>.</span><span>nnz</span><br><span class=nsl>... </span><a class=foo href=/p/numpy/1.22.3/api/numpy.ndarray.html>indptr</a><span> </span><span class=o>=</span><span> </span><a class=foo href=/p/numpy/1.22.3/api/numpy.html>np</a><span class=o>.</span><span>concatenate</span><span>(</span><span>[</span><span>[</span><span class=mi>0</span><span>]</span><span>,</span><br><span class=nsl>... </span><span>                         </span><span>graph</span><span class=o>.</span><a class=foo href=/p/numpy/1.22.3/api/numpy.ndarray.html>indptr</a><span> </span><span class=o>+</span><span> </span><span>i</span><span>,</span><br><span class=nsl>... </span><span>                         </span><a class=foo href=/p/numpy/1.22.3/api/numpy.html>np</a><span class=o>.</span><a class=foo href=/p/numpy/1.22.3/api/numpy.arange.html>arange</a><span>(</span><span>n</span><span> </span><span class=o>+</span><span> </span><span>i</span><span> </span><span class=o>+</span><span> </span><span class=mi>1</span><span>,</span><span> </span><span>n</span><span> </span><span class=o>+</span><span> </span><span>i</span><span> </span><span class=o>+</span><span> </span><span>j</span><span> </span><span class=o>+</span><span> </span><span class=mi>1</span><span>)</span><span>,</span><br><span class=nsl>... </span><span>                         </span><span>[</span><span>n</span><span> </span><span class=o>+</span><span> </span><span>i</span><span> </span><span class=o>+</span><span> </span><span>j</span><span>]</span><span>]</span><span>)</span><br><span class=nsl>... </span><span>indices</span><span> </span><span class=o>=</span><span> </span><a class=foo href=/p/numpy/1.22.3/api/numpy.html>np</a><span class=o>.</span><span>concatenate</span><span>(</span><span>[</span><a class=foo href=/p/numpy/1.22.3/api/numpy.html>np</a><span class=o>.</span><a class=foo href=/p/numpy/1.22.3/api/numpy.arange.html>arange</a><span>(</span><span class=mi>1</span><span>,</span><span> </span><span>i</span><span> </span><span class=o>+</span><span> </span><span class=mi>1</span><span>)</span><span>,</span><br><span class=nsl>... </span><span>                          </span><span>graph</span><span class=o>.</span><span>indices</span><span> </span><span class=o>+</span><span> </span><span>i</span><span> </span><span class=o>+</span><span> </span><span class=mi>1</span><span>,</span><br><span class=nsl>... </span><span>                          </span><a class=foo href=/p/numpy/1.22.3/api/numpy.html>np</a><span class=o>.</span><a class=foo href=/p/numpy/1.22.3/api/numpy.repeat.html>repeat</a><span>(</span><span>i</span><span> </span><span class=o>+</span><span> </span><span>j</span><span> </span><span class=o>+</span><span> </span><span class=mi>1</span><span>,</span><span> </span><span>j</span><span>)</span><span>]</span><span>)</span><br><span class=nsl>... </span><a class=foo href=/p/scipy/1.8.0/api/scipy.sparse.data.html>data</a><span> </span><span class=o>=</span><span> </span><a class=foo href=/p/numpy/1.22.3/api/numpy.html>np</a><span class=o>.</span><a class=foo href=/p/numpy/1.22.3/api/numpy.ones.html>ones</a><span>(</span><span>n</span><span> </span><span class=o>+</span><span> </span><span>i</span><span> </span><span class=o>+</span><span> </span><span>j</span><span>,</span><span> </span><span>dtype</span><span class=o>=</span><span class=nb>int</span><span>)</span>
>>></pre><pre class="highlight execed"><span class=nsl>>>> </span><span>graph_flow</span><span> </span><span class=o>=</span><span> </span><a class=foo href=/p/scipy/1.8.0/api/scipy.sparse._csr.csr_matrix.html>csr_matrix</a><span>(</span><span>(</span><a class=foo href=/p/numpy/1.22.3/api/numpy.ndarray.html>data</a><span>,</span><span> </span><span>indices</span><span>,</span><span> </span><a class=foo href=/p/numpy/1.22.3/api/numpy.ndarray.html>indptr</a><span>)</span><span>)</span><br><span class=nsl>... </span><span class=nb>print</span><span>(</span><span>graph_flow</span><span class=o>.</span><span>toarray</span><span>(</span><span>)</span><span>)</span>
[[0 1 1 1 0 0 0 0 0]
 [0 0 0 0 0 1 0 1 0]
 [0 0 0 0 1 0 1 0 0]
 [0 0 0 0 0 1 1 0 0]
 [0 0 0 0 0 0 0 0 1]
 [0 0 0 0 0 0 0 0 1]
 [0 0 0 0 0 0 0 0 1]
 [0 0 0 0 0 0 0 0 1]
 [0 0 0 0 0 0 0 0 0]]</pre><p>At this point, we can find the maximum flow between the added sink and the added source and the desired matching can be obtained by restricting the residual graph to the block corresponding to the original graph:</p><pre class="highlight execed"><span class=nsl>>>> </span><span>flow</span><span> </span><span class=o>=</span><span> </span><a class=foo href=/p/scipy/1.8.0/api/scipy.sparse.csgraph._flow.maximum_flow.html>maximum_flow</a><span>(</span><span>graph_flow</span><span>,</span><span> </span><span class=mi>0</span><span>,</span><span> </span><span>i</span><span class=o>+</span><span>j</span><span class=o>+</span><span class=mi>1</span><span>,</span><span> </span><a href="/p/scipy/1.8.0/api/scipy.sparse._data._create_method.<locals>.method.html"class=foo>method</a><span class=o>=</span><span class=s1>'</span><span class=s1>dinic</span><span class=s1>'</span><span>)</span><br><span class=nsl>... </span><span>matching</span><span> </span><span class=o>=</span><span> </span><span>flow</span><span class=o>.</span><span>residual</span><span>[</span><span class=mi>1</span><span>:</span><span>i</span><span class=o>+</span><span class=mi>1</span><span>,</span><span> </span><span>i</span><span class=o>+</span><span class=mi>1</span><span>:</span><span>i</span><span class=o>+</span><span>j</span><span class=o>+</span><span class=mi>1</span><span>]</span><br><span class=nsl>... </span><span class=nb>print</span><span>(</span><span>matching</span><span class=o>.</span><span>toarray</span><span>(</span><span>)</span><span>)</span>
[[0 1 0 0]
 [1 0 0 0]
 [0 0 1 0]]</pre><p>This tells us that the first, second, and third vertex in <span class=tex2jax_process>$U$</span> are matched with the second, first, and third vertex in <span class=tex2jax_process>$V$</span> respectively.</p><p>While this solves the maximum bipartite matching problem in general, note that algorithms specialized to that problem, such as <code><a class=exists href=/p/scipy/1.8.0/api/scipy.sparse.csgraph._matching.maximum_bipartite_matching.html link>maximum_bipartite_matching</a></code> , will generally perform better.</p><p>This approach can also be used to solve various common generalizations of the maximum bipartite matching problem. If, for instance, some vertices can be matched with more than one other vertex, this may be handled by modifying the capacities of the new graph appropriately.</p> See : <h3 id=section-backrefs>Back References</h3><p>The following pages refer to to this document either explicitly or contain code examples using this.</p><code><a class=exists href=/p/scipy/1.8.0/api/scipy.sparse.csgraph._flow.maximum_flow.html link>scipy.sparse.csgraph._flow.maximum_flow</a></code><h3>Local connectivity graph</h3><p>Hover to see nodes names; edges to Self not shown, Caped at 50 nodes.</p><p>Using a canvas is more power efficient and can get hundred of nodes ; but does not allow hyperlinks; , arrows or text (beyond on hover)</p><canvas class=graph height=500 width=800></canvas><p>SVG is more flexible but power hungry; and does not scale well to 50 + nodes.</p><svg class=graph height=500 width=600></svg><p>All aboves nodes referred to, (or are referred from) current nodes; Edges from Self to other have been omitted (or all nodes would be connected to the central node "self" which is not useful). Nodes are colored by the library they belong to, and scaled with the number of references pointing them</p><hr> GitHub : <a class=external href=https://github.com/scipy/scipy/blob/v1.8.0/None#LNone>None#None</a><br> type: &LTclass 'builtin_function_or_method'> <br> Commit: <br><script src=https://d3js.org/d3.v4.min.js></script><script src=https://d3js.org/d3-selection-multi.v1.js></script><style>.node {};
        .link { stroke: #999; stroke-opacity: .6; stroke-width: 1px; };</style><script>window._data_graph={nodes:[{id:1,val:14.782329983125269,label:"numpy.ones",mod:"numpy",url:"/p/numpy/1.22.3/api/numpy.ones"},{id:2,val:32.37211521390788,label:"scipy",mod:"scipy",url:"/p/scipy/1.8.0/api/scipy"},{id:3,val:24.186414056238647,label:"numpy.arange",mod:"numpy",url:"/p/numpy/1.22.3/api/numpy.arange"},{id:4,val:17.486832980505138,label:"scipy.sparse",mod:"scipy",url:"/p/scipy/1.8.0/api/scipy.sparse"},{id:5,val:11.3166247903554,label:"numpy.repeat",mod:"numpy",url:"/p/numpy/1.22.3/api/numpy.repeat"},{id:7,val:9.732050807568877,label:"scipy.sparse.csgraph._matching.maximum_bipartite_matching",mod:"scipy",url:"/p/scipy/1.8.0/api/scipy.sparse.csgraph._matching.maximum_bipartite_matching"},{id:8,val:13.385164807134505,label:"scipy.sparse._data._create_method.<locals>.method",mod:"scipy",url:"/p/scipy/1.8.0/api/scipy.sparse._data._create_method.<locals>.method"},{id:9,val:12.582575694955839,label:"scipy.sparse.csgraph",mod:"scipy",url:"/p/scipy/1.8.0/api/scipy.sparse.csgraph"},{id:10,val:33.96150997149434,label:"numpy.ndarray",mod:"numpy",url:"/p/numpy/1.22.3/api/numpy.ndarray"},{id:11,val:12.79583152331272,label:"scipy.sparse.data",mod:"scipy",url:"/p/scipy/1.8.0/api/scipy.sparse.data"},{id:12,val:44,label:"numpy",mod:"numpy",url:"/p/numpy/1.22.3/api/numpy"},{id:13,val:14.32455532033676,label:"scipy.sparse._csr.csr_matrix",mod:"scipy",url:"/p/scipy/1.8.0/api/scipy.sparse._csr.csr_matrix"}],links:[{source:2,target:7,id:104},{source:2,target:13,id:137},{source:12,target:13,id:1006},{source:12,target:10,id:1767},{source:13,target:7,id:2206},{source:4,target:7,id:2298},{source:4,target:13,id:2318},{source:9,target:7,id:2335},{source:10,target:7,id:2510},{source:10,target:13,id:2546},{source:11,target:7,id:3079},{source:11,target:13,id:3081}]};</script><script src=/graph_canvas.js></script><script src=/graph_svg.js></script></div></body></html>