<!doctypehtml><html lang=en><meta charset=UTF-8><meta content=width=device-width,initial-scale=1.0 name=viewport><title>Document</title><link href=https://fonts.xz.style/serve/inter.css rel=stylesheet><link crossorigin=anonymous href=https://use.fontawesome.com/releases/v5.8.1/css/all.css integrity=sha384-50oBUHEmvpQ+1lW4y57PTFmhCaXp0ML5d60M1M7uH2+nqUivzIebhndOJK28anvf rel=stylesheet><link href=https://cdn.jsdelivr.net/npm/@exampledev/new.css@1.1.2/new.min.css rel=stylesheet><script type=text/x-mathjax-config>
        // this should process only math inside  span with tex2jax_process class
    MathJax.Hub.Config({
        extensions: ["tex2jax.js"],
        jax: ["input/TeX", "output/HTML-CSS"],
        tex2jax: {
        inlineMath: [ ['$','$'], ["\\(","\\)"] ],
        displayMath: [ ['$$','$$'], ["\\[","\\]"] ],
        processEscapes: true
        },
        "HTML-CSS": { fonts: ["TeX"] }
    });
    </script><script async src=https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/MathJax.js></script><link href=/papyri.css rel=stylesheet><style>header > brand, header>:first-child {
        border-right: 1px solid #ccc;
        border-left: 1px solid #ccc;
        padding: 16px;
        padding-top: 0.5rem;
        padding-bottom: 0.5rem;
        display: inline-block; 
        width: 167px;
    }
    pre { line-height: 125%; }
td.linenos .normal { color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px; }
span.linenos { color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px; }
td.linenos .special { color: #000000; background-color: #ffffc0; padding-left: 5px; padding-right: 5px; }
span.linenos.special { color: #000000; background-color: #ffffc0; padding-left: 5px; padding-right: 5px; }
.highlight .hll { background-color: #ffffcc }
.highlight { background: #ffffff; }
.highlight .c { color: #888888 } /* Comment */
.highlight .err { color: #a61717; background-color: #e3d2d2 } /* Error */
.highlight .k { color: #008800; font-weight: bold } /* Keyword */
.highlight .ch { color: #888888 } /* Comment.Hashbang */
.highlight .cm { color: #888888 } /* Comment.Multiline */
.highlight .cp { color: #cc0000; font-weight: bold } /* Comment.Preproc */
.highlight .cpf { color: #888888 } /* Comment.PreprocFile */
.highlight .c1 { color: #888888 } /* Comment.Single */
.highlight .cs { color: #cc0000; font-weight: bold; background-color: #fff0f0 } /* Comment.Special */
.highlight .gd { color: #000000; background-color: #ffdddd } /* Generic.Deleted */
.highlight .ge { font-style: italic } /* Generic.Emph */
.highlight .gr { color: #aa0000 } /* Generic.Error */
.highlight .gh { color: #333333 } /* Generic.Heading */
.highlight .gi { color: #000000; background-color: #ddffdd } /* Generic.Inserted */
.highlight .go { color: #888888 } /* Generic.Output */
.highlight .gp { color: #555555 } /* Generic.Prompt */
.highlight .gs { font-weight: bold } /* Generic.Strong */
.highlight .gu { color: #666666 } /* Generic.Subheading */
.highlight .gt { color: #aa0000 } /* Generic.Traceback */
.highlight .kc { color: #008800; font-weight: bold } /* Keyword.Constant */
.highlight .kd { color: #008800; font-weight: bold } /* Keyword.Declaration */
.highlight .kn { color: #008800; font-weight: bold } /* Keyword.Namespace */
.highlight .kp { color: #008800 } /* Keyword.Pseudo */
.highlight .kr { color: #008800; font-weight: bold } /* Keyword.Reserved */
.highlight .kt { color: #888888; font-weight: bold } /* Keyword.Type */
.highlight .m { color: #0000DD; font-weight: bold } /* Literal.Number */
.highlight .s { color: #dd2200; background-color: #fff0f0 } /* Literal.String */
.highlight .na { color: #336699 } /* Name.Attribute */
.highlight .nb { color: #003388 } /* Name.Builtin */
.highlight .nc { color: #bb0066; font-weight: bold } /* Name.Class */
.highlight .no { color: #003366; font-weight: bold } /* Name.Constant */
.highlight .nd { color: #555555 } /* Name.Decorator */
.highlight .ne { color: #bb0066; font-weight: bold } /* Name.Exception */
.highlight .nf { color: #0066bb; font-weight: bold } /* Name.Function */
.highlight .nl { color: #336699; font-style: italic } /* Name.Label */
.highlight .nn { color: #bb0066; font-weight: bold } /* Name.Namespace */
.highlight .py { color: #336699; font-weight: bold } /* Name.Property */
.highlight .nt { color: #bb0066; font-weight: bold } /* Name.Tag */
.highlight .nv { color: #336699 } /* Name.Variable */
.highlight .ow { color: #008800 } /* Operator.Word */
.highlight .w { color: #bbbbbb } /* Text.Whitespace */
.highlight .mb { color: #0000DD; font-weight: bold } /* Literal.Number.Bin */
.highlight .mf { color: #0000DD; font-weight: bold } /* Literal.Number.Float */
.highlight .mh { color: #0000DD; font-weight: bold } /* Literal.Number.Hex */
.highlight .mi { color: #0000DD; font-weight: bold } /* Literal.Number.Integer */
.highlight .mo { color: #0000DD; font-weight: bold } /* Literal.Number.Oct */
.highlight .sa { color: #dd2200; background-color: #fff0f0 } /* Literal.String.Affix */
.highlight .sb { color: #dd2200; background-color: #fff0f0 } /* Literal.String.Backtick */
.highlight .sc { color: #dd2200; background-color: #fff0f0 } /* Literal.String.Char */
.highlight .dl { color: #dd2200; background-color: #fff0f0 } /* Literal.String.Delimiter */
.highlight .sd { color: #dd2200; background-color: #fff0f0 } /* Literal.String.Doc */
.highlight .s2 { color: #dd2200; background-color: #fff0f0 } /* Literal.String.Double */
.highlight .se { color: #0044dd; background-color: #fff0f0 } /* Literal.String.Escape */
.highlight .sh { color: #dd2200; background-color: #fff0f0 } /* Literal.String.Heredoc */
.highlight .si { color: #3333bb; background-color: #fff0f0 } /* Literal.String.Interpol */
.highlight .sx { color: #22bb22; background-color: #f0fff0 } /* Literal.String.Other */
.highlight .sr { color: #008800; background-color: #fff0ff } /* Literal.String.Regex */
.highlight .s1 { color: #dd2200; background-color: #fff0f0 } /* Literal.String.Single */
.highlight .ss { color: #aa6600; background-color: #fff0f0 } /* Literal.String.Symbol */
.highlight .bp { color: #003388 } /* Name.Builtin.Pseudo */
.highlight .fm { color: #0066bb; font-weight: bold } /* Name.Function.Magic */
.highlight .vc { color: #336699 } /* Name.Variable.Class */
.highlight .vg { color: #dd7700 } /* Name.Variable.Global */
.highlight .vi { color: #3333bb } /* Name.Variable.Instance */
.highlight .vm { color: #336699 } /* Name.Variable.Magic */
.highlight .il { color: #0000DD; font-weight: bold } /* Literal.Number.Integer.Long */</style></head><body class=tex2jax_ignore><header><brand><i class="fab fa-python"></i><a href=/>Home</a></brand><nav>/ <a href=/>p</a>  /  <div class=dropdown><a href=scipy>scipy</a> /  <div class=dropdown-content><a href=/p/IPython/8.2.0.dev/api/IPython.html>IPython</a><a href=/p/astropy/5.0/api/astropy.html>astropy</a><a href=/p/dask/2021.10.0/api/dask.html>dask</a><a href=/p/distributed/2021.10.0/api/distributed.html>distributed</a><a href=/p/matplotlib/3.5.1/api/matplotlib.html>matplotlib</a><a href=/p/networkx/2.7.2rc1.dev0/api/networkx.html>networkx</a><a href=/p/numpy/1.22.3/api/numpy.html>numpy</a><a href=/p/pandas/1.4.1/api/pandas.html>pandas</a><a href=/p/papyri/0.0.8/api/papyri.html>papyri</a><a href=/p/scipy/1.8.0/api/scipy.html>scipy</a><a href=/p/skimage/0.17.2/api/skimage.html>skimage</a></div></div><div class=dropdown><a href=/p/scipy/1.8.0/api/scipy.html>1.8.0</a> /  <div class=dropdown-content><a href=/p/scipy/1.8.0/api/scipy.html>1.8.0</a></div></div><div class=dropdown><a href=/p/scipy/1.8.0/api/scipy.html>api</a> /  <div class=dropdown-content><a href=/p/scipy/1.8.0/api/scipy.html>API</a><a href=/p/scipy/1.8.0/gallery>Gallery</a><a href=/p/scipy/1.8.0/examples>Examples</a></div></div><div class=dropdown><a class=dropbtn href=scipy.html>scipy</a>.</div><div class=dropdown><a class=dropbtn href=scipy.signal.html>signal</a>. <div class=dropdown-content><a href=/p/?/?/api/scipy._lib.html>_lib</a><a href=/p/scipy/1.8.0/api/scipy.fft.html>fft</a><a href=/p/scipy/1.8.0/api/scipy.integrate.html>integrate</a><a href=/p/scipy/1.8.0/api/scipy.interpolate.html>interpolate</a><a href=/p/scipy/1.8.0/api/scipy.linalg.html>linalg</a><a href=/p/?/?/api/scipy.ndimage.html>ndimage</a><a href=/p/scipy/1.8.0/api/scipy.optimize.html>optimize</a><a href=/p/scipy/1.8.0/api/scipy.signal.html>signal</a><a href=/p/scipy/1.8.0/api/scipy.sparse.html>sparse</a><a href=/p/scipy/1.8.0/api/scipy.spatial.html>spatial</a><a href=/p/scipy/1.8.0/api/scipy.special.html>special</a><a href=/p/?/?/api/scipy.stats.html>stats</a></div></div><div class=dropdown><a class=dropbtn href=scipy.signal._fir_filter_design.html>_fir_filter_design</a>. <div class=dropdown-content><a href=/p/scipy/1.8.0/api/scipy.signal._arraytools.html>_arraytools</a><a href=/p/scipy/1.8.0/api/scipy.signal._bsplines.html>_bsplines</a><a href=/p/scipy/1.8.0/api/scipy.signal._czt.html>_czt</a><a href=/p/scipy/1.8.0/api/scipy.signal._filter_design.html>_filter_design</a><a href=/p/scipy/1.8.0/api/scipy.signal._fir_filter_design.html>_fir_filter_design</a><a href=/p/scipy/1.8.0/api/scipy.signal._lti_conversion.html>_lti_conversion</a><a href=/p/scipy/1.8.0/api/scipy.signal._ltisys.html>_ltisys</a><a href=/p/scipy/1.8.0/api/scipy.signal._max_len_seq.html>_max_len_seq</a><a href=/p/scipy/1.8.0/api/scipy.signal._max_len_seq_inner.html>_max_len_seq_inner</a><a href=/p/scipy/1.8.0/api/scipy.signal._peak_finding.html>_peak_finding</a><a href=/p/scipy/1.8.0/api/scipy.signal._peak_finding_utils.html>_peak_finding_utils</a><a href=/p/scipy/1.8.0/api/scipy.signal._savitzky_golay.html>_savitzky_golay</a><a href=/p/scipy/1.8.0/api/scipy.signal._signaltools.html>_signaltools</a><a href=/p/scipy/1.8.0/api/scipy.signal._sigtools.html>_sigtools</a><a href=/p/scipy/1.8.0/api/scipy.signal._sosfilt.html>_sosfilt</a><a href=/p/scipy/1.8.0/api/scipy.signal._spectral.html>_spectral</a><a href=/p/scipy/1.8.0/api/scipy.signal._spectral_py.html>_spectral_py</a><a href=/p/scipy/1.8.0/api/scipy.signal._spline.html>_spline</a><a href=/p/scipy/1.8.0/api/scipy.signal._upfirdn.html>_upfirdn</a><a href=/p/scipy/1.8.0/api/scipy.signal._upfirdn_apply.html>_upfirdn_apply</a><a href=/p/scipy/1.8.0/api/scipy.signal._waveforms.html>_waveforms</a><a href=/p/scipy/1.8.0/api/scipy.signal._wavelets.html>_wavelets</a><a href=/p/scipy/1.8.0/api/scipy.signal.barthann.html>barthann</a><a href=/p/scipy/1.8.0/api/scipy.signal.bartlett.html>bartlett</a><a href=/p/scipy/1.8.0/api/scipy.signal.blackman.html>blackman</a><a href=/p/scipy/1.8.0/api/scipy.signal.blackmanharris.html>blackmanharris</a><a href=/p/scipy/1.8.0/api/scipy.signal.bohman.html>bohman</a><a href=/p/scipy/1.8.0/api/scipy.signal.boxcar.html>boxcar</a><a href=/p/scipy/1.8.0/api/scipy.signal.bsplines.html>bsplines</a><a href=/p/scipy/1.8.0/api/scipy.signal.chebwin.html>chebwin</a><a href=/p/scipy/1.8.0/api/scipy.signal.cosine.html>cosine</a><a href=/p/scipy/1.8.0/api/scipy.signal.exponential.html>exponential</a><a href=/p/scipy/1.8.0/api/scipy.signal.filter_design.html>filter_design</a><a href=/p/scipy/1.8.0/api/scipy.signal.fir_filter_design.html>fir_filter_design</a><a href=/p/scipy/1.8.0/api/scipy.signal.flattop.html>flattop</a><a href=/p/scipy/1.8.0/api/scipy.signal.gaussian.html>gaussian</a><a href=/p/scipy/1.8.0/api/scipy.signal.general_gaussian.html>general_gaussian</a><a href=/p/scipy/1.8.0/api/scipy.signal.hamming.html>hamming</a><a href=/p/scipy/1.8.0/api/scipy.signal.hann.html>hann</a><a href=/p/scipy/1.8.0/api/scipy.signal.kaiser.html>kaiser</a><a href=/p/scipy/1.8.0/api/scipy.signal.lti_conversion.html>lti_conversion</a><a href=/p/scipy/1.8.0/api/scipy.signal.ltisys.html>ltisys</a><a href=/p/scipy/1.8.0/api/scipy.signal.nuttall.html>nuttall</a><a href=/p/scipy/1.8.0/api/scipy.signal.parzen.html>parzen</a><a href=/p/scipy/1.8.0/api/scipy.signal.signaltools.html>signaltools</a><a href=/p/scipy/1.8.0/api/scipy.signal.spectral.html>spectral</a><a href=/p/scipy/1.8.0/api/scipy.signal.spline.html>spline</a><a href=/p/scipy/1.8.0/api/scipy.signal.triang.html>triang</a><a href=/p/scipy/1.8.0/api/scipy.signal.tukey.html>tukey</a><a href=/p/scipy/1.8.0/api/scipy.signal.waveforms.html>waveforms</a><a href=/p/scipy/1.8.0/api/scipy.signal.wavelets.html>wavelets</a><a href=/p/scipy/1.8.0/api/scipy.signal.windows.html>windows</a></div></div><div class=dropdown><a class=dropbtn href=scipy.signal._fir_filter_design.remez.html>remez</a><div class=dropdown-content><a href=/p/scipy/1.8.0/api/scipy.signal._fir_filter_design._dhtm.html>_dhtm</a><a href=/p/scipy/1.8.0/api/scipy.signal._fir_filter_design._get_fs.html>_get_fs</a><a href=/p/scipy/1.8.0/api/scipy.signal._fir_filter_design.firls.html>firls</a><a href=/p/scipy/1.8.0/api/scipy.signal._fir_filter_design.firwin.html>firwin</a><a href=/p/scipy/1.8.0/api/scipy.signal._fir_filter_design.firwin2.html>firwin2</a><a href=/p/scipy/1.8.0/api/scipy.signal._fir_filter_design.kaiser_atten.html>kaiser_atten</a><a href=/p/scipy/1.8.0/api/scipy.signal._fir_filter_design.kaiser_beta.html>kaiser_beta</a><a href=/p/scipy/1.8.0/api/scipy.signal._fir_filter_design.kaiserord.html>kaiserord</a><a href=/p/scipy/1.8.0/api/scipy.signal._fir_filter_design.minimum_phase.html>minimum_phase</a><a href=/p/scipy/1.8.0/api/scipy.signal._fir_filter_design.remez.html>remez</a></div></div></nav></header><div class=container><div class=sidenav><img src=/p/scipy/1.8.0/img/logo.png><a href=#>scipy</a><a href=#>1.8.0</a><a class=external href=https://pypi.org/project/scipy>Pypi</a><a class=external href=https://github.com/scipy/scipy>GitHub</a><a class=external href=https://scipy.org/>Homepage</a><hr><a class=external href=https://docs.scipy.org/doc/scipy/>Other Docs</a><hr><a href=#section-Parameters>Parameters</a><a href=#section-Returns>Returns</a><a href=#section-backrefs>BackRef</a></div><code class=signature>remez(numtaps, bands, desired, weight=None, Hz=None, type='bandpass', maxiter=25, grid_density=16, fs=None)</code><p>Calculate the filter-coefficients for the finite impulse response (FIR) filter whose transfer function minimizes the maximum error between the desired gain and the realized gain in the specified frequency bands using the Remez exchange algorithm.</p><h3 id=section-Parameters>Parameters</h3><dl><dt><a id=numtaps>numtaps</a> : int</dt><dd><p>The desired number of taps in the filter. The number of taps is the number of terms in the filter, or the filter order plus one.</p></dd><dt><a id=bands>bands</a> : array_like</dt><dd><p>A monotonic sequence containing the band edges. All elements must be non-negative and less than half the sampling frequency as given by <code><a class=local href=#fs link>fs</a></code>.</p></dd><dt><a id=desired>desired</a> : array_like</dt><dd><p>A sequence half the size of bands containing the desired gain in each of the specified bands.</p></dd><dt><a id=weight>weight</a> : array_like, optional</dt><dd><p>A relative weighting to give to each band region. The length of <code><a class=local href=#weight link>weight</a></code> has to be half the length of <code><a class=exists href=/p/scipy/1.8.0/api/scipy.integrate._ode.vode._determine_mf_and_set_bands.html link>bands</a></code> .</p></dd><dt><a id=Hz>Hz</a> : scalar, optional</dt><dd><p><em>Deprecated. Use `fs` instead.</em> The sampling frequency in Hz. Default is 1.</p></dd><dt><a id=type>type</a> : {'bandpass', 'differentiator', 'hilbert'}, optional</dt><dd><p>The type of filter:</p> <pre>* 'bandpass' : flat response in bands. This is the default.

* 'differentiator' : frequency proportional response in bands.

* 'hilbert' : filter with odd symmetry, that is, type III
              (for even order) or type IV (for odd order)
              linear phase filters.
</pre></dd><dt><a id=maxiter>maxiter</a> : int, optional</dt><dd><p>Maximum number of iterations of the algorithm. Default is 25.</p></dd><dt><a id=grid_density>grid_density</a> : int, optional</dt><dd><p>Grid density. The dense grid used in <code><a class=exists href=/p/scipy/1.8.0/api/scipy.signal._fir_filter_design.remez.html link>remez</a></code> is of size <code class=verbatim>(numtaps + 1) * grid_density</code> . Default is 16.</p></dd><dt><a id=fs>fs</a> : float, optional</dt><dd><p>The sampling frequency of the signal. Default is 1.</p></dd></dl><h3 id=section-Returns>Returns</h3><dl><dt><a id=out>out</a> : ndarray</dt><dd><p>A rank-1 array containing the coefficients of the optimal (in a minimax sense) filter.</p></dd></dl><p>Calculate the minimax optimal filter using the Remez exchange algorithm.</p><h3 id=section-Examples>Examples</h3><p>In these examples <code><a class=exists href=/p/scipy/1.8.0/api/scipy.signal._fir_filter_design.remez.html link>remez</a></code> gets used creating a bandpass, bandstop, lowpass and highpass filter. The used parameters are the filter order, an array with according frequency boundaries, the desired attenuation values and the sampling frequency. Using <code><a class=exists href=/p/scipy/1.8.0/api/scipy.signal._filter_design.freqz.html link>freqz</a></code> the corresponding frequency response gets calculated and plotted.</p><pre class="highlight execed"><span class=nsl>>>> </span><span class=kn>from</span><span> </span><a class="foo nn"href=/p/scipy/1.8.0/api/scipy.html>scipy</a><span> </span><span class=kn>import</span><span> </span><a class=foo href=/p/scipy/1.8.0/api/scipy.signal.html>signal</a><br><span class=nsl>... </span><span class=kn>import</span><span> </span><a class="foo nn"href=/p/matplotlib/3.5.1/api/matplotlib.html>matplotlib</a><span class=nn>.</span><a class="foo nn"href=/p/matplotlib/3.5.1/api/matplotlib.pyplot.html>pyplot</a><span> </span><span class=k>as</span><span> </span><a class="foo nn"href=/p/matplotlib/3.5.1/api/matplotlib.pyplot.html>plt</a>
</pre><pre class="highlight execed"><span class=nsl>>>> </span><span class=k>def</span><span> </span><span class=nf>plot_response</span><span>(</span><span>fs</span><span>,</span><span> </span><span>w</span><span>,</span><span> </span><span>h</span><span>,</span><span> </span><span>title</span><span>)</span><span>:</span><br><span class=nsl>... </span><span>    </span><span class=s2>"</span><span class=s2>Utility function to plot response functions</span><span class=s2>"</span><br><span class=nsl>... </span><span>    </span><span>fig</span><span> </span><span class=o>=</span><span> </span><a class=foo href=/p/matplotlib/3.5.1/api/matplotlib.pyplot.html>plt</a><span class=o>.</span><a class=foo href=/p/matplotlib/3.5.1/api/matplotlib.pyplot.figure.html>figure</a><span>(</span><span>)</span><br><span class=nsl>... </span><span>    </span><span>ax</span><span> </span><span class=o>=</span><span> </span><span>fig</span><span class=o>.</span><span>add_subplot</span><span>(</span><span class=mi>111</span><span>)</span><br><span class=nsl>... </span><span>    </span><span>ax</span><span class=o>.</span><span>plot</span><span>(</span><span class=mf>0.5</span><span class=o>*</span><span>fs</span><span class=o>*</span><span>w</span><span class=o>/</span><a class=foo href=/p/numpy/1.22.3/api/numpy.html>np</a><span class=o>.</span><span>pi</span><span>,</span><span> </span><span class=mi>20</span><span class=o>*</span><a class=foo href=/p/numpy/1.22.3/api/numpy.html>np</a><span class=o>.</span><a class=foo href=/p/numpy/1.22.3/api/numpy.ufunc.html>log10</a><span>(</span><a class=foo href=/p/numpy/1.22.3/api/numpy.html>np</a><span class=o>.</span><a class=foo href=/p/numpy/1.22.3/api/numpy.ufunc.html>abs</a><span>(</span><span>h</span><span>)</span><span>)</span><span>)</span><br><span class=nsl>... </span><span>    </span><span>ax</span><span class=o>.</span><span>set_ylim</span><span>(</span><span class=o>-</span><span class=mi>40</span><span>,</span><span> </span><span class=mi>5</span><span>)</span><br><span class=nsl>... </span><span>    </span><span>ax</span><span class=o>.</span><span>set_xlim</span><span>(</span><span class=mi>0</span><span>,</span><span> </span><span class=mf>0.5</span><span class=o>*</span><span>fs</span><span>)</span><br><span class=nsl>... </span><span>    </span><span>ax</span><span class=o>.</span><span>grid</span><span>(</span><span class=kc>True</span><span>)</span><br><span class=nsl>... </span><span>    </span><span>ax</span><span class=o>.</span><span>set_xlabel</span><span>(</span><span class=s1>'</span><span class=s1>Frequency (Hz)</span><span class=s1>'</span><span>)</span><br><span class=nsl>... </span><span>    </span><span>ax</span><span class=o>.</span><span>set_ylabel</span><span>(</span><span class=s1>'</span><span class=s1>Gain (dB)</span><span class=s1>'</span><span>)</span><br><span class=nsl>... </span><span>    </span><span>ax</span><span class=o>.</span><span>set_title</span><span>(</span><span>title</span><span>)</span>
</pre><p>This example shows a steep low pass transition according to the small transition width and high filter order:</p><pre class="highlight execed"><span class=nsl>>>> </span><span>fs</span><span> </span><span class=o>=</span><span> </span><span class=mf>22050.0</span><span>       </span><span class=c1># Sample rate, Hz</span><br><span class=nsl>... </span><span>cutoff</span><span> </span><span class=o>=</span><span> </span><span class=mf>8000.0</span><span>    </span><span class=c1># Desired cutoff frequency, Hz</span><br><span class=nsl>... </span><span>trans_width</span><span> </span><span class=o>=</span><span> </span><span class=mi>100</span><span>  </span><span class=c1># Width of transition from pass band to stop band, Hz</span><br><span class=nsl>... </span><span>numtaps</span><span> </span><span class=o>=</span><span> </span><span class=mi>400</span><span>      </span><span class=c1># Size of the FIR filter.</span><br><span class=nsl>... </span><span>taps</span><span> </span><span class=o>=</span><span> </span><a class=foo href=/p/scipy/1.8.0/api/scipy.signal.html>signal</a><span class=o>.</span><a class=foo href=/p/scipy/1.8.0/api/scipy.signal._fir_filter_design.remez.html>remez</a><span>(</span><span>numtaps</span><span>,</span><span> </span><span>[</span><span class=mi>0</span><span>,</span><span> </span><span>cutoff</span><span>,</span><span> </span><span>cutoff</span><span> </span><span class=o>+</span><span> </span><span>trans_width</span><span>,</span><span> </span><span class=mf>0.5</span><span class=o>*</span><span>fs</span><span>]</span><span>,</span><span> </span><span>[</span><span class=mi>1</span><span>,</span><span> </span><span class=mi>0</span><span>]</span><span>,</span><span> </span><span>Hz</span><span class=o>=</span><span>fs</span><span>)</span><br><span class=nsl>... </span><span>w</span><span>,</span><span> </span><span>h</span><span> </span><span class=o>=</span><span> </span><a class=foo href=/p/scipy/1.8.0/api/scipy.signal.html>signal</a><span class=o>.</span><a class=foo href=/p/scipy/1.8.0/api/scipy.signal._filter_design.freqz.html>freqz</a><span>(</span><a class=foo href=/p/numpy/1.22.3/api/numpy.ndarray.html>taps</a><span>,</span><span> </span><span>[</span><span class=mi>1</span><span>]</span><span>,</span><span> </span><span>worN</span><span class=o>=</span><span class=mi>2000</span><span>)</span><br><span class=nsl>... </span><span>plot_response</span><span>(</span><span>fs</span><span>,</span><span> </span><span>w</span><span>,</span><span> </span><span>h</span><span>,</span><span> </span><span class=s2>"</span><span class=s2>Low-pass Filter</span><span class=s2>"</span><span>)</span>
</pre><p>This example shows a high pass filter:</p><pre class="highlight execed"><span class=nsl>>>> </span><span>fs</span><span> </span><span class=o>=</span><span> </span><span class=mf>22050.0</span><span>       </span><span class=c1># Sample rate, Hz</span><br><span class=nsl>... </span><span>cutoff</span><span> </span><span class=o>=</span><span> </span><span class=mf>2000.0</span><span>    </span><span class=c1># Desired cutoff frequency, Hz</span><br><span class=nsl>... </span><span>trans_width</span><span> </span><span class=o>=</span><span> </span><span class=mi>250</span><span>  </span><span class=c1># Width of transition from pass band to stop band, Hz</span><br><span class=nsl>... </span><span>numtaps</span><span> </span><span class=o>=</span><span> </span><span class=mi>125</span><span>      </span><span class=c1># Size of the FIR filter.</span><br><span class=nsl>... </span><span>taps</span><span> </span><span class=o>=</span><span> </span><a class=foo href=/p/scipy/1.8.0/api/scipy.signal.html>signal</a><span class=o>.</span><a class=foo href=/p/scipy/1.8.0/api/scipy.signal._fir_filter_design.remez.html>remez</a><span>(</span><span>numtaps</span><span>,</span><span> </span><span>[</span><span class=mi>0</span><span>,</span><span> </span><span>cutoff</span><span> </span><span class=o>-</span><span> </span><span>trans_width</span><span>,</span><span> </span><span>cutoff</span><span>,</span><span> </span><span class=mf>0.5</span><span class=o>*</span><span>fs</span><span>]</span><span>,</span><br><span class=nsl>... </span><span>                    </span><span>[</span><span class=mi>0</span><span>,</span><span> </span><span class=mi>1</span><span>]</span><span>,</span><span> </span><span>Hz</span><span class=o>=</span><span>fs</span><span>)</span><br><span class=nsl>... </span><span>w</span><span>,</span><span> </span><span>h</span><span> </span><span class=o>=</span><span> </span><a class=foo href=/p/scipy/1.8.0/api/scipy.signal.html>signal</a><span class=o>.</span><a class=foo href=/p/scipy/1.8.0/api/scipy.signal._filter_design.freqz.html>freqz</a><span>(</span><a class=foo href=/p/numpy/1.22.3/api/numpy.ndarray.html>taps</a><span>,</span><span> </span><span>[</span><span class=mi>1</span><span>]</span><span>,</span><span> </span><span>worN</span><span class=o>=</span><span class=mi>2000</span><span>)</span><br><span class=nsl>... </span><span>plot_response</span><span>(</span><span>fs</span><span>,</span><span> </span><span>w</span><span>,</span><span> </span><span>h</span><span>,</span><span> </span><span class=s2>"</span><span class=s2>High-pass Filter</span><span class=s2>"</span><span>)</span>
</pre><p>For a signal sampled with 22 kHz a bandpass filter with a pass band of 2-5 kHz gets calculated using the Remez algorithm. The transition width is 260 Hz and the filter order 10:</p><pre class="highlight execed"><span class=nsl>>>> </span><span>fs</span><span> </span><span class=o>=</span><span> </span><span class=mf>22000.0</span><span>         </span><span class=c1># Sample rate, Hz</span><br><span class=nsl>... </span><span>band</span><span> </span><span class=o>=</span><span> </span><span>[</span><span class=mi>2000</span><span>,</span><span> </span><span class=mi>5000</span><span>]</span><span>  </span><span class=c1># Desired pass band, Hz</span><br><span class=nsl>... </span><span>trans_width</span><span> </span><span class=o>=</span><span> </span><span class=mi>260</span><span>    </span><span class=c1># Width of transition from pass band to stop band, Hz</span><br><span class=nsl>... </span><span>numtaps</span><span> </span><span class=o>=</span><span> </span><span class=mi>10</span><span>        </span><span class=c1># Size of the FIR filter.</span><br><span class=nsl>... </span><span>edges</span><span> </span><span class=o>=</span><span> </span><span>[</span><span class=mi>0</span><span>,</span><span> </span><span>band</span><span>[</span><span class=mi>0</span><span>]</span><span> </span><span class=o>-</span><span> </span><span>trans_width</span><span>,</span><span> </span><span>band</span><span>[</span><span class=mi>0</span><span>]</span><span>,</span><span> </span><span>band</span><span>[</span><span class=mi>1</span><span>]</span><span>,</span><br><span class=nsl>... </span><span>         </span><span>band</span><span>[</span><span class=mi>1</span><span>]</span><span> </span><span class=o>+</span><span> </span><span>trans_width</span><span>,</span><span> </span><span class=mf>0.5</span><span class=o>*</span><span>fs</span><span>]</span><br><span class=nsl>... </span><span>taps</span><span> </span><span class=o>=</span><span> </span><a class=foo href=/p/scipy/1.8.0/api/scipy.signal.html>signal</a><span class=o>.</span><a class=foo href=/p/scipy/1.8.0/api/scipy.signal._fir_filter_design.remez.html>remez</a><span>(</span><span>numtaps</span><span>,</span><span> </span><span>edges</span><span>,</span><span> </span><span>[</span><span class=mi>0</span><span>,</span><span> </span><span class=mi>1</span><span>,</span><span> </span><span class=mi>0</span><span>]</span><span>,</span><span> </span><span>Hz</span><span class=o>=</span><span>fs</span><span>)</span><br><span class=nsl>... </span><span>w</span><span>,</span><span> </span><span>h</span><span> </span><span class=o>=</span><span> </span><a class=foo href=/p/scipy/1.8.0/api/scipy.signal.html>signal</a><span class=o>.</span><a class=foo href=/p/scipy/1.8.0/api/scipy.signal._filter_design.freqz.html>freqz</a><span>(</span><a class=foo href=/p/numpy/1.22.3/api/numpy.ndarray.html>taps</a><span>,</span><span> </span><span>[</span><span class=mi>1</span><span>]</span><span>,</span><span> </span><span>worN</span><span class=o>=</span><span class=mi>2000</span><span>)</span><br><span class=nsl>... </span><span>plot_response</span><span>(</span><span>fs</span><span>,</span><span> </span><span>w</span><span>,</span><span> </span><span>h</span><span>,</span><span> </span><span class=s2>"</span><span class=s2>Band-pass Filter</span><span class=s2>"</span><span>)</span>
</pre><p>It can be seen that for this bandpass filter, the low order leads to higher ripple and less steep transitions. There is very low attenuation in the stop band and little overshoot in the pass band. Of course the desired gain can be better approximated with a higher filter order.</p><p>The next example shows a bandstop filter. Because of the high filter order the transition is quite steep:</p><pre class="highlight execed"><span class=nsl>>>> </span><span>fs</span><span> </span><span class=o>=</span><span> </span><span class=mf>20000.0</span><span>         </span><span class=c1># Sample rate, Hz</span><br><span class=nsl>... </span><span>band</span><span> </span><span class=o>=</span><span> </span><span>[</span><span class=mi>6000</span><span>,</span><span> </span><span class=mi>8000</span><span>]</span><span>  </span><span class=c1># Desired stop band, Hz</span><br><span class=nsl>... </span><span>trans_width</span><span> </span><span class=o>=</span><span> </span><span class=mi>200</span><span>    </span><span class=c1># Width of transition from pass band to stop band, Hz</span><br><span class=nsl>... </span><span>numtaps</span><span> </span><span class=o>=</span><span> </span><span class=mi>175</span><span>        </span><span class=c1># Size of the FIR filter.</span><br><span class=nsl>... </span><span>edges</span><span> </span><span class=o>=</span><span> </span><span>[</span><span class=mi>0</span><span>,</span><span> </span><span>band</span><span>[</span><span class=mi>0</span><span>]</span><span> </span><span class=o>-</span><span> </span><span>trans_width</span><span>,</span><span> </span><span>band</span><span>[</span><span class=mi>0</span><span>]</span><span>,</span><span> </span><span>band</span><span>[</span><span class=mi>1</span><span>]</span><span>,</span><span> </span><span>band</span><span>[</span><span class=mi>1</span><span>]</span><span> </span><span class=o>+</span><span> </span><span>trans_width</span><span>,</span><span> </span><span class=mf>0.5</span><span class=o>*</span><span>fs</span><span>]</span><br><span class=nsl>... </span><span>taps</span><span> </span><span class=o>=</span><span> </span><a class=foo href=/p/scipy/1.8.0/api/scipy.signal.html>signal</a><span class=o>.</span><a class=foo href=/p/scipy/1.8.0/api/scipy.signal._fir_filter_design.remez.html>remez</a><span>(</span><span>numtaps</span><span>,</span><span> </span><span>edges</span><span>,</span><span> </span><span>[</span><span class=mi>1</span><span>,</span><span> </span><span class=mi>0</span><span>,</span><span> </span><span class=mi>1</span><span>]</span><span>,</span><span> </span><span>Hz</span><span class=o>=</span><span>fs</span><span>)</span><br><span class=nsl>... </span><span>w</span><span>,</span><span> </span><span>h</span><span> </span><span class=o>=</span><span> </span><a class=foo href=/p/scipy/1.8.0/api/scipy.signal.html>signal</a><span class=o>.</span><a class=foo href=/p/scipy/1.8.0/api/scipy.signal._filter_design.freqz.html>freqz</a><span>(</span><a class=foo href=/p/numpy/1.22.3/api/numpy.ndarray.html>taps</a><span>,</span><span> </span><span>[</span><span class=mi>1</span><span>]</span><span>,</span><span> </span><span>worN</span><span class=o>=</span><span class=mi>2000</span><span>)</span><br><span class=nsl>... </span><span>plot_response</span><span>(</span><span>fs</span><span>,</span><span> </span><span>w</span><span>,</span><span> </span><span>h</span><span>,</span><span> </span><span class=s2>"</span><span class=s2>Band-stop Filter</span><span class=s2>"</span><span>)</span>
</pre><pre class="highlight execed"><span class=nsl>>>> </span><a class=foo href=/p/matplotlib/3.5.1/api/matplotlib.pyplot.html>plt</a><span class=o>.</span><a class=foo href=/p/matplotlib/3.5.1/api/matplotlib.pyplot.show.html>show</a><span>(</span><span>)</span>
</pre><div><img src=/p/scipy/1.8.0/img/fig-scipy.signal._fir_filter_design.remez-3.png></div> See : <h3 id=section-backrefs>Back References</h3><p>The following pages refer to to this document either explicitly or contain code examples using this.</p><code><a class=exists href=/p/scipy/1.8.0/api/scipy.signal._fir_filter_design.remez.html link>scipy.signal._fir_filter_design.remez</a></code><code><a class=exists href=/p/scipy/1.8.0/api/scipy.signal._fir_filter_design.firls.html link>scipy.signal._fir_filter_design.firls</a></code><code><a class=exists href=/p/scipy/1.8.0/api/scipy.signal._fir_filter_design.minimum_phase.html link>scipy.signal._fir_filter_design.minimum_phase</a></code><h3>Local connectivity graph</h3><p>Hover to see nodes names; edges to Self not shown, Caped at 50 nodes.</p><p>Using a canvas is more power efficient and can get hundred of nodes ; but does not allow hyperlinks; , arrows or text (beyond on hover)</p><canvas class=graph height=500 width=800></canvas><p>SVG is more flexible but power hungry; and does not scale well to 50 + nodes.</p><svg class=graph height=500 width=600></svg><p>All aboves nodes referred to, (or are referred from) current nodes; Edges from Self to other have been omitted (or all nodes would be connected to the central node "self" which is not useful). Nodes are colored by the library they belong to, and scaled with the number of references pointing them</p><hr> GitHub : <a class=external href=https://github.com/scipy/scipy/blob/v1.8.0//scipy/signal/_fir_filter_design.py#L685>/scipy/signal/_fir_filter_design.py#685</a><br> type: &LTclass 'function'> <br> Commit: <br><script src=https://d3js.org/d3.v4.min.js></script><script src=https://d3js.org/d3-selection-multi.v1.js></script><style>.node {};
        .link { stroke: #999; stroke-opacity: .6; stroke-width: 1px; };</style><script>window._data_graph={nodes:[{id:1,val:32.37211521390788,label:"scipy",mod:"scipy",url:"/p/scipy/1.8.0/api/scipy"},{id:2,val:9,label:"scipy.signal._fir_filter_design.firls",mod:"scipy",url:"/p/scipy/1.8.0/api/scipy.signal._fir_filter_design.firls"},{id:3,val:11.872983346207416,label:"scipy.signal._filter_design.freqz",mod:"scipy",url:"/p/scipy/1.8.0/api/scipy.signal._filter_design.freqz"},{id:4,val:23.394804318340654,label:"matplotlib.pyplot",mod:"matplotlib",url:"/p/matplotlib/3.5.1/api/matplotlib.pyplot"},{id:5,val:9,label:"fig-scipy.signal._fir_filter_design.remez-3.png",mod:"fig-scipy",url:"/p/scipy/1.8.0/api/fig-scipy.signal._fir_filter_design.remez-3.png"},{id:7,val:16.717797887081346,label:"matplotlib.pyplot.figure",mod:"matplotlib",url:"/p/matplotlib/3.5.1/api/matplotlib.pyplot.figure"},{id:8,val:20.60952021291849,label:"numpy.ufunc",mod:"numpy",url:"/p/numpy/1.22.3/api/numpy.ufunc"},{id:9,val:34.419689627245816,label:"matplotlib",mod:"matplotlib",url:"/p/matplotlib/3.5.1/api/matplotlib"},{id:10,val:33.96150997149434,label:"numpy.ndarray",mod:"numpy",url:"/p/numpy/1.22.3/api/numpy.ndarray"},{id:11,val:22.2828568570857,label:"scipy.signal",mod:"scipy",url:"/p/scipy/1.8.0/api/scipy.signal"},{id:12,val:21.07669683062202,label:"matplotlib.pyplot.show",mod:"matplotlib",url:"/p/matplotlib/3.5.1/api/matplotlib.pyplot.show"},{id:13,val:44,label:"numpy",mod:"numpy",url:"/p/numpy/1.22.3/api/numpy"},{id:14,val:9.414213562373096,label:"scipy.integrate._ode.vode._determine_mf_and_set_bands",mod:"scipy",url:"/p/scipy/1.8.0/api/scipy.integrate._ode.vode._determine_mf_and_set_bands"},{id:15,val:9,label:"scipy.signal._fir_filter_design.minimum_phase",mod:"scipy",url:"/p/scipy/1.8.0/api/scipy.signal._fir_filter_design.minimum_phase"}],links:[{source:1,target:2,id:300},{source:1,target:3,id:400},{source:1,target:15,id:475},{source:7,target:4,id:601},{source:7,target:9,id:641},{source:13,target:2,id:837},{source:13,target:15,id:1550},{source:13,target:10,id:1814},{source:13,target:3,id:1860},{source:11,target:2,id:1976},{source:11,target:15,id:2003},{source:11,target:3,id:2114},{source:14,target:2,id:2170},{source:9,target:2,id:2524},{source:9,target:3,id:2629},{source:9,target:15,id:2727},{source:4,target:2,id:2894},{source:4,target:15,id:2927},{source:4,target:3,id:3045},{source:3,target:15,id:3112},{source:3,target:2,id:3114},{source:8,target:2,id:3135},{source:8,target:15,id:3155},{source:8,target:3,id:3229},{source:10,target:2,id:3643},{source:10,target:3,id:3750},{source:10,target:15,id:3826},{source:12,target:2,id:3974},{source:12,target:3,id:4083}]};</script><script src=/graph_canvas.js></script><script src=/graph_svg.js></script></div></body></html>