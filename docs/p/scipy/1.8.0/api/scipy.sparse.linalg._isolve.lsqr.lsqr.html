<!doctypehtml><html lang=en><meta charset=UTF-8><meta content=width=device-width,initial-scale=1.0 name=viewport><title>Document</title><link href=https://fonts.xz.style/serve/inter.css rel=stylesheet><link crossorigin=anonymous href=https://use.fontawesome.com/releases/v5.8.1/css/all.css integrity=sha384-50oBUHEmvpQ+1lW4y57PTFmhCaXp0ML5d60M1M7uH2+nqUivzIebhndOJK28anvf rel=stylesheet><link href=https://cdn.jsdelivr.net/npm/@exampledev/new.css@1.1.2/new.min.css rel=stylesheet><script type=text/x-mathjax-config>
        // this should process only math inside  span with tex2jax_process class
    MathJax.Hub.Config({
        extensions: ["tex2jax.js"],
        jax: ["input/TeX", "output/HTML-CSS"],
        tex2jax: {
        inlineMath: [ ['$','$'], ["\\(","\\)"] ],
        displayMath: [ ['$$','$$'], ["\\[","\\]"] ],
        processEscapes: true
        },
        "HTML-CSS": { fonts: ["TeX"] }
    });
    </script><script async src=https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/MathJax.js></script><style>body{
        font-family: 'Roboto', 'Helvetica Neue', 'Helvetica', 'Arial', sans-serif;
        color: #606c76;
        font-weight: 350;
        line-height: 1.6;
        max-width: 100%;
        margin-left:0;

    }
    

.external:after {
    font-weight: 900;
    content: "\2009\f35d";
    font-family: "Font Awesome 5 Free";
    display: inline-block;
    font-style: normal;
    font-variant: normal;
    text-rendering: auto;
    line-height: 1;
    font-size: small;
    
}
    .search {

        text-align: center
    }

    .search input {
        width: 80%;<D-r>
        border-radius:0;


    }
    .cards {
        display: grid;
        /*grid-template-columns: repeat(3, 1fr);*/
        grid-template-columns: repeat(auto-fill, 270px);
        grid-auto-rows: auto;
        justify-content: center;
        align-content: center;
        grid-gap: 1rem;
    }

    .helper {
        display: inline-block;
        height: 100%;
        vertical-align: middle;
    }
    
    .card {
        /* Add shadows to create the "card" effect */
        box-shadow: 0 4px 8px 0 rgba(0,0,0,0.2);
        width: 250px;
        height: 300px;
        padding: 10px;
        text-align: center;
    }

    .card div:nth-child(1){
        height: 200px;
    }

    /* On mouse-over, add a deeper shadow */
    .card:hover {
        box-shadow: 0 8px 16px 0 rgba(0,0,0,0.2);
    }
    .card > div {
        padding: 2px 16px;
    }

    .cards h4, .cards a {
        text-decoration: none;
        color: var(--nc-tx-1);
    }

    .card img {
        display: inline-block;
        max-width: 90%;
        max-height: 90%;
        vertical-align: middle;
    }



    .graph{border: 1px gray solid;}
    .foo:hover{text-decoration:underline}
    .foo{font-weight:bold; color:#4e4e4e}
    .exists{font-weight:bold; color:#4e4e4e;text-decoration:none;}
    .local{font-weight:bold; color:#1e6f04;text-decoration:none;}
    .exists:hover{text-decoration:underline;color:black}
    .missing,.missing:hover{color:darkred;text-decoration:none;font-weight:normal}
    .signature {font-size:100%; margin-bottom: 2rem; display: block; border:none; background-color: #FFFFFF;
        font-weight:600;}
    h1, h2, h3 {color: #4e4e4e; font-weight:400;
        margin-bottom: 1rem;border-bottom: 1px solid var(--nc-bg-3);
    }
    pre{border-radius:0;
        padding:0.6rem;
    border-left: 3px solid #AAA}
    dt {font-weight: 400;}

    header{
        box-shadow: rgba(0, 0, 0, 0.24) 0px 3px 8px;

        padding-top:0rem;
        padding-bottom:0rem;
        z-index: 2;
        padding-left: 0;
        position: fixed;
        top: 30px;
        left:0; 
        width: 100%;
        height: 42px;
        backdrop-filter: blur(5px);
        background-color: rgba(255, 255, 255, .15);
    }
      dd::before {
        content: '';
      }
      header > brand, header>:first-child {
          border-right: 1px solid #ccc;
          border-left: 1px solid #ccc;
          padding: 16px;
          padding-top: 0.5rem;
          padding-bottom: 0.5rem;
          display: inline-block; 
          width: 167px;
          

      }
      brand > a {color:#606c76}
      brand > i {
          padding-right: 0.5rem;

        }
          nav{display:inline-block;
              padding: 10px;
              padding-left: 1rem;

          }

          dd {
              margin-left: 1rem;
              border-left:  solid #ddd;
              padding-left: 1rem;
          }
          summary > h2 { display: inline }

          .sidenav {
                height: 100%; /* Full-height: remove this if you want "auto" height */
                width: 200px; /* Set the width of the sidebar */
                position: fixed; /* Fixed Sidebar (stay in place on scroll) */
                z-index: 1; /* Stay on top */
                top: 0; /* Stay at the top */
                left: 0;
                background-color: var(--nc-bg-1);; /* Black */
                border-right: thin solid #ccc;
                overflow-x: hidden; /* Disable horizontal scroll */
                padding-top: 3rem;
 
                box-shadow: rgba(0, 0, 0, 0.24) 0px 3px 8px;
                
          }

          .sidenav a {
            padding: 6px 8px 6px 16px;
            text-decoration: none;
            color: #818181;
            display: block;
          }
          .sidenav a:hover{
            text-decoration: underline;
          }
          .sidenav img {
              width: 160px;
              padding-left:20px;
              padding-right:20px;
              border-bottom: solid thin #DDD; 
              padding-bottom: .5rem;
              max-width: 100%;
          }
          .sidenav i {
              font-size: 100;
              padding-left: 3.5rem;
              padding-right: 3.5rem;
              padding-bottom: .5rem;
              border-bottom: solid thin #DDD; 

          }
          .container {
              padding-left: 210px;
              
              padding-top: 30px;

          }

          ::selection {
	/* Set background color for selected text */
                background: #59b4fd;
                color: var(--nc-ac-tx);
          }

          img {max-width: 40%;}

          pre.highlight.execed, .admonition {
            border-left: 3px solid #0070f3;
          }
          .admonition {
            padding-left: 1em;
          }
          .admonition > div {
            background-color: rgba(0, 123, 255, 0.1);
            position: relative;
            margin: 0 -1rem;
            padding: 0.4rem 0.1rem 0.4rem 1.5rem;
            font-weight: bold;
            text-transform: capitalize;
        }
          .note {color: #7d77d2}
          .warning {color: #af7b1a}
          .error {color: #f44336}
          pre.highlight.compiled {
            border-left: 3px solid #7d77d2;
          }
          pre.highlight.syntax_error, pre.highlight.exception_in_exec {
            border-left: 3px solid #f44336;
          }

        /* Dropdown Button */
/* The container <div> - needed to position the dropdown content */
.dropdown {
  position: relative;
  display: inline-block;
  margin-left: -4px;
}

nav  a {
    color: #606c76;
    text-decoration: none;

}

/* Dropdown Content (Hidden by Default) */
.dropdown-content {
  display: none;
  position: absolute;
  background-color: #f1f1f1;
  min-width: 160px;
  box-shadow: 0px 8px 16px 0px rgba(0,0,0,0.2);
  z-index: 1;
}

/* Links inside the dropdown */
.dropdown-content a {
  color: black;
  padding: 12px 16px;
  text-decoration: none;
  display: block;
}

/* Change color of dropdown links on hover */
.dropdown-content a:hover {background-color: #ddd;}

/* Show the dropdown menu on hover */
.dropdown:hover .dropdown-content {display: block;
    max-height: 80vh;
    overflow: scroll;}

/* Change the background color of the dropdown button when the dropdown content is shown */
.dropdown:hover .dropbtn {}


pre { line-height: 125%; }
td.linenos .normal { color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px; }
span.linenos { color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px; }
td.linenos .special { color: #000000; background-color: #ffffc0; padding-left: 5px; padding-right: 5px; }
span.linenos.special { color: #000000; background-color: #ffffc0; padding-left: 5px; padding-right: 5px; }
.highlight .hll { background-color: #ffffcc }
.highlight { background: #ffffff; }
.highlight .c { color: #888888 } /* Comment */
.highlight .err { color: #a61717; background-color: #e3d2d2 } /* Error */
.highlight .k { color: #008800; font-weight: bold } /* Keyword */
.highlight .ch { color: #888888 } /* Comment.Hashbang */
.highlight .cm { color: #888888 } /* Comment.Multiline */
.highlight .cp { color: #cc0000; font-weight: bold } /* Comment.Preproc */
.highlight .cpf { color: #888888 } /* Comment.PreprocFile */
.highlight .c1 { color: #888888 } /* Comment.Single */
.highlight .cs { color: #cc0000; font-weight: bold; background-color: #fff0f0 } /* Comment.Special */
.highlight .gd { color: #000000; background-color: #ffdddd } /* Generic.Deleted */
.highlight .ge { font-style: italic } /* Generic.Emph */
.highlight .gr { color: #aa0000 } /* Generic.Error */
.highlight .gh { color: #333333 } /* Generic.Heading */
.highlight .gi { color: #000000; background-color: #ddffdd } /* Generic.Inserted */
.highlight .go { color: #888888 } /* Generic.Output */
.highlight .gp { color: #555555 } /* Generic.Prompt */
.highlight .gs { font-weight: bold } /* Generic.Strong */
.highlight .gu { color: #666666 } /* Generic.Subheading */
.highlight .gt { color: #aa0000 } /* Generic.Traceback */
.highlight .kc { color: #008800; font-weight: bold } /* Keyword.Constant */
.highlight .kd { color: #008800; font-weight: bold } /* Keyword.Declaration */
.highlight .kn { color: #008800; font-weight: bold } /* Keyword.Namespace */
.highlight .kp { color: #008800 } /* Keyword.Pseudo */
.highlight .kr { color: #008800; font-weight: bold } /* Keyword.Reserved */
.highlight .kt { color: #888888; font-weight: bold } /* Keyword.Type */
.highlight .m { color: #0000DD; font-weight: bold } /* Literal.Number */
.highlight .s { color: #dd2200; background-color: #fff0f0 } /* Literal.String */
.highlight .na { color: #336699 } /* Name.Attribute */
.highlight .nb { color: #003388 } /* Name.Builtin */
.highlight .nc { color: #bb0066; font-weight: bold } /* Name.Class */
.highlight .no { color: #003366; font-weight: bold } /* Name.Constant */
.highlight .nd { color: #555555 } /* Name.Decorator */
.highlight .ne { color: #bb0066; font-weight: bold } /* Name.Exception */
.highlight .nf { color: #0066bb; font-weight: bold } /* Name.Function */
.highlight .nl { color: #336699; font-style: italic } /* Name.Label */
.highlight .nn { color: #bb0066; font-weight: bold } /* Name.Namespace */
.highlight .py { color: #336699; font-weight: bold } /* Name.Property */
.highlight .nt { color: #bb0066; font-weight: bold } /* Name.Tag */
.highlight .nv { color: #336699 } /* Name.Variable */
.highlight .ow { color: #008800 } /* Operator.Word */
.highlight .w { color: #bbbbbb } /* Text.Whitespace */
.highlight .mb { color: #0000DD; font-weight: bold } /* Literal.Number.Bin */
.highlight .mf { color: #0000DD; font-weight: bold } /* Literal.Number.Float */
.highlight .mh { color: #0000DD; font-weight: bold } /* Literal.Number.Hex */
.highlight .mi { color: #0000DD; font-weight: bold } /* Literal.Number.Integer */
.highlight .mo { color: #0000DD; font-weight: bold } /* Literal.Number.Oct */
.highlight .sa { color: #dd2200; background-color: #fff0f0 } /* Literal.String.Affix */
.highlight .sb { color: #dd2200; background-color: #fff0f0 } /* Literal.String.Backtick */
.highlight .sc { color: #dd2200; background-color: #fff0f0 } /* Literal.String.Char */
.highlight .dl { color: #dd2200; background-color: #fff0f0 } /* Literal.String.Delimiter */
.highlight .sd { color: #dd2200; background-color: #fff0f0 } /* Literal.String.Doc */
.highlight .s2 { color: #dd2200; background-color: #fff0f0 } /* Literal.String.Double */
.highlight .se { color: #0044dd; background-color: #fff0f0 } /* Literal.String.Escape */
.highlight .sh { color: #dd2200; background-color: #fff0f0 } /* Literal.String.Heredoc */
.highlight .si { color: #3333bb; background-color: #fff0f0 } /* Literal.String.Interpol */
.highlight .sx { color: #22bb22; background-color: #f0fff0 } /* Literal.String.Other */
.highlight .sr { color: #008800; background-color: #fff0ff } /* Literal.String.Regex */
.highlight .s1 { color: #dd2200; background-color: #fff0f0 } /* Literal.String.Single */
.highlight .ss { color: #aa6600; background-color: #fff0f0 } /* Literal.String.Symbol */
.highlight .bp { color: #003388 } /* Name.Builtin.Pseudo */
.highlight .fm { color: #0066bb; font-weight: bold } /* Name.Function.Magic */
.highlight .vc { color: #336699 } /* Name.Variable.Class */
.highlight .vg { color: #dd7700 } /* Name.Variable.Global */
.highlight .vi { color: #3333bb } /* Name.Variable.Instance */
.highlight .vm { color: #336699 } /* Name.Variable.Magic */
.highlight .il { color: #0000DD; font-weight: bold } /* Literal.Number.Integer.Long */

.nsl {
-webkit-touch-callout: none;
-webkit-user-select: none;
-khtml-user-select: none;
-moz-user-select: none;
-ms-user-select: none;
user-select: none;
}


.block_directive{

    border-left: thin solid var(--nc-lk-1);
    padding-bottom: 8px;
    padding-left: 12px;
}

.block_directive.head{

    border: thin solid var(--nc-lk-1);
}


.block_directive > p{
    margin-left: 2em;
    margin-top: 1em;
}
.head {
    font-family: monospace;
    color: var(--nc-lk-1);
}</style><body class=tex2jax_ignore><header><brand><i class="fab fa-python"></i><a href=/>Home</a></brand><nav>/ <a href=/>p</a>  /  <div class=dropdown><a href=scipy>scipy</a> /  <div class=dropdown-content><a href=/p/IPython/8.2.0.dev/api/IPython.html>IPython</a><a href=/p/astropy/5.0/api/astropy.html>astropy</a><a href=/p/dask/2021.10.0/api/dask.html>dask</a><a href=/p/distributed/2021.10.0/api/distributed.html>distributed</a><a href=/p/matplotlib/3.5.1/api/matplotlib.html>matplotlib</a><a href=/p/networkx/2.7.2rc1.dev0/api/networkx.html>networkx</a><a href=/p/numpy/1.22.3/api/numpy.html>numpy</a><a href=/p/pandas/1.4.1/api/pandas.html>pandas</a><a href=/p/papyri/0.0.8/api/papyri.html>papyri</a><a href=/p/scipy/1.8.0/api/scipy.html>scipy</a><a href=/p/skimage/0.17.2/api/skimage.html>skimage</a></div></div><div class=dropdown><a href=/p/scipy/1.8.0/api/scipy.html>1.8.0</a> /  <div class=dropdown-content><a href=/p/scipy/1.8.0/api/scipy.html>1.8.0</a></div></div><div class=dropdown><a href=/p/scipy/1.8.0/api/scipy.html>api</a> /  <div class=dropdown-content><a href=/p/scipy/1.8.0/api/scipy.html>API</a><a href=/p/scipy/1.8.0/gallery>Gallery</a><a href=/p/scipy/1.8.0/examples>Examples</a></div></div><div class=dropdown><a class=dropbtn href=scipy.html>scipy</a>.</div><div class=dropdown><a class=dropbtn href=scipy.sparse.html>sparse</a>. <div class=dropdown-content><a href=/p/?/?/api/scipy._lib.html>_lib</a><a href=/p/scipy/1.8.0/api/scipy.fft.html>fft</a><a href=/p/scipy/1.8.0/api/scipy.integrate.html>integrate</a><a href=/p/scipy/1.8.0/api/scipy.interpolate.html>interpolate</a><a href=/p/scipy/1.8.0/api/scipy.linalg.html>linalg</a><a href=/p/?/?/api/scipy.ndimage.html>ndimage</a><a href=/p/scipy/1.8.0/api/scipy.optimize.html>optimize</a><a href=/p/scipy/1.8.0/api/scipy.signal.html>signal</a><a href=/p/scipy/1.8.0/api/scipy.sparse.html>sparse</a><a href=/p/scipy/1.8.0/api/scipy.spatial.html>spatial</a><a href=/p/scipy/1.8.0/api/scipy.special.html>special</a><a href=/p/?/?/api/scipy.stats.html>stats</a></div></div><div class=dropdown><a class=dropbtn href=scipy.sparse.linalg.html>linalg</a>. <div class=dropdown-content><a href=/p/scipy/1.8.0/api/scipy.sparse._arrays.html>_arrays</a><a href=/p/scipy/1.8.0/api/scipy.sparse._base.html>_base</a><a href=/p/scipy/1.8.0/api/scipy.sparse._bsr.html>_bsr</a><a href=/p/scipy/1.8.0/api/scipy.sparse._compressed.html>_compressed</a><a href=/p/scipy/1.8.0/api/scipy.sparse._construct.html>_construct</a><a href=/p/scipy/1.8.0/api/scipy.sparse._coo.html>_coo</a><a href=/p/scipy/1.8.0/api/scipy.sparse._csc.html>_csc</a><a href=/p/scipy/1.8.0/api/scipy.sparse._csparsetools.html>_csparsetools</a><a href=/p/scipy/1.8.0/api/scipy.sparse._csr.html>_csr</a><a href=/p/scipy/1.8.0/api/scipy.sparse._data.html>_data</a><a href=/p/scipy/1.8.0/api/scipy.sparse._dia.html>_dia</a><a href=/p/scipy/1.8.0/api/scipy.sparse._dok.html>_dok</a><a href=/p/scipy/1.8.0/api/scipy.sparse._extract.html>_extract</a><a href=/p/scipy/1.8.0/api/scipy.sparse._index.html>_index</a><a href=/p/scipy/1.8.0/api/scipy.sparse._lil.html>_lil</a><a href=/p/scipy/1.8.0/api/scipy.sparse._matrix_io.html>_matrix_io</a><a href=/p/scipy/1.8.0/api/scipy.sparse._sparsetools.html>_sparsetools</a><a href=/p/scipy/1.8.0/api/scipy.sparse._sputils.html>_sputils</a><a href=/p/scipy/1.8.0/api/scipy.sparse.base.html>base</a><a href=/p/scipy/1.8.0/api/scipy.sparse.bsr.html>bsr</a><a href=/p/scipy/1.8.0/api/scipy.sparse.compressed.html>compressed</a><a href=/p/scipy/1.8.0/api/scipy.sparse.construct.html>construct</a><a href=/p/scipy/1.8.0/api/scipy.sparse.coo.html>coo</a><a href=/p/scipy/1.8.0/api/scipy.sparse.csc.html>csc</a><a href=/p/scipy/1.8.0/api/scipy.sparse.csgraph.html>csgraph</a><a href=/p/scipy/1.8.0/api/scipy.sparse.csr.html>csr</a><a href=/p/scipy/1.8.0/api/scipy.sparse.data.html>data</a><a href=/p/scipy/1.8.0/api/scipy.sparse.dia.html>dia</a><a href=/p/scipy/1.8.0/api/scipy.sparse.dok.html>dok</a><a href=/p/scipy/1.8.0/api/scipy.sparse.extract.html>extract</a><a href=/p/scipy/1.8.0/api/scipy.sparse.lil.html>lil</a><a href=/p/scipy/1.8.0/api/scipy.sparse.linalg.html>linalg</a><a href=/p/scipy/1.8.0/api/scipy.sparse.sparsetools.html>sparsetools</a><a href=/p/scipy/1.8.0/api/scipy.sparse.sputils.html>sputils</a></div></div><div class=dropdown><a class=dropbtn href=scipy.sparse.linalg._isolve.html>_isolve</a>. <div class=dropdown-content><a href=/p/scipy/1.8.0/api/scipy.sparse.linalg._dsolve.html>_dsolve</a><a href=/p/scipy/1.8.0/api/scipy.sparse.linalg._eigen.html>_eigen</a><a href=/p/scipy/1.8.0/api/scipy.sparse.linalg._expm_multiply.html>_expm_multiply</a><a href=/p/scipy/1.8.0/api/scipy.sparse.linalg._interface.html>_interface</a><a href=/p/scipy/1.8.0/api/scipy.sparse.linalg._isolve.html>_isolve</a><a href=/p/scipy/1.8.0/api/scipy.sparse.linalg._matfuncs.html>_matfuncs</a><a href=/p/scipy/1.8.0/api/scipy.sparse.linalg._norm.html>_norm</a><a href=/p/scipy/1.8.0/api/scipy.sparse.linalg._onenormest.html>_onenormest</a><a href=/p/scipy/1.8.0/api/scipy.sparse.linalg.dsolve.html>dsolve</a><a href=/p/scipy/1.8.0/api/scipy.sparse.linalg.eigen.html>eigen</a><a href=/p/scipy/1.8.0/api/scipy.sparse.linalg.interface.html>interface</a><a href=/p/scipy/1.8.0/api/scipy.sparse.linalg.isolve.html>isolve</a><a href=/p/scipy/1.8.0/api/scipy.sparse.linalg.matfuncs.html>matfuncs</a></div></div><div class=dropdown><a class=dropbtn href=scipy.sparse.linalg._isolve.lsqr.html>lsqr</a><div class=dropdown-content><a href=/p/scipy/1.8.0/api/scipy.sparse.linalg._isolve.lsqr.lsqr.html>lsqr</a></div></div></nav></header><div class=container><div class=sidenav><img src=/p/scipy/1.8.0/img/logo.png><a href=#>scipy</a><a href=#>1.8.0</a><a class=external href=https://pypi.org/project/scipy>Pypi</a><a class=external href=https://github.com/scipy/scipy>GitHub</a><a class=external href=https://scipy.org/>Homepage</a><hr><a class=external href=https://docs.scipy.org/doc/scipy/>Other Docs</a><hr><a href=#section-Notes>Notes</a><a href=#section-Parameters>Parameters</a><a href=#section-Returns>Returns</a><a href=#section-backrefs>BackRef</a></div><code class=signature>lsqr(A, b, damp=0.0, atol=1e-06, btol=1e-06, conlim=100000000.0, iter_lim=None, show=False, calc_var=False, x0=None)</code><dl><pre>
   


    
    
        
        
           
               
        <p>The function solves 
        <code class=verbatim>Ax = b</code>
      or  
        <code class=verbatim>min ||Ax - b||^2</code>
     or 
        <code class=verbatim>min ||Ax - b||^2 + d^2 ||x - x0||^2</code>
    .</p>

    
           
               
        <p>The matrix A may be square or rectangular (over-determined or under-determined), and may have any rank.</p>

    
           
               
            <pre>1. Unsymmetric equations --    solve  Ax = b

2. Linear least squares  --    solve  Ax = b
                               in the least-squares sense

3. Damped least squares  --    solve  (   A    )*x = (    b    )
                                      ( damp*I )     ( damp*x0 )
                               in the least-squares sense</pre>
       
           
       
    


    
    
       
   


    
        <h3 id=section-Notes>Notes</h3>
    
    
        
        
           
               
        <p>LSQR uses an iterative method to approximate the solution.  The number of iterations required to reach a certain accuracy depends strongly on the scaling of the problem.  Poor scaling of the rows or columns of A should therefore be avoided where possible.</p>

    
           
               
        <p>For example, in problem 1 the solution is unaltered by row-scaling.  If a row of A is very small or large compared to the other rows of A, the corresponding row of ( A  b ) should be scaled up or down.</p>

    
           
               
        <p>In problems 1 and 2, the solution x is easily recovered following column-scaling.  Unless better information is known, the nonzero columns of A should be scaled so that they all have the same Euclidean norm (e.g., 1.0).</p>

    
           
               
        <p>In problem 3, there is no freedom to re-scale if damp is nonzero.  However, the value of damp should be assigned only after attention has been paid to the scaling of A.</p>

    
           
               
        <p>The parameter damp is intended to help regularize ill-conditioned systems, by preventing the true solution from being very large.  Another aid to regularization is provided by the parameter acond, which may be used to terminate iterations before the computed solution becomes very large.</p>

    
           
               
        <p>If some initial estimate 
        <code class=verbatim>x0</code>
     is known and if 
        <code class=verbatim>damp == 0</code>
    , one could proceed as follows:</p>

    
           
               
            <pre>1. Compute a residual vector ``r0 = b - A@x0``.
2. Use LSQR to solve the system  ``A@dx = r0``.
3. Add the correction dx to obtain a final solution ``x = x0 + dx``.
</pre>

       
           
               
        <p>This requires that 
        <code class=verbatim>x0</code>
     be available before and after the call to LSQR.  To judge the benefits, suppose LSQR takes k1 iterations to solve A@x = b and k2 iterations to solve A@dx = r0. If x0 is "good", norm(r0) will be smaller than norm(b). If the same stopping tolerances atol and btol are used for each system, k1 and k2 will be similar, but the final solution x0 + dx should be more accurate.  The only way to reduce the total work is to use a larger stopping tolerance for the second system. If some value btol is suitable for A@x = b, the larger value btol*norm(b)/norm(r0)  should be suitable for A@dx = r0.</p>

    
           
               
        <p>Preconditioning is another way to reduce the number of iterations. If it is possible to solve a related system 
        <code class=verbatim>M@x = b</code>
     efficiently, where M approximates A in some helpful way (e.g. M - A has low rank or its elements are small relative to those of A), LSQR may converge more rapidly on the system 
        <code class=verbatim>A@M(inverse)@z =
b</code>
    , after which x can be recovered by solving M@x = z.</p>

    
           
               
        <p>If A is symmetric, LSQR should not be used!</p>

    
           
               
        <p>Alternatives are the symmetric conjugate-gradient method (cg) and/or SYMMLQ.  SYMMLQ is an implementation of symmetric cg that applies to any symmetric A and will converge more rapidly than LSQR.  If A is positive definite, there are other implementations of symmetric cg that require slightly less work per iteration than SYMMLQ (but will take the same number of iterations).</p>

    
           
       
    


    
    
       <dl>
           

   <pre>
   


    
        <h3 id=section-Parameters>Parameters</h3>
    
    
       <dl>
           
            
                <dt><a id=A>A</a> : {sparse matrix, ndarray, LinearOperator}</dt>
            
        </dl>

        <dd>
            
                
        <p>Representation of an m-by-n matrix. Alternatively, 
        <code class=verbatim>A</code>
     can be a linear operator which can produce 
        <code class=verbatim>Ax</code>
     and 
        <code class=verbatim>A^T x</code>
     using, e.g., 
        <code class=verbatim>scipy.sparse.linalg.LinearOperator</code>
    .</p>

    
            
        </dd>
       
            
                <dt><a id=b>b</a> : array_like, shape (m,)</dt>
            
        <dl>

        <dd>
            
                
        <p>Right-hand side vector 
        <code class=verbatim>b</code>
    .</p>

    
            
        </dd>
       
            
                <dt><a id=damp>damp</a> : float</dt>
            
        </dl>

        <dd>
            
                
        <p>Damping coefficient. Default is 0.</p>

    
            
        </dd>
       
            
                <dt><a id="atol, btol">atol, btol</a> : float, optional</dt>
            
        <dl>

        <dd>
            
                
        <p>Stopping tolerances. <code><a class=exists href=/p/scipy/1.8.0/api/scipy.sparse.linalg._isolve.lsqr.lsqr.html link>lsqr</a></code>
         continues iterations until a certain backward error estimate is smaller than some quantity depending on atol and btol.  Let 
        <code class=verbatim>r = b - Ax</code>
     be the residual vector for the current approximate solution 
        <code class=verbatim>x</code>
    . If 
        <code class=verbatim>Ax = b</code>
     seems to be consistent, <code><a class=exists href=/p/scipy/1.8.0/api/scipy.sparse.linalg._isolve.lsqr.lsqr.html link>lsqr</a></code>
         terminates when 
        <code class=verbatim>norm(r) <= atol * norm(A) * norm(x) + btol * norm(b)</code>
    . Otherwise, <code><a class=exists href=/p/scipy/1.8.0/api/scipy.sparse.linalg._isolve.lsqr.lsqr.html link>lsqr</a></code>
         terminates when 
        <code class=verbatim>norm(A^H r) <=
atol * norm(A) * norm(r)</code>
    .  If both tolerances are 1.0e-6 (default), the final 
        <code class=verbatim>norm(r)</code>
     should be accurate to about 6 digits. (The final 
        <code class=verbatim>x</code>
     will usually have fewer correct digits, depending on 
        <code class=verbatim>cond(A)</code>
     and the size of LAMBDA.)  If <code><a class=exists href=/p/scipy/1.8.0/api/scipy.sparse.linalg._isolve.iterative._get_atol.html link>atol</a></code>
         or <code><a class=local href=#btol link>btol</a></code> is None, a default value of 1.0e-6 will be used. Ideally, they should be estimates of the relative error in the entries of 
        <code class=verbatim>A</code>
     and 
        <code class=verbatim>b</code>
     respectively.  For example, if the entries of 
        <code class=verbatim>A</code>
     have 7 correct digits, set 
        <code class=verbatim>atol = 1e-7</code>
    . This prevents the algorithm from doing unnecessary work beyond the uncertainty of the input data.</p>

    
            
        </dd>
       
            
                <dt><a id=conlim>conlim</a> : float, optional</dt>
            
        </dl>

        <dd>
            
                
        <p>Another stopping tolerance.  lsqr terminates if an estimate of 
        <code class=verbatim>cond(A)</code>
     exceeds <code><a class=local href=#conlim link>conlim</a></code>.  For compatible systems 
        <code class=verbatim>Ax =
b</code>
    , <code><a class=local href=#conlim link>conlim</a></code> could be as large as 1.0e+12 (say).  For least-squares problems, conlim should be less than 1.0e+8. Maximum precision can be obtained by setting 
        <code class=verbatim>atol = btol =
conlim = zero</code>
    , but the number of iterations may then be excessive. Default is 1e8.</p>

    
            
        </dd>
       
            
                <dt><a id=iter_lim>iter_lim</a> : int, optional</dt>
            
        <dl>

        <dd>
            
                
        <p>Explicit limitation on number of iterations (for safety).</p>

    
            
        </dd>
       
            
                <dt><a id=show>show</a> : bool, optional</dt>
            
        </dl>

        <dd>
            
                
        <p>Display an iteration log. Default is False.</p>

    
            
        </dd>
       
            
                <dt><a id=calc_var>calc_var</a> : bool, optional</dt>
            
        <dl>

        <dd>
            
                
        <p>Whether to estimate diagonals of 
        <code class=verbatim>(A'A + damp^2*I)^{-1}</code>
    .</p>

    
            
        </dd>
       
            
                <dt><a id=x0>x0</a> : array_like, shape (n,), optional</dt>
            
        </dl>

        <dd>
            
                
        <p>Initial guess of x, if None zeros are used. Default is None.</p>

    
            
                
            <div class=admonition>
    <div>versionadded</div>
    
        
        <p>1.0.0 </p>

    
    
</div>

       
            
        </dd>
       

   </pre>
   


    
    
       <dl>
           

   <pre>
   


    
    
       
   


    
        <h3 id=section-Returns>Returns</h3>
    
    
       <dl>
           
            
                <dt><a id=x>x</a> : ndarray of float</dt>
            
        </dl>

        <dd>
            
                
        <p>The final solution.</p>

    
            
        </dd>
       
            
                <dt><a id=istop>istop</a> : int</dt>
            
        <dl>

        <dd>
            
                
        <p>Gives the reason for termination. 1 means x is an approximate solution to Ax = b. 2 means x approximately solves the least-squares problem.</p>

    
            
        </dd>
       
            
                <dt><a id=itn>itn</a> : int</dt>
            
        </dl>

        <dd>
            
                
        <p>Iteration number upon termination.</p>

    
            
        </dd>
       
            
                <dt><a id=r1norm>r1norm</a> : float</dt>
            
        <dl>

        <dd>
            
                
        <p>
        <code class=verbatim>norm(r)</code>
    , where 
        <code class=verbatim>r = b - Ax</code>
    .</p>

    
            
        </dd>
       
            
                <dt><a id=r2norm>r2norm</a> : float</dt>
            
        </dl>

        <dd>
            
                
        <p>
        <code class=verbatim>sqrt( norm(r)^2  +  damp^2 * norm(x - x0)^2 )</code>
    .  Equal to <code><a class=local href=#r1norm link>r1norm</a></code> if 
        <code class=verbatim>damp == 0</code>
    .</p>

    
            
        </dd>
       
            
                <dt><a id=anorm>anorm</a> : float</dt>
            
        <dl>

        <dd>
            
                
        <p>Estimate of Frobenius norm of 
        <code class=verbatim>Abar = [[A]; [damp*I]]</code>
    .</p>

    
            
        </dd>
       
            
                <dt><a id=acond>acond</a> : float</dt>
            
        </dl>

        <dd>
            
                
        <p>Estimate of 
        <code class=verbatim>cond(Abar)</code>
    .</p>

    
            
        </dd>
       
            
                <dt><a id=arnorm>arnorm</a> : float</dt>
            
        <dl>

        <dd>
            
                
        <p>Estimate of 
        <code class=verbatim>norm(A'@r - damp^2*(x - x0))</code>
    .</p>

    
            
        </dd>
       
            
                <dt><a id=xnorm>xnorm</a> : float</dt>
            
        </dl>

        <dd>
            
                
        <p>
        <code class=verbatim>norm(x)</code>
    </p>

    
            
        </dd>
       
            
                <dt><a id=var>var</a> : ndarray of float</dt>
            
        <dl>

        <dd>
            
                
        <p>If 
        <code class=verbatim>calc_var</code>
     is True, estimates all diagonals of 
        <code class=verbatim>(A'A)^{-1}</code>
     (if 
        <code class=verbatim>damp == 0</code>
    ) or more generally 
        <code class=verbatim>(A'A +
damp^2*I)^{-1}</code>
    .  This is well defined if A has full column rank or 
        <code class=verbatim>damp > 0</code>
    .  (Not sure what var means if 
        <code class=verbatim>rank(A)
< n</code>
     and 
        <code class=verbatim>damp = 0.</code>
    )</p>

    
            
        </dd>
       

   <pre>
   


    
    
        
        
           
               
        <p>Find the least-squares solution to a large, sparse, linear system of equations.</p>

    
           
       
    


    
    
       
   


    
    
       <dl>
           

   <pre>
   


    
    
       <dl>
           

   <pre>
   



    <h3 id=section-Examples>Examples</h3>
        
                <pre class="highlight execed"><span class=nsl>>>> </span><span class=kn>from</span><span> </span><a class="foo nn", href=/p/scipy/1.8.0/api/scipy.html>scipy</a><span class=nn>.</span><a class="foo nn", href=/p/scipy/1.8.0/api/scipy.sparse.html>sparse</a><span> </span><span class=kn>import</span><span> </span><a , class=foo href=/p/scipy/1.8.0/api/scipy.sparse._csc.csc_matrix.html>csc_matrix</a><br><span class=nsl>... </span><span class=kn>from</span><span> </span><a class="foo nn", href=/p/scipy/1.8.0/api/scipy.html>scipy</a><span class=nn>.</span><a class="foo nn", href=/p/scipy/1.8.0/api/scipy.sparse.html>sparse</a><span class=nn>.</span><a class="foo nn", href=/p/scipy/1.8.0/api/scipy.linalg.html>linalg</a><span> </span><span class=kn>import</span><span> </span><a , class=foo href=/p/scipy/1.8.0/api/scipy.sparse.linalg._isolve.lsqr.lsqr.html>lsqr</a><br><span class=nsl>... </span><span>A</span><span> </span><span class=o>=</span><span> </span><a , class=foo href=/p/scipy/1.8.0/api/scipy.sparse._csc.csc_matrix.html>csc_matrix</a><span>(</span><span>[</span><span>[</span><span class=mf>1.</span><span>,</span><span> </span><span class=mf>0.</span><span>]</span><span>,</span><span> </span><span>[</span><span class=mf>1.</span><span>,</span><span> </span><span class=mf>1.</span><span>]</span><span>,</span><span> </span><span>[</span><span class=mf>0.</span><span>,</span><span> </span><span class=mf>1.</span><span>]</span><span>]</span><span>,</span><span> </span><span>dtype</span><span class=o>=</span><span class=nb>float</span><span>)</span>
</pre>
            
            
         
                
        <p>The first example has the trivial solution <code>:None:None:`[0, 0]`</code></p>

    
            
            
         
                <pre class="highlight execed"><span class=nsl>>>> </span><a , class=foo href=/p/numpy/1.22.3/api/numpy.ndarray.html>b</a><span> </span><span class=o>=</span><span> </span><a , class=foo href=/p/numpy/1.22.3/api/numpy.html>np</a><span class=o>.</span><a , class=foo href=/p/numpy/1.22.3/api/numpy.array.html>array</a><span>(</span><span>[</span><span class=mf>0.</span><span>,</span><span> </span><span class=mf>0.</span><span>,</span><span> </span><span class=mf>0.</span><span>]</span><span>,</span><span> </span><span>dtype</span><span class=o>=</span><span class=nb>float</span><span>)</span><br><span class=nsl>... </span><span>x</span><span>,</span><span> </span><span>istop</span><span>,</span><span> </span><span>itn</span><span>,</span><span> </span><span>normr</span><span> </span><span class=o>=</span><span> </span><a , class=foo href=/p/scipy/1.8.0/api/scipy.sparse.linalg._isolve.lsqr.lsqr.html>lsqr</a><span>(</span><span>A</span><span>,</span><span> </span><a , class=foo href=/p/numpy/1.22.3/api/numpy.ndarray.html>b</a><span>)</span><span>[</span><span>:</span><span class=mi>4</span><span>]</span><br><span class=nsl>... </span><span>istop</span>
0</pre>
            
            
         
                <pre class="highlight execed"><span class=nsl>>>> </span><span>x</span>
array([ 0.,  0.])</pre>
            
            
         
                
        <p>The stopping code <code>:None:None:`istop=0`</code> returned indicates that a vector of zeros was found as a solution. The returned solution <code><a class=local href=#x link>x</a></code> indeed contains <code>:None:None:`[0., 0.]`</code>. The next example has a non-trivial solution:</p>

    
            
            
         
                <pre class="highlight execed"><span class=nsl>>>> </span><a , class=foo href=/p/numpy/1.22.3/api/numpy.ndarray.html>b</a><span> </span><span class=o>=</span><span> </span><a , class=foo href=/p/numpy/1.22.3/api/numpy.html>np</a><span class=o>.</span><a , class=foo href=/p/numpy/1.22.3/api/numpy.array.html>array</a><span>(</span><span>[</span><span class=mf>1.</span><span>,</span><span> </span><span class=mf>0.</span><span>,</span><span> </span><span class=o>-</span><span class=mf>1.</span><span>]</span><span>,</span><span> </span><span>dtype</span><span class=o>=</span><span class=nb>float</span><span>)</span><br><span class=nsl>... </span><span>x</span><span>,</span><span> </span><span>istop</span><span>,</span><span> </span><span>itn</span><span>,</span><span> </span><span>r1norm</span><span> </span><span class=o>=</span><span> </span><a , class=foo href=/p/scipy/1.8.0/api/scipy.sparse.linalg._isolve.lsqr.lsqr.html>lsqr</a><span>(</span><span>A</span><span>,</span><span> </span><a , class=foo href=/p/numpy/1.22.3/api/numpy.ndarray.html>b</a><span>)</span><span>[</span><span>:</span><span class=mi>4</span><span>]</span><br><span class=nsl>... </span><span>istop</span>
1</pre>
            
            
         
                <pre class="highlight execed"><span class=nsl>>>> </span><span>x</span>
array([ 1., -1.])</pre>
            
            
         
                <pre class="highlight execed"><span class=nsl>>>> </span><span>itn</span>
1</pre>
            
            
         
                <pre class="highlight execed"><span class=nsl>>>> </span><span>r1norm</span>
4.440892098500627e-16</pre>
            
            
         
                
        <p>As indicated by <code>:None:None:`istop=1`</code>, <code><a class=exists href=/p/scipy/1.8.0/api/scipy.sparse.linalg._isolve.lsqr.lsqr.html link>lsqr</a></code>
         found a solution obeying the tolerance limits. The given solution <code>:None:None:`[1., -1.]`</code> obviously solves the equation. The remaining return values include information about the number of iterations (<code>:None:None:`itn=1`</code>) and the remaining difference of left and right side of the solved equation. The final example demonstrates the behavior in the case where there is no solution for the equation:</p>

    
            
            
         
                <pre class="highlight execed"><span class=nsl>>>> </span><a , class=foo href=/p/numpy/1.22.3/api/numpy.ndarray.html>b</a><span> </span><span class=o>=</span><span> </span><a , class=foo href=/p/numpy/1.22.3/api/numpy.html>np</a><span class=o>.</span><a , class=foo href=/p/numpy/1.22.3/api/numpy.array.html>array</a><span>(</span><span>[</span><span class=mf>1.</span><span>,</span><span> </span><span class=mf>0.01</span><span>,</span><span> </span><span class=o>-</span><span class=mf>1.</span><span>]</span><span>,</span><span> </span><span>dtype</span><span class=o>=</span><span class=nb>float</span><span>)</span><br><span class=nsl>... </span><span>x</span><span>,</span><span> </span><span>istop</span><span>,</span><span> </span><span>itn</span><span>,</span><span> </span><span>r1norm</span><span> </span><span class=o>=</span><span> </span><a , class=foo href=/p/scipy/1.8.0/api/scipy.sparse.linalg._isolve.lsqr.lsqr.html>lsqr</a><span>(</span><span>A</span><span>,</span><span> </span><a , class=foo href=/p/numpy/1.22.3/api/numpy.ndarray.html>b</a><span>)</span><span>[</span><span>:</span><span class=mi>4</span><span>]</span><br><span class=nsl>... </span><span>istop</span>
2</pre>
            
            
         
                <pre class="highlight execed"><span class=nsl>>>> </span><span>x</span>
array([ 1.00333333, -0.99666667])</pre>
            
            
         
                <pre class="highlight execed"><span class=nsl>>>> </span><span>A</span><span class=o>.</span><span>dot</span><span>(</span><span>x</span><span>)</span><span class=o>-</span><a , class=foo href=/p/numpy/1.22.3/api/numpy.ndarray.html>b</a>
array([ 0.00333333, -0.00333333,  0.00333333])</pre>
            
            
         
                <pre class="highlight execed"><span class=nsl>>>> </span><span>r1norm</span>
0.005773502691896255</pre>
            
            
         
                
        <p><code><a class=local href=#istop link>istop</a></code> indicates that the system is inconsistent and thus <code><a class=local href=#x link>x</a></code> is rather an approximate solution to the corresponding least-squares problem. <code><a class=local href=#r1norm link>r1norm</a></code> contains the norm of the minimal residual that was found.</p>

    
            
            
         
         See :
     
    


    <h3 id=section-backrefs>Back References</h3>
    <p>The following pages refer to to this document either explicitly or contain code examples using this.</p>

    
    
        <code><a class=exists href=/p/scipy/1.8.0/api/scipy.sparse.linalg._isolve.lsqr.lsqr.html link>scipy.sparse.linalg._isolve.lsqr.lsqr</a></code>
        
    
    
    



<h3>Local connectivity graph</h3>
<p>Hover to see nodes names; edges to Self not shown, Caped at 50 nodes.</p>

<p> Using a canvas is more power efficient and can get hundred of nodes ; but does not allow hyperlinks; , arrows
or text (beyond on hover) </p> 
<canvas class=graph height=500 width=800></canvas>
<p> SVG is more flexible but power hungry; and does not scale well to 50 + nodes. </p> 

<svg class=graph height=500 width=600></svg>

<p>All aboves nodes referred to, (or are referred from) current nodes; Edges from Self to other have been omitted
(or all nodes would be connected to the central node "self" which is not useful). Nodes are colored by the library
they belong to, and scaled with the number of references pointing them</p>


<hr>


    GitHub : <a class=external href=https://github.com/scipy/scipy/blob/v1.8.0//scipy/sparse/linalg/_isolve/lsqr.py#L96>/scipy/sparse/linalg/_isolve/lsqr.py#96</a>
<br>

type: &LTclass 'function'> 
Commit: 
<div>


    
    <script src=https://d3js.org/d3.v4.min.js></script>
    <script src=https://d3js.org/d3-selection-multi.v1.js></script>
        <style>.node {}

        .link { stroke: #999; stroke-opacity: .6; stroke-width: 1px; }</style>
<script>var canvas=document.querySelector("canvas"),context=canvas.getContext("2d"),width=canvas.width,height=canvas.height,searchRadius=40,color=d3.scaleOrdinal().range(d3.schemeCategory10),canvas_simulation=d3.forceSimulation().force("charge",d3.forceManyBody().strength(-100)).force("link",d3.forceLink().distance(30).strength(.1).iterations(1).id(function(e){return e.id})).force("r",d3.forceRadial(150)),canvas_graph={nodes:[{id:1,val:17.486832980505138,label:"scipy.sparse",mod:"scipy",url:"/p/scipy/1.8.0/api/scipy.sparse"},{id:2,val:33.96150997149434,label:"numpy.ndarray",mod:"numpy",url:"/p/numpy/1.22.3/api/numpy.ndarray"},{id:4,val:31.748684174075834,label:"numpy.array",mod:"numpy",url:"/p/numpy/1.22.3/api/numpy.array"},{id:5,val:18.77032961426901,label:"scipy.linalg",mod:"scipy",url:"/p/scipy/1.8.0/api/scipy.linalg"},{id:6,val:12.358898943540673,label:"scipy.sparse._csc.csc_matrix",mod:"scipy",url:"/p/scipy/1.8.0/api/scipy.sparse._csc.csc_matrix"},{id:7,val:44,label:"numpy",mod:"numpy",url:"/p/numpy/1.22.3/api/numpy"},{id:8,val:32.37211521390788,label:"scipy",mod:"scipy",url:"/p/scipy/1.8.0/api/scipy"},{id:9,val:11.464101615137753,label:"scipy.sparse.linalg._isolve.iterative._get_atol",mod:"scipy",url:"/p/scipy/1.8.0/api/scipy.sparse.linalg._isolve.iterative._get_atol"}],links:[{source:8,target:6,id:250},{source:2,target:6,id:858},{source:4,target:2,id:1414},{source:4,target:6,id:1502},{source:1,target:6,id:1915},{source:7,target:2,id:2012},{source:7,target:6,id:2750}]};(function(){var e=d3.nest().key(function(t){return t.mod}).entries(canvas_graph.nodes).sort(function(t,a){return a.values.length-t.values.length}),c=color.domain(e.map(function(t){return t.key}));canvas_simulation.nodes(canvas_graph.nodes).on("tick",i),canvas_simulation.force("link").links(canvas_graph.links),d3.select(canvas).on("mousemove",s).call(d3.drag().container(canvas).subject(r).on("start",dragstarted).on("drag",dragged).on("end",dragended));function i(){context.clearRect(0,0,width,height),context.save(),context.translate(width/2,height/2),context.beginPath(),canvas_graph.links.forEach(drawLink),context.strokeStyle="#aaa",context.stroke();var t=10;e.forEach(function(a){context.beginPath(),a.values.forEach(drawNode),context.fillStyle=color(a.key),context.fill()}),context.restore()}function r(){return canvas_simulation.find(d3.event.x-width/2,d3.event.y-height/2,searchRadius)}function s(){var t=this.parentNode,a=d3.mouse(this),n=canvas_simulation.find(a[0]-width/2,a[1]-height/2,searchRadius);if(!n)return t.removeAttribute("href"),t.removeAttribute("title");t.setAttribute("title",n.label)}})();function dragstarted(){d3.event.active||canvas_simulation.alphaTarget(.3).restart(),d3.event.subject.fx=d3.event.subject.x,d3.event.subject.fy=d3.event.subject.y}function dragged(){d3.event.subject.fx=d3.event.x,d3.event.subject.fy=d3.event.y}function dragended(){d3.event.active||canvas_simulation.alphaTarget(0),d3.event.subject.fx=null,d3.event.subject.fy=null}function drawLink(e){context.moveTo(e.source.x,e.source.y),context.lineTo(e.target.x,e.target.y)}function drawNode(e){context.moveTo(e.x+5,e.y),context.arc(e.x,e.y,e.val,0,2*Math.PI)}</script>
<script>var colors=d3.scaleOrdinal(d3.schemeCategory10),svg=d3.select("svg"),width=svg.attr("width"),height=svg.attr("height"),node,link;svg.append("defs").append("marker").attrs({id:"arrowhead",viewBox:"-0 -5 10 10",refX:13,refY:0,orient:"auto",markerWidth:13,markerHeight:13,xoverflow:"visible"}).append("svg:path").attr("d","M 0,-5 L 10 ,0 L 0,5").attr("fill","#999").style("stroke","none");var svg_simulation=d3.forceSimulation().force("charge",d3.forceManyBody().strength(-30)).force("r",d3.forceRadial(200,width/2,height/2)).force("link",d3.forceLink().distance(80).strength(.01).iterations(10).id(function(t){return t.id})),svg_graph={nodes:[{id:1,val:17.486832980505138,label:"scipy.sparse",mod:"scipy",url:"/p/scipy/1.8.0/api/scipy.sparse"},{id:2,val:33.96150997149434,label:"numpy.ndarray",mod:"numpy",url:"/p/numpy/1.22.3/api/numpy.ndarray"},{id:4,val:31.748684174075834,label:"numpy.array",mod:"numpy",url:"/p/numpy/1.22.3/api/numpy.array"},{id:5,val:18.77032961426901,label:"scipy.linalg",mod:"scipy",url:"/p/scipy/1.8.0/api/scipy.linalg"},{id:6,val:12.358898943540673,label:"scipy.sparse._csc.csc_matrix",mod:"scipy",url:"/p/scipy/1.8.0/api/scipy.sparse._csc.csc_matrix"},{id:7,val:44,label:"numpy",mod:"numpy",url:"/p/numpy/1.22.3/api/numpy"},{id:8,val:32.37211521390788,label:"scipy",mod:"scipy",url:"/p/scipy/1.8.0/api/scipy"},{id:9,val:11.464101615137753,label:"scipy.sparse.linalg._isolve.iterative._get_atol",mod:"scipy",url:"/p/scipy/1.8.0/api/scipy.sparse.linalg._isolve.iterative._get_atol"}],links:[{source:8,target:6,id:250},{source:2,target:6,id:858},{source:4,target:2,id:1414},{source:4,target:6,id:1502},{source:1,target:6,id:1915},{source:7,target:2,id:2012},{source:7,target:6,id:2750}]};(function(t,r){if(t)throw t;r.nodes.forEach(function(e){e.x=width*Math.random(),e.y=height*Math.random()}),update(r.links,r.nodes)})(null,svg_graph);var edgelabels;function update(t,r){link=svg.selectAll(".link").data(t).enter().append("line").attr("class","link").attr("marker-end","url(#arrowhead)"),edgepaths=svg.selectAll(".edgepath").data(t).enter().append("path").attrs({class:"edgepath","fill-opacity":0,"stroke-opacity":0,id:function(e,a){return"edgepath"+a}}).style("pointer-events","none"),edgelabels=svg.selectAll(".edgelabel").data(t).enter().append("text").style("pointer-events","none").attrs({class:"edgelabel",id:function(e,a){return"edgelabel"+a},"font-size":10,fill:"#aaa"}),edgelabels.append("textPath").attr("xlink:href",function(e,a){return"#edgepath"+a}).style("text-anchor","middle").style("pointer-events","none").attr("startOffset","50%").text(function(e){return e.type}),node=svg.selectAll(".node").data(r).enter().append("g").attr("class","node").call(d3.drag().on("start",dragstarted).on("drag",dragged).on("end",dragended)),node.append("a").attr("xlink:href",function(e){return e.url}).append("circle").attr("r",function(e){return e.val}).style("fill",function(e,a){return colors(e.mod)}).style("stroke","#FFF"),node.append("title").text(function(e){return e.label}),node.append("text").attr("dy",10).attr("opacity","0.5").text(function(e){return arr=e.label.split("."),arr[arr.length-1]}),svg_simulation.nodes(r).on("tick",ticked),svg_simulation.force("link").links(t)}function ticked(){link.attr("x1",function(t){return t.source.x}).attr("y1",function(t){return t.source.y}).attr("x2",function(t){return t.target.x}).attr("y2",function(t){return t.target.y}),node.attr("transform",function(t){return"translate("+t.x+", "+t.y+")"}),edgepaths.attr("d",function(t){return"M "+t.source.x+" "+t.source.y+" L "+t.target.x+" "+t.target.y}),edgelabels.attr("transform",function(t){if(t.target.x<t.source.x){var r=this.getBBox();return rx=r.x+r.width/2,ry=r.y+r.height/2,"rotate(180 "+rx+" "+ry+")"}else return"rotate(0)"})}function dragstarted(t){d3.event.active||svg_simulation.alphaTarget(.3).restart(),t.fx=t.x,t.fy=t.y}function dragged(t){t.fx=d3.event.x,t.fy=d3.event.y}function dragended(t){d3.event.active||svg_simulation.alphaTarget(0),t.fx=null,t.fy=null}</script>




</div>

