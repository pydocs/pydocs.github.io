<!doctypehtml><html lang=en><meta charset=UTF-8><meta content=width=device-width,initial-scale=1.0 name=viewport><title>Document</title><link href=https://fonts.xz.style/serve/inter.css rel=stylesheet><link crossorigin=anonymous href=https://use.fontawesome.com/releases/v5.8.1/css/all.css integrity=sha384-50oBUHEmvpQ+1lW4y57PTFmhCaXp0ML5d60M1M7uH2+nqUivzIebhndOJK28anvf rel=stylesheet><link href=https://cdn.jsdelivr.net/npm/@exampledev/new.css@1.1.2/new.min.css rel=stylesheet><script type=text/x-mathjax-config>
        // this should process only math inside  span with tex2jax_process class
    MathJax.Hub.Config({
        extensions: ["tex2jax.js"],
        jax: ["input/TeX", "output/HTML-CSS"],
        tex2jax: {
        inlineMath: [ ['$','$'], ["\\(","\\)"] ],
        displayMath: [ ['$$','$$'], ["\\[","\\]"] ],
        processEscapes: true
        },
        "HTML-CSS": { fonts: ["TeX"] }
    });
    </script><script async src=https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/MathJax.js></script><link href=/papyri.css rel=stylesheet><style>header > brand, header>:first-child {
        border-right: 1px solid #ccc;
        border-left: 1px solid #ccc;
        padding: 16px;
        padding-top: 0.5rem;
        padding-bottom: 0.5rem;
        display: inline-block; 
        width: 167px;
    }
    pre { line-height: 125%; }
td.linenos .normal { color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px; }
span.linenos { color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px; }
td.linenos .special { color: #000000; background-color: #ffffc0; padding-left: 5px; padding-right: 5px; }
span.linenos.special { color: #000000; background-color: #ffffc0; padding-left: 5px; padding-right: 5px; }
.highlight .hll { background-color: #ffffcc }
.highlight { background: #ffffff; }
.highlight .c { color: #888888 } /* Comment */
.highlight .err { color: #a61717; background-color: #e3d2d2 } /* Error */
.highlight .k { color: #008800; font-weight: bold } /* Keyword */
.highlight .ch { color: #888888 } /* Comment.Hashbang */
.highlight .cm { color: #888888 } /* Comment.Multiline */
.highlight .cp { color: #cc0000; font-weight: bold } /* Comment.Preproc */
.highlight .cpf { color: #888888 } /* Comment.PreprocFile */
.highlight .c1 { color: #888888 } /* Comment.Single */
.highlight .cs { color: #cc0000; font-weight: bold; background-color: #fff0f0 } /* Comment.Special */
.highlight .gd { color: #000000; background-color: #ffdddd } /* Generic.Deleted */
.highlight .ge { font-style: italic } /* Generic.Emph */
.highlight .gr { color: #aa0000 } /* Generic.Error */
.highlight .gh { color: #333333 } /* Generic.Heading */
.highlight .gi { color: #000000; background-color: #ddffdd } /* Generic.Inserted */
.highlight .go { color: #888888 } /* Generic.Output */
.highlight .gp { color: #555555 } /* Generic.Prompt */
.highlight .gs { font-weight: bold } /* Generic.Strong */
.highlight .gu { color: #666666 } /* Generic.Subheading */
.highlight .gt { color: #aa0000 } /* Generic.Traceback */
.highlight .kc { color: #008800; font-weight: bold } /* Keyword.Constant */
.highlight .kd { color: #008800; font-weight: bold } /* Keyword.Declaration */
.highlight .kn { color: #008800; font-weight: bold } /* Keyword.Namespace */
.highlight .kp { color: #008800 } /* Keyword.Pseudo */
.highlight .kr { color: #008800; font-weight: bold } /* Keyword.Reserved */
.highlight .kt { color: #888888; font-weight: bold } /* Keyword.Type */
.highlight .m { color: #0000DD; font-weight: bold } /* Literal.Number */
.highlight .s { color: #dd2200; background-color: #fff0f0 } /* Literal.String */
.highlight .na { color: #336699 } /* Name.Attribute */
.highlight .nb { color: #003388 } /* Name.Builtin */
.highlight .nc { color: #bb0066; font-weight: bold } /* Name.Class */
.highlight .no { color: #003366; font-weight: bold } /* Name.Constant */
.highlight .nd { color: #555555 } /* Name.Decorator */
.highlight .ne { color: #bb0066; font-weight: bold } /* Name.Exception */
.highlight .nf { color: #0066bb; font-weight: bold } /* Name.Function */
.highlight .nl { color: #336699; font-style: italic } /* Name.Label */
.highlight .nn { color: #bb0066; font-weight: bold } /* Name.Namespace */
.highlight .py { color: #336699; font-weight: bold } /* Name.Property */
.highlight .nt { color: #bb0066; font-weight: bold } /* Name.Tag */
.highlight .nv { color: #336699 } /* Name.Variable */
.highlight .ow { color: #008800 } /* Operator.Word */
.highlight .w { color: #bbbbbb } /* Text.Whitespace */
.highlight .mb { color: #0000DD; font-weight: bold } /* Literal.Number.Bin */
.highlight .mf { color: #0000DD; font-weight: bold } /* Literal.Number.Float */
.highlight .mh { color: #0000DD; font-weight: bold } /* Literal.Number.Hex */
.highlight .mi { color: #0000DD; font-weight: bold } /* Literal.Number.Integer */
.highlight .mo { color: #0000DD; font-weight: bold } /* Literal.Number.Oct */
.highlight .sa { color: #dd2200; background-color: #fff0f0 } /* Literal.String.Affix */
.highlight .sb { color: #dd2200; background-color: #fff0f0 } /* Literal.String.Backtick */
.highlight .sc { color: #dd2200; background-color: #fff0f0 } /* Literal.String.Char */
.highlight .dl { color: #dd2200; background-color: #fff0f0 } /* Literal.String.Delimiter */
.highlight .sd { color: #dd2200; background-color: #fff0f0 } /* Literal.String.Doc */
.highlight .s2 { color: #dd2200; background-color: #fff0f0 } /* Literal.String.Double */
.highlight .se { color: #0044dd; background-color: #fff0f0 } /* Literal.String.Escape */
.highlight .sh { color: #dd2200; background-color: #fff0f0 } /* Literal.String.Heredoc */
.highlight .si { color: #3333bb; background-color: #fff0f0 } /* Literal.String.Interpol */
.highlight .sx { color: #22bb22; background-color: #f0fff0 } /* Literal.String.Other */
.highlight .sr { color: #008800; background-color: #fff0ff } /* Literal.String.Regex */
.highlight .s1 { color: #dd2200; background-color: #fff0f0 } /* Literal.String.Single */
.highlight .ss { color: #aa6600; background-color: #fff0f0 } /* Literal.String.Symbol */
.highlight .bp { color: #003388 } /* Name.Builtin.Pseudo */
.highlight .fm { color: #0066bb; font-weight: bold } /* Name.Function.Magic */
.highlight .vc { color: #336699 } /* Name.Variable.Class */
.highlight .vg { color: #dd7700 } /* Name.Variable.Global */
.highlight .vi { color: #3333bb } /* Name.Variable.Instance */
.highlight .vm { color: #336699 } /* Name.Variable.Magic */
.highlight .il { color: #0000DD; font-weight: bold } /* Literal.Number.Integer.Long */</style></head><body class=tex2jax_ignore><header><brand><i class="fab fa-python"></i><a href=/>Home</a></brand><nav>/ <a href=/>p</a>  /  <div class=dropdown><a href=scipy>scipy</a> /  <div class=dropdown-content><a href=/p/IPython/8.2.0.dev/api/IPython.html>IPython</a><a href=/p/astropy/5.0/api/astropy.html>astropy</a><a href=/p/dask/2021.10.0/api/dask.html>dask</a><a href=/p/distributed/2021.10.0/api/distributed.html>distributed</a><a href=/p/matplotlib/3.5.1/api/matplotlib.html>matplotlib</a><a href=/p/networkx/2.7.2rc1.dev0/api/networkx.html>networkx</a><a href=/p/numpy/1.22.3/api/numpy.html>numpy</a><a href=/p/pandas/1.4.1/api/pandas.html>pandas</a><a href=/p/papyri/0.0.8/api/papyri.html>papyri</a><a href=/p/scipy/1.8.0/api/scipy.html>scipy</a><a href=/p/skimage/0.17.2/api/skimage.html>skimage</a></div></div><div class=dropdown><a href=/p/scipy/1.8.0/api/scipy.html>1.8.0</a> /  <div class=dropdown-content><a href=/p/scipy/1.8.0/api/scipy.html>1.8.0</a></div></div><div class=dropdown><a href=/p/scipy/1.8.0/api/scipy.html>api</a> /  <div class=dropdown-content><a href=/p/scipy/1.8.0/api/scipy.html>API</a><a href=/p/scipy/1.8.0/gallery>Gallery</a><a href=/p/scipy/1.8.0/examples>Examples</a></div></div><div class=dropdown><a class=dropbtn href=scipy.html>scipy</a>.</div><div class=dropdown><a class=dropbtn href=scipy.linalg.html>linalg</a>. <div class=dropdown-content><a href=/p/?/?/api/scipy._lib.html>_lib</a><a href=/p/scipy/1.8.0/api/scipy.fft.html>fft</a><a href=/p/scipy/1.8.0/api/scipy.integrate.html>integrate</a><a href=/p/scipy/1.8.0/api/scipy.interpolate.html>interpolate</a><a href=/p/scipy/1.8.0/api/scipy.linalg.html>linalg</a><a href=/p/?/?/api/scipy.ndimage.html>ndimage</a><a href=/p/scipy/1.8.0/api/scipy.optimize.html>optimize</a><a href=/p/scipy/1.8.0/api/scipy.signal.html>signal</a><a href=/p/scipy/1.8.0/api/scipy.sparse.html>sparse</a><a href=/p/scipy/1.8.0/api/scipy.spatial.html>spatial</a><a href=/p/scipy/1.8.0/api/scipy.special.html>special</a><a href=/p/?/?/api/scipy.stats.html>stats</a></div></div><div class=dropdown><a class=dropbtn href=scipy.linalg._basic.html>_basic</a>. <div class=dropdown-content><a href=/p/scipy/1.8.0/api/scipy.linalg._basic.html>_basic</a><a href=/p/scipy/1.8.0/api/scipy.linalg._cythonized_array_utils.html>_cythonized_array_utils</a><a href=/p/scipy/1.8.0/api/scipy.linalg._decomp.html>_decomp</a><a href=/p/scipy/1.8.0/api/scipy.linalg._decomp_cholesky.html>_decomp_cholesky</a><a href=/p/scipy/1.8.0/api/scipy.linalg._decomp_cossin.html>_decomp_cossin</a><a href=/p/scipy/1.8.0/api/scipy.linalg._decomp_ldl.html>_decomp_ldl</a><a href=/p/scipy/1.8.0/api/scipy.linalg._decomp_lu.html>_decomp_lu</a><a href=/p/scipy/1.8.0/api/scipy.linalg._decomp_polar.html>_decomp_polar</a><a href=/p/scipy/1.8.0/api/scipy.linalg._decomp_qr.html>_decomp_qr</a><a href=/p/scipy/1.8.0/api/scipy.linalg._decomp_qz.html>_decomp_qz</a><a href=/p/scipy/1.8.0/api/scipy.linalg._decomp_schur.html>_decomp_schur</a><a href=/p/scipy/1.8.0/api/scipy.linalg._decomp_svd.html>_decomp_svd</a><a href=/p/scipy/1.8.0/api/scipy.linalg._decomp_update.html>_decomp_update</a><a href=/p/scipy/1.8.0/api/scipy.linalg._expm_frechet.html>_expm_frechet</a><a href=/p/scipy/1.8.0/api/scipy.linalg._fblas.html>_fblas</a><a href=/p/scipy/1.8.0/api/scipy.linalg._flapack.html>_flapack</a><a href=/p/scipy/1.8.0/api/scipy.linalg._flinalg.html>_flinalg</a><a href=/p/scipy/1.8.0/api/scipy.linalg._flinalg_py.html>_flinalg_py</a><a href=/p/scipy/1.8.0/api/scipy.linalg._interpolative.html>_interpolative</a><a href=/p/scipy/1.8.0/api/scipy.linalg._interpolative_backend.html>_interpolative_backend</a><a href=/p/scipy/1.8.0/api/scipy.linalg._matfuncs.html>_matfuncs</a><a href=/p/scipy/1.8.0/api/scipy.linalg._matfuncs_sqrtm.html>_matfuncs_sqrtm</a><a href=/p/scipy/1.8.0/api/scipy.linalg._matfuncs_sqrtm_triu.html>_matfuncs_sqrtm_triu</a><a href=/p/scipy/1.8.0/api/scipy.linalg._misc.html>_misc</a><a href=/p/scipy/1.8.0/api/scipy.linalg._procrustes.html>_procrustes</a><a href=/p/scipy/1.8.0/api/scipy.linalg._sketches.html>_sketches</a><a href=/p/scipy/1.8.0/api/scipy.linalg._solve_toeplitz.html>_solve_toeplitz</a><a href=/p/scipy/1.8.0/api/scipy.linalg._solvers.html>_solvers</a><a href=/p/scipy/1.8.0/api/scipy.linalg._special_matrices.html>_special_matrices</a><a href=/p/scipy/1.8.0/api/scipy.linalg.basic.html>basic</a><a href=/p/scipy/1.8.0/api/scipy.linalg.blas.html>blas</a><a href=/p/scipy/1.8.0/api/scipy.linalg.cython_blas.html>cython_blas</a><a href=/p/scipy/1.8.0/api/scipy.linalg.cython_lapack.html>cython_lapack</a><a href=/p/scipy/1.8.0/api/scipy.linalg.decomp.html>decomp</a><a href=/p/scipy/1.8.0/api/scipy.linalg.decomp_cholesky.html>decomp_cholesky</a><a href=/p/scipy/1.8.0/api/scipy.linalg.decomp_lu.html>decomp_lu</a><a href=/p/scipy/1.8.0/api/scipy.linalg.decomp_qr.html>decomp_qr</a><a href=/p/scipy/1.8.0/api/scipy.linalg.decomp_schur.html>decomp_schur</a><a href=/p/scipy/1.8.0/api/scipy.linalg.decomp_svd.html>decomp_svd</a><a href=/p/scipy/1.8.0/api/scipy.linalg.flinalg.html>flinalg</a><a href=/p/scipy/1.8.0/api/scipy.linalg.interpolative.html>interpolative</a><a href=/p/scipy/1.8.0/api/scipy.linalg.lapack.html>lapack</a><a href=/p/scipy/1.8.0/api/scipy.linalg.matfuncs.html>matfuncs</a><a href=/p/scipy/1.8.0/api/scipy.linalg.misc.html>misc</a><a href=/p/scipy/1.8.0/api/scipy.linalg.special_matrices.html>special_matrices</a></div></div><div class=dropdown><a class=dropbtn href=scipy.linalg._basic.solve_circulant.html>solve_circulant</a><div class=dropdown-content><a href=/p/scipy/1.8.0/api/scipy.linalg._basic._get_axis_len.html>_get_axis_len</a><a href=/p/scipy/1.8.0/api/scipy.linalg._basic._solve_check.html>_solve_check</a><a href=/p/scipy/1.8.0/api/scipy.linalg._basic._validate_args_for_toeplitz_ops.html>_validate_args_for_toeplitz_ops</a><a href=/p/scipy/1.8.0/api/scipy.linalg._basic.det.html>det</a><a href=/p/scipy/1.8.0/api/scipy.linalg._basic.inv.html>inv</a><a href=/p/scipy/1.8.0/api/scipy.linalg._basic.lstsq.html>lstsq</a><a href=/p/scipy/1.8.0/api/scipy.linalg._basic.matmul_toeplitz.html>matmul_toeplitz</a><a href=/p/scipy/1.8.0/api/scipy.linalg._basic.matrix_balance.html>matrix_balance</a><a href=/p/scipy/1.8.0/api/scipy.linalg._basic.pinv.html>pinv</a><a href=/p/scipy/1.8.0/api/scipy.linalg._basic.pinv2.html>pinv2</a><a href=/p/scipy/1.8.0/api/scipy.linalg._basic.pinvh.html>pinvh</a><a href=/p/scipy/1.8.0/api/scipy.linalg._basic.solve.html>solve</a><a href=/p/scipy/1.8.0/api/scipy.linalg._basic.solve_banded.html>solve_banded</a><a href=/p/scipy/1.8.0/api/scipy.linalg._basic.solve_circulant.html>solve_circulant</a><a href=/p/scipy/1.8.0/api/scipy.linalg._basic.solve_toeplitz.html>solve_toeplitz</a><a href=/p/scipy/1.8.0/api/scipy.linalg._basic.solve_triangular.html>solve_triangular</a><a href=/p/scipy/1.8.0/api/scipy.linalg._basic.solveh_banded.html>solveh_banded</a></div></div></nav></header><div class=container><div class=sidenav><img src=/p/scipy/1.8.0/img/logo.png><a href=#>scipy</a><a href=#>1.8.0</a><a class=external href=https://pypi.org/project/scipy>Pypi</a><a class=external href=https://github.com/scipy/scipy>GitHub</a><a class=external href=https://scipy.org/>Homepage</a><hr><a class=external href=https://docs.scipy.org/doc/scipy/>Other Docs</a><hr><a href=#section-Notes>Notes</a><a href=#section-Parameters>Parameters</a><a href=#section-Raises>Raises</a><a href=#section-Returns>Returns</a><a href=#section-backrefs>BackRef</a></div><code class=signature>solve_circulant(c, b, singular='raise', tol=None, caxis=-1, baxis=0, outaxis=0)</code><p><code>:None:None:`C`</code> is the circulant matrix associated with the vector <code><a class=local href=#c link>c</a></code>.</p><p>The system is solved by doing division in Fourier space. The calculation is::</p><pre>x = ifft(fft(b) / fft(c))</pre><p>where <code><a class=exists href=/p/scipy/1.8.0/api/scipy.fft.html link>fft</a></code> and <code><a class=exists href=/p/scipy/1.8.0/api/scipy.fft._basic.ifft.html link>ifft</a></code> are the fast Fourier transform and its inverse, respectively. For a large vector <code><a class=local href=#c link>c</a></code>, this is <em>much</em> faster than solving the system with the full circulant matrix.</p><h3 id=section-Notes>Notes</h3><p>For a 1-D vector <code><a class=local href=#c link>c</a></code> with length <code>:None:None:`m`</code>, and an array <code><a class=local href=#b link>b</a></code> with shape <code class=verbatim>(m, ...)</code> ,</p><pre>solve_circulant(c, b)
</pre><p>returns the same result as</p><pre>solve(circulant(c), b)
</pre><p>where <code><a class=exists href=/p/scipy/1.8.0/api/scipy.linalg._basic.solve.html link>solve</a></code> and <code><a class=exists href=/p/scipy/1.8.0/api/scipy.linalg._special_matrices.circulant.html link>circulant</a></code> are from <code><a class=exists href=/p/scipy/1.8.0/api/scipy.linalg.html link>scipy.linalg</a></code> .</p><div class=admonition><div>versionadded</div><p>0.16.0</p></div><h3 id=section-Parameters>Parameters</h3><dl><dt><a id=c>c</a> : array_like</dt><dd><p>The coefficients of the circulant matrix.</p></dd><dt><a id=b>b</a> : array_like</dt><dd><p>Right-hand side matrix in <code class=verbatim>a x = b</code> .</p></dd><dt><a id=singular>singular</a> : str, optional</dt><dd><p>This argument controls how a near singular circulant matrix is handled. If <code><a class=local href=#singular link>singular</a></code> is "raise" and the circulant matrix is near singular, a <code>:None:None:`LinAlgError`</code> is raised. If <code><a class=local href=#singular link>singular</a></code> is "lstsq", the least squares solution is returned. Default is "raise".</p></dd><dt><a id=tol>tol</a> : float, optional</dt><dd><p>If any eigenvalue of the circulant matrix has an absolute value that is less than or equal to <code><a class=local href=#tol link>tol</a></code>, the matrix is considered to be near singular. If not given, <code><a class=local href=#tol link>tol</a></code> is set to::</p> <pre>tol = abs_eigs.max() * abs_eigs.size * np.finfo(np.float64).eps</pre> <p>where <code>:None:None:`abs_eigs`</code> is the array of absolute values of the eigenvalues of the circulant matrix.</p></dd><dt><a id=caxis>caxis</a> : int</dt><dd><p>When <code><a class=local href=#c link>c</a></code> has dimension greater than 1, it is viewed as a collection of circulant vectors. In this case, <code><a class=local href=#caxis link>caxis</a></code> is the axis of <code><a class=local href=#c link>c</a></code> that holds the vectors of circulant coefficients.</p></dd><dt><a id=baxis>baxis</a> : int</dt><dd><p>When <code><a class=local href=#b link>b</a></code> has dimension greater than 1, it is viewed as a collection of vectors. In this case, <code><a class=local href=#baxis link>baxis</a></code> is the axis of <code><a class=local href=#b link>b</a></code> that holds the right-hand side vectors.</p></dd><dt><a id=outaxis>outaxis</a> : int</dt><dd><p>When <code><a class=local href=#c link>c</a></code> or <code><a class=local href=#b link>b</a></code> are multidimensional, the value returned by <code><a class=exists href=/p/scipy/1.8.0/api/scipy.linalg._basic.solve_circulant.html link>solve_circulant</a></code> is multidimensional. In this case, <code><a class=local href=#outaxis link>outaxis</a></code> is the axis of the result that holds the solution vectors.</p></dd></dl><h3 id=section-Raises>Raises</h3><dl><dt>LinAlgError</dt><dd><p>If the circulant matrix associated with <code><a class=local href=#c link>c</a></code> is near singular.</p></dd></dl><h3 id=section-Returns>Returns</h3><dl><dt><a id=x>x</a> : ndarray</dt><dd><p>Solution to the system <code class=verbatim>C x = b</code> .</p></dd></dl><p>Solve C x = b for x, where C is a circulant matrix.</p><h3 id=section-Examples>Examples</h3><pre class="highlight execed"><span class=nsl>>>> </span><span class=kn>from</span><span> </span><a class="foo nn"href=/p/scipy/1.8.0/api/scipy.html>scipy</a><span class=nn>.</span><a class="foo nn"href=/p/scipy/1.8.0/api/scipy.linalg.html>linalg</a><span> </span><span class=kn>import</span><span> </span><a class=foo href=/p/scipy/1.8.0/api/scipy.linalg._basic.solve_circulant.html>solve_circulant</a><span>,</span><span> </span><a class=foo href=/p/scipy/1.8.0/api/scipy.linalg._basic.solve.html>solve</a><span>,</span><span> </span><a class=foo href=/p/scipy/1.8.0/api/scipy.linalg._special_matrices.circulant.html>circulant</a><span>,</span><span> </span><a class=foo href=/p/scipy/1.8.0/api/scipy.linalg._basic.lstsq.html>lstsq</a>
</pre><pre class="highlight execed"><span class=nsl>>>> </span><a class=foo href=/p/numpy/1.22.3/api/numpy.ndarray.html>c</a><span> </span><span class=o>=</span><span> </span><a class=foo href=/p/numpy/1.22.3/api/numpy.html>np</a><span class=o>.</span><a class=foo href=/p/numpy/1.22.3/api/numpy.array.html>array</a><span>(</span><span>[</span><span class=mi>2</span><span>,</span><span> </span><span class=mi>2</span><span>,</span><span> </span><span class=mi>4</span><span>]</span><span>)</span><br><span class=nsl>... </span><a class=foo href=/p/numpy/1.22.3/api/numpy.ndarray.html>b</a><span> </span><span class=o>=</span><span> </span><a class=foo href=/p/numpy/1.22.3/api/numpy.html>np</a><span class=o>.</span><a class=foo href=/p/numpy/1.22.3/api/numpy.array.html>array</a><span>(</span><span>[</span><span class=mi>1</span><span>,</span><span> </span><span class=mi>2</span><span>,</span><span> </span><span class=mi>3</span><span>]</span><span>)</span><br><span class=nsl>... </span><a class=foo href=/p/scipy/1.8.0/api/scipy.linalg._basic.solve_circulant.html>solve_circulant</a><span>(</span><a class=foo href=/p/numpy/1.22.3/api/numpy.ndarray.html>c</a><span>,</span><span> </span><a class=foo href=/p/numpy/1.22.3/api/numpy.ndarray.html>b</a><span>)</span>
array([ 0.75, -0.25,  0.25])</pre><p>Compare that result to solving the system with <code><a class=exists href=/p/scipy/*/api/scipy.linalg._basic.solve.html link>scipy.linalg.solve</a></code> :</p><pre class="highlight execed"><span class=nsl>>>> </span><a class=foo href=/p/scipy/1.8.0/api/scipy.linalg._basic.solve.html>solve</a><span>(</span><a class=foo href=/p/scipy/1.8.0/api/scipy.linalg._special_matrices.circulant.html>circulant</a><span>(</span><a class=foo href=/p/numpy/1.22.3/api/numpy.ndarray.html>c</a><span>)</span><span>,</span><span> </span><a class=foo href=/p/numpy/1.22.3/api/numpy.ndarray.html>b</a><span>)</span>
array([ 0.75, -0.25,  0.25])</pre><p>A singular example:</p><pre class="highlight execed"><span class=nsl>>>> </span><a class=foo href=/p/numpy/1.22.3/api/numpy.ndarray.html>c</a><span> </span><span class=o>=</span><span> </span><a class=foo href=/p/numpy/1.22.3/api/numpy.html>np</a><span class=o>.</span><a class=foo href=/p/numpy/1.22.3/api/numpy.array.html>array</a><span>(</span><span>[</span><span class=mi>1</span><span>,</span><span> </span><span class=mi>1</span><span>,</span><span> </span><span class=mi>0</span><span>,</span><span> </span><span class=mi>0</span><span>]</span><span>)</span><br><span class=nsl>... </span><a class=foo href=/p/numpy/1.22.3/api/numpy.ndarray.html>b</a><span> </span><span class=o>=</span><span> </span><a class=foo href=/p/numpy/1.22.3/api/numpy.html>np</a><span class=o>.</span><a class=foo href=/p/numpy/1.22.3/api/numpy.array.html>array</a><span>(</span><span>[</span><span class=mi>1</span><span>,</span><span> </span><span class=mi>2</span><span>,</span><span> </span><span class=mi>3</span><span>,</span><span> </span><span class=mi>4</span><span>]</span><span>)</span>
</pre><p>Calling <code class=verbatim>solve_circulant(c, b)</code> will raise a <code>:None:None:`LinAlgError`</code>. For the least square solution, use the option <code class=verbatim>singular='lstsq'</code> :</p><pre class="highlight execed"><span class=nsl>>>> </span><a class=foo href=/p/scipy/1.8.0/api/scipy.linalg._basic.solve_circulant.html>solve_circulant</a><span>(</span><a class=foo href=/p/numpy/1.22.3/api/numpy.ndarray.html>c</a><span>,</span><span> </span><a class=foo href=/p/numpy/1.22.3/api/numpy.ndarray.html>b</a><span>,</span><span> </span><span>singular</span><span class=o>=</span><span class=s1>'</span><a class="foo s1"href=/p/scipy/1.8.0/api/scipy.linalg._basic.lstsq.html>lstsq</a><span class=s1>'</span><span>)</span>
array([ 0.25,  1.25,  2.25,  1.25])</pre><p>Compare to <code><a class=exists href=/p/scipy/*/api/scipy.linalg._basic.lstsq.html link>scipy.linalg.lstsq</a></code> :</p><pre class="highlight execed"><span class=nsl>>>> </span><span>x</span><span>,</span><span> </span><span>resid</span><span>,</span><span> </span><span>rnk</span><span>,</span><span> </span><span>s</span><span> </span><span class=o>=</span><span> </span><a class=foo href=/p/scipy/1.8.0/api/scipy.linalg._basic.lstsq.html>lstsq</a><span>(</span><a class=foo href=/p/scipy/1.8.0/api/scipy.linalg._special_matrices.circulant.html>circulant</a><span>(</span><a class=foo href=/p/numpy/1.22.3/api/numpy.ndarray.html>c</a><span>)</span><span>,</span><span> </span><a class=foo href=/p/numpy/1.22.3/api/numpy.ndarray.html>b</a><span>)</span><br><span class=nsl>... </span><a class=foo href=/p/numpy/1.22.3/api/numpy.ndarray.html>x</a>
array([ 0.25,  1.25,  2.25,  1.25])</pre><p>A broadcasting example:</p><p>Suppose we have the vectors of two circulant matrices stored in an array with shape (2, 5), and three <code><a class=local href=#b link>b</a></code> vectors stored in an array with shape (3, 5). For example,</p><pre class="highlight execed"><span class=nsl>>>> </span><a class=foo href=/p/numpy/1.22.3/api/numpy.ndarray.html>c</a><span> </span><span class=o>=</span><span> </span><a class=foo href=/p/numpy/1.22.3/api/numpy.html>np</a><span class=o>.</span><a class=foo href=/p/numpy/1.22.3/api/numpy.array.html>array</a><span>(</span><span>[</span><span>[</span><span class=mf>1.5</span><span>,</span><span> </span><span class=mi>2</span><span>,</span><span> </span><span class=mi>3</span><span>,</span><span> </span><span class=mi>0</span><span>,</span><span> </span><span class=mi>0</span><span>]</span><span>,</span><span> </span><span>[</span><span class=mi>1</span><span>,</span><span> </span><span class=mi>1</span><span>,</span><span> </span><span class=mi>4</span><span>,</span><span> </span><span class=mi>3</span><span>,</span><span> </span><span class=mi>2</span><span>]</span><span>]</span><span>)</span><br><span class=nsl>... </span><span>b</span><span> </span><span class=o>=</span><span> </span><a class=foo href=/p/numpy/1.22.3/api/numpy.html>np</a><span class=o>.</span><a class=foo href=/p/numpy/1.22.3/api/numpy.arange.html>arange</a><span>(</span><a class="foo mi"href=/p/scipy/1.8.0/api/scipy.integrate._quad_vec._quadrature_gk15.html>15</a><span>)</span><span class=o>.</span><span>reshape</span><span>(</span><span class=o>-</span><span class=mi>1</span><span>,</span><span> </span><span class=mi>5</span><span>)</span>
</pre><p>We want to solve all combinations of circulant matrices and <code><a class=local href=#b link>b</a></code> vectors, with the result stored in an array with shape (2, 3, 5). When we disregard the axes of <code><a class=local href=#c link>c</a></code> and <code><a class=local href=#b link>b</a></code> that hold the vectors of coefficients, the shapes of the collections are (2,) and (3,), respectively, which are not compatible for broadcasting. To have a broadcast result with shape (2, 3), we add a trivial dimension to <code><a class=local href=#c link>c</a></code>: <code class=verbatim>c[:, np.newaxis, :]</code> has shape (2, 1, 5). The last dimension holds the coefficients of the circulant matrices, so when we call <code><a class=exists href=/p/scipy/1.8.0/api/scipy.linalg._basic.solve_circulant.html link>solve_circulant</a></code> , we can use the default <code class=verbatim>caxis=-1</code> . The coefficients of the <code><a class=local href=#b link>b</a></code> vectors are in the last dimension of the array <code><a class=local href=#b link>b</a></code>, so we use <code class=verbatim>baxis=-1</code> . If we use the default <code><a class=local href=#outaxis link>outaxis</a></code>, the result will have shape (5, 2, 3), so we'll use <code class=verbatim>outaxis=-1</code> to put the solution vectors in the last dimension.</p><pre class="highlight execed"><span class=nsl>>>> </span><a class=foo href=/p/numpy/1.22.3/api/numpy.ndarray.html>x</a><span> </span><span class=o>=</span><span> </span><a class=foo href=/p/scipy/1.8.0/api/scipy.linalg._basic.solve_circulant.html>solve_circulant</a><span>(</span><a class=foo href=/p/numpy/1.22.3/api/numpy.ndarray.html>c</a><span>[</span><span>:</span><span>,</span><span> </span><a class=foo href=/p/numpy/1.22.3/api/numpy.html>np</a><span class=o>.</span><span>newaxis</span><span>,</span><span> </span><span>:</span><span>]</span><span>,</span><span> </span><a class=foo href=/p/numpy/1.22.3/api/numpy.ndarray.html>b</a><span>,</span><span> </span><span>baxis</span><span class=o>=</span><span class=o>-</span><span class=mi>1</span><span>,</span><span> </span><span>outaxis</span><span class=o>=</span><span class=o>-</span><span class=mi>1</span><span>)</span><br><span class=nsl>... </span><a class=foo href=/p/numpy/1.22.3/api/numpy.ndarray.html>x</a><span class=o>.</span><span>shape</span>
(2, 3, 5)</pre><pre class="highlight execed"><span class=nsl>>>> </span><a class=foo href=/p/numpy/1.22.3/api/numpy.html>np</a><span class=o>.</span><a class=foo href=/p/numpy/1.22.3/api/numpy.set_printoptions.html>set_printoptions</a><span>(</span><a class=foo href=/p/scipy/1.8.0/api/scipy.optimize._shgo.SHGO.finite_precision.html>precision</a><span class=o>=</span><span class=mi>3</span><span>)</span><span>  </span><span class=c1># For compact output of numbers.</span><br><span class=nsl>... </span><a class=foo href=/p/numpy/1.22.3/api/numpy.ndarray.html>x</a>
array([[[-0.118,  0.22 ,  1.277, -0.142,  0.302],
        [ 0.651,  0.989,  2.046,  0.627,  1.072],
        [ 1.42 ,  1.758,  2.816,  1.396,  1.841]],
       [[ 0.401,  0.304,  0.694, -0.867,  0.377],
        [ 0.856,  0.758,  1.149, -0.412,  0.831],
        [ 1.31 ,  1.213,  1.603,  0.042,  1.286]]])</pre><p>Check by solving one pair of <code><a class=local href=#c link>c</a></code> and <code><a class=local href=#b link>b</a></code> vectors (cf. <code class=verbatim>x[1, 1, :]</code> ):</p><pre class="highlight execed"><span class=nsl>>>> </span><a class=foo href=/p/scipy/1.8.0/api/scipy.linalg._basic.solve_circulant.html>solve_circulant</a><span>(</span><a class=foo href=/p/numpy/1.22.3/api/numpy.ndarray.html>c</a><span>[</span><span class=mi>1</span><span>]</span><span>,</span><span> </span><a class=foo href=/p/numpy/1.22.3/api/numpy.ndarray.html>b</a><span>[</span><span class=mi>1</span><span>,</span><span> </span><span>:</span><span>]</span><span>)</span>
array([ 0.856,  0.758,  1.149, -0.412,  0.831])</pre> See : <h3 id=section-backrefs>Back References</h3><p>The following pages refer to to this document either explicitly or contain code examples using this.</p><code><a class=exists href=/p/scipy/1.8.0/api/scipy.linalg._basic.solve_circulant.html link>scipy.linalg._basic.solve_circulant</a></code><h3>Local connectivity graph</h3><p>Hover to see nodes names; edges to Self not shown, Caped at 50 nodes.</p><p>Using a canvas is more power efficient and can get hundred of nodes ; but does not allow hyperlinks; , arrows or text (beyond on hover)</p><canvas class=graph height=500 width=800></canvas><p>SVG is more flexible but power hungry; and does not scale well to 50 + nodes.</p><svg class=graph height=500 width=600></svg><p>All aboves nodes referred to, (or are referred from) current nodes; Edges from Self to other have been omitted (or all nodes would be connected to the central node "self" which is not useful). Nodes are colored by the library they belong to, and scaled with the number of references pointing them</p><hr> GitHub : <a class=external href=https://github.com/scipy/scipy/blob/v1.8.0//scipy/linalg/_basic.py#L702>/scipy/linalg/_basic.py#702</a><br> type: &LTclass 'function'> <br> Commit: <br><script src=https://d3js.org/d3.v4.min.js></script><script src=https://d3js.org/d3-selection-multi.v1.js></script><style>.node {};
        .link { stroke: #999; stroke-opacity: .6; stroke-width: 1px; };</style><script>window._data_graph={nodes:[{id:2,val:11.74165738677394,label:"numpy.set_printoptions",mod:"numpy",url:"/p/numpy/1.22.3/api/numpy.set_printoptions"},{id:3,val:31.748684174075834,label:"numpy.array",mod:"numpy",url:"/p/numpy/1.22.3/api/numpy.array"},{id:4,val:9.414213562373096,label:"scipy.linalg._basic.solve",mod:"scipy",url:"/p/scipy/1.8.0/api/scipy.linalg._basic.solve"},{id:5,val:32.37211521390788,label:"scipy",mod:"scipy",url:"/p/scipy/1.8.0/api/scipy"},{id:6,val:24.186414056238647,label:"numpy.arange",mod:"numpy",url:"/p/numpy/1.22.3/api/numpy.arange"},{id:7,val:16.88819441731559,label:"scipy.fft",mod:"scipy",url:"/p/scipy/1.8.0/api/scipy.fft"},{id:8,val:12,label:"scipy.integrate._quad_vec._quadrature_gk15",mod:"scipy",url:"/p/scipy/1.8.0/api/scipy.integrate._quad_vec._quadrature_gk15"},{id:9,val:11.16227766016838,label:"scipy.fft._basic.ifft",mod:"scipy",url:"/p/scipy/1.8.0/api/scipy.fft._basic.ifft"},{id:10,val:9.732050807568877,label:"scipy.linalg._basic.lstsq",mod:"scipy",url:"/p/scipy/1.8.0/api/scipy.linalg._basic.lstsq"},{id:11,val:9.414213562373096,label:"scipy.linalg._special_matrices.circulant",mod:"scipy",url:"/p/scipy/1.8.0/api/scipy.linalg._special_matrices.circulant"},{id:12,val:33.96150997149434,label:"numpy.ndarray",mod:"numpy",url:"/p/numpy/1.22.3/api/numpy.ndarray"},{id:13,val:18.77032961426901,label:"scipy.linalg",mod:"scipy",url:"/p/scipy/1.8.0/api/scipy.linalg"},{id:14,val:10,label:"scipy.optimize._shgo.SHGO.finite_precision",mod:"scipy",url:"/p/scipy/1.8.0/api/scipy.optimize._shgo.SHGO.finite_precision"},{id:15,val:44,label:"numpy",mod:"numpy",url:"/p/numpy/1.22.3/api/numpy"}],links:[{source:15,target:9,id:222},{source:15,target:4,id:444},{source:15,target:10,id:974},{source:15,target:12,id:1144},{source:7,target:9,id:1347},{source:12,target:10,id:1424},{source:12,target:4,id:1684},{source:12,target:9,id:1851},{source:5,target:10,id:2086},{source:5,target:4,id:2313},{source:5,target:9,id:2461},{source:5,target:11,id:2647},{source:6,target:2,id:2814},{source:6,target:9,id:2838},{source:3,target:10,id:2957},{source:3,target:2,id:3025},{source:3,target:4,id:3176},{source:3,target:12,id:3228},{source:13,target:10,id:3532},{source:13,target:4,id:3600},{source:13,target:11,id:3621}]};</script><script src=/graph_canvas.js></script><script src=/graph_svg.js></script></div></body></html>