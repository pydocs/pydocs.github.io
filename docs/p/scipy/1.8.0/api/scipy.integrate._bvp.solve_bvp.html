<!doctypehtml><html lang=en><meta charset=UTF-8><meta content=width=device-width,initial-scale=1.0 name=viewport><title>Document</title><link href=https://fonts.xz.style/serve/inter.css rel=stylesheet><link crossorigin=anonymous href=https://use.fontawesome.com/releases/v5.8.1/css/all.css integrity=sha384-50oBUHEmvpQ+1lW4y57PTFmhCaXp0ML5d60M1M7uH2+nqUivzIebhndOJK28anvf rel=stylesheet><link href=https://cdn.jsdelivr.net/npm/@exampledev/new.css@1.1.2/new.min.css rel=stylesheet><script type=text/x-mathjax-config>
        // this should process only math inside  span with tex2jax_process class
    MathJax.Hub.Config({
        extensions: ["tex2jax.js"],
        jax: ["input/TeX", "output/HTML-CSS"],
        tex2jax: {
        inlineMath: [ ['$','$'], ["\\(","\\)"] ],
        displayMath: [ ['$$','$$'], ["\\[","\\]"] ],
        processEscapes: true
        },
        "HTML-CSS": { fonts: ["TeX"] }
    });
    </script><script async src=https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/MathJax.js></script><link href=/papyri.css rel=stylesheet><style>header > brand, header>:first-child {
        border-right: 1px solid #ccc;
        border-left: 1px solid #ccc;
        padding: 16px;
        padding-top: 0.5rem;
        padding-bottom: 0.5rem;
        display: inline-block; 
        width: 167px;
    }
    pre { line-height: 125%; }
td.linenos .normal { color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px; }
span.linenos { color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px; }
td.linenos .special { color: #000000; background-color: #ffffc0; padding-left: 5px; padding-right: 5px; }
span.linenos.special { color: #000000; background-color: #ffffc0; padding-left: 5px; padding-right: 5px; }
.highlight .hll { background-color: #ffffcc }
.highlight { background: #ffffff; }
.highlight .c { color: #888888 } /* Comment */
.highlight .err { color: #a61717; background-color: #e3d2d2 } /* Error */
.highlight .k { color: #008800; font-weight: bold } /* Keyword */
.highlight .ch { color: #888888 } /* Comment.Hashbang */
.highlight .cm { color: #888888 } /* Comment.Multiline */
.highlight .cp { color: #cc0000; font-weight: bold } /* Comment.Preproc */
.highlight .cpf { color: #888888 } /* Comment.PreprocFile */
.highlight .c1 { color: #888888 } /* Comment.Single */
.highlight .cs { color: #cc0000; font-weight: bold; background-color: #fff0f0 } /* Comment.Special */
.highlight .gd { color: #000000; background-color: #ffdddd } /* Generic.Deleted */
.highlight .ge { font-style: italic } /* Generic.Emph */
.highlight .gr { color: #aa0000 } /* Generic.Error */
.highlight .gh { color: #333333 } /* Generic.Heading */
.highlight .gi { color: #000000; background-color: #ddffdd } /* Generic.Inserted */
.highlight .go { color: #888888 } /* Generic.Output */
.highlight .gp { color: #555555 } /* Generic.Prompt */
.highlight .gs { font-weight: bold } /* Generic.Strong */
.highlight .gu { color: #666666 } /* Generic.Subheading */
.highlight .gt { color: #aa0000 } /* Generic.Traceback */
.highlight .kc { color: #008800; font-weight: bold } /* Keyword.Constant */
.highlight .kd { color: #008800; font-weight: bold } /* Keyword.Declaration */
.highlight .kn { color: #008800; font-weight: bold } /* Keyword.Namespace */
.highlight .kp { color: #008800 } /* Keyword.Pseudo */
.highlight .kr { color: #008800; font-weight: bold } /* Keyword.Reserved */
.highlight .kt { color: #888888; font-weight: bold } /* Keyword.Type */
.highlight .m { color: #0000DD; font-weight: bold } /* Literal.Number */
.highlight .s { color: #dd2200; background-color: #fff0f0 } /* Literal.String */
.highlight .na { color: #336699 } /* Name.Attribute */
.highlight .nb { color: #003388 } /* Name.Builtin */
.highlight .nc { color: #bb0066; font-weight: bold } /* Name.Class */
.highlight .no { color: #003366; font-weight: bold } /* Name.Constant */
.highlight .nd { color: #555555 } /* Name.Decorator */
.highlight .ne { color: #bb0066; font-weight: bold } /* Name.Exception */
.highlight .nf { color: #0066bb; font-weight: bold } /* Name.Function */
.highlight .nl { color: #336699; font-style: italic } /* Name.Label */
.highlight .nn { color: #bb0066; font-weight: bold } /* Name.Namespace */
.highlight .py { color: #336699; font-weight: bold } /* Name.Property */
.highlight .nt { color: #bb0066; font-weight: bold } /* Name.Tag */
.highlight .nv { color: #336699 } /* Name.Variable */
.highlight .ow { color: #008800 } /* Operator.Word */
.highlight .w { color: #bbbbbb } /* Text.Whitespace */
.highlight .mb { color: #0000DD; font-weight: bold } /* Literal.Number.Bin */
.highlight .mf { color: #0000DD; font-weight: bold } /* Literal.Number.Float */
.highlight .mh { color: #0000DD; font-weight: bold } /* Literal.Number.Hex */
.highlight .mi { color: #0000DD; font-weight: bold } /* Literal.Number.Integer */
.highlight .mo { color: #0000DD; font-weight: bold } /* Literal.Number.Oct */
.highlight .sa { color: #dd2200; background-color: #fff0f0 } /* Literal.String.Affix */
.highlight .sb { color: #dd2200; background-color: #fff0f0 } /* Literal.String.Backtick */
.highlight .sc { color: #dd2200; background-color: #fff0f0 } /* Literal.String.Char */
.highlight .dl { color: #dd2200; background-color: #fff0f0 } /* Literal.String.Delimiter */
.highlight .sd { color: #dd2200; background-color: #fff0f0 } /* Literal.String.Doc */
.highlight .s2 { color: #dd2200; background-color: #fff0f0 } /* Literal.String.Double */
.highlight .se { color: #0044dd; background-color: #fff0f0 } /* Literal.String.Escape */
.highlight .sh { color: #dd2200; background-color: #fff0f0 } /* Literal.String.Heredoc */
.highlight .si { color: #3333bb; background-color: #fff0f0 } /* Literal.String.Interpol */
.highlight .sx { color: #22bb22; background-color: #f0fff0 } /* Literal.String.Other */
.highlight .sr { color: #008800; background-color: #fff0ff } /* Literal.String.Regex */
.highlight .s1 { color: #dd2200; background-color: #fff0f0 } /* Literal.String.Single */
.highlight .ss { color: #aa6600; background-color: #fff0f0 } /* Literal.String.Symbol */
.highlight .bp { color: #003388 } /* Name.Builtin.Pseudo */
.highlight .fm { color: #0066bb; font-weight: bold } /* Name.Function.Magic */
.highlight .vc { color: #336699 } /* Name.Variable.Class */
.highlight .vg { color: #dd7700 } /* Name.Variable.Global */
.highlight .vi { color: #3333bb } /* Name.Variable.Instance */
.highlight .vm { color: #336699 } /* Name.Variable.Magic */
.highlight .il { color: #0000DD; font-weight: bold } /* Literal.Number.Integer.Long */</style></head><body class=tex2jax_ignore><header><brand><i class="fab fa-python"></i><a href=/>Home</a></brand><nav>/ <a href=/>p</a>  /  <div class=dropdown><a href=scipy>scipy</a> /  <div class=dropdown-content><a href=/p/IPython/8.2.0.dev/api/IPython.html>IPython</a><a href=/p/astropy/5.0/api/astropy.html>astropy</a><a href=/p/dask/2021.10.0/api/dask.html>dask</a><a href=/p/distributed/2021.10.0/api/distributed.html>distributed</a><a href=/p/matplotlib/3.5.1/api/matplotlib.html>matplotlib</a><a href=/p/networkx/2.7.2rc1.dev0/api/networkx.html>networkx</a><a href=/p/numpy/1.22.3/api/numpy.html>numpy</a><a href=/p/pandas/1.4.1/api/pandas.html>pandas</a><a href=/p/papyri/0.0.8/api/papyri.html>papyri</a><a href=/p/scipy/1.8.0/api/scipy.html>scipy</a><a href=/p/skimage/0.17.2/api/skimage.html>skimage</a></div></div><div class=dropdown><a href=/p/scipy/1.8.0/api/scipy.html>1.8.0</a> /  <div class=dropdown-content><a href=/p/scipy/1.8.0/api/scipy.html>1.8.0</a></div></div><div class=dropdown><a href=/p/scipy/1.8.0/api/scipy.html>api</a> /  <div class=dropdown-content><a href=/p/scipy/1.8.0/api/scipy.html>API</a><a href=/p/scipy/1.8.0/gallery>Gallery</a><a href=/p/scipy/1.8.0/examples>Examples</a></div></div><div class=dropdown><a class=dropbtn href=scipy.html>scipy</a>.</div><div class=dropdown><a class=dropbtn href=scipy.integrate.html>integrate</a>. <div class=dropdown-content><a href=/p/?/?/api/scipy._lib.html>_lib</a><a href=/p/scipy/1.8.0/api/scipy.fft.html>fft</a><a href=/p/scipy/1.8.0/api/scipy.integrate.html>integrate</a><a href=/p/scipy/1.8.0/api/scipy.interpolate.html>interpolate</a><a href=/p/scipy/1.8.0/api/scipy.linalg.html>linalg</a><a href=/p/?/?/api/scipy.ndimage.html>ndimage</a><a href=/p/scipy/1.8.0/api/scipy.optimize.html>optimize</a><a href=/p/scipy/1.8.0/api/scipy.signal.html>signal</a><a href=/p/scipy/1.8.0/api/scipy.sparse.html>sparse</a><a href=/p/scipy/1.8.0/api/scipy.spatial.html>spatial</a><a href=/p/scipy/1.8.0/api/scipy.special.html>special</a><a href=/p/?/?/api/scipy.stats.html>stats</a></div></div><div class=dropdown><a class=dropbtn href=scipy.integrate._bvp.html>_bvp</a>. <div class=dropdown-content><a href=/p/scipy/1.8.0/api/scipy.integrate._bvp.html>_bvp</a><a href=/p/scipy/1.8.0/api/scipy.integrate._dop.html>_dop</a><a href=/p/scipy/1.8.0/api/scipy.integrate._ivp.html>_ivp</a><a href=/p/scipy/1.8.0/api/scipy.integrate._lsoda.html>_lsoda</a><a href=/p/scipy/1.8.0/api/scipy.integrate._ode.html>_ode</a><a href=/p/scipy/1.8.0/api/scipy.integrate._odepack.html>_odepack</a><a href=/p/scipy/1.8.0/api/scipy.integrate._odepack_py.html>_odepack_py</a><a href=/p/scipy/1.8.0/api/scipy.integrate._quad_vec.html>_quad_vec</a><a href=/p/scipy/1.8.0/api/scipy.integrate._quadpack.html>_quadpack</a><a href=/p/scipy/1.8.0/api/scipy.integrate._quadpack_py.html>_quadpack_py</a><a href=/p/scipy/1.8.0/api/scipy.integrate._quadrature.html>_quadrature</a><a href=/p/scipy/1.8.0/api/scipy.integrate._vode.html>_vode</a><a href=/p/scipy/1.8.0/api/scipy.integrate.dop.html>dop</a><a href=/p/scipy/1.8.0/api/scipy.integrate.lsoda.html>lsoda</a><a href=/p/scipy/1.8.0/api/scipy.integrate.odepack.html>odepack</a><a href=/p/scipy/1.8.0/api/scipy.integrate.quadpack.html>quadpack</a><a href=/p/scipy/1.8.0/api/scipy.integrate.vode.html>vode</a></div></div><div class=dropdown><a class=dropbtn href=scipy.integrate._bvp.solve_bvp.html>solve_bvp</a><div class=dropdown-content><a href=/p/scipy/1.8.0/api/scipy.integrate._bvp.BVPResult.html>BVPResult</a><a href=/p/scipy/1.8.0/api/scipy.integrate._bvp.collocation_fun.html>collocation_fun</a><a href=/p/scipy/1.8.0/api/scipy.integrate._bvp.compute_jac_indices.html>compute_jac_indices</a><a href=/p/scipy/1.8.0/api/scipy.integrate._bvp.construct_global_jac.html>construct_global_jac</a><a href=/p/scipy/1.8.0/api/scipy.integrate._bvp.create_spline.html>create_spline</a><a href=/p/scipy/1.8.0/api/scipy.integrate._bvp.estimate_bc_jac.html>estimate_bc_jac</a><a href=/p/scipy/1.8.0/api/scipy.integrate._bvp.estimate_fun_jac.html>estimate_fun_jac</a><a href=/p/scipy/1.8.0/api/scipy.integrate._bvp.estimate_rms_residuals.html>estimate_rms_residuals</a><a href=/p/scipy/1.8.0/api/scipy.integrate._bvp.modify_mesh.html>modify_mesh</a><a href=/p/scipy/1.8.0/api/scipy.integrate._bvp.prepare_sys.html>prepare_sys</a><a href=/p/scipy/1.8.0/api/scipy.integrate._bvp.print_iteration_header.html>print_iteration_header</a><a href=/p/scipy/1.8.0/api/scipy.integrate._bvp.print_iteration_progress.html>print_iteration_progress</a><a href=/p/scipy/1.8.0/api/scipy.integrate._bvp.solve_bvp.html>solve_bvp</a><a href=/p/scipy/1.8.0/api/scipy.integrate._bvp.solve_newton.html>solve_newton</a><a href=/p/scipy/1.8.0/api/scipy.integrate._bvp.stacked_matmul.html>stacked_matmul</a><a href=/p/scipy/1.8.0/api/scipy.integrate._bvp.wrap_functions.html>wrap_functions</a></div></div></nav></header><div class=container><div class=sidenav><img src=/p/scipy/1.8.0/img/logo.png><a href=#>scipy</a><a href=#>1.8.0</a><a class=external href=https://pypi.org/project/scipy>Pypi</a><a class=external href=https://github.com/scipy/scipy>GitHub</a><a class=external href=https://scipy.org/>Homepage</a><hr><a class=external href=https://docs.scipy.org/doc/scipy/>Other Docs</a><hr><a href=#section-Notes>Notes</a><a href=#section-Parameters>Parameters</a><a href=#section-Returns>Returns</a><a href=#section-backrefs>BackRef</a></div><code class=signature>solve_bvp(fun, bc, x, y, p=None, S=None, fun_jac=None, bc_jac=None, tol=0.001, max_nodes=1000, verbose=0, bc_tol=None)</code><p>This function numerically solves a first order system of ODEs subject to two-point boundary conditions::</p><pre>dy / dx = f(x, y, p) + S * y / (x - a), a <= x <= b
bc(y(a), y(b), p) = 0</pre><p>Here x is a 1-D independent variable, y(x) is an N-D vector-valued function and p is a k-D vector of unknown parameters which is to be found along with y(x). For the problem to be determined, there must be n + k boundary conditions, i.e., bc must be an (n + k)-D function.</p><p>The last singular term on the right-hand side of the system is optional. It is defined by an n-by-n matrix S, such that the solution must satisfy S y(a) = 0. This condition will be forced during iterations, so it must not contradict boundary conditions. See for the explanation how this term is handled when solving BVPs numerically.</p><p>Problems in a complex domain can be solved as well. In this case, y and p are considered to be complex, and f and bc are assumed to be complex-valued functions, but x stays real. Note that f and bc must be complex differentiable (satisfy Cauchy-Riemann equations ), otherwise you should rewrite your problem for real and imaginary parts separately. To solve a problem in a complex domain, pass an initial guess for y with a complex data type (see below).</p><h3 id=section-Notes>Notes</h3><p>This function implements a 4th order collocation algorithm with the control of residuals similar to . A collocation system is solved by a damped Newton method with an affine-invariant criterion function as described in .</p><p>Note that in integral residuals are defined without normalization by interval lengths. So, their definition is different by a multiplier of h**0.5 (h is an interval length) from the definition used here.</p><div class=admonition><div>versionadded</div><p>0.18.0</p></div><h3 id=section-Parameters>Parameters</h3><dl><dt><a id=fun>fun</a> : callable</dt><dd><p>Right-hand side of the system. The calling signature is <code class=verbatim>fun(x, y)</code> , or <code class=verbatim>fun(x, y, p)</code> if parameters are present. All arguments are ndarray: <code class=verbatim>x</code> with shape (m,), <code class=verbatim>y</code> with shape (n, m), meaning that <code class=verbatim>y[:, i]</code> corresponds to <code class=verbatim>x[i]</code> , and <code class=verbatim>p</code> with shape (k,). The return value must be an array with shape (n, m) and with the same layout as <code class=verbatim>y</code> .</p></dd><dt><a id=bc>bc</a> : callable</dt><dd><p>Function evaluating residuals of the boundary conditions. The calling signature is <code class=verbatim>bc(ya, yb)</code> , or <code class=verbatim>bc(ya, yb, p)</code> if parameters are present. All arguments are ndarray: <code class=verbatim>ya</code> and <code class=verbatim>yb</code> with shape (n,), and <code class=verbatim>p</code> with shape (k,). The return value must be an array with shape (n + k,).</p></dd><dt><a id=x>x</a> : array_like, shape (m,)</dt><dd><p>Initial mesh. Must be a strictly increasing sequence of real numbers with <code class=verbatim>x[0]=a</code> and <code class=verbatim>x[-1]=b</code> .</p></dd><dt><a id=y>y</a> : array_like, shape (n, m)</dt><dd><p>Initial guess for the function values at the mesh nodes, ith column corresponds to <code class=verbatim>x[i]</code> . For problems in a complex domain pass <code><a class=local href=#y link>y</a></code> with a complex data type (even if the initial guess is purely real).</p></dd><dt><a id=p>p</a> : array_like with shape (k,) or None, optional</dt><dd><p>Initial guess for the unknown parameters. If None (default), it is assumed that the problem doesn't depend on any parameters.</p></dd><dt><a id=S>S</a> : array_like with shape (n, n) or None</dt><dd><p>Matrix defining the singular term. If None (default), the problem is solved without the singular term.</p></dd><dt><a id=fun_jac>fun_jac</a> : callable or None, optional</dt><dd><p>Function computing derivatives of f with respect to y and p. The calling signature is <code class=verbatim>fun_jac(x, y)</code> , or <code class=verbatim>fun_jac(x, y, p)</code> if parameters are present. The return must contain 1 or 2 elements in the following order:</p></dd><dt><a id=bc_jac>bc_jac</a> : callable or None, optional</dt><dd><p>Function computing derivatives of bc with respect to ya, yb, and p. The calling signature is <code class=verbatim>bc_jac(ya, yb)</code> , or <code class=verbatim>bc_jac(ya, yb, p)</code> if parameters are present. The return must contain 2 or 3 elements in the following order:</p></dd><dt><a id=tol>tol</a> : float, optional</dt><dd><p>Desired tolerance of the solution. If we define <code class=verbatim>r = y' - f(x, y)</code> , where y is the found solution, then the solver tries to achieve on each mesh interval <code class=verbatim>norm(r / (1 + abs(f)) < tol</code> , where <code class=verbatim>norm</code> is estimated in a root mean squared sense (using a numerical quadrature formula). Default is 1e-3.</p></dd><dt><a id=max_nodes>max_nodes</a> : int, optional</dt><dd><p>Maximum allowed number of the mesh nodes. If exceeded, the algorithm terminates. Default is 1000.</p></dd><dt><a id=verbose>verbose</a> : {0, 1, 2}, optional</dt><dd><p>Level of algorithm's verbosity:</p></dd><dt><a id=bc_tol>bc_tol</a> : float, optional</dt><dd><p>Desired absolute tolerance for the boundary condition residuals: <code><a class=local href=#bc link>bc</a></code> value should satisfy <code class=verbatim>abs(bc) < bc_tol</code> component-wise. Equals to <code><a class=local href=#tol link>tol</a></code> by default. Up to 10 iterations are allowed to achieve this tolerance.</p></dd></dl><h3 id=section-Returns>Returns</h3><dl><dt>Bunch object with the following fields defined:</dt><dd></dd><dt><a id=sol>sol</a> : PPoly</dt><dd><p>Found solution for y as <code><a class=exists href=/p/scipy/*/api/scipy.interpolate._interpolate.PPoly.html link>scipy.interpolate.PPoly</a></code> instance, a C1 continuous cubic spline.</p></dd><dt><a id=p>p</a> : ndarray or None, shape (k,)</dt><dd><p>Found parameters. None, if the parameters were not present in the problem.</p></dd><dt><a id=x>x</a> : ndarray, shape (m,)</dt><dd><p>Nodes of the final mesh.</p></dd><dt><a id=y>y</a> : ndarray, shape (n, m)</dt><dd><p>Solution values at the mesh nodes.</p></dd><dt><a id=yp>yp</a> : ndarray, shape (n, m)</dt><dd><p>Solution derivatives at the mesh nodes.</p></dd><dt><a id=rms_residuals>rms_residuals</a> : ndarray, shape (m - 1,)</dt><dd><p>RMS values of the relative residuals over each mesh interval (see the description of <code><a class=local href=#tol link>tol</a></code> parameter).</p></dd><dt><a id=niter>niter</a> : int</dt><dd><p>Number of completed iterations.</p></dd><dt><a id=status>status</a> : int</dt><dd><p>Reason for algorithm termination:</p> <pre>* 0: The algorithm converged to the desired accuracy.
* 1: The maximum number of mesh nodes is exceeded.
* 2: A singular Jacobian encountered when solving the collocation
  system.
</pre></dd><dt><a id=message>message</a> : string</dt><dd><p>Verbal description of the termination reason.</p></dd><dt><a id=success>success</a> : bool</dt><dd><p>True if the algorithm converged to the desired accuracy ( <code class=verbatim>status=0</code> ).</p></dd></dl><p>Solve a boundary value problem for a system of ODEs.</p><h3 id=section-Examples>Examples</h3><pre>y'' + k * exp(y) = 0
y(0) = y(1) = 0
</pre><p>for k = 1.</p><pre>y1' = y2
y2' = -exp(y1)
</pre><pre class="highlight execed"><span class=nsl>>>> </span><span class=k>def</span><span> </span><span class=nf>fun</span><span>(</span><span>x</span><span>,</span><span> </span><span>y</span><span>)</span><span>:</span><br><span class=nsl>... </span><span>    </span><a class="foo k"href=/p/scipy/1.8.0/api/scipy.integrate._ode.ode.get_return_code.html>return</a><span> </span><a class=foo href=/p/numpy/1.22.3/api/numpy.html>np</a><span class=o>.</span><a class=foo href=/p/numpy/1.22.3/api/numpy.vstack.html>vstack</a><span>(</span><span>(</span><span>y</span><span>[</span><span class=mi>1</span><span>]</span><span>,</span><span> </span><span class=o>-</span><a class=foo href=/p/numpy/1.22.3/api/numpy.html>np</a><span class=o>.</span><a class=foo href=/p/numpy/1.22.3/api/numpy.ufunc.html>exp</a><span>(</span><span>y</span><span>[</span><span class=mi>0</span><span>]</span><span>)</span><span>)</span><span>)</span>
</pre><p>Implement evaluation of the boundary condition residuals:</p><pre class="highlight execed"><span class=nsl>>>> </span><span class=k>def</span><span> </span><span class=nf>bc</span><span>(</span><span>ya</span><span>,</span><span> </span><span>yb</span><span>)</span><span>:</span><br><span class=nsl>... </span><span>    </span><a class="foo k"href=/p/scipy/1.8.0/api/scipy.integrate._ode.ode.get_return_code.html>return</a><span> </span><a class=foo href=/p/numpy/1.22.3/api/numpy.html>np</a><span class=o>.</span><a class=foo href=/p/numpy/1.22.3/api/numpy.array.html>array</a><span>(</span><span>[</span><span>ya</span><span>[</span><span class=mi>0</span><span>]</span><span>,</span><span> </span><span>yb</span><span>[</span><span class=mi>0</span><span>]</span><span>]</span><span>)</span>
</pre><p>Define the initial mesh with 5 nodes:</p><pre class="highlight execed"><span class=nsl>>>> </span><span>x</span><span> </span><span class=o>=</span><span> </span><a class=foo href=/p/numpy/1.22.3/api/numpy.html>np</a><span class=o>.</span><a class=foo href=/p/numpy/1.22.3/api/numpy.linspace.html>linspace</a><span>(</span><span class=mi>0</span><span>,</span><span> </span><span class=mi>1</span><span>,</span><span> </span><span class=mi>5</span><span>)</span>
</pre><p>This problem is known to have two solutions. To obtain both of them, we use two different initial guesses for y. We denote them by subscripts a and b.</p><pre class="highlight execed"><span class=nsl>>>> </span><a class=foo href=/p/numpy/1.22.3/api/numpy.ndarray.html>y_a</a><span> </span><span class=o>=</span><span> </span><a class=foo href=/p/numpy/1.22.3/api/numpy.html>np</a><span class=o>.</span><a class=foo href=/p/numpy/1.22.3/api/numpy.zeros.html>zeros</a><span>(</span><span>(</span><span class=mi>2</span><span>,</span><span> </span><span>x</span><span class=o>.</span><span>size</span><span>)</span><span>)</span><br><span class=nsl>... </span><a class=foo href=/p/numpy/1.22.3/api/numpy.ndarray.html>y_b</a><span> </span><span class=o>=</span><span> </span><a class=foo href=/p/numpy/1.22.3/api/numpy.html>np</a><span class=o>.</span><a class=foo href=/p/numpy/1.22.3/api/numpy.zeros.html>zeros</a><span>(</span><span>(</span><span class=mi>2</span><span>,</span><span> </span><span>x</span><span class=o>.</span><span>size</span><span>)</span><span>)</span><br><span class=nsl>... </span><a class=foo href=/p/numpy/1.22.3/api/numpy.ndarray.html>y_b</a><span>[</span><span class=mi>0</span><span>]</span><span> </span><span class=o>=</span><span> </span><span class=mi>3</span>
</pre><p>Now we are ready to run the solver.</p><pre class="highlight execed"><span class=nsl>>>> </span><span class=kn>from</span><span> </span><a class="foo nn"href=/p/scipy/1.8.0/api/scipy.html>scipy</a><span class=nn>.</span><a class="foo nn"href=/p/scipy/1.8.0/api/scipy.integrate.html>integrate</a><span> </span><span class=kn>import</span><span> </span><a class=foo href=/p/scipy/1.8.0/api/scipy.integrate._bvp.solve_bvp.html>solve_bvp</a><br><span class=nsl>... </span><span>res_a</span><span> </span><span class=o>=</span><span> </span><a class=foo href=/p/scipy/1.8.0/api/scipy.integrate._bvp.solve_bvp.html>solve_bvp</a><span>(</span><span>fun</span><span>,</span><span> </span><span>bc</span><span>,</span><span> </span><span>x</span><span>,</span><span> </span><a class=foo href=/p/numpy/1.22.3/api/numpy.ndarray.html>y_a</a><span>)</span><br><span class=nsl>... </span><span>res_b</span><span> </span><span class=o>=</span><span> </span><a class=foo href=/p/scipy/1.8.0/api/scipy.integrate._bvp.solve_bvp.html>solve_bvp</a><span>(</span><span>fun</span><span>,</span><span> </span><span>bc</span><span>,</span><span> </span><span>x</span><span>,</span><span> </span><a class=foo href=/p/numpy/1.22.3/api/numpy.ndarray.html>y_b</a><span>)</span>
</pre><p>Let's plot the two found solutions. We take an advantage of having the solution in a spline form to produce a smooth plot.</p><pre class="highlight execed"><span class=nsl>>>> </span><span>x_plot</span><span> </span><span class=o>=</span><span> </span><a class=foo href=/p/numpy/1.22.3/api/numpy.html>np</a><span class=o>.</span><a class=foo href=/p/numpy/1.22.3/api/numpy.linspace.html>linspace</a><span>(</span><span class=mi>0</span><span>,</span><span> </span><span class=mi>1</span><span>,</span><span> </span><span class=mi>100</span><span>)</span><br><span class=nsl>... </span><span>y_plot_a</span><span> </span><span class=o>=</span><span> </span><span>res_a</span><span class=o>.</span><span>sol</span><span>(</span><span>x_plot</span><span>)</span><span>[</span><span class=mi>0</span><span>]</span><br><span class=nsl>... </span><span>y_plot_b</span><span> </span><span class=o>=</span><span> </span><span>res_b</span><span class=o>.</span><span>sol</span><span>(</span><span>x_plot</span><span>)</span><span>[</span><span class=mi>0</span><span>]</span><br><span class=nsl>... </span><span class=kn>import</span><span> </span><a class="foo nn"href=/p/matplotlib/3.5.1/api/matplotlib.html>matplotlib</a><span class=nn>.</span><a class="foo nn"href=/p/matplotlib/3.5.1/api/matplotlib.pyplot.html>pyplot</a><span> </span><span class=k>as</span><span> </span><a class="foo nn"href=/p/matplotlib/3.5.1/api/matplotlib.pyplot.html>plt</a><br><span class=nsl>... </span><a class=foo href=/p/matplotlib/3.5.1/api/matplotlib.pyplot.html>plt</a><span class=o>.</span><a class=foo href=/p/matplotlib/3.5.1/api/matplotlib.pyplot.plot.html>plot</a><span>(</span><span>x_plot</span><span>,</span><span> </span><a class=foo href=/p/numpy/1.22.3/api/numpy.ndarray.html>y_plot_a</a><span>,</span><span> </span><span>label</span><span class=o>=</span><span class=s1>'</span><span class=s1>y_a</span><span class=s1>'</span><span>)</span><br><span class=nsl>... </span><a class=foo href=/p/matplotlib/3.5.1/api/matplotlib.pyplot.html>plt</a><span class=o>.</span><a class=foo href=/p/matplotlib/3.5.1/api/matplotlib.pyplot.plot.html>plot</a><span>(</span><span>x_plot</span><span>,</span><span> </span><a class=foo href=/p/numpy/1.22.3/api/numpy.ndarray.html>y_plot_b</a><span>,</span><span> </span><span>label</span><span class=o>=</span><span class=s1>'</span><span class=s1>y_b</span><span class=s1>'</span><span>)</span><br><span class=nsl>... </span><a class=foo href=/p/matplotlib/3.5.1/api/matplotlib.pyplot.html>plt</a><span class=o>.</span><a class=foo href=/p/matplotlib/3.5.1/api/matplotlib.pyplot.legend.html>legend</a><span>(</span><span>)</span><br><span class=nsl>... </span><a class=foo href=/p/matplotlib/3.5.1/api/matplotlib.pyplot.html>plt</a><span class=o>.</span><a class=foo href=/p/matplotlib/3.5.1/api/matplotlib.pyplot.xlabel.html>xlabel</a><span>(</span><span class=s2>"</span><span class=s2>x</span><span class=s2>"</span><span>)</span><br><span class=nsl>... </span><a class=foo href=/p/matplotlib/3.5.1/api/matplotlib.pyplot.html>plt</a><span class=o>.</span><a class=foo href=/p/matplotlib/3.5.1/api/matplotlib.pyplot.ylabel.html>ylabel</a><span>(</span><span class=s2>"</span><span class=s2>y</span><span class=s2>"</span><span>)</span><br><span class=nsl>... </span><a class=foo href=/p/matplotlib/3.5.1/api/matplotlib.pyplot.html>plt</a><span class=o>.</span><a class=foo href=/p/matplotlib/3.5.1/api/matplotlib.pyplot.show.html>show</a><span>(</span><span>)</span>
</pre><div><img src=/p/scipy/1.8.0/img/fig-scipy.integrate._bvp.solve_bvp-0.png></div><p>We see that the two solutions have similar shape, but differ in scale significantly.</p><pre>y'' + k**2 * y = 0
y(0) = y(1) = 0
</pre><pre>y'(0) = k
</pre><pre>y1' = y2
y2' = -k**2 * y1
</pre><pre class="highlight execed"><span class=nsl>>>> </span><span class=k>def</span><span> </span><span class=nf>fun</span><span>(</span><span>x</span><span>,</span><span> </span><span>y</span><span>,</span><span> </span><span>p</span><span>)</span><span>:</span><br><span class=nsl>... </span><span>    </span><span>k</span><span> </span><span class=o>=</span><span> </span><span>p</span><span>[</span><span class=mi>0</span><span>]</span><br><span class=nsl>... </span><span>    </span><a class="foo k"href=/p/scipy/1.8.0/api/scipy.integrate._ode.ode.get_return_code.html>return</a><span> </span><a class=foo href=/p/numpy/1.22.3/api/numpy.html>np</a><span class=o>.</span><a class=foo href=/p/numpy/1.22.3/api/numpy.vstack.html>vstack</a><span>(</span><span>(</span><span>y</span><span>[</span><span class=mi>1</span><span>]</span><span>,</span><span> </span><span class=o>-</span><span>k</span><span class=o>*</span><span class=o>*</span><span class=mi>2</span><span> </span><span class=o>*</span><span> </span><span>y</span><span>[</span><span class=mi>0</span><span>]</span><span>)</span><span>)</span>
</pre><p>Note that parameters p are passed as a vector (with one element in our case).</p><p>Implement the boundary conditions:</p><pre class="highlight execed"><span class=nsl>>>> </span><span class=k>def</span><span> </span><span class=nf>bc</span><span>(</span><span>ya</span><span>,</span><span> </span><span>yb</span><span>,</span><span> </span><span>p</span><span>)</span><span>:</span><br><span class=nsl>... </span><span>    </span><span>k</span><span> </span><span class=o>=</span><span> </span><span>p</span><span>[</span><span class=mi>0</span><span>]</span><br><span class=nsl>... </span><span>    </span><a class="foo k"href=/p/scipy/1.8.0/api/scipy.integrate._ode.ode.get_return_code.html>return</a><span> </span><a class=foo href=/p/numpy/1.22.3/api/numpy.html>np</a><span class=o>.</span><a class=foo href=/p/numpy/1.22.3/api/numpy.array.html>array</a><span>(</span><span>[</span><span>ya</span><span>[</span><span class=mi>0</span><span>]</span><span>,</span><span> </span><span>yb</span><span>[</span><span class=mi>0</span><span>]</span><span>,</span><span> </span><span>ya</span><span>[</span><span class=mi>1</span><span>]</span><span> </span><span class=o>-</span><span> </span><span>k</span><span>]</span><span>)</span>
</pre><p>Set up the initial mesh and guess for y. We aim to find the solution for k = 2 * pi, to achieve that we set values of y to approximately follow sin(2 * pi * x):</p><pre class="highlight execed"><span class=nsl>>>> </span><span>x</span><span> </span><span class=o>=</span><span> </span><a class=foo href=/p/numpy/1.22.3/api/numpy.html>np</a><span class=o>.</span><a class=foo href=/p/numpy/1.22.3/api/numpy.linspace.html>linspace</a><span>(</span><span class=mi>0</span><span>,</span><span> </span><span class=mi>1</span><span>,</span><span> </span><span class=mi>5</span><span>)</span><br><span class=nsl>... </span><a class=foo href=/p/numpy/1.22.3/api/numpy.ndarray.html>y</a><span> </span><span class=o>=</span><span> </span><a class=foo href=/p/numpy/1.22.3/api/numpy.html>np</a><span class=o>.</span><a class=foo href=/p/numpy/1.22.3/api/numpy.zeros.html>zeros</a><span>(</span><span>(</span><span class=mi>2</span><span>,</span><span> </span><span>x</span><span class=o>.</span><span>size</span><span>)</span><span>)</span><br><span class=nsl>... </span><a class=foo href=/p/numpy/1.22.3/api/numpy.ndarray.html>y</a><span>[</span><span class=mi>0</span><span>,</span><span> </span><span class=mi>1</span><span>]</span><span> </span><span class=o>=</span><span> </span><span class=mi>1</span><br><span class=nsl>... </span><a class=foo href=/p/numpy/1.22.3/api/numpy.ndarray.html>y</a><span>[</span><span class=mi>0</span><span>,</span><span> </span><span class=mi>3</span><span>]</span><span> </span><span class=o>=</span><span> </span><span class=o>-</span><span class=mi>1</span>
</pre><p>Run the solver with 6 as an initial guess for k.</p><pre class="highlight execed"><span class=nsl>>>> </span><span>sol</span><span> </span><span class=o>=</span><span> </span><a class=foo href=/p/scipy/1.8.0/api/scipy.integrate._bvp.solve_bvp.html>solve_bvp</a><span>(</span><span>fun</span><span>,</span><span> </span><span>bc</span><span>,</span><span> </span><span>x</span><span>,</span><span> </span><a class=foo href=/p/numpy/1.22.3/api/numpy.ndarray.html>y</a><span>,</span><span> </span><span>p</span><span class=o>=</span><span>[</span><span class=mi>6</span><span>]</span><span>)</span>
</pre><p>We see that the found k is approximately correct:</p><pre class="highlight execed"><span class=nsl>>>> </span><span>sol</span><span class=o>.</span><span>p</span><span>[</span><span class=mi>0</span><span>]</span>
6.28329460046</pre><p>And, finally, plot the solution to see the anticipated sinusoid:</p><pre class="highlight execed"><span class=nsl>>>> </span><span>x_plot</span><span> </span><span class=o>=</span><span> </span><a class=foo href=/p/numpy/1.22.3/api/numpy.html>np</a><span class=o>.</span><a class=foo href=/p/numpy/1.22.3/api/numpy.linspace.html>linspace</a><span>(</span><span class=mi>0</span><span>,</span><span> </span><span class=mi>1</span><span>,</span><span> </span><span class=mi>100</span><span>)</span><br><span class=nsl>... </span><a class=foo href=/p/scipy/1.8.0/api/scipy.spatial._plotutils.delaunay_plot_2d.html>y_plot</a><span> </span><span class=o>=</span><span> </span><span>sol</span><span class=o>.</span><span>sol</span><span>(</span><span>x_plot</span><span>)</span><span>[</span><span class=mi>0</span><span>]</span><br><span class=nsl>... </span><a class=foo href=/p/matplotlib/3.5.1/api/matplotlib.pyplot.html>plt</a><span class=o>.</span><a class=foo href=/p/matplotlib/3.5.1/api/matplotlib.pyplot.plot.html>plot</a><span>(</span><span>x_plot</span><span>,</span><span> </span><a class=foo href=/p/numpy/1.22.3/api/numpy.ndarray.html>y_plot</a><span>)</span><br><span class=nsl>... </span><a class=foo href=/p/matplotlib/3.5.1/api/matplotlib.pyplot.html>plt</a><span class=o>.</span><a class=foo href=/p/matplotlib/3.5.1/api/matplotlib.pyplot.xlabel.html>xlabel</a><span>(</span><span class=s2>"</span><span class=s2>x</span><span class=s2>"</span><span>)</span><br><span class=nsl>... </span><a class=foo href=/p/matplotlib/3.5.1/api/matplotlib.pyplot.html>plt</a><span class=o>.</span><a class=foo href=/p/matplotlib/3.5.1/api/matplotlib.pyplot.ylabel.html>ylabel</a><span>(</span><span class=s2>"</span><span class=s2>y</span><span class=s2>"</span><span>)</span><br><span class=nsl>... </span><a class=foo href=/p/matplotlib/3.5.1/api/matplotlib.pyplot.html>plt</a><span class=o>.</span><a class=foo href=/p/matplotlib/3.5.1/api/matplotlib.pyplot.show.html>show</a><span>(</span><span>)</span>
</pre><div><img src=/p/scipy/1.8.0/img/fig-scipy.integrate._bvp.solve_bvp-1.png></div> See : <h3 id=section-backrefs>Back References</h3><p>The following pages refer to to this document either explicitly or contain code examples using this.</p><code><a class=exists href=/p/scipy/1.8.0/api/scipy.integrate._bvp.solve_bvp.html link>scipy.integrate._bvp.solve_bvp</a></code><h3>Local connectivity graph</h3><p>Hover to see nodes names; edges to Self not shown, Caped at 50 nodes.</p><p>Using a canvas is more power efficient and can get hundred of nodes ; but does not allow hyperlinks; , arrows or text (beyond on hover)</p><canvas class=graph height=500 width=800></canvas><p>SVG is more flexible but power hungry; and does not scale well to 50 + nodes.</p><svg class=graph height=500 width=600></svg><p>All aboves nodes referred to, (or are referred from) current nodes; Edges from Self to other have been omitted (or all nodes would be connected to the central node "self" which is not useful). Nodes are colored by the library they belong to, and scaled with the number of references pointing them</p><hr> GitHub : <a class=external href=https://github.com/scipy/scipy/blob/v1.8.0//scipy/integrate/_bvp.py#L710>/scipy/integrate/_bvp.py#710</a><br> type: &LTclass 'function'> <br> Commit: <br><script src=https://d3js.org/d3.v4.min.js></script><script src=https://d3js.org/d3-selection-multi.v1.js></script><style>.node {};
        .link { stroke: #999; stroke-opacity: .6; stroke-width: 1px; };</style><script>window._data_graph={nodes:[{id:1,val:17.327379053088816,label:"matplotlib.pyplot.ylabel",mod:"matplotlib",url:"/p/matplotlib/3.5.1/api/matplotlib.pyplot.ylabel"},{id:2,val:34.419689627245816,label:"matplotlib",mod:"matplotlib",url:"/p/matplotlib/3.5.1/api/matplotlib"},{id:3,val:10.449489742783179,label:"numpy.vstack",mod:"numpy",url:"/p/numpy/1.22.3/api/numpy.vstack"},{id:4,val:31.748684174075834,label:"numpy.array",mod:"numpy",url:"/p/numpy/1.22.3/api/numpy.array"},{id:5,val:15.14142842854285,label:"scipy.integrate._ode.ode.get_return_code",mod:"scipy",url:"/p/scipy/1.8.0/api/scipy.integrate._ode.ode.get_return_code"},{id:6,val:19.18033988749895,label:"numpy.zeros",mod:"numpy",url:"/p/numpy/1.22.3/api/numpy.zeros"},{id:7,val:20.60952021291849,label:"numpy.ufunc",mod:"numpy",url:"/p/numpy/1.22.3/api/numpy.ufunc"},{id:8,val:33.96150997149434,label:"numpy.ndarray",mod:"numpy",url:"/p/numpy/1.22.3/api/numpy.ndarray"},{id:9,val:9.732050807568877,label:"scipy.spatial._plotutils.delaunay_plot_2d",mod:"scipy",url:"/p/scipy/1.8.0/api/scipy.spatial._plotutils.delaunay_plot_2d"},{id:10,val:20.24744871391589,label:"matplotlib.pyplot.plot",mod:"matplotlib",url:"/p/matplotlib/3.5.1/api/matplotlib.pyplot.plot"},{id:11,val:44,label:"numpy",mod:"numpy",url:"/p/numpy/1.22.3/api/numpy"},{id:12,val:15.280109889280517,label:"matplotlib.pyplot.legend",mod:"matplotlib",url:"/p/matplotlib/3.5.1/api/matplotlib.pyplot.legend"},{id:13,val:32.37211521390788,label:"scipy",mod:"scipy",url:"/p/scipy/1.8.0/api/scipy"},{id:14,val:10.23606797749979,label:"scipy.interpolate._interpolate.PPoly",mod:"scipy",url:"/p/scipy/*/api/scipy.interpolate._interpolate.PPoly"},{id:15,val:17.69535971483266,label:"matplotlib.pyplot.xlabel",mod:"matplotlib",url:"/p/matplotlib/3.5.1/api/matplotlib.pyplot.xlabel"},{id:16,val:11.872983346207416,label:"scipy.integrate",mod:"scipy",url:"/p/scipy/1.8.0/api/scipy.integrate"},{id:18,val:9,label:"fig-scipy.integrate._bvp.solve_bvp-0.png",mod:"fig-scipy",url:"/p/scipy/1.8.0/api/fig-scipy.integrate._bvp.solve_bvp-0.png"},{id:19,val:20.767145334803704,label:"numpy.linspace",mod:"numpy",url:"/p/numpy/1.22.3/api/numpy.linspace"},{id:20,val:23.394804318340654,label:"matplotlib.pyplot",mod:"matplotlib",url:"/p/matplotlib/3.5.1/api/matplotlib.pyplot"},{id:21,val:9,label:"fig-scipy.integrate._bvp.solve_bvp-1.png",mod:"fig-scipy",url:"/p/scipy/1.8.0/api/fig-scipy.integrate._bvp.solve_bvp-1.png"},{id:22,val:21.07669683062202,label:"matplotlib.pyplot.show",mod:"matplotlib",url:"/p/matplotlib/3.5.1/api/matplotlib.pyplot.show"}],links:[{source:11,target:8,id:1231},{source:11,target:9,id:1287},{source:2,target:19,id:1811},{source:2,target:9,id:1929},{source:13,target:9,id:3674},{source:20,target:19,id:3892},{source:20,target:9,id:4048},{source:10,target:19,id:4112},{source:6,target:19,id:4253},{source:6,target:8,id:4255},{source:4,target:8,id:4662},{source:4,target:3,id:4693},{source:22,target:19,id:5015},{source:22,target:9,id:5127}]};</script><script src=/graph_canvas.js></script><script src=/graph_svg.js></script></div></body></html>