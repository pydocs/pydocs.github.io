<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <link rel="icon" href="/favicon.ico" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
    <link rel="stylesheet"
          href="https://use.fontawesome.com/releases/v5.8.1/css/all.css"
          integrity="sha384-50oBUHEmvpQ+1lW4y57PTFmhCaXp0ML5d60M1M7uH2+nqUivzIebhndOJK28anvf"
          crossorigin="anonymous">
    
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@exampledev/new.css@1.1.2/new.min.css">
    <script type="text/x-mathjax-config">
      // this should process only math inside  span with tex2jax_process class
      MathJax.Hub.Config({
          extensions: ["tex2jax.js"],
          jax: ["input/TeX", "output/HTML-CSS"],
          tex2jax: {
          inlineMath: [ ['$','$'], ["\\(","\\)"] ],
          displayMath: [ ['$$','$$'], ["\\[","\\]"] ],
          processEscapes: true
          },
          "HTML-CSS": { fonts: ["TeX"] }
      });
    </script>
    <script async
        src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/MathJax.js">
    </script>
    <link rel="stylesheet" href="/papyri.css">
    <link rel="stylesheet" href="/pygments.css">
<style>

    header > brand {
        /*border-right: 1px solid #ccc;
          border-left: 1px solid #ccc;*/
        margin-left: 15px;
        padding: 0px;
        display: inline-block; 
        width: 67px;
    }

    brand > a {
        text-decoration: None;

    }
    brand >a> img {
            display: inline-block;
    margin: 0;
    padding: 0;
    position: relative;
    bottom: -10px;

   }
    .container {
       max-width: 800px;
       padding-left: 210px;
       padding-top: 30px;
    }
</style>
</head><body class="tex2jax_ignore">
    <header>
        <brand><a href='/'><img src='/favicon.ico'/></a></brand>
        <nav> / <a href='/' >p</a>  &nbsp;/&nbsp; 
                <div class="dropdown">
                <a href=scipy>scipy</a>&nbsp;/&nbsp;
                    <div class="dropdown-content">
<a href="/p/IPython/8.3.0/api/IPython.html">IPython</a>
<a href="/p/astropy/5.0/api/astropy.html">astropy</a>
<a href="/p/dask/2021.10.0/api/dask.html">dask</a>
<a href="/p/distributed/2021.10.0/api/distributed.html">distributed</a>
<a href="/p/matplotlib/3.5.1/api/matplotlib.html">matplotlib</a>
<a href="/p/networkx/2.7.2rc1.dev0/api/networkx.html">networkx</a>
<a href="/p/numpy/1.22.3/api/numpy.html">numpy</a>
<a href="/p/pandas/1.4.1/api/pandas.html">pandas</a>
<a href="/p/papyri/0.0.8/api/papyri.html">papyri</a>
<a href="/p/scipy/1.8.0/api/scipy.html">scipy</a>
<a href="/p/skimage/0.17.2/api/skimage.html">skimage</a>
                     </div>
                </div>
                <div class="dropdown">
                <a href='/p/scipy/1.8.0/api/scipy.html'>1.8.0</a>&nbsp;/&nbsp;
                    <div class="dropdown-content">
<a href="/p/scipy/1.8.0/api/scipy.html">1.8.0</a>
                    </div>
                </div>

                <div class="dropdown">
                    <a href='/p/scipy/1.8.0/api/scipy.html'>API</a>&nbsp;/&nbsp;
                    <div class="dropdown-content">
                        <a href="/p/scipy/1.8.0/api/scipy.html">API</a>
                        <a href="/p/scipy/1.8.0/gallery">Gallery</a>
                        <a href="/p/scipy/1.8.0/examples">Examples</a>
                        <a href="/p/scipy/1.8.0/docs">Narrative</a>
                     </div>
                </div>

                    <div class="dropdown">
                            <a class="dropbtn" href='scipy.html'>scipy</a>.                    </div><!--end dropdown-->
                    <div class="dropdown">
                            <a class="dropbtn" href='scipy.signal.html'>signal</a>.                            <div class="dropdown-content">
<a href="/p/?/?/?/scipy._lib.html.html">_lib</a>
<a href="/p/scipy/1.8.0/api/scipy.fft.html">fft</a>
<a href="/p/scipy/1.8.0/api/scipy.integrate.html">integrate</a>
<a href="/p/scipy/1.8.0/api/scipy.interpolate.html">interpolate</a>
<a href="/p/scipy/1.8.0/api/scipy.linalg.html">linalg</a>
<a href="/p/scipy/1.8.0/api/scipy.misc.html">misc</a>
<a href="/p/?/?/?/scipy.ndimage.html.html">ndimage</a>
<a href="/p/scipy/1.8.0/api/scipy.optimize.html">optimize</a>
<a href="/p/scipy/1.8.0/api/scipy.signal.html">signal</a>
<a href="/p/scipy/1.8.0/api/scipy.sparse.html">sparse</a>
<a href="/p/scipy/1.8.0/api/scipy.spatial.html">spatial</a>
<a href="/p/scipy/1.8.0/api/scipy.special.html">special</a>
<a href="/p/?/?/?/scipy.stats.html.html">stats</a>
                            </div>
                    </div><!--end dropdown-->
                    <div class="dropdown">
                            <a class="dropbtn" href='scipy.signal._peak_finding.html'>_peak_finding</a>.                            <div class="dropdown-content">
<a href="/p/scipy/1.8.0/api/scipy.signal._arraytools.html">_arraytools</a>
<a href="/p/scipy/1.8.0/api/scipy.signal._bsplines.html">_bsplines</a>
<a href="/p/scipy/1.8.0/api/scipy.signal._czt.html">_czt</a>
<a href="/p/scipy/1.8.0/api/scipy.signal._filter_design.html">_filter_design</a>
<a href="/p/scipy/1.8.0/api/scipy.signal._fir_filter_design.html">_fir_filter_design</a>
<a href="/p/scipy/1.8.0/api/scipy.signal._lti_conversion.html">_lti_conversion</a>
<a href="/p/scipy/1.8.0/api/scipy.signal._ltisys.html">_ltisys</a>
<a href="/p/scipy/1.8.0/api/scipy.signal._max_len_seq.html">_max_len_seq</a>
<a href="/p/scipy/1.8.0/api/scipy.signal._max_len_seq_inner.html">_max_len_seq_inner</a>
<a href="/p/scipy/1.8.0/api/scipy.signal._peak_finding.html">_peak_finding</a>
<a href="/p/scipy/1.8.0/api/scipy.signal._peak_finding_utils.html">_peak_finding_utils</a>
<a href="/p/scipy/1.8.0/api/scipy.signal._savitzky_golay.html">_savitzky_golay</a>
<a href="/p/scipy/1.8.0/api/scipy.signal._signaltools.html">_signaltools</a>
<a href="/p/scipy/1.8.0/api/scipy.signal._sigtools.html">_sigtools</a>
<a href="/p/scipy/1.8.0/api/scipy.signal._sosfilt.html">_sosfilt</a>
<a href="/p/scipy/1.8.0/api/scipy.signal._spectral.html">_spectral</a>
<a href="/p/scipy/1.8.0/api/scipy.signal._spectral_py.html">_spectral_py</a>
<a href="/p/scipy/1.8.0/api/scipy.signal._spline.html">_spline</a>
<a href="/p/scipy/1.8.0/api/scipy.signal._upfirdn.html">_upfirdn</a>
<a href="/p/scipy/1.8.0/api/scipy.signal._upfirdn_apply.html">_upfirdn_apply</a>
<a href="/p/scipy/1.8.0/api/scipy.signal._waveforms.html">_waveforms</a>
<a href="/p/scipy/1.8.0/api/scipy.signal._wavelets.html">_wavelets</a>
<a href="/p/scipy/1.8.0/api/scipy.signal.barthann.html">barthann</a>
<a href="/p/scipy/1.8.0/api/scipy.signal.bartlett.html">bartlett</a>
<a href="/p/scipy/1.8.0/api/scipy.signal.blackman.html">blackman</a>
<a href="/p/scipy/1.8.0/api/scipy.signal.blackmanharris.html">blackmanharris</a>
<a href="/p/scipy/1.8.0/api/scipy.signal.bohman.html">bohman</a>
<a href="/p/scipy/1.8.0/api/scipy.signal.boxcar.html">boxcar</a>
<a href="/p/scipy/1.8.0/api/scipy.signal.bsplines.html">bsplines</a>
<a href="/p/scipy/1.8.0/api/scipy.signal.chebwin.html">chebwin</a>
<a href="/p/scipy/1.8.0/api/scipy.signal.cosine.html">cosine</a>
<a href="/p/scipy/1.8.0/api/scipy.signal.exponential.html">exponential</a>
<a href="/p/scipy/1.8.0/api/scipy.signal.filter_design.html">filter_design</a>
<a href="/p/scipy/1.8.0/api/scipy.signal.fir_filter_design.html">fir_filter_design</a>
<a href="/p/scipy/1.8.0/api/scipy.signal.flattop.html">flattop</a>
<a href="/p/scipy/1.8.0/api/scipy.signal.gaussian.html">gaussian</a>
<a href="/p/scipy/1.8.0/api/scipy.signal.general_gaussian.html">general_gaussian</a>
<a href="/p/scipy/1.8.0/api/scipy.signal.hamming.html">hamming</a>
<a href="/p/scipy/1.8.0/api/scipy.signal.hann.html">hann</a>
<a href="/p/scipy/1.8.0/api/scipy.signal.kaiser.html">kaiser</a>
<a href="/p/scipy/1.8.0/api/scipy.signal.lti_conversion.html">lti_conversion</a>
<a href="/p/scipy/1.8.0/api/scipy.signal.ltisys.html">ltisys</a>
<a href="/p/scipy/1.8.0/api/scipy.signal.nuttall.html">nuttall</a>
<a href="/p/scipy/1.8.0/api/scipy.signal.parzen.html">parzen</a>
<a href="/p/scipy/1.8.0/api/scipy.signal.signaltools.html">signaltools</a>
<a href="/p/scipy/1.8.0/api/scipy.signal.spectral.html">spectral</a>
<a href="/p/scipy/1.8.0/api/scipy.signal.spline.html">spline</a>
<a href="/p/scipy/1.8.0/api/scipy.signal.triang.html">triang</a>
<a href="/p/scipy/1.8.0/api/scipy.signal.tukey.html">tukey</a>
<a href="/p/scipy/1.8.0/api/scipy.signal.waveforms.html">waveforms</a>
<a href="/p/scipy/1.8.0/api/scipy.signal.wavelets.html">wavelets</a>
<a href="/p/scipy/1.8.0/api/scipy.signal.windows.html">windows</a>
                            </div>
                    </div><!--end dropdown-->
                    <div class="dropdown">
                            <a class="dropbtn" href='scipy.signal._peak_finding.find_peaks_cwt.html'>find_peaks_cwt</a>                            <div class="dropdown-content">
<a href="/p/scipy/1.8.0/api/scipy.signal._peak_finding._arg_peaks_as_expected.html">_arg_peaks_as_expected</a>
<a href="/p/scipy/1.8.0/api/scipy.signal._peak_finding._arg_wlen_as_expected.html">_arg_wlen_as_expected</a>
<a href="/p/scipy/1.8.0/api/scipy.signal._peak_finding._arg_x_as_expected.html">_arg_x_as_expected</a>
<a href="/p/scipy/1.8.0/api/scipy.signal._peak_finding._boolrelextrema.html">_boolrelextrema</a>
<a href="/p/scipy/1.8.0/api/scipy.signal._peak_finding._filter_ridge_lines.html">_filter_ridge_lines</a>
<a href="/p/scipy/1.8.0/api/scipy.signal._peak_finding._select_by_peak_threshold.html">_select_by_peak_threshold</a>
<a href="/p/scipy/1.8.0/api/scipy.signal._peak_finding._select_by_property.html">_select_by_property</a>
<a href="/p/scipy/1.8.0/api/scipy.signal._peak_finding._unpack_condition_args.html">_unpack_condition_args</a>
<a href="/p/scipy/1.8.0/api/scipy.signal._peak_finding.argrelextrema.html">argrelextrema</a>
<a href="/p/scipy/1.8.0/api/scipy.signal._peak_finding.argrelmax.html">argrelmax</a>
<a href="/p/scipy/1.8.0/api/scipy.signal._peak_finding.argrelmin.html">argrelmin</a>
<a href="/p/scipy/1.8.0/api/scipy.signal._peak_finding.find_peaks.html">find_peaks</a>
<a href="/p/scipy/1.8.0/api/scipy.signal._peak_finding.find_peaks_cwt.html">find_peaks_cwt</a>
<a href="/p/scipy/1.8.0/api/scipy.signal._peak_finding.peak_prominences.html">peak_prominences</a>
<a href="/p/scipy/1.8.0/api/scipy.signal._peak_finding.peak_widths.html">peak_widths</a>
                            </div>
                    </div><!--end dropdown-->
</nav>
    </header>
    <div class='container'>

    <div class="sidenav">
        <img src="/p/scipy/1.8.0/img/scipy_logo.png"/>
    <a href="#">scipy</a>
    <a href="#">1.8.0</a>
        <a class='external'  href="https://pypi.org/project/scipy">Pypi</a>
        <a class='external' href="https://github.com/scipy/scipy">GitHub</a>
        <a class='external' href="https://scipy.org/">Homepage</a>
    <hr/>
        <a class='external' href="https://docs.scipy.org/doc/scipy/">Other Docs</a>
    <hr/>
<a href="#section-Notes">Notes</a><a href="#section-Parameters">Parameters</a><a href="#section-Returns">Returns</a><a href="#section-backrefs">BackRef</a>
    </div><!--end sidenav-->







<code class='signature'>find_peaks_cwt(vector, widths, wavelet=None, max_distances=None, gap_thresh=None, min_length=None, min_snr=1, noise_perc=10, window_size=None)</code><!-- rendering Extended Summary -->
                       <p>The general approach is to smooth <code class='not-implemented'>:None:None:`vector`</code> by convolving it with <code class='not-implemented'>:None:None:`wavelet(width)`</code> for each width in <code class='not-implemented'>:None:None:`widths`</code>. Relative maxima which appear at enough length scales, and with sufficiently high SNR, are accepted.</p>

<h3 id="section-Notes">Notes</h3>
<!-- rendering Notes -->
                       <p>This approach was designed for finding sharp peaks among noisy data, however with proper parameter selection it should function well for different peak shapes.</p>

               <!-- deflist -->
           <dl>
               <dt><p>The algorithm is as follows:</p>
</dt>
               <dd>           <ol>               <li>               <p>Perform a continuous wavelet transform on <code class='not-implemented'>:None:None:`vector`</code>, for the supplied     <code class='not-implemented'>:None:None:`widths`</code>. This is a convolution of <code class='not-implemented'>:None:None:`vector`</code> with <code class='not-implemented'>:None:None:`wavelet(width)`</code> for     each width in <code class='not-implemented'>:None:None:`widths`</code>. See <code><a href="/p/scipy/1.8.0/api/scipy.signal._wavelets.cwt.html" class='exists'>cwt</a></code>
.</p>

</li>
               <li>               <p>Identify &#34;ridge lines&#34; in the cwt matrix. These are relative maxima     at each row, connected across adjacent rows. See identify_ridge_lines</p>

</li>
               <li>               <p>Filter the ridge_lines using filter_ridge_lines.</p>

</li>
            </ol>
</dd>
           </dl>

                           <div class='admonition'>
    <div>versionadded</div>
</div>


<h3 id="section-Parameters">Parameters</h3>
<dl>
<dt><a id="vector">vector</a> : ndarray</dt>
<dd>
<p>1-D array in which to find the peaks.</p>

</dd>
<dt><a id="widths">widths</a> : float or sequence</dt>
<dd>
<p>Single width or 1-D array-like of widths to use for calculating the CWT matrix. In general, this range should cover the expected width of peaks of interest.</p>

</dd>
<dt><a id="wavelet">wavelet</a> : callable, optional</dt>
<dd>
<p>Should take two parameters and return a 1-D array to convolve with <code class='not-implemented'>:None:None:`vector`</code>. The first parameter determines the number of points of the returned wavelet array, the second parameter is the scale (<code class='not-implemented'>:None:None:`width`</code>) of the wavelet. Should be normalized and symmetric. Default is the ricker wavelet.</p>

</dd>
<dt><a id="max_distances">max_distances</a> : ndarray, optional</dt>
<dd>
<p>At each row, a ridge line is only connected if the relative max at row[n] is within         <code class='verbatim'>max_distances[n]</code>
 from the relative max at         <code class='verbatim'>row[n+1]</code>
.  Default value is         <code class='verbatim'>widths/4</code>
.</p>

</dd>
<dt><a id="gap_thresh">gap_thresh</a> : float, optional</dt>
<dd>
<p>If a relative maximum is not found within <code class='not-implemented'>:None:None:`max_distances`</code>, there will be a gap. A ridge line is discontinued if there are more than <code class='not-implemented'>:None:None:`gap_thresh`</code> points without connecting a new relative maximum. Default is the first value of the widths array i.e. widths[0].</p>

</dd>
<dt><a id="min_length">min_length</a> : int, optional</dt>
<dd>
<p>Minimum length a ridge line needs to be acceptable. Default is         <code class='verbatim'>cwt.shape[0] / 4</code>
, ie 1/4-th the number of widths.</p>

</dd>
<dt><a id="min_snr">min_snr</a> : float, optional</dt>
<dd>
<p>Minimum SNR ratio. Default 1. The signal is the value of the cwt matrix at the shortest length scale (        <code class='verbatim'>cwt[0, loc]</code>
), the noise is the <code class='not-implemented'>:None:None:`noise_perc&#39;th percentile of datapoints contained within a
window of &#39;window_size`</code> around         <code class='verbatim'>cwt[0, loc]</code>
.</p>

</dd>
<dt><a id="noise_perc">noise_perc</a> : float, optional</dt>
<dd>
<p>When calculating the noise floor, percentile of data points examined below which to consider noise. Calculated using <code class='not-implemented'>:None:None:`stats.scoreatpercentile`</code>.  Default is 10.</p>

</dd>
<dt><a id="window_size">window_size</a> : int, optional</dt>
<dd>
<p>Size of window to use to calculate noise floor. Default is         <code class='verbatim'>cwt.shape[1] / 20</code>
.</p>

</dd>
</dl>

<h3 id="section-Returns">Returns</h3>
<dl>
<dt><a id="peaks_indices">peaks_indices</a> : ndarray</dt>
<dd>
<p>Indices of the locations in the <code class='not-implemented'>:None:None:`vector`</code> where peaks were found. The list is sorted.</p>

</dd>
</dl>

<!-- rendering Summary -->
                       <p>Find peaks in a 1-D array with wavelet transformation.</p>

<h3> See Also</h3>
<dl>
            <dt><code><a href="/p/scipy/1.8.0/api/scipy.signal._wavelets.cwt.html" class='exists'>cwt</a></code>
</dt>
            <!-- This See also will be incorrect as the SeeAlsoItems are improperly deserialised. -->
            <dd>        <p>Continuous wavelet transform.</p>
</dd>
        </dl>
<dl>
            <dt><code><a href="/p/scipy/1.8.0/api/scipy.signal._peak_finding.find_peaks.html" class='exists'>find_peaks</a></code>
</dt>
            <!-- This See also will be incorrect as the SeeAlsoItems are improperly deserialised. -->
            <dd>        <p>Find peaks inside a signal based on peak properties.</p>
</dd>
        </dl>
<h3 id="section-Examples">Examples</h3>
<pre class='highlight execed'><span class='nsl'>&gt;&gt;&gt; </span><span class="kn">from</span><span class=""> </span><span class="nn">scipy</span><span class=""> </span><span class="kn">import</span><span class=""> </span><span class="">signal</span><br><span class='nsl'>...&nbsp;</span><span class="">xs</span><span class=""> </span><span class="o">=</span><span class=""> </span><span class="">np</span><span class="o">.</span><span class="">arange</span><span class="">(</span><span class="mi">0</span><span class="">,</span><span class=""> </span><span class="">np</span><span class="o">.</span><span class="">pi</span><span class="">,</span><span class=""> </span><span class="mf">0.05</span><span class="">)</span><br><span class='nsl'>...&nbsp;</span><span class="">data</span><span class=""> </span><span class="o">=</span><span class=""> </span><span class="">np</span><span class="o">.</span><span class="">sin</span><span class="">(</span><span class="">xs</span><span class="">)</span><br><span class='nsl'>...&nbsp;</span><span class="">peakind</span><span class=""> </span><span class="o">=</span><span class=""> </span><span class="">signal</span><span class="o">.</span><span class="">find_peaks_cwt</span><span class="">(</span><span class="">data</span><span class="">,</span><span class=""> </span><span class="">np</span><span class="o">.</span><span class="">arange</span><span class="">(</span><span class="mi">1</span><span class="">,</span><span class="mi">10</span><span class="">)</span><span class="">)</span><br><span class='nsl'>...&nbsp;</span><span class="">peakind</span><span class="">,</span><span class=""> </span><span class="">xs</span><span class="">[</span><span class="">peakind</span><span class="">]</span><span class="">,</span><span class=""> </span><span class="">data</span><span class="">[</span><span class="">peakind</span><span class="">]</span>
([32], array([ 1.6]), array([ 0.9995736]))</pre>
            
         See :
    

    <h3 id='section-backrefs'>Back References</h3>
    <p>The following pages refer to to this document either explicitly or contain code examples using this.</p>

        <code><a link href="/p/scipy/1.8.0/api/scipy.signal._peak_finding.find_peaks.html" class='exists'>scipy.signal._peak_finding.find_peaks</a></code>

<h3>Local connectivity graph</h3>
<p>Hover to see nodes names; edges to Self not shown, Caped at 50 nodes.</p>

<p> Using a canvas is more power efficient and can get hundred of nodes ; but does not allow hyperlinks; , arrows
or text (beyond on hover) </p> 
<canvas class='graph' width="800" height="500"></canvas>
<p> SVG is more flexible but power hungry; and does not scale well to 50 + nodes. </p> 

<svg class='graph' width="600" height="500"></svg>

<p>All aboves nodes referred to, (or are referred from) current nodes; Edges from Self to other have been omitted
(or all nodes would be connected to the central node "self" which is not useful). Nodes are colored by the library
they belong to, and scaled with the number of references pointing them</p>

<hr>

    GitHub : <a class='external' href='https://github.com/scipy/scipy/blob/v1.8.0//scipy/signal/_peak_finding.py#L1190'>/scipy/signal/_peak_finding.py#1190</a>
<br/>

type: &lt;class &#39;function&#39;&gt; <br/>
Commit: <br/>

        <script src="https://d3js.org/d3.v4.min.js"></script>
    <script src="https://d3js.org/d3-selection-multi.v1.js"></script>
    <style type="text/css">
        .node {};
        .link { stroke: #999; stroke-opacity: .6; stroke-width: 1px; };
    </style>
<script>
    window._data_graph = {"nodes": [{"id": 1, "val": 10.82842712474619, "label": "scipy.signal._peak_finding.find_peaks", "mod": "scipy", "url": "/p/scipy/1.8.0/api/scipy.signal._peak_finding.find_peaks"}, {"id": 2, "val": 9.732050807568877, "label": "scipy.signal._wavelets.cwt", "mod": "scipy", "url": "/p/scipy/1.8.0/api/scipy.signal._wavelets.cwt"}], "links": []};
</script>
<script type="text/javascript" src='/graph_canvas.js'></script>
<script type="text/javascript" src='/graph_svg.js'></script>


</div>
</body>
</html>