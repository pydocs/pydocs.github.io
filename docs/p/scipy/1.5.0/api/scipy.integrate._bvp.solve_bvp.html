<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
    <link rel="stylesheet" href="https://fonts.xz.style/serve/inter.css">
	<link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.8.1/css/all.css" integrity="sha384-50oBUHEmvpQ+1lW4y57PTFmhCaXp0ML5d60M1M7uH2+nqUivzIebhndOJK28anvf" crossorigin="anonymous">
    
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@exampledev/new.css@1.1.2/new.min.css">
    <script type="text/javascript">
        // only process math in math tags (faster and less false positive with `...`)
        MathJax = {
          options: {
            ignoreHtmlClass: 'tex2jax_ignore',    //  class that marks tags not to search
            processHtmlClass: 'tex2jax_process',  //  class that marks tags that should be searched
          }
        };
    </script>
    <script type="text/x-mathjax-config">
        MathJax.Hub.Config({tex2jax: {inlineMath: [['$','$'], ['\\(','\\)']]}});
    </script>
    <script type="text/javascript" async
        src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/MathJax.js?config=TeX-MML-AM_CHTML">
    </script>
<style>
body{
    font-family: 'Roboto', 'Helvetica Neue', 'Helvetica', 'Arial', sans-serif;
    color: #606c76;
    font-weight: 350;
    line-height: 1.6;
    max-width: 1000px;
    margin-left:0;

}
          svg,canvas{border: 1px gray solid;}
          .foo:hover{text-decoration:underline}
          .foo{font-weight:bold; color:#4e4e4e}
          .exists{font-weight:bold; color:#4e4e4e;text-decoration:none;}
          .local{font-weight:bold; color:#1e6f04;text-decoration:none;}
          .exists:hover{text-decoration:underline;color:black}
          .missing,.missing:hover{color:darkred;text-decoration:none;font-weight:normal}
          .signature {font-size:100%; margin-bottom: 2rem; display: block; border:none; background-color: #FFFFFF;
              font-weight:600;}
          h1, h2, h3 {color: #4e4e4e; font-weight:400;
              margin-bottom: 1rem;border-bottom: 1px solid var(--nc-bg-3);
          }
          pre{border-radius:0;
              padding:0.6rem;
          border-left: 3px solid #AAA}
          dt {font-weight: 400;}

          header{
              box-shadow: rgba(0, 0, 0, 0.24) 0px 3px 8px;
              
              padding-top:0rem;
              padding-bottom:0rem;
              z-index: 2;
              padding-left: 0;
              position: fixed;
              top: 30px;
              left:0; 
              width: 100%;
              backdrop-filter: blur(5px);
              background-color: rgba(255, 255, 255, .15);
          }
          dd::before {
            content: '';
          }
          header > brand, header>:first-child {
              border-right: 1px solid #ccc;
              border-left: 1px solid #ccc;
              padding: 16px;
              padding-top: 0.5rem;
              padding-bottom: 0.5rem;
              display: inline-block; 
              width: 167px;

          }
          brand > a {color:#606c76}
          brand > i {
              padding-right: 0.5rem;

        }
          nav{display:inline;
          padding-left: 1rem;
          }

          dd {
              margin-left: 1rem;
              border-left:  solid #ddd;
              padding-left: 1rem;
          }
          summary > h2 { display: inline }

          .sidenav {
                height: 100%; /* Full-height: remove this if you want "auto" height */
                width: 200px; /* Set the width of the sidebar */
                position: fixed; /* Fixed Sidebar (stay in place on scroll) */
                z-index: 1; /* Stay on top */
                top: 0; /* Stay at the top */
                left: 0;
                background-color: var(--nc-bg-1);; /* Black */
                border-right: thin solid #ccc;
                overflow-x: hidden; /* Disable horizontal scroll */
                padding-top: 3rem;
 
                box-shadow: rgba(0, 0, 0, 0.24) 0px 3px 8px;
          }

          .sidenav a {
            padding: 6px 8px 6px 16px;
            text-decoration: none;
            color: #818181;
            display: block;
          }
          .sidenav img {
              width: 160px;
              padding-left:20px;
              padding-right:20px;
              border-bottom: solid thin #DDD; 
              padding-bottom: .5rem;
              max-width: 100%;
          }
          .sidenav i {
              font-size: 100;
              padding-left: 3.5rem;
              padding-right: 3.5rem;
              padding-bottom: .5rem;
              border-bottom: solid thin #DDD; 

          }
          .container {
              padding-left: 210px;
              padding-top: 30px;

          }

          ::selection {
	/* Set background color for selected text */
                background: #59b4fd;
                color: var(--nc-ac-tx);
          }

          img {max-width: 40%;}

          pre.highlight.execed, .admonition {
            border-left: 3px solid #0070f3;
          }
          .admonition {
            padding-left: 1em;
         }
          .note {color: #7d77d2}
          .warning {color: #f44336}
          pre.highlight.compiled {
            border-left: 3px solid #7d77d2;
          }
          pre.highlight.syntax_error, pre.highlight.exception_in_exec {
            border-left: 3px solid #f44336;
          }

        /* Dropdown Button */
/* The container <div> - needed to position the dropdown content */
.dropdown {
  position: relative;
  display: inline-block;
  margin-left: -4px;
}

/* Dropdown Content (Hidden by Default) */
.dropdown-content {
  display: none;
  position: absolute;
  background-color: #f1f1f1;
  min-width: 160px;
  box-shadow: 0px 8px 16px 0px rgba(0,0,0,0.2);
  z-index: 1;
}

/* Links inside the dropdown */
.dropdown-content a {
  color: black;
  padding: 12px 16px;
  text-decoration: none;
  display: block;
}

/* Change color of dropdown links on hover */
.dropdown-content a:hover {background-color: #ddd;}

/* Show the dropdown menu on hover */
.dropdown:hover .dropdown-content {display: block;
    max-height: 80vh;
    overflow: scroll;}

/* Change the background color of the dropdown button when the dropdown content is shown */
.dropdown:hover .dropbtn {}


pre { line-height: 125%; }
td.linenos .normal { color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px; }
span.linenos { color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px; }
td.linenos .special { color: #000000; background-color: #ffffc0; padding-left: 5px; padding-right: 5px; }
span.linenos.special { color: #000000; background-color: #ffffc0; padding-left: 5px; padding-right: 5px; }
.highlight .hll { background-color: #ffffcc }
.highlight { background: #ffffff; }
.highlight .c { color: #888888 } /* Comment */
.highlight .err { color: #a61717; background-color: #e3d2d2 } /* Error */
.highlight .k { color: #008800; font-weight: bold } /* Keyword */
.highlight .ch { color: #888888 } /* Comment.Hashbang */
.highlight .cm { color: #888888 } /* Comment.Multiline */
.highlight .cp { color: #cc0000; font-weight: bold } /* Comment.Preproc */
.highlight .cpf { color: #888888 } /* Comment.PreprocFile */
.highlight .c1 { color: #888888 } /* Comment.Single */
.highlight .cs { color: #cc0000; font-weight: bold; background-color: #fff0f0 } /* Comment.Special */
.highlight .gd { color: #000000; background-color: #ffdddd } /* Generic.Deleted */
.highlight .ge { font-style: italic } /* Generic.Emph */
.highlight .gr { color: #aa0000 } /* Generic.Error */
.highlight .gh { color: #333333 } /* Generic.Heading */
.highlight .gi { color: #000000; background-color: #ddffdd } /* Generic.Inserted */
.highlight .go { color: #888888 } /* Generic.Output */
.highlight .gp { color: #555555 } /* Generic.Prompt */
.highlight .gs { font-weight: bold } /* Generic.Strong */
.highlight .gu { color: #666666 } /* Generic.Subheading */
.highlight .gt { color: #aa0000 } /* Generic.Traceback */
.highlight .kc { color: #008800; font-weight: bold } /* Keyword.Constant */
.highlight .kd { color: #008800; font-weight: bold } /* Keyword.Declaration */
.highlight .kn { color: #008800; font-weight: bold } /* Keyword.Namespace */
.highlight .kp { color: #008800 } /* Keyword.Pseudo */
.highlight .kr { color: #008800; font-weight: bold } /* Keyword.Reserved */
.highlight .kt { color: #888888; font-weight: bold } /* Keyword.Type */
.highlight .m { color: #0000DD; font-weight: bold } /* Literal.Number */
.highlight .s { color: #dd2200; background-color: #fff0f0 } /* Literal.String */
.highlight .na { color: #336699 } /* Name.Attribute */
.highlight .nb { color: #003388 } /* Name.Builtin */
.highlight .nc { color: #bb0066; font-weight: bold } /* Name.Class */
.highlight .no { color: #003366; font-weight: bold } /* Name.Constant */
.highlight .nd { color: #555555 } /* Name.Decorator */
.highlight .ne { color: #bb0066; font-weight: bold } /* Name.Exception */
.highlight .nf { color: #0066bb; font-weight: bold } /* Name.Function */
.highlight .nl { color: #336699; font-style: italic } /* Name.Label */
.highlight .nn { color: #bb0066; font-weight: bold } /* Name.Namespace */
.highlight .py { color: #336699; font-weight: bold } /* Name.Property */
.highlight .nt { color: #bb0066; font-weight: bold } /* Name.Tag */
.highlight .nv { color: #336699 } /* Name.Variable */
.highlight .ow { color: #008800 } /* Operator.Word */
.highlight .w { color: #bbbbbb } /* Text.Whitespace */
.highlight .mb { color: #0000DD; font-weight: bold } /* Literal.Number.Bin */
.highlight .mf { color: #0000DD; font-weight: bold } /* Literal.Number.Float */
.highlight .mh { color: #0000DD; font-weight: bold } /* Literal.Number.Hex */
.highlight .mi { color: #0000DD; font-weight: bold } /* Literal.Number.Integer */
.highlight .mo { color: #0000DD; font-weight: bold } /* Literal.Number.Oct */
.highlight .sa { color: #dd2200; background-color: #fff0f0 } /* Literal.String.Affix */
.highlight .sb { color: #dd2200; background-color: #fff0f0 } /* Literal.String.Backtick */
.highlight .sc { color: #dd2200; background-color: #fff0f0 } /* Literal.String.Char */
.highlight .dl { color: #dd2200; background-color: #fff0f0 } /* Literal.String.Delimiter */
.highlight .sd { color: #dd2200; background-color: #fff0f0 } /* Literal.String.Doc */
.highlight .s2 { color: #dd2200; background-color: #fff0f0 } /* Literal.String.Double */
.highlight .se { color: #0044dd; background-color: #fff0f0 } /* Literal.String.Escape */
.highlight .sh { color: #dd2200; background-color: #fff0f0 } /* Literal.String.Heredoc */
.highlight .si { color: #3333bb; background-color: #fff0f0 } /* Literal.String.Interpol */
.highlight .sx { color: #22bb22; background-color: #f0fff0 } /* Literal.String.Other */
.highlight .sr { color: #008800; background-color: #fff0ff } /* Literal.String.Regex */
.highlight .s1 { color: #dd2200; background-color: #fff0f0 } /* Literal.String.Single */
.highlight .ss { color: #aa6600; background-color: #fff0f0 } /* Literal.String.Symbol */
.highlight .bp { color: #003388 } /* Name.Builtin.Pseudo */
.highlight .fm { color: #0066bb; font-weight: bold } /* Name.Function.Magic */
.highlight .vc { color: #336699 } /* Name.Variable.Class */
.highlight .vg { color: #dd7700 } /* Name.Variable.Global */
.highlight .vi { color: #3333bb } /* Name.Variable.Instance */
.highlight .vm { color: #336699 } /* Name.Variable.Magic */
.highlight .il { color: #0000DD; font-weight: bold } /* Literal.Number.Integer.Long */

.nsl {
-webkit-touch-callout: none;
-webkit-user-select: none;
-khtml-user-select: none;
-moz-user-select: none;
-ms-user-select: none;
user-select: none;
}


.block_directive{

    border-left: thin solid var(--nc-lk-1);
    padding-bottom: 8px;
    padding-left: 12px;
}

.block_directive.head{

    border: thin solid var(--nc-lk-1);
}


.block_directive > p{
    margin-left: 2em;
    margin-top: 1em;
}
.head {
    font-family: monospace;
    color: var(--nc-lk-1);
}
</style>
</head>
<body class="tex2jax_ignore">
    <header>
        <brand><i class="fab fa-python"></i><a href='/'>Home</a></brand>
        <nav> <a href='/' >/ p</a>  / 
                <div class="dropdown">
                <a href=scipy>scipy</a>&nbsp;/&nbsp;
                    <div class="dropdown-content">
                            <a href="/p/IPython/8.0.0.dev/api/IPython.html">IPython</a>
                            <a href="/p/dask/2021.01.1+8.g34f990a81/api/dask.html">dask</a>
                            <a href="/p/distributed/2021.01.1+9.g613b3c820/api/distributed.html">distributed</a>
                            <a href="/p/matplotlib/3.3.3/api/matplotlib.html">matplotlib</a>
                            <a href="/p/numpy/1.20.0/api/numpy.html">numpy</a>
                            <a href="/p/papyri/0.0.6/api/papyri.html">papyri</a>
                            <a href="/p/scipy/1.5.0/api/scipy.html">scipy</a>
                            
                     </div>
                </div>
                <div class="dropdown">
                <a href='/p/scipy/1.5.0/api/scipy.html'>1.5.0</a>&nbsp;/&nbsp;
                    <div class="dropdown-content">
                            <a href="/p/scipy/1.5.0/api/scipy.html">1.5.0</a>
                            
                    </div>
                </div>

                <div class="dropdown">
                    <a href='/p/scipy/1.5.0/api/scipy.html'>api</a>&nbsp;/&nbsp;
                    <div class="dropdown-content">
                        <a href="/p/scipy/1.5.0/api/scipy.html">API</a>
                        <a href="/p/scipy/1.5.0/gallery">Gallery</a>
                     </div>
                </div>

            
                
                    <div class="dropdown">
                        
                            <a class="dropbtn" href='scipy.html'>scipy</a>.
                        
                        
                    </div>
                
                
                    <div class="dropdown">
                        
                            <a class="dropbtn" href='scipy.integrate.html'>integrate</a>.
                        
                        
                            <div class="dropdown-content">
                            <a href="/p/scipy/1.5.0/api/scipy.__config__.html">__config__</a>
                            <a href="/p/scipy/1.5.0/api/scipy._distributor_init.html">_distributor_init</a>
                            <a href="/p/scipy/1.5.0/api/scipy._lib.html">_lib</a>
                            <a href="/p/scipy/1.5.0/api/scipy.constants.html">constants</a>
                            <a href="/p/scipy/1.5.0/api/scipy.fft.html">fft</a>
                            <a href="/p/scipy/1.5.0/api/scipy.integrate.html">integrate</a>
                            <a href="/p/scipy/1.5.0/api/scipy.interpolate.html">interpolate</a>
                            <a href="/p/scipy/1.5.0/api/scipy.linalg.html">linalg</a>
                            <a href="/p/scipy/1.5.0/api/scipy.misc.html">misc</a>
                            <a href="/p/scipy/1.5.0/api/scipy.ndimage.html">ndimage</a>
                            <a href="/p/scipy/1.5.0/api/scipy.optimize.html">optimize</a>
                            <a href="/p/scipy/1.5.0/api/scipy.signal.html">signal</a>
                            <a href="/p/scipy/1.5.0/api/scipy.sparse.html">sparse</a>
                            <a href="/p/scipy/1.5.0/api/scipy.spatial.html">spatial</a>
                            <a href="/p/scipy/1.5.0/api/scipy.special.html">special</a>
                            <a href="/p/scipy/1.5.0/api/scipy.stats.html">stats</a>
                            <a href="/p/scipy/1.5.0/api/scipy.version.html">version</a>
                            
                            </div>
                        
                    </div>
                
                
                    <div class="dropdown">
                        
                            <a class="dropbtn" href='scipy.integrate._bvp.html'>_bvp</a>.
                        
                        
                            <div class="dropdown-content">
                            <a href="/p/scipy/1.5.0/api/scipy.integrate._bvp.html">_bvp</a>
                            <a href="/p/scipy/1.5.0/api/scipy.integrate._dop.html">_dop</a>
                            <a href="/p/scipy/1.5.0/api/scipy.integrate._ivp.html">_ivp</a>
                            <a href="/p/scipy/1.5.0/api/scipy.integrate._ode.html">_ode</a>
                            <a href="/p/scipy/1.5.0/api/scipy.integrate._odepack.html">_odepack</a>
                            <a href="/p/scipy/1.5.0/api/scipy.integrate._quad_vec.html">_quad_vec</a>
                            <a href="/p/scipy/1.5.0/api/scipy.integrate._quadpack.html">_quadpack</a>
                            <a href="/p/scipy/1.5.0/api/scipy.integrate._quadrature.html">_quadrature</a>
                            <a href="/p/scipy/1.5.0/api/scipy.integrate.lsoda.html">lsoda</a>
                            <a href="/p/scipy/1.5.0/api/scipy.integrate.odepack.html">odepack</a>
                            <a href="/p/scipy/1.5.0/api/scipy.integrate.quadpack.html">quadpack</a>
                            <a href="/p/scipy/1.5.0/api/scipy.integrate.vode.html">vode</a>
                            
                            </div>
                        
                    </div>
                
                
                    <div class="dropdown">
                        
                            <a class="dropbtn" href='scipy.integrate._bvp.solve_bvp.html'>solve_bvp</a>
                        
                        
                            <div class="dropdown-content">
                            <a href="/p/scipy/1.5.0/api/scipy.integrate._bvp.collocation_fun.html">collocation_fun</a>
                            <a href="/p/scipy/1.5.0/api/scipy.integrate._bvp.compute_jac_indices.html">compute_jac_indices</a>
                            <a href="/p/scipy/1.5.0/api/scipy.integrate._bvp.construct_global_jac.html">construct_global_jac</a>
                            <a href="/p/scipy/1.5.0/api/scipy.integrate._bvp.create_spline.html">create_spline</a>
                            <a href="/p/scipy/1.5.0/api/scipy.integrate._bvp.estimate_bc_jac.html">estimate_bc_jac</a>
                            <a href="/p/scipy/1.5.0/api/scipy.integrate._bvp.estimate_fun_jac.html">estimate_fun_jac</a>
                            <a href="/p/scipy/1.5.0/api/scipy.integrate._bvp.estimate_rms_residuals.html">estimate_rms_residuals</a>
                            <a href="/p/scipy/1.5.0/api/scipy.integrate._bvp.modify_mesh.html">modify_mesh</a>
                            <a href="/p/scipy/1.5.0/api/scipy.integrate._bvp.prepare_sys.html">prepare_sys</a>
                            <a href="/p/scipy/1.5.0/api/scipy.integrate._bvp.solve_bvp.html">solve_bvp</a>
                            <a href="/p/scipy/1.5.0/api/scipy.integrate._bvp.solve_newton.html">solve_newton</a>
                            <a href="/p/scipy/1.5.0/api/scipy.integrate._bvp.stacked_matmul.html">stacked_matmul</a>
                            <a href="/p/scipy/1.5.0/api/scipy.integrate._bvp.wrap_functions.html">wrap_functions</a>
                            
                            </div>
                        
                    </div>
                </nav>
    </header>
<div class='container'>
    <div class="sidenav">
    
        <img src="/p/scipy/1.5.0/img/logo.png"/>
    
    <a href="#">Library: scipy</a>
    <a href="#">Version: 1.5.0</a>
    <a href="#">Authors:</a>
    <a href="#">PyPI:</a>
    <a href="#">Source</a>
    <a href="#">Homepage</a>
    <a href="#">Fundings</a>
    <a href="#">Stars</a>
    <a href="#">Forks</a>
    <a href="#">Related</a>
    <hr/>
    <a>Narrative Docs</a>
    <hr/>
    <a href="#section-Parameters">Parameters</a>

    <a href="#section-Returns">Returns</a>

    <a href="#section-Notes">Notes</a>

    

    </div>

    













    <code class='signature'>solve_bvp(fun, bc, x, y, p=None, S=None, fun_jac=None, bc_jac=None, tol=0.001, max_nodes=1000, verbose=0, bc_tol=None)</code>




    
    
        <!-- rendering Summary -->
        
           
               
        <p>Solve a boundary value problem for a system of ODEs.</p>

    
           
       
    


    
    
        <!-- rendering Extended Summary -->
        
           
               
        <p>This function numerically solves a first order system of ODEs subject to two-point boundary conditions::</p>

    
           
               
            <pre>dy / dx = f(x, y, p) + S * y / (x - a), a &lt;= x &lt;= b
bc(y(a), y(b), p) = 0
</pre>
       
           
               
        <p>Here x is a 1-D independent variable, y(x) is an N-D vector-valued function and p is a k-D vector of unknown parameters which is to be found along with y(x). For the problem to be determined, there must be n + k boundary conditions, i.e., bc must be an (n + k)-D function.</p>

    
           
               
        <p>The last singular term on the right-hand side of the system is optional. It is defined by an n-by-n matrix S, such that the solution must satisfy S y(a) = 0. This condition will be forced during iterations, so it must not contradict boundary conditions. See [2]_ for the explanation how this term is handled when solving BVPs numerically.</p>

    
           
               
        <p>Problems in a complex domain can be solved as well. In this case, y and p are considered to be complex, and f and bc are assumed to be complex-valued functions, but x stays real. Note that f and bc must be complex differentiable (satisfy Cauchy-Riemann equations [4]_), otherwise you should rewrite your problem for real and imaginary parts separately. To solve a problem in a complex domain, pass an initial guess for y with a complex data type (see below).</p>

    
           
       
    


    
        <h3 id="section-Parameters">Parameters</h3>
    
    
       <dl>
           
            
                <dt><a id="fun">fun</a> : callable</dt>
            
        </dl>

        <dd>
            
                
        <p>Right-hand side of the system. The calling signature is 
        <code class='verbatim'>fun(x, y)</code>
    , or 
        <code class='verbatim'>fun(x, y, p)</code>
     if parameters are present. All arguments are ndarray: 
        <code class='verbatim'>x</code>
     with shape (m,), 
        <code class='verbatim'>y</code>
     with shape (n, m), meaning that 
        <code class='verbatim'>y[:, i]</code>
     corresponds to 
        <code class='verbatim'>x[i]</code>
    , and 
        <code class='verbatim'>p</code>
     with shape (k,). The return value must be an array with shape (n, m) and with the same layout as 
        <code class='verbatim'>y</code>
    .</p>

    
            
        </dd>
       
            
                <dt><a id="bc">bc</a> : callable</dt>
            
        </dl>

        <dd>
            
                
        <p>Function evaluating residuals of the boundary conditions. The calling signature is 
        <code class='verbatim'>bc(ya, yb)</code>
    , or 
        <code class='verbatim'>bc(ya, yb, p)</code>
     if parameters are present. All arguments are ndarray: 
        <code class='verbatim'>ya</code>
     and 
        <code class='verbatim'>yb</code>
     with shape (n,), and 
        <code class='verbatim'>p</code>
     with shape (k,). The return value must be an array with shape (n + k,).</p>

    
            
        </dd>
       
            
                <dt><a id="x">x</a> : array_like, shape (m,)</dt>
            
        </dl>

        <dd>
            
                
        <p>Initial mesh. Must be a strictly increasing sequence of real numbers with 
        <code class='verbatim'>x[0]=a</code>
     and 
        <code class='verbatim'>x[-1]=b</code>
    .</p>

    
            
        </dd>
       
            
                <dt><a id="y">y</a> : array_like, shape (n, m)</dt>
            
        </dl>

        <dd>
            
                
        <p>Initial guess for the function values at the mesh nodes, ith column corresponds to 
        <code class='verbatim'>x[i]</code>
    . For problems in a complex domain pass <code><a link href="#y" class='local'>y</a></code> with a complex data type (even if the initial guess is purely real).</p>

    
            
        </dd>
       
            
                <dt><a id="p">p</a> : array_like with shape (k,) or None, optional</dt>
            
        </dl>

        <dd>
            
                
        <p>Initial guess for the unknown parameters. If None (default), it is assumed that the problem doesn&#39;t depend on any parameters.</p>

    
            
        </dd>
       
            
                <dt><a id="S">S</a> : array_like with shape (n, n) or None</dt>
            
        </dl>

        <dd>
            
                
        <p>Matrix defining the singular term. If None (default), the problem is solved without the singular term.</p>

    
            
        </dd>
       
            
                <dt><a id="fun_jac">fun_jac</a> : callable or None, optional</dt>
            
        </dl>

        <dd>
            
                
        <p>Function computing derivatives of f with respect to y and p. The calling signature is 
        <code class='verbatim'>fun_jac(x, y)</code>
    , or 
        <code class='verbatim'>fun_jac(x, y, p)</code>
     if parameters are present. The return must contain 1 or 2 elements in the following order:</p>

    
            
                
          <!-- deflist -->
           <dl>
               
               <dt>
        <p>* df_dy : array_like with shape (n, n, m), where an element</p>

    <dt>
               <dd>

                       
        <p>(i, j, q) equals to d f_i(x_q, y_q, p) / d (y_q)_j.</p>

    
                  
               <dd>
               
               <dt>
        <p>* df_dp : array_like with shape (n, k, m), where an element</p>

    <dt>
               <dd>

                       
        <p>(i, j, q) equals to d f_i(x_q, y_q, p) / d p_j. </p>

    
                  
               <dd>
                 
           </dl>
       
            
                
        <p>Here q numbers nodes at which x and y are defined, whereas i and j number vector components. If the problem is solved without unknown parameters, df_dp should not be returned.</p>

    
            
                
        <p>If <code><a link href="#fun_jac" class='local'>fun_jac</a></code> is None (default), the derivatives will be estimated by the forward finite differences.</p>

    
            
        </dd>
       
            
                <dt><a id="bc_jac">bc_jac</a> : callable or None, optional</dt>
            
        </dl>

        <dd>
            
                
        <p>Function computing derivatives of bc with respect to ya, yb, and p. The calling signature is 
        <code class='verbatim'>bc_jac(ya, yb)</code>
    , or 
        <code class='verbatim'>bc_jac(ya, yb, p)</code>
     if parameters are present. The return must contain 2 or 3 elements in the following order:</p>

    
            
                
          <!-- deflist -->
           <dl>
               
               <dt>
        <p>* dbc_dya : array_like with shape (n, n), where an element (i, j)</p>

    <dt>
               <dd>

                       
        <p>equals to d bc_i(ya, yb, p) / d ya_j.</p>

    
                  
               <dd>
               
               <dt>
        <p>* dbc_dyb : array_like with shape (n, n), where an element (i, j)</p>

    <dt>
               <dd>

                       
        <p>equals to d bc_i(ya, yb, p) / d yb_j.</p>

    
                  
               <dd>
               
               <dt>
        <p>* dbc_dp : array_like with shape (n, k), where an element (i, j)</p>

    <dt>
               <dd>

                       
        <p>equals to d bc_i(ya, yb, p) / d p_j. </p>

    
                  
               <dd>
                 
           </dl>
       
            
                
        <p>If the problem is solved without unknown parameters, dbc_dp should not be returned.</p>

    
            
                
        <p>If <code><a link href="#bc_jac" class='local'>bc_jac</a></code> is None (default), the derivatives will be estimated by the forward finite differences.</p>

    
            
        </dd>
       
            
                <dt><a id="tol">tol</a> : float, optional</dt>
            
        </dl>

        <dd>
            
                
        <p>Desired tolerance of the solution. If we define 
        <code class='verbatim'>r = y&#39; - f(x, y)</code>
    , where y is the found solution, then the solver tries to achieve on each mesh interval 
        <code class='verbatim'>norm(r / (1 + abs(f)) &lt; tol</code>
    , where 
        <code class='verbatim'>norm</code>
     is estimated in a root mean squared sense (using a numerical quadrature formula). Default is 1e-3.</p>

    
            
        </dd>
       
            
                <dt><a id="max_nodes">max_nodes</a> : int, optional</dt>
            
        </dl>

        <dd>
            
                
        <p>Maximum allowed number of the mesh nodes. If exceeded, the algorithm terminates. Default is 1000.</p>

    
            
        </dd>
       
            
                <dt><a id="verbose">verbose</a> : {0, 1, 2}, optional</dt>
            
        </dl>

        <dd>
            
                
        <p>Level of algorithm&#39;s verbosity:</p>

    
            
                
        <p>    * 0 (default) : work silently.     * 1 : display a termination report.     * 2 : display progress during iterations.</p>

    
            
        </dd>
       
            
                <dt><a id="bc_tol">bc_tol</a> : float, optional</dt>
            
        </dl>

        <dd>
            
                
        <p>Desired absolute tolerance for the boundary condition residuals: <code><a link href="#bc" class='local'>bc</a></code> value should satisfy 
        <code class='verbatim'>abs(bc) &lt; bc_tol</code>
     component-wise. Equals to <code><a link href="#tol" class='local'>tol</a></code> by default. Up to 10 iterations are allowed to achieve this tolerance.</p>

    
            
        </dd>
       

   </pre>
   


    
        <h3 id="section-Returns">Returns</h3>
    
    
       <dl>
           
            
                <dt>Bunch object with the following fields defined:</dt>
            
        </dl>

        <dd>
            
        </dd>
       
            
                <dt><a id="sol">sol</a> : PPoly</dt>
            
        </dl>

        <dd>
            
                
        <p>Found solution for y as <code><a link href="/p/scipy/1.5.0/api/scipy.interpolate.interpolate.PPoly.html" class='exists'>scipy.interpolate.PPoly</a></code>
         instance, a C1 continuous cubic spline.</p>

    
            
        </dd>
       
            
                <dt><a id="p">p</a> : ndarray or None, shape (k,)</dt>
            
        </dl>

        <dd>
            
                
        <p>Found parameters. None, if the parameters were not present in the problem.</p>

    
            
        </dd>
       
            
                <dt><a id="x">x</a> : ndarray, shape (m,)</dt>
            
        </dl>

        <dd>
            
                
        <p>Nodes of the final mesh.</p>

    
            
        </dd>
       
            
                <dt><a id="y">y</a> : ndarray, shape (n, m)</dt>
            
        </dl>

        <dd>
            
                
        <p>Solution values at the mesh nodes.</p>

    
            
        </dd>
       
            
                <dt><a id="yp">yp</a> : ndarray, shape (n, m)</dt>
            
        </dl>

        <dd>
            
                
        <p>Solution derivatives at the mesh nodes.</p>

    
            
        </dd>
       
            
                <dt><a id="rms_residuals">rms_residuals</a> : ndarray, shape (m - 1,)</dt>
            
        </dl>

        <dd>
            
                
        <p>RMS values of the relative residuals over each mesh interval (see the description of <code><a link href="#tol" class='local'>tol</a></code> parameter).</p>

    
            
        </dd>
       
            
                <dt><a id="niter">niter</a> : int</dt>
            
        </dl>

        <dd>
            
                
        <p>Number of completed iterations.</p>

    
            
        </dd>
       
            
                <dt><a id="status">status</a> : int</dt>
            
        </dl>

        <dd>
            
                
        <p>Reason for algorithm termination:</p>

    
            
                
        <p>    * 0: The algorithm converged to the desired accuracy.     * 1: The maximum number of mesh nodes is exceeded.     * 2: A singular Jacobian encountered when solving the collocation</p>

    
            
                
        <p>      system.</p>

    
            
        </dd>
       
            
                <dt><a id="message">message</a> : string</dt>
            
        </dl>

        <dd>
            
                
        <p>Verbal description of the termination reason.</p>

    
            
        </dd>
       
            
                <dt><a id="success">success</a> : bool</dt>
            
        </dl>

        <dd>
            
                
        <p>True if the algorithm converged to the desired accuracy (
        <code class='verbatim'>status=0</code>
    ).</p>

    
            
        </dd>
       

   </pre>
   


    
    
       <dl>
           

   </pre>
   


    
    
       
   


    
    
       <dl>
           

   </pre>
   


    
    
       <dl>
           

   </pre>
   


    
    
       <dl>
           

   </pre>
   


    
    
       <dl>
           

   </pre>
   


    
    
       
   


    
        <h3 id="section-Notes">Notes</h3>
    
    
        <!-- rendering Notes -->
        
           
               
        <p>This function implements a 4th order collocation algorithm with the control of residuals similar to [1]_. A collocation system is solved by a damped Newton method with an affine-invariant criterion function as described in [3]_.</p>

    
           
               
        <p>Note that in [1]_  integral residuals are defined without normalization by interval lengths. So, their definition is different by a multiplier of h**0.5 (h is an interval length) from the definition used here.</p>

    
           
               
            <div class='admonition'>
    <div>versionadded</div>
    
</div>

       
           
       
    


    
    
       
   



    <h3 id="section-Examples">Examples</h3>
        
                
        <p>In the first example, we solve Bratu&#39;s problem::</p>

    
            
            
         
                
          <!-- deflist -->
           <dl>
               
               <dt>
        <p>:: workaround numpyoc summary/ext summary bug in take2::Line.__init__</p>

    <dt>
               <dd>

                       
        <p>y&#39;&#39; + k * exp(y) = 0 y(0) = y(1) = 0</p>

    
                  
               <dd>
                 
           </dl>
       
            
            
         
                
        <p>for k = 1.</p>

    
            
            
         
                
        <p>We rewrite the equation as a first-order system and implement its right-hand side evaluation::</p>

    
            
            
         
                
          <!-- deflist -->
           <dl>
               
               <dt>
        <p>:: workaround numpyoc summary/ext summary bug in take2::Line.__init__</p>

    <dt>
               <dd>

                       
        <p>y1&#39; = y2 y2&#39; = -exp(y1)</p>

    
                  
               <dd>
                 
           </dl>
       
            
            
         
                <pre class='highlight execed'><span class='nsl'>&gt;&gt;&gt; </span><span class="k">def</span><span class=""> </span><span class="nf">fun</span><span class="">(</span><span class="">x</span><span class="">,</span><span class=""> </span><span class="">y</span><span class="">)</span><span class="">:</span><br><span class='nsl'>...&nbsp;</span><span class="">    </span><span class="k">return</span><span class=""> </span><a class="foo ", href="/p/numpy/1.20.0/api/numpy.html">np</a><span class="o">.</span><a class="foo ", href="/p/numpy/1.20.0/api/numpy.vstack.html">vstack</a><span class="">(</span><span class="">(</span><span class="">y</span><span class="">[</span><span class="mi">1</span><span class="">]</span><span class="">,</span><span class=""> </span><span class="o">-</span><a class="foo ", href="/p/numpy/1.20.0/api/numpy.html">np</a><span class="o">.</span><a class="foo ", href="/p/numpy/1.20.0/api/numpy.ufunc.html">exp</a><span class="">(</span><span class="">y</span><span class="">[</span><span class="mi">0</span><span class="">]</span><span class="">)</span><span class="">)</span><span class="">)</span>
</pre>
            
            
         
                
        <p>Implement evaluation of the boundary condition residuals:</p>

    
            
            
         
                <pre class='highlight execed'><span class='nsl'>&gt;&gt;&gt; </span><span class="k">def</span><span class=""> </span><span class="nf">bc</span><span class="">(</span><span class="">ya</span><span class="">,</span><span class=""> </span><span class="">yb</span><span class="">)</span><span class="">:</span><br><span class='nsl'>...&nbsp;</span><span class="">    </span><span class="k">return</span><span class=""> </span><a class="foo ", href="/p/numpy/1.20.0/api/numpy.html">np</a><span class="o">.</span><a class="foo ", href="/p/numpy/1.20.0/api/numpy.array.html">array</a><span class="">(</span><span class="">[</span><span class="">ya</span><span class="">[</span><span class="mi">0</span><span class="">]</span><span class="">,</span><span class=""> </span><span class="">yb</span><span class="">[</span><span class="mi">0</span><span class="">]</span><span class="">]</span><span class="">)</span>
</pre>
            
            
         
                
        <p>Define the initial mesh with 5 nodes:</p>

    
            
            
         
                <pre class='highlight execed'><span class='nsl'>&gt;&gt;&gt; </span><span class="">x</span><span class=""> </span><span class="o">=</span><span class=""> </span><a class="foo ", href="/p/numpy/1.20.0/api/numpy.html">np</a><span class="o">.</span><a class="foo ", href="/p/numpy/1.20.0/api/numpy.linspace.html">linspace</a><span class="">(</span><span class="mi">0</span><span class="">,</span><span class=""> </span><span class="mi">1</span><span class="">,</span><span class=""> </span><span class="mi">5</span><span class="">)</span>
</pre>
            
            
         
                
        <p>This problem is known to have two solutions. To obtain both of them, we use two different initial guesses for y. We denote them by subscripts a and b.</p>

    
            
            
         
                <pre class='highlight execed'><span class='nsl'>&gt;&gt;&gt; </span><a class="foo ", href="/p/numpy/1.20.0/api/numpy.ndarray.html">y_a</a><span class=""> </span><span class="o">=</span><span class=""> </span><a class="foo ", href="/p/numpy/1.20.0/api/numpy.html">np</a><span class="o">.</span><a class="foo ", href="/p/numpy/1.20.0/api/numpy.zeros.html">zeros</a><span class="">(</span><span class="">(</span><span class="mi">2</span><span class="">,</span><span class=""> </span><span class="">x</span><span class="o">.</span><span class="">size</span><span class="">)</span><span class="">)</span><br><span class='nsl'>...&nbsp;</span><a class="foo ", href="/p/numpy/1.20.0/api/numpy.ndarray.html">y_b</a><span class=""> </span><span class="o">=</span><span class=""> </span><a class="foo ", href="/p/numpy/1.20.0/api/numpy.html">np</a><span class="o">.</span><a class="foo ", href="/p/numpy/1.20.0/api/numpy.zeros.html">zeros</a><span class="">(</span><span class="">(</span><span class="mi">2</span><span class="">,</span><span class=""> </span><span class="">x</span><span class="o">.</span><span class="">size</span><span class="">)</span><span class="">)</span><br><span class='nsl'>...&nbsp;</span><a class="foo ", href="/p/numpy/1.20.0/api/numpy.ndarray.html">y_b</a><span class="">[</span><span class="mi">0</span><span class="">]</span><span class=""> </span><span class="o">=</span><span class=""> </span><span class="mi">3</span>
</pre>
            
            
         
                
        <p>Now we are ready to run the solver.</p>

    
            
            
         
                <pre class='highlight execed'><span class='nsl'>&gt;&gt;&gt; </span><span class="kn">from</span><span class=""> </span><span class="nn">scipy</span><span class="nn">.</span><span class="nn">integrate</span><span class=""> </span><span class="kn">import</span><span class=""> </span><span class="">solve_bvp</span><br><span class='nsl'>...&nbsp;</span><br><span class='nsl'>...&nbsp;</span><span class="">res_a</span><span class=""> </span><span class="o">=</span><span class=""> </span><span class="">solve_bvp</span><span class="">(</span><span class="">fun</span><span class="">,</span><span class=""> </span><span class="">bc</span><span class="">,</span><span class=""> </span><span class="">x</span><span class="">,</span><span class=""> </span><a class="foo ", href="/p/numpy/1.20.0/api/numpy.ndarray.html">y_a</a><span class="">)</span><br><span class='nsl'>...&nbsp;</span><span class="">res_b</span><span class=""> </span><span class="o">=</span><span class=""> </span><span class="">solve_bvp</span><span class="">(</span><span class="">fun</span><span class="">,</span><span class=""> </span><span class="">bc</span><span class="">,</span><span class=""> </span><span class="">x</span><span class="">,</span><span class=""> </span><a class="foo ", href="/p/numpy/1.20.0/api/numpy.ndarray.html">y_b</a><span class="">)</span>
</pre>
            
            
         
                
        <p>Let&#39;s plot the two found solutions. We take an advantage of having the solution in a spline form to produce a smooth plot.</p>

    
            
            
         
                <pre class='highlight execed'><span class='nsl'>&gt;&gt;&gt; </span><span class="">x_plot</span><span class=""> </span><span class="o">=</span><span class=""> </span><a class="foo ", href="/p/numpy/1.20.0/api/numpy.html">np</a><span class="o">.</span><a class="foo ", href="/p/numpy/1.20.0/api/numpy.linspace.html">linspace</a><span class="">(</span><span class="mi">0</span><span class="">,</span><span class=""> </span><span class="mi">1</span><span class="">,</span><span class=""> </span><span class="mi">100</span><span class="">)</span><br><span class='nsl'>...&nbsp;</span><span class="">y_plot_a</span><span class=""> </span><span class="o">=</span><span class=""> </span><span class="">res_a</span><span class="o">.</span><span class="">sol</span><span class="">(</span><span class="">x_plot</span><span class="">)</span><span class="">[</span><span class="mi">0</span><span class="">]</span><br><span class='nsl'>...&nbsp;</span><span class="">y_plot_b</span><span class=""> </span><span class="o">=</span><span class=""> </span><span class="">res_b</span><span class="o">.</span><span class="">sol</span><span class="">(</span><span class="">x_plot</span><span class="">)</span><span class="">[</span><span class="mi">0</span><span class="">]</span><br><span class='nsl'>...&nbsp;</span><span class="kn">import</span><span class=""> </span><a class="foo nn", href="/p/matplotlib/3.3.3/api/matplotlib.html">matplotlib</a><span class="nn">.</span><a class="foo nn", href="/p/matplotlib/3.3.3/api/matplotlib.pyplot.html">pyplot</a><span class=""> </span><span class="k">as</span><span class=""> </span><a class="foo nn", href="/p/matplotlib/3.3.3/api/matplotlib.pyplot.html">plt</a><br><span class='nsl'>...&nbsp;</span><br><span class='nsl'>...&nbsp;</span><a class="foo ", href="/p/matplotlib/3.3.3/api/matplotlib.pyplot.html">plt</a><span class="o">.</span><a class="foo ", href="/p/matplotlib/3.3.3/api/matplotlib.pyplot.plot.html">plot</a><span class="">(</span><span class="">x_plot</span><span class="">,</span><span class=""> </span><a class="foo ", href="/p/numpy/1.20.0/api/numpy.ndarray.html">y_plot_a</a><span class="">,</span><span class=""> </span><span class="">label</span><span class="o">=</span><span class="s2">&#34;</span><span class="s2">y_a</span><span class="s2">&#34;</span><span class="">)</span><br><span class='nsl'>...&nbsp;</span><a class="foo ", href="/p/matplotlib/3.3.3/api/matplotlib.pyplot.html">plt</a><span class="o">.</span><a class="foo ", href="/p/matplotlib/3.3.3/api/matplotlib.pyplot.plot.html">plot</a><span class="">(</span><span class="">x_plot</span><span class="">,</span><span class=""> </span><a class="foo ", href="/p/numpy/1.20.0/api/numpy.ndarray.html">y_plot_b</a><span class="">,</span><span class=""> </span><span class="">label</span><span class="o">=</span><span class="s2">&#34;</span><span class="s2">y_b</span><span class="s2">&#34;</span><span class="">)</span><br><span class='nsl'>...&nbsp;</span><a class="foo ", href="/p/matplotlib/3.3.3/api/matplotlib.pyplot.html">plt</a><span class="o">.</span><a class="foo ", href="/p/matplotlib/3.3.3/api/matplotlib.pyplot.legend.html">legend</a><span class="">(</span><span class="">)</span><br><span class='nsl'>...&nbsp;</span><a class="foo ", href="/p/matplotlib/3.3.3/api/matplotlib.pyplot.html">plt</a><span class="o">.</span><a class="foo ", href="/p/matplotlib/3.3.3/api/matplotlib.pyplot.xlabel.html">xlabel</a><span class="">(</span><span class="s2">&#34;</span><span class="s2">x</span><span class="s2">&#34;</span><span class="">)</span><br><span class='nsl'>...&nbsp;</span><a class="foo ", href="/p/matplotlib/3.3.3/api/matplotlib.pyplot.html">plt</a><span class="o">.</span><a class="foo ", href="/p/matplotlib/3.3.3/api/matplotlib.pyplot.ylabel.html">ylabel</a><span class="">(</span><span class="s2">&#34;</span><span class="s2">y</span><span class="s2">&#34;</span><span class="">)</span><br><span class='nsl'>...&nbsp;</span><a class="foo ", href="/p/matplotlib/3.3.3/api/matplotlib.pyplot.html">plt</a><span class="o">.</span><a class="foo ", href="/p/matplotlib/3.3.3/api/matplotlib.pyplot.show.html">show</a><span class="">(</span><span class="">)</span>
</pre>
            
            
         
                <div><img src="/p/scipy/1.5.0/img/fig-scipy.integrate._bvp.solve_bvp-1.png"/></div>
            
            
         
                
        <p>We see that the two solutions have similar shape, but differ in scale significantly.</p>

    
            
            
         
                
        <p>In the second example, we solve a simple Sturm-Liouville problem::</p>

    
            
            
         
                
          <!-- deflist -->
           <dl>
               
               <dt>
        <p>:: workaround numpyoc summary/ext summary bug in take2::Line.__init__</p>

    <dt>
               <dd>

                       
        <p>y&#39;&#39; + k**2 * y = 0 y(0) = y(1) = 0</p>

    
                  
               <dd>
                 
           </dl>
       
            
            
         
                
        <p>It is known that a non-trivial solution y = A * sin(k * x) is possible for k = pi * n, where n is an integer. To establish the normalization constant A = 1 we add a boundary condition::</p>

    
            
            
         
                
          <!-- deflist -->
           <dl>
               
               <dt>
        <p>:: workaround numpyoc summary/ext summary bug in take2::Line.__init__</p>

    <dt>
               <dd>

                       
        <p>y&#39;(0) = k</p>

    
                  
               <dd>
                 
           </dl>
       
            
            
         
                
        <p>Again, we rewrite our equation as a first-order system and implement its right-hand side evaluation::</p>

    
            
            
         
                
          <!-- deflist -->
           <dl>
               
               <dt>
        <p>:: workaround numpyoc summary/ext summary bug in take2::Line.__init__</p>

    <dt>
               <dd>

                       
        <p>y1&#39; = y2 y2&#39; = -k**2 * y1</p>

    
                  
               <dd>
                 
           </dl>
       
            
            
         
                <pre class='highlight execed'><span class='nsl'>&gt;&gt;&gt; </span><span class="k">def</span><span class=""> </span><span class="nf">fun</span><span class="">(</span><span class="">x</span><span class="">,</span><span class=""> </span><span class="">y</span><span class="">,</span><span class=""> </span><span class="">p</span><span class="">)</span><span class="">:</span><br><span class='nsl'>...&nbsp;</span><span class="">    </span><span class="">k</span><span class=""> </span><span class="o">=</span><span class=""> </span><span class="">p</span><span class="">[</span><span class="mi">0</span><span class="">]</span><br><span class='nsl'>...&nbsp;</span><span class="">    </span><span class="k">return</span><span class=""> </span><a class="foo ", href="/p/numpy/1.20.0/api/numpy.html">np</a><span class="o">.</span><a class="foo ", href="/p/numpy/1.20.0/api/numpy.vstack.html">vstack</a><span class="">(</span><span class="">(</span><span class="">y</span><span class="">[</span><span class="mi">1</span><span class="">]</span><span class="">,</span><span class=""> </span><span class="o">-</span><span class="">(</span><span class="">k</span><span class=""> </span><span class="o">*</span><span class="o">*</span><span class=""> </span><span class="mi">2</span><span class="">)</span><span class=""> </span><span class="o">*</span><span class=""> </span><span class="">y</span><span class="">[</span><span class="mi">0</span><span class="">]</span><span class="">)</span><span class="">)</span>
</pre>
            
            
         
                
        <p>Note that parameters p are passed as a vector (with one element in our case).</p>

    
            
            
         
                
        <p>Implement the boundary conditions:</p>

    
            
            
         
                <pre class='highlight execed'><span class='nsl'>&gt;&gt;&gt; </span><span class="k">def</span><span class=""> </span><span class="nf">bc</span><span class="">(</span><span class="">ya</span><span class="">,</span><span class=""> </span><span class="">yb</span><span class="">,</span><span class=""> </span><span class="">p</span><span class="">)</span><span class="">:</span><br><span class='nsl'>...&nbsp;</span><span class="">    </span><span class="">k</span><span class=""> </span><span class="o">=</span><span class=""> </span><span class="">p</span><span class="">[</span><span class="mi">0</span><span class="">]</span><br><span class='nsl'>...&nbsp;</span><span class="">    </span><span class="k">return</span><span class=""> </span><a class="foo ", href="/p/numpy/1.20.0/api/numpy.html">np</a><span class="o">.</span><a class="foo ", href="/p/numpy/1.20.0/api/numpy.array.html">array</a><span class="">(</span><span class="">[</span><span class="">ya</span><span class="">[</span><span class="mi">0</span><span class="">]</span><span class="">,</span><span class=""> </span><span class="">yb</span><span class="">[</span><span class="mi">0</span><span class="">]</span><span class="">,</span><span class=""> </span><span class="">ya</span><span class="">[</span><span class="mi">1</span><span class="">]</span><span class=""> </span><span class="o">-</span><span class=""> </span><span class="">k</span><span class="">]</span><span class="">)</span>
</pre>
            
            
         
                
        <p>Set up the initial mesh and guess for y. We aim to find the solution for k = 2 * pi, to achieve that we set values of y to approximately follow sin(2 * pi * x):</p>

    
            
            
         
                <pre class='highlight execed'><span class='nsl'>&gt;&gt;&gt; </span><span class="">x</span><span class=""> </span><span class="o">=</span><span class=""> </span><a class="foo ", href="/p/numpy/1.20.0/api/numpy.html">np</a><span class="o">.</span><a class="foo ", href="/p/numpy/1.20.0/api/numpy.linspace.html">linspace</a><span class="">(</span><span class="mi">0</span><span class="">,</span><span class=""> </span><span class="mi">1</span><span class="">,</span><span class=""> </span><span class="mi">5</span><span class="">)</span><br><span class='nsl'>...&nbsp;</span><a class="foo ", href="/p/numpy/1.20.0/api/numpy.ndarray.html">y</a><span class=""> </span><span class="o">=</span><span class=""> </span><a class="foo ", href="/p/numpy/1.20.0/api/numpy.html">np</a><span class="o">.</span><a class="foo ", href="/p/numpy/1.20.0/api/numpy.zeros.html">zeros</a><span class="">(</span><span class="">(</span><span class="mi">2</span><span class="">,</span><span class=""> </span><span class="">x</span><span class="o">.</span><span class="">size</span><span class="">)</span><span class="">)</span><br><span class='nsl'>...&nbsp;</span><a class="foo ", href="/p/numpy/1.20.0/api/numpy.ndarray.html">y</a><span class="">[</span><span class="mi">0</span><span class="">,</span><span class=""> </span><span class="mi">1</span><span class="">]</span><span class=""> </span><span class="o">=</span><span class=""> </span><span class="mi">1</span><br><span class='nsl'>...&nbsp;</span><a class="foo ", href="/p/numpy/1.20.0/api/numpy.ndarray.html">y</a><span class="">[</span><span class="mi">0</span><span class="">,</span><span class=""> </span><span class="mi">3</span><span class="">]</span><span class=""> </span><span class="o">=</span><span class=""> </span><span class="o">-</span><span class="mi">1</span>
</pre>
            
            
         
                
        <p>Run the solver with 6 as an initial guess for k.</p>

    
            
            
         
                <pre class='highlight execed'><span class='nsl'>&gt;&gt;&gt; </span><span class="">sol</span><span class=""> </span><span class="o">=</span><span class=""> </span><span class="">solve_bvp</span><span class="">(</span><span class="">fun</span><span class="">,</span><span class=""> </span><span class="">bc</span><span class="">,</span><span class=""> </span><span class="">x</span><span class="">,</span><span class=""> </span><a class="foo ", href="/p/numpy/1.20.0/api/numpy.ndarray.html">y</a><span class="">,</span><span class=""> </span><span class="">p</span><span class="o">=</span><span class="">[</span><span class="mi">6</span><span class="">]</span><span class="">)</span>
</pre>
            
            
         
                
        <p>We see that the found k is approximately correct:</p>

    
            
            
         
                <pre class='highlight execed'><span class='nsl'>&gt;&gt;&gt; </span><span class="">sol</span><span class="o">.</span><span class="">p</span><span class="">[</span><span class="mi">0</span><span class="">]</span>
6.28329460046</pre>
            
            
         
                
        <p>And, finally, plot the solution to see the anticipated sinusoid:</p>

    
            
            
         
                <pre class='highlight execed'><span class='nsl'>&gt;&gt;&gt; </span><span class="">x_plot</span><span class=""> </span><span class="o">=</span><span class=""> </span><a class="foo ", href="/p/numpy/1.20.0/api/numpy.html">np</a><span class="o">.</span><a class="foo ", href="/p/numpy/1.20.0/api/numpy.linspace.html">linspace</a><span class="">(</span><span class="mi">0</span><span class="">,</span><span class=""> </span><span class="mi">1</span><span class="">,</span><span class=""> </span><span class="mi">100</span><span class="">)</span><br><span class='nsl'>...&nbsp;</span><span class="">y_plot</span><span class=""> </span><span class="o">=</span><span class=""> </span><span class="">sol</span><span class="o">.</span><span class="">sol</span><span class="">(</span><span class="">x_plot</span><span class="">)</span><span class="">[</span><span class="mi">0</span><span class="">]</span><br><span class='nsl'>...&nbsp;</span><a class="foo ", href="/p/matplotlib/3.3.3/api/matplotlib.pyplot.html">plt</a><span class="o">.</span><a class="foo ", href="/p/matplotlib/3.3.3/api/matplotlib.pyplot.plot.html">plot</a><span class="">(</span><span class="">x_plot</span><span class="">,</span><span class=""> </span><a class="foo ", href="/p/numpy/1.20.0/api/numpy.ndarray.html">y_plot</a><span class="">)</span><br><span class='nsl'>...&nbsp;</span><a class="foo ", href="/p/matplotlib/3.3.3/api/matplotlib.pyplot.html">plt</a><span class="o">.</span><a class="foo ", href="/p/matplotlib/3.3.3/api/matplotlib.pyplot.xlabel.html">xlabel</a><span class="">(</span><span class="s2">&#34;</span><span class="s2">x</span><span class="s2">&#34;</span><span class="">)</span><br><span class='nsl'>...&nbsp;</span><a class="foo ", href="/p/matplotlib/3.3.3/api/matplotlib.pyplot.html">plt</a><span class="o">.</span><a class="foo ", href="/p/matplotlib/3.3.3/api/matplotlib.pyplot.ylabel.html">ylabel</a><span class="">(</span><span class="s2">&#34;</span><span class="s2">y</span><span class="s2">&#34;</span><span class="">)</span><br><span class='nsl'>...&nbsp;</span><a class="foo ", href="/p/matplotlib/3.3.3/api/matplotlib.pyplot.html">plt</a><span class="o">.</span><a class="foo ", href="/p/matplotlib/3.3.3/api/matplotlib.pyplot.show.html">show</a><span class="">(</span><span class="">)</span>
</pre>
            
            
         
                <div><img src="/p/scipy/1.5.0/img/fig-scipy.integrate._bvp.solve_bvp-2.png"/></div>
            
            
         
         See :
         
             <code><a link href="/p/numpy/1.20.0/api/numpy.ufunc.html" class='exists'>numpy.ufunc</a></code>
        
         
             <code><a link href="/p/matplotlib/3.3.3/api/matplotlib.pyplot.show.html" class='exists'>matplotlib.pyplot.show</a></code>
        
         
             <code><a link href="/p/numpy/1.20.0/api/numpy.ndarray.html" class='exists'>numpy.ndarray</a></code>
        
         
             <code><a link href="/p/scipy/??/api/fig-scipy.integrate._bvp.solve_bvp-1.png.html" class='exists'>fig-scipy.integrate._bvp.solve_bvp-1.png</a></code>
        
         
             <code><a link href="/p/numpy/1.20.0/api/numpy.zeros.html" class='exists'>numpy.zeros</a></code>
        
         
             <code><a link href="/p/matplotlib/3.3.3/api/matplotlib.pyplot.ylabel.html" class='exists'>matplotlib.pyplot.ylabel</a></code>
        
         
             <code><a link href="/p/scipy/1.5.0/api/fig-scipy.integrate._bvp.solve_bvp-1.png.html" class='exists'>fig-scipy.integrate._bvp.solve_bvp-1.png</a></code>
        
         
             <code><a link href="/p/matplotlib/3.3.3/api/matplotlib.pyplot.plot.html" class='exists'>matplotlib.pyplot.plot</a></code>
        
         
             <code><a link href="/p/matplotlib/3.3.3/api/matplotlib.html" class='exists'>matplotlib</a></code>
        
         
             <code><a link href="/p/matplotlib/3.3.3/api/matplotlib.pyplot.html" class='exists'>matplotlib.pyplot</a></code>
        
         
             <code><a link href="/p/matplotlib/3.3.3/api/matplotlib.pyplot.legend.html" class='exists'>matplotlib.pyplot.legend</a></code>
        
         
             <code><a link href="/p/scipy/??/api/fig-scipy.integrate._bvp.solve_bvp-2.png.html" class='exists'>fig-scipy.integrate._bvp.solve_bvp-2.png</a></code>
        
         
             <code><a link href="/p/scipy/1.5.0/api/fig-scipy.integrate._bvp.solve_bvp-2.png.html" class='exists'>fig-scipy.integrate._bvp.solve_bvp-2.png</a></code>
        
         
             <code><a link href="/p/numpy/1.20.0/api/numpy.html" class='exists'>numpy</a></code>
        
         
             <code><a link href="/p/numpy/1.20.0/api/numpy.linspace.html" class='exists'>numpy.linspace</a></code>
        
         
             <code><a link href="/p/numpy/1.20.0/api/numpy.array.html" class='exists'>numpy.array</a></code>
        
         
             <code><a link href="/p/numpy/1.20.0/api/numpy.vstack.html" class='exists'>numpy.vstack</a></code>
        
         
             <code><a link href="/p/matplotlib/3.3.3/api/matplotlib.pyplot.xlabel.html" class='exists'>matplotlib.pyplot.xlabel</a></code>
        
         
             <code><a link href="/p/scipy/1.5.0/api/scipy.interpolate.interpolate.PPoly.html" class='exists'>scipy.interpolate.interpolate.PPoly</a></code>
        
         
     
    




<h3>Local connectivity graph</h3>
<p>Hover to see nodes names; edges to Self not shown, Caped at 50 nodes.</p>

<p> Using a canvas is more power efficient and can get hundred of nodes ; but does not allow hyperlinks; , arrows
or text (beyond on hover) </p> 
<canvas width="800" height="500"></canvas>
<p> SVG is more flexible but power hungry; and does not scale well to 50 + nodes. </p> 

<svg width="800" height="500"></svg>

<p>All aboves nodes referred to, (or are referred from) current nodes; Edges from Self to other have been omitted
(or all nodes would be connected to the central node "self" which is not useful). Nodes are colored by the library
they belong to, and scaled with the number of references pointing them</p>


<hr>

To Be Done: </br>

File: /Users/bussonniermatthias/miniconda3/lib/python3.8/site-packages/scipy/integrate/_bvp.py </br>
Line: 711 </br>
type: &lt;class &#39;function&#39;&gt; </br>
Commit: </br>
Tag: </br>
Link to the right github gitalab repository, file and line (maybe range?)</br>
</div>


    
    <script src="https://d3js.org/d3.v4.min.js"></script>
    <script src="https://d3js.org/d3-selection-multi.v1.js"></script>
        <style type="text/css">
        .node {}

        .link { stroke: #999; stroke-opacity: .6; stroke-width: 1px; }
    </style>
<script>

var canvas = document.querySelector("canvas"),
    context = canvas.getContext("2d"),
    width = canvas.width,
    height = canvas.height;
var searchRadius = 40;



var color = d3.scaleOrdinal()
    .range(d3.schemeCategory10);

var canvas_simulation = d3.forceSimulation()
    .force("charge", d3.forceManyBody().strength(-100))
    .force("link", d3.forceLink().distance(30).strength(0.1).iterations(1).id(function(d) { return d.id; }))
    .force("x", d3.forceX().strength(0.1))
    .force("y", d3.forceY().strength(0.2));


var canvas_graph = {"nodes": [{"id": 1, "val": 17.327379053088816, "label": "matplotlib.pyplot.ylabel", "mod": "matplotlib", "url": "/p/matplotlib/3.3.3/api/matplotlib.pyplot.ylabel"}, {"id": 2, "val": 23.968719422671313, "label": "matplotlib", "mod": "matplotlib", "url": "/p/matplotlib/3.3.3/api/matplotlib"}, {"id": 3, "val": 9.414213562373096, "label": "scipy.interpolate.interpolate.PPoly", "mod": "scipy", "url": "/p/scipy/1.5.0/api/scipy.interpolate.interpolate.PPoly"}, {"id": 4, "val": 9.732050807568877, "label": "numpy.vstack", "mod": "numpy", "url": "/p/numpy/1.20.0/api/numpy.vstack"}, {"id": 5, "val": 21.74772708486752, "label": "matplotlib.pyplot.show", "mod": "matplotlib", "url": "/p/matplotlib/3.3.3/api/matplotlib.pyplot.show"}, {"id": 6, "val": 30.891046284519195, "label": "numpy", "mod": "numpy", "url": "/p/numpy/1.20.0/api/numpy"}, {"id": 7, "val": 21.820274961085254, "label": "numpy.array", "mod": "numpy", "url": "/p/numpy/1.20.0/api/numpy.array"}, {"id": 8, "val": 9.0, "label": "fig-scipy.integrate._bvp.solve_bvp-2.png", "mod": "fig-scipy", "url": "/p/scipy/1.5.0/api/fig-scipy.integrate._bvp.solve_bvp-2.png"}, {"id": 9, "val": 20.041594578792296, "label": "numpy.ufunc", "mod": "numpy", "url": "/p/numpy/1.20.0/api/numpy.ufunc"}, {"id": 10, "val": 20.0, "label": "matplotlib.pyplot.plot", "mod": "matplotlib", "url": "/p/matplotlib/3.3.3/api/matplotlib.pyplot.plot"}, {"id": 11, "val": 19.618950038622252, "label": "numpy.linspace", "mod": "numpy", "url": "/p/numpy/1.20.0/api/numpy.linspace"}, {"id": 12, "val": 17.69535971483266, "label": "matplotlib.pyplot.xlabel", "mod": "matplotlib", "url": "/p/matplotlib/3.3.3/api/matplotlib.pyplot.xlabel"}, {"id": 13, "val": 30.891046284519195, "label": "numpy.ndarray", "mod": "numpy", "url": "/p/numpy/1.20.0/api/numpy.ndarray"}, {"id": 14, "val": 9.0, "label": "fig-scipy.integrate._bvp.solve_bvp-1.png", "mod": "fig-scipy", "url": "/p/scipy/1.5.0/api/fig-scipy.integrate._bvp.solve_bvp-1.png"}, {"id": 15, "val": 14.403124237432849, "label": "matplotlib.pyplot.legend", "mod": "matplotlib", "url": "/p/matplotlib/3.3.3/api/matplotlib.pyplot.legend"}, {"id": 16, "val": 14.6332495807108, "label": "numpy.zeros", "mod": "numpy", "url": "/p/numpy/1.20.0/api/numpy.zeros"}, {"id": 17, "val": 24.0312195418814, "label": "matplotlib.pyplot", "mod": "matplotlib", "url": "/p/matplotlib/3.3.3/api/matplotlib.pyplot"}], "links": [{"source": 5, "target": 11, "id": 163}, {"source": 16, "target": 13, "id": 860}, {"source": 10, "target": 11, "id": 1004}, {"source": 2, "target": 11, "id": 1149}, {"source": 17, "target": 11, "id": 1407}, {"source": 6, "target": 13, "id": 1692}, {"source": 7, "target": 13, "id": 2351}]};

(function() {

  var pages = d3.nest()
      .key(function(d) { return d.mod; })
      .entries(canvas_graph.nodes)
      .sort(function(a, b) { return b.values.length - a.values.length; });

  var c = color.domain(pages.map(function(d) { return d.key; }));

    

  canvas_simulation
      .nodes(canvas_graph.nodes)
      .on("tick", ticked);

  canvas_simulation.force("link")
      .links(canvas_graph.links);

  d3.select(canvas)
      .on("mousemove", mousemoved)
      .call(d3.drag()
          .container(canvas)
          .subject(dragsubject)
          .on("start", dragstarted)
          .on("drag", dragged)
          .on("end", dragended));

  function ticked() {
    context.clearRect(0, 0, width, height);
    context.save();
    context.translate(width / 2, height / 2);

    context.beginPath();
    canvas_graph.links.forEach(drawLink);
    context.strokeStyle = "#aaa";
    context.stroke();
    var margin = 10; 
    
    pages.forEach(function(page) {
      context.beginPath();
      page.values.forEach(drawNode);
      context.fillStyle = color(page.key);
      context.fill();
    });

    context.restore();

  }

  function dragsubject() {
    return canvas_simulation.find(d3.event.x - width / 2, d3.event.y - height / 2, searchRadius);
  }

  function mousemoved() {
    var a = this.parentNode, m = d3.mouse(this), d = canvas_simulation.find(m[0] - width / 2, m[1] - height / 2, searchRadius);
    if (!d) return a.removeAttribute("href"), a.removeAttribute("title");
    //a.setAttribute("href", "http://bl.ocks.org/" + (d.user ? d.user + "/" : "") + d.id);
    a.setAttribute("title", d.label );
  }
})();

function dragstarted() {
  if (!d3.event.active) canvas_simulation.alphaTarget(0.3).restart();
  d3.event.subject.fx = d3.event.subject.x;
  d3.event.subject.fy = d3.event.subject.y;
}

function dragged() {
  d3.event.subject.fx = d3.event.x;
  d3.event.subject.fy = d3.event.y;
}

function dragended() {
  if (!d3.event.active) canvas_simulation.alphaTarget(0);
  d3.event.subject.fx = null;
  d3.event.subject.fy = null;
}

function drawLink(d) {
  context.moveTo(d.source.x, d.source.y);
  context.lineTo(d.target.x, d.target.y);
   //context.moveTo(d.x + 3, d.y);
  //context.arc((d.target.x*9+d.source.x)/10, (d.target.y*9+d.source.y)/10, 2, 0, 2 * Math.PI);
}

function drawNode(d) {
  context.moveTo(d.x + 5, d.y);
  context.arc(d.x, d.y, d.val, 0, 2 * Math.PI);
}

</script>
<script type="text/javascript">
    var colors = d3.scaleOrdinal(d3.schemeCategory10);

    var svg = d3.select("svg");
    var width = svg.attr("width");
    var height = svg.attr("height");
    var node;
    var link;

    // syle for arrow head in the svg...
    svg.append('defs').append('marker')
        .attrs({'id':'arrowhead',
            'viewBox':'-0 -5 10 10',
            'refX':13,
            'refY':0,
            'orient':'auto',
            'markerWidth':13,
            'markerHeight':13,
            'xoverflow':'visible'})
        .append('svg:path')
        .attr('d', 'M 0,-5 L 10 ,0 L 0,5')
        .attr('fill', '#999')
        .style('stroke','none');


    var svg_simulation = d3.forceSimulation()
        .force("charge", d3.forceManyBody().strength(-100))
        .force("link", d3.forceLink().distance(80).strength(0.01).iterations(10).id(function(d) { return d.id; }))
        .force("x", d3.forceX(width/2).strength(0.04))
        .force("y", d3.forceY(height/2).strength(0.06));





    var svg_graph = {"nodes": [{"id": 1, "val": 17.327379053088816, "label": "matplotlib.pyplot.ylabel", "mod": "matplotlib", "url": "/p/matplotlib/3.3.3/api/matplotlib.pyplot.ylabel"}, {"id": 2, "val": 23.968719422671313, "label": "matplotlib", "mod": "matplotlib", "url": "/p/matplotlib/3.3.3/api/matplotlib"}, {"id": 3, "val": 9.414213562373096, "label": "scipy.interpolate.interpolate.PPoly", "mod": "scipy", "url": "/p/scipy/1.5.0/api/scipy.interpolate.interpolate.PPoly"}, {"id": 4, "val": 9.732050807568877, "label": "numpy.vstack", "mod": "numpy", "url": "/p/numpy/1.20.0/api/numpy.vstack"}, {"id": 5, "val": 21.74772708486752, "label": "matplotlib.pyplot.show", "mod": "matplotlib", "url": "/p/matplotlib/3.3.3/api/matplotlib.pyplot.show"}, {"id": 6, "val": 30.891046284519195, "label": "numpy", "mod": "numpy", "url": "/p/numpy/1.20.0/api/numpy"}, {"id": 7, "val": 21.820274961085254, "label": "numpy.array", "mod": "numpy", "url": "/p/numpy/1.20.0/api/numpy.array"}, {"id": 8, "val": 9.0, "label": "fig-scipy.integrate._bvp.solve_bvp-2.png", "mod": "fig-scipy", "url": "/p/scipy/1.5.0/api/fig-scipy.integrate._bvp.solve_bvp-2.png"}, {"id": 9, "val": 20.041594578792296, "label": "numpy.ufunc", "mod": "numpy", "url": "/p/numpy/1.20.0/api/numpy.ufunc"}, {"id": 10, "val": 20.0, "label": "matplotlib.pyplot.plot", "mod": "matplotlib", "url": "/p/matplotlib/3.3.3/api/matplotlib.pyplot.plot"}, {"id": 11, "val": 19.618950038622252, "label": "numpy.linspace", "mod": "numpy", "url": "/p/numpy/1.20.0/api/numpy.linspace"}, {"id": 12, "val": 17.69535971483266, "label": "matplotlib.pyplot.xlabel", "mod": "matplotlib", "url": "/p/matplotlib/3.3.3/api/matplotlib.pyplot.xlabel"}, {"id": 13, "val": 30.891046284519195, "label": "numpy.ndarray", "mod": "numpy", "url": "/p/numpy/1.20.0/api/numpy.ndarray"}, {"id": 14, "val": 9.0, "label": "fig-scipy.integrate._bvp.solve_bvp-1.png", "mod": "fig-scipy", "url": "/p/scipy/1.5.0/api/fig-scipy.integrate._bvp.solve_bvp-1.png"}, {"id": 15, "val": 14.403124237432849, "label": "matplotlib.pyplot.legend", "mod": "matplotlib", "url": "/p/matplotlib/3.3.3/api/matplotlib.pyplot.legend"}, {"id": 16, "val": 14.6332495807108, "label": "numpy.zeros", "mod": "numpy", "url": "/p/numpy/1.20.0/api/numpy.zeros"}, {"id": 17, "val": 24.0312195418814, "label": "matplotlib.pyplot", "mod": "matplotlib", "url": "/p/matplotlib/3.3.3/api/matplotlib.pyplot"}], "links": [{"source": 5, "target": 11, "id": 163}, {"source": 16, "target": 13, "id": 860}, {"source": 10, "target": 11, "id": 1004}, {"source": 2, "target": 11, "id": 1149}, {"source": 17, "target": 11, "id": 1407}, {"source": 6, "target": 13, "id": 1692}, {"source": 7, "target": 13, "id": 2351}]};
    (function (error, graph) {
            if (error) throw error;
        graph.nodes.forEach(function(d) { d.x = width*Math.random(); d.y = height*Math.random()});
        update(graph.links, graph.nodes);
        })(null, svg_graph);

    var edgelabels;

    function update(links, nodes) {
        link = svg.selectAll(".link")
            .data(links)
            .enter()
            .append("line")
            .attr("class", "link")
            .attr('marker-end','url(#arrowhead)');

        //link.append("title")
        //    .text(function (d) {return d.type;});

        edgepaths = svg.selectAll(".edgepath")
            .data(links)
            .enter()
            .append('path')
            .attrs({
                'class': 'edgepath',
                'fill-opacity': 0,
                'stroke-opacity': 0,
                'id': function (d, i) {return 'edgepath' + i}
            })
            .style("pointer-events", "none");

        edgelabels = svg.selectAll(".edgelabel")
            .data(links)
            .enter()
            .append('text')
            .style("pointer-events", "none")
            .attrs({
                'class': 'edgelabel',
                'id': function (d, i) {return 'edgelabel' + i},
                'font-size': 10,
                'fill': '#aaa'
            });

        edgelabels.append('textPath')
            .attr('xlink:href', function (d, i) {return '#edgepath' + i})
            .style("text-anchor", "middle")
            .style("pointer-events", "none")
            .attr("startOffset", "50%")
            .text(function (d) {return d.type});

        node = svg.selectAll(".node")
            .data(nodes)
            .enter()
            .append("g")
            .attr("class", "node")
            .call(d3.drag()
                    .on("start", dragstarted)
                    .on("drag", dragged)
                    .on("end", dragended)
            );

        node.append("a")
                .attr("xlink:href", function(node){return node.url})
            .append("circle")
                .attr("r", function(node){return node.val})
                .style("fill", function (d, i) {return colors(d.mod);})
                .style("stroke", "#FFF")

        node.append("title")
            .text(function (d) {return d.label;});

        node.append("text")
                //.attr("dx", function(node){return node.val+1})
                .attr("dy", +10)
                .attr("opacity", "0.5")
            .text(function (d) {arr = d.label.split('.'); return arr[arr.length-1]});

        svg_simulation
            .nodes(nodes)
            .on("tick", ticked);

        svg_simulation.force("link")
                .links(links)

    }

    function ticked() {
        link
            .attr("x1", function (d) {return d.source.x;})
            .attr("y1", function (d) {return d.source.y;})
            .attr("x2", function (d) {return d.target.x;})
            .attr("y2", function (d) {return d.target.y;});

        node
            .attr("transform", function (d) {return "translate(" + d.x + ", " + d.y + ")";});

        edgepaths.attr('d', function (d) {
            return 'M ' + d.source.x + ' ' + d.source.y + ' L ' + d.target.x + ' ' + d.target.y;
        });

        edgelabels.attr('transform', function (d) {
            if (d.target.x < d.source.x) {
                var bbox = this.getBBox();

                rx = bbox.x + bbox.width / 2;
                ry = bbox.y + bbox.height / 2;
                return 'rotate(180 ' + rx + ' ' + ry + ')';
            }
            else {
                return 'rotate(0)';
            }
        });
    }

    function dragstarted(d) {
        if (!d3.event.active) svg_simulation.alphaTarget(0.3).restart()
        d.fx = d.x;
        d.fy = d.y;
    }

    function dragged(d) {
        d.fx = d3.event.x;
        d.fy = d3.event.y;
    }

    function dragended(d) {
        if (!d3.event.active) svg_simulation.alphaTarget(0);
        d.fx = null;
        d.fy = null;
    }

</script>




</div>
</body>
</html>