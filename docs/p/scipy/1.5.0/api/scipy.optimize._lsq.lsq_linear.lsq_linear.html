<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
    <link rel="stylesheet" href="https://fonts.xz.style/serve/inter.css">
	<link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.8.1/css/all.css" integrity="sha384-50oBUHEmvpQ+1lW4y57PTFmhCaXp0ML5d60M1M7uH2+nqUivzIebhndOJK28anvf" crossorigin="anonymous">
    
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@exampledev/new.css@1.1.2/new.min.css">
    <script type="text/x-mathjax-config">
        // only process math in math tags (faster and less false positive with `...`)
        MathJax = {
          options: {
            ignoreHtmlClass: 'tex2jax_ignore',    //  class that marks tags not to search
            processHtmlClass: 'tex2jax_process',  //  class that marks tags that should be searched
          }
        };
        MathJax.Hub.Config({tex2jax: {inlineMath: [['$','$'], ['\\(','\\)']]}});
    </script>
    <script type="text/javascript" async
        src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/MathJax.js?config=TeX-MML-AM_CHTML">
    </script>
<style>
body{
    font-family: 'Roboto', 'Helvetica Neue', 'Helvetica', 'Arial', sans-serif;
    color: #606c76;
    font-weight: 350;
    line-height: 1.6;
    max-width: 1000px;
    margin-left:0;

}
          svg,canvas{border: 1px gray solid;}
          .foo:hover{text-decoration:underline}
          .foo{font-weight:bold; color:#4e4e4e}
          .exists{font-weight:bold; color:#4e4e4e;text-decoration:none;}
          .local{font-weight:bold; color:#1e6f04;text-decoration:none;}
          .exists:hover{text-decoration:underline;color:black}
          .missing,.missing:hover{color:darkred;text-decoration:none;font-weight:normal}
          .signature {font-size:100%; margin-bottom: 2rem; display: block; border:none; background-color: #FFFFFF;
              font-weight:600;}
          h1, h2, h3 {color: #4e4e4e; font-weight:400;
              margin-bottom: 1rem;border-bottom: 1px solid var(--nc-bg-3);
          }
          pre{border-radius:0;
              padding:0.6rem;
          border-left: 3px solid #AAA}
          dt {font-weight: 400;}

          header{
              box-shadow: rgba(0, 0, 0, 0.24) 0px 3px 8px;
              
              padding-top:0rem;
              padding-bottom:0rem;
              z-index: 2;
              padding-left: 0;
              position: fixed;
              top: 30px;
              left:0; 
              width: 100%;
              backdrop-filter: blur(5px);
              background-color: rgba(255, 255, 255, .15);
          }
          dd::before {
            content: '';
          }
          header > brand, header>:first-child {
              border-right: 1px solid #ccc;
              border-left: 1px solid #ccc;
              padding: 16px;
              padding-top: 0.5rem;
              padding-bottom: 0.5rem;
              display: inline-block; 
              width: 167px;

          }
          brand > a {color:#606c76}
          brand > i {
              padding-right: 0.5rem;

        }
          nav{display:inline;
          padding-left: 1rem;
          }

          dd {
              margin-left: 1rem;
              border-left:  solid #ddd;
              padding-left: 1rem;
          }
          summary > h2 { display: inline }

          .sidenav {
                height: 100%; /* Full-height: remove this if you want "auto" height */
                width: 200px; /* Set the width of the sidebar */
                position: fixed; /* Fixed Sidebar (stay in place on scroll) */
                z-index: 1; /* Stay on top */
                top: 0; /* Stay at the top */
                left: 0;
                background-color: var(--nc-bg-1);; /* Black */
                border-right: thin solid #ccc;
                overflow-x: hidden; /* Disable horizontal scroll */
                padding-top: 3rem;
 
                box-shadow: rgba(0, 0, 0, 0.24) 0px 3px 8px;
          }

          .sidenav a {
            padding: 6px 8px 6px 16px;
            text-decoration: none;
            color: #818181;
            display: block;
          }
          .sidenav img {
              width: 160px;
              padding-left:20px;
              padding-right:20px;
              border-bottom: solid thin #DDD; 
              padding-bottom: .5rem;
              max-width: 100%;
          }
          .sidenav i {
              font-size: 100;
              padding-left: 3.5rem;
              padding-right: 3.5rem;
              padding-bottom: .5rem;
              border-bottom: solid thin #DDD; 

          }
          .container {
              padding-left: 210px;
              padding-top: 30px;

          }

          ::selection {
	/* Set background color for selected text */
                background: #59b4fd;
                color: var(--nc-ac-tx);
          }

          img {max-width: 40%;}

          pre.highlight.execed {
            border-left: 3px solid #0070f3;
          }
          .note {color: #7d77d2}
          .warning {color: #f44336}
          pre.highlight.compiled {
            border-left: 3px solid #7d77d2;
          }
          pre.highlight.syntax_error, pre.highlight.exception_in_exec {
            border-left: 3px solid #f44336;
          }

        /* Dropdown Button */
/* The container <div> - needed to position the dropdown content */
.dropdown {
  position: relative;
  display: inline-block;
  margin-left: -4px;
}

/* Dropdown Content (Hidden by Default) */
.dropdown-content {
  display: none;
  position: absolute;
  background-color: #f1f1f1;
  min-width: 160px;
  box-shadow: 0px 8px 16px 0px rgba(0,0,0,0.2);
  z-index: 1;
}

/* Links inside the dropdown */
.dropdown-content a {
  color: black;
  padding: 12px 16px;
  text-decoration: none;
  display: block;
}

/* Change color of dropdown links on hover */
.dropdown-content a:hover {background-color: #ddd;}

/* Show the dropdown menu on hover */
.dropdown:hover .dropdown-content {display: block;
    max-height: 80vh;
    overflow: scroll;}

/* Change the background color of the dropdown button when the dropdown content is shown */
.dropdown:hover .dropbtn {}


pre { line-height: 125%; }
td.linenos .normal { color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px; }
span.linenos { color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px; }
td.linenos .special { color: #000000; background-color: #ffffc0; padding-left: 5px; padding-right: 5px; }
span.linenos.special { color: #000000; background-color: #ffffc0; padding-left: 5px; padding-right: 5px; }
.highlight .hll { background-color: #ffffcc }
.highlight { background: #ffffff; }
.highlight .c { color: #888888 } /* Comment */
.highlight .err { color: #a61717; background-color: #e3d2d2 } /* Error */
.highlight .k { color: #008800; font-weight: bold } /* Keyword */
.highlight .ch { color: #888888 } /* Comment.Hashbang */
.highlight .cm { color: #888888 } /* Comment.Multiline */
.highlight .cp { color: #cc0000; font-weight: bold } /* Comment.Preproc */
.highlight .cpf { color: #888888 } /* Comment.PreprocFile */
.highlight .c1 { color: #888888 } /* Comment.Single */
.highlight .cs { color: #cc0000; font-weight: bold; background-color: #fff0f0 } /* Comment.Special */
.highlight .gd { color: #000000; background-color: #ffdddd } /* Generic.Deleted */
.highlight .ge { font-style: italic } /* Generic.Emph */
.highlight .gr { color: #aa0000 } /* Generic.Error */
.highlight .gh { color: #333333 } /* Generic.Heading */
.highlight .gi { color: #000000; background-color: #ddffdd } /* Generic.Inserted */
.highlight .go { color: #888888 } /* Generic.Output */
.highlight .gp { color: #555555 } /* Generic.Prompt */
.highlight .gs { font-weight: bold } /* Generic.Strong */
.highlight .gu { color: #666666 } /* Generic.Subheading */
.highlight .gt { color: #aa0000 } /* Generic.Traceback */
.highlight .kc { color: #008800; font-weight: bold } /* Keyword.Constant */
.highlight .kd { color: #008800; font-weight: bold } /* Keyword.Declaration */
.highlight .kn { color: #008800; font-weight: bold } /* Keyword.Namespace */
.highlight .kp { color: #008800 } /* Keyword.Pseudo */
.highlight .kr { color: #008800; font-weight: bold } /* Keyword.Reserved */
.highlight .kt { color: #888888; font-weight: bold } /* Keyword.Type */
.highlight .m { color: #0000DD; font-weight: bold } /* Literal.Number */
.highlight .s { color: #dd2200; background-color: #fff0f0 } /* Literal.String */
.highlight .na { color: #336699 } /* Name.Attribute */
.highlight .nb { color: #003388 } /* Name.Builtin */
.highlight .nc { color: #bb0066; font-weight: bold } /* Name.Class */
.highlight .no { color: #003366; font-weight: bold } /* Name.Constant */
.highlight .nd { color: #555555 } /* Name.Decorator */
.highlight .ne { color: #bb0066; font-weight: bold } /* Name.Exception */
.highlight .nf { color: #0066bb; font-weight: bold } /* Name.Function */
.highlight .nl { color: #336699; font-style: italic } /* Name.Label */
.highlight .nn { color: #bb0066; font-weight: bold } /* Name.Namespace */
.highlight .py { color: #336699; font-weight: bold } /* Name.Property */
.highlight .nt { color: #bb0066; font-weight: bold } /* Name.Tag */
.highlight .nv { color: #336699 } /* Name.Variable */
.highlight .ow { color: #008800 } /* Operator.Word */
.highlight .w { color: #bbbbbb } /* Text.Whitespace */
.highlight .mb { color: #0000DD; font-weight: bold } /* Literal.Number.Bin */
.highlight .mf { color: #0000DD; font-weight: bold } /* Literal.Number.Float */
.highlight .mh { color: #0000DD; font-weight: bold } /* Literal.Number.Hex */
.highlight .mi { color: #0000DD; font-weight: bold } /* Literal.Number.Integer */
.highlight .mo { color: #0000DD; font-weight: bold } /* Literal.Number.Oct */
.highlight .sa { color: #dd2200; background-color: #fff0f0 } /* Literal.String.Affix */
.highlight .sb { color: #dd2200; background-color: #fff0f0 } /* Literal.String.Backtick */
.highlight .sc { color: #dd2200; background-color: #fff0f0 } /* Literal.String.Char */
.highlight .dl { color: #dd2200; background-color: #fff0f0 } /* Literal.String.Delimiter */
.highlight .sd { color: #dd2200; background-color: #fff0f0 } /* Literal.String.Doc */
.highlight .s2 { color: #dd2200; background-color: #fff0f0 } /* Literal.String.Double */
.highlight .se { color: #0044dd; background-color: #fff0f0 } /* Literal.String.Escape */
.highlight .sh { color: #dd2200; background-color: #fff0f0 } /* Literal.String.Heredoc */
.highlight .si { color: #3333bb; background-color: #fff0f0 } /* Literal.String.Interpol */
.highlight .sx { color: #22bb22; background-color: #f0fff0 } /* Literal.String.Other */
.highlight .sr { color: #008800; background-color: #fff0ff } /* Literal.String.Regex */
.highlight .s1 { color: #dd2200; background-color: #fff0f0 } /* Literal.String.Single */
.highlight .ss { color: #aa6600; background-color: #fff0f0 } /* Literal.String.Symbol */
.highlight .bp { color: #003388 } /* Name.Builtin.Pseudo */
.highlight .fm { color: #0066bb; font-weight: bold } /* Name.Function.Magic */
.highlight .vc { color: #336699 } /* Name.Variable.Class */
.highlight .vg { color: #dd7700 } /* Name.Variable.Global */
.highlight .vi { color: #3333bb } /* Name.Variable.Instance */
.highlight .vm { color: #336699 } /* Name.Variable.Magic */
.highlight .il { color: #0000DD; font-weight: bold } /* Literal.Number.Integer.Long */

.nsl {
-webkit-touch-callout: none;
-webkit-user-select: none;
-khtml-user-select: none;
-moz-user-select: none;
-ms-user-select: none;
user-select: none;
}


.block_directive{

    border-left: thin solid var(--nc-lk-1);
    padding-bottom: 8px;
    padding-left: 12px;
}

.block_directive.head{

    border: thin solid var(--nc-lk-1);
}


.block_directive > p{
    margin-left: 2em;
    margin-top: 1em;
}
.head {
    font-family: monospace;
    color: var(--nc-lk-1);
}
</style>
</head>
<body class="tex2jax_ignore">
    <header>
        <brand><i class="fab fa-python"></i><a href='/'>Home</a></brand>
        <nav> <a href='/' >/ p</a>  / 
                <div class="dropdown">
                <a href=scipy>scipy</a>&nbsp;/&nbsp;
                    <div class="dropdown-content">
                            <a href="/p/IPython/8.0.0.dev/api/IPython.html">IPython</a>
                            <a href="/p/dask/2021.01.1+8.g34f990a81/api/dask.html">dask</a>
                            <a href="/p/distributed/2021.01.1+9.g613b3c820/api/distributed.html">distributed</a>
                            <a href="/p/matplotlib/3.3.3/api/matplotlib.html">matplotlib</a>
                            <a href="/p/numpy/1.20.0/api/numpy.html">numpy</a>
                            <a href="/p/papyri/0.0.2/api/papyri.html">papyri</a>
                            <a href="/p/scipy/1.5.0/api/scipy.html">scipy</a>
                            
                     </div>
                </div>
                <div class="dropdown">
                <a href='/p/scipy/1.5.0/api/scipy.html'>1.5.0</a>&nbsp;/&nbsp;
                    <div class="dropdown-content">
                            <a href="/p/scipy/1.5.0/api/scipy.html">1.5.0</a>
                            
                    </div>
                </div>

                <div class="dropdown">
                    <a href='/p/scipy/1.5.0/api/scipy.html'>api</a>&nbsp;/&nbsp;
                    <div class="dropdown-content">
                        <a href="/p/scipy/1.5.0/api/scipy.html">API</a>
                        <a href="/p/scipy/1.5.0/gallery">Gallery</a>
                     </div>
                </div>

            
                
                    <div class="dropdown">
                        
                            <a class="dropbtn" href='scipy.html'>scipy</a>.
                        
                        
                    </div>
                
                
                    <div class="dropdown">
                        
                            <a class="dropbtn" href='scipy.optimize.html'>optimize</a>.
                        
                        
                            <div class="dropdown-content">
                            <a href="/p/scipy/1.5.0/api/scipy.__config__.html">__config__</a>
                            <a href="/p/scipy/1.5.0/api/scipy._distributor_init.html">_distributor_init</a>
                            <a href="/p/scipy/1.5.0/api/scipy._lib.html">_lib</a>
                            <a href="/p/scipy/1.5.0/api/scipy.constants.html">constants</a>
                            <a href="/p/scipy/1.5.0/api/scipy.fft.html">fft</a>
                            <a href="/p/scipy/1.5.0/api/scipy.integrate.html">integrate</a>
                            <a href="/p/scipy/1.5.0/api/scipy.interpolate.html">interpolate</a>
                            <a href="/p/scipy/1.5.0/api/scipy.linalg.html">linalg</a>
                            <a href="/p/scipy/1.5.0/api/scipy.misc.html">misc</a>
                            <a href="/p/scipy/1.5.0/api/scipy.ndimage.html">ndimage</a>
                            <a href="/p/scipy/1.5.0/api/scipy.optimize.html">optimize</a>
                            <a href="/p/scipy/1.5.0/api/scipy.signal.html">signal</a>
                            <a href="/p/scipy/1.5.0/api/scipy.sparse.html">sparse</a>
                            <a href="/p/scipy/1.5.0/api/scipy.spatial.html">spatial</a>
                            <a href="/p/scipy/1.5.0/api/scipy.special.html">special</a>
                            <a href="/p/scipy/1.5.0/api/scipy.stats.html">stats</a>
                            <a href="/p/scipy/1.5.0/api/scipy.version.html">version</a>
                            
                            </div>
                        
                    </div>
                
                
                    <div class="dropdown">
                        
                            <a class="dropbtn" href='scipy.optimize._lsq.html'>_lsq</a>.
                        
                        
                            <div class="dropdown-content">
                            <a href="/p/scipy/1.5.0/api/scipy.optimize.__nnls.html">__nnls</a>
                            <a href="/p/scipy/1.5.0/api/scipy.optimize._basinhopping.html">_basinhopping</a>
                            <a href="/p/scipy/1.5.0/api/scipy.optimize._bglu_dense.html">_bglu_dense</a>
                            <a href="/p/scipy/1.5.0/api/scipy.optimize._cobyla.html">_cobyla</a>
                            <a href="/p/scipy/1.5.0/api/scipy.optimize._constraints.html">_constraints</a>
                            <a href="/p/scipy/1.5.0/api/scipy.optimize._differentiable_functions.html">_differentiable_functions</a>
                            <a href="/p/scipy/1.5.0/api/scipy.optimize._differentialevolution.html">_differentialevolution</a>
                            <a href="/p/scipy/1.5.0/api/scipy.optimize._dual_annealing.html">_dual_annealing</a>
                            <a href="/p/scipy/1.5.0/api/scipy.optimize._group_columns.html">_group_columns</a>
                            <a href="/p/scipy/1.5.0/api/scipy.optimize._hessian_update_strategy.html">_hessian_update_strategy</a>
                            <a href="/p/scipy/1.5.0/api/scipy.optimize._lbfgsb.html">_lbfgsb</a>
                            <a href="/p/scipy/1.5.0/api/scipy.optimize._linprog.html">_linprog</a>
                            <a href="/p/scipy/1.5.0/api/scipy.optimize._linprog_ip.html">_linprog_ip</a>
                            <a href="/p/scipy/1.5.0/api/scipy.optimize._linprog_rs.html">_linprog_rs</a>
                            <a href="/p/scipy/1.5.0/api/scipy.optimize._linprog_simplex.html">_linprog_simplex</a>
                            <a href="/p/scipy/1.5.0/api/scipy.optimize._linprog_util.html">_linprog_util</a>
                            <a href="/p/scipy/1.5.0/api/scipy.optimize._lsap.html">_lsap</a>
                            <a href="/p/scipy/1.5.0/api/scipy.optimize._lsap_module.html">_lsap_module</a>
                            <a href="/p/scipy/1.5.0/api/scipy.optimize._lsq.html">_lsq</a>
                            <a href="/p/scipy/1.5.0/api/scipy.optimize._minimize.html">_minimize</a>
                            <a href="/p/scipy/1.5.0/api/scipy.optimize._minpack.html">_minpack</a>
                            <a href="/p/scipy/1.5.0/api/scipy.optimize._nnls.html">_nnls</a>
                            <a href="/p/scipy/1.5.0/api/scipy.optimize._numdiff.html">_numdiff</a>
                            <a href="/p/scipy/1.5.0/api/scipy.optimize._remove_redundancy.html">_remove_redundancy</a>
                            <a href="/p/scipy/1.5.0/api/scipy.optimize._root.html">_root</a>
                            <a href="/p/scipy/1.5.0/api/scipy.optimize._root_scalar.html">_root_scalar</a>
                            <a href="/p/scipy/1.5.0/api/scipy.optimize._shgo.html">_shgo</a>
                            <a href="/p/scipy/1.5.0/api/scipy.optimize._shgo_lib.html">_shgo_lib</a>
                            <a href="/p/scipy/1.5.0/api/scipy.optimize._slsqp.html">_slsqp</a>
                            <a href="/p/scipy/1.5.0/api/scipy.optimize._spectral.html">_spectral</a>
                            <a href="/p/scipy/1.5.0/api/scipy.optimize._trlib.html">_trlib</a>
                            <a href="/p/scipy/1.5.0/api/scipy.optimize._trustregion.html">_trustregion</a>
                            <a href="/p/scipy/1.5.0/api/scipy.optimize._trustregion_constr.html">_trustregion_constr</a>
                            <a href="/p/scipy/1.5.0/api/scipy.optimize._trustregion_dogleg.html">_trustregion_dogleg</a>
                            <a href="/p/scipy/1.5.0/api/scipy.optimize._trustregion_exact.html">_trustregion_exact</a>
                            <a href="/p/scipy/1.5.0/api/scipy.optimize._trustregion_krylov.html">_trustregion_krylov</a>
                            <a href="/p/scipy/1.5.0/api/scipy.optimize._trustregion_ncg.html">_trustregion_ncg</a>
                            <a href="/p/scipy/1.5.0/api/scipy.optimize._zeros.html">_zeros</a>
                            <a href="/p/scipy/1.5.0/api/scipy.optimize.cobyla.html">cobyla</a>
                            <a href="/p/scipy/1.5.0/api/scipy.optimize.lbfgsb.html">lbfgsb</a>
                            <a href="/p/scipy/1.5.0/api/scipy.optimize.linesearch.html">linesearch</a>
                            <a href="/p/scipy/1.5.0/api/scipy.optimize.minpack.html">minpack</a>
                            <a href="/p/scipy/1.5.0/api/scipy.optimize.minpack2.html">minpack2</a>
                            <a href="/p/scipy/1.5.0/api/scipy.optimize.moduleTNC.html">moduleTNC</a>
                            <a href="/p/scipy/1.5.0/api/scipy.optimize.nonlin.html">nonlin</a>
                            <a href="/p/scipy/1.5.0/api/scipy.optimize.optimize.html">optimize</a>
                            <a href="/p/scipy/1.5.0/api/scipy.optimize.slsqp.html">slsqp</a>
                            <a href="/p/scipy/1.5.0/api/scipy.optimize.tnc.html">tnc</a>
                            <a href="/p/scipy/1.5.0/api/scipy.optimize.zeros.html">zeros</a>
                            
                            </div>
                        
                    </div>
                
                
                    <div class="dropdown">
                        
                            <a class="dropbtn" href='scipy.optimize._lsq.lsq_linear.html'>lsq_linear</a>
                        
                        
                            <div class="dropdown-content">
                            <a href="/p/scipy/1.5.0/api/scipy.optimize._lsq.lsq_linear.lsq_linear.html">lsq_linear</a>
                            
                            </div>
                        
                    </div>
                </nav>
    </header>
<div class='container'>
    <div class="sidenav">
    
        <img src="/p/scipy/1.5.0/img/logo.png"/>
    
    <a href="#">Library: scipy</a>
    <a href="#">Version: 1.5.0</a>
    <a href="#">Authors:</a>
    <a href="#">PyPI:</a>
    <a href="#">Source</a>
    <a href="#">Homepage</a>
    <a href="#">Fundings</a>
    <a href="#">Stars</a>
    <a href="#">Forks</a>
    <a href="#">Related</a>
    <hr/>
    <a>Narrative Docs</a>
    <hr/>
    <a href="#section-Parameters">Parameters</a>

    <a href="#section-Returns">Returns</a>

    <a href="#section-Notes">Notes</a>

    

    </div>

    













    <code class='signature'>lsq_linear(A, b, bounds=(-inf, inf), method=&#39;trf&#39;, tol=1e-10, lsq_solver=None, lsmr_tol=None, max_iter=None, verbose=0)</code>




    
    
        <!-- rendering Summary -->
        
           
               
        <p>Solve a linear least-squares problem with bounds on the variables.</p>

    
           
       
    


    
    
        <!-- rendering Extended Summary -->
        
           
               
        <p>Given a m-by-n design matrix A and a target vector b with m elements, <code><a link href="/p/scipy/1.5.0/api/scipy.optimize._lsq.lsq_linear.lsq_linear.html" class='exists'>lsq_linear</a></code>
         solves the following optimization problem::</p>

    
           
               
            <pre>minimize 0.5 * ||A x - b||**2
subject to lb &lt;= x &lt;= ub
</pre>
       
           
               
        <p>This optimization problem is convex, hence a found minimum (if iterations have converged) is guaranteed to be global.</p>

    
           
       
    


    
        <h3 id="section-Parameters">Parameters</h3>
    
    
       <dl>
           
            
                <dt><a id="A">A</a> : array_like, sparse matrix of LinearOperator, shape (m, n)</dt>
            
        </dl>

        <dd>
            
                
        <p>Design matrix. Can be <code>:None:None:`scipy.sparse.linalg.LinearOperator`</code>.</p>

    
            
        </dd>
       
            
                <dt><a id="b">b</a> : array_like, shape (m,)</dt>
            
        </dl>

        <dd>
            
                
        <p>Target vector.</p>

    
            
        </dd>
       
            
                <dt><a id="bounds">bounds</a> : 2-tuple of array_like, optional</dt>
            
        </dl>

        <dd>
            
                
        <p>Lower and upper bounds on independent variables. Defaults to no bounds. Each array must have shape (n,) or be a scalar, in the latter case a bound will be the same for all variables. Use 
        <code class='verbatim'>np.inf</code>
     with an appropriate sign to disable bounds on all or some variables.</p>

    
            
        </dd>
       
            
                <dt><a id="method">method</a> : &#39;trf&#39; or &#39;bvls&#39;, optional</dt>
            
        </dl>

        <dd>
            
                
        <p>Method to perform minimization.</p>

    
            
                
          <!-- deflist -->
           <dl>
               
               <dt>
        <p>* &#39;trf&#39; : Trust Region Reflective algorithm adapted for a linear</p>

    <dt>
               <dd>

                       
        <p>least-squares problem. This is an interior-point-like method and the required number of iterations is weakly correlated with the number of variables.</p>

    
                  
               <dd>
               
               <dt>
        <p>* &#39;bvls&#39; : Bounded-variable least-squares algorithm. This is</p>

    <dt>
               <dd>

                       
        <p>an active set method, which requires the number of iterations comparable to the number of variables. Can&#39;t be used when <code><a link href="#A" class='local'>A</a></code> is sparse or LinearOperator. </p>

    
                  
               <dd>
                 
           </dl>
       
            
                
        <p>Default is &#39;trf&#39;.</p>

    
            
        </dd>
       
            
                <dt><a id="tol">tol</a> : float, optional</dt>
            
        </dl>

        <dd>
            
                
        <p>Tolerance parameter. The algorithm terminates if a relative change of the cost function is less than <code><a link href="#tol" class='local'>tol</a></code> on the last iteration. Additionally, the first-order optimality measure is considered:</p>

    
            
                
        <p>    * 
        <code class='verbatim'>method=&#39;trf&#39;</code>
     terminates if the uniform norm of the gradient,</p>

    
            
                
        <p>      scaled to account for the presence of the bounds, is less than       <code><a link href="#tol" class='local'>tol</a></code>.</p>

    
            
                
        <p>    * 
        <code class='verbatim'>method=&#39;bvls&#39;</code>
     terminates if Karush-Kuhn-Tucker conditions</p>

    
            
                
        <p>      are satisfied within <code><a link href="#tol" class='local'>tol</a></code> tolerance.</p>

    
            
        </dd>
       
            
                <dt><a id="lsq_solver">lsq_solver</a> : {None, &#39;exact&#39;, &#39;lsmr&#39;}, optional</dt>
            
        </dl>

        <dd>
            
                
        <p>Method of solving unbounded least-squares problems throughout iterations:</p>

    
            
                
          <!-- deflist -->
           <dl>
               
               <dt>
        <p>* &#39;exact&#39; : Use dense QR or SVD decomposition approach. Can&#39;t be</p>

    <dt>
               <dd>

                       
        <p>used when <code><a link href="#A" class='local'>A</a></code> is sparse or LinearOperator.</p>

    
                  
               <dd>
                 
           </dl>
       
            
                
        <p>    * &#39;lsmr&#39; : Use <code><a link href="/p/scipy/1.5.0/api/scipy.sparse.linalg.isolve.lsmr.lsmr.html" class='exists'>scipy.sparse.linalg.lsmr</a></code>
         iterative procedure</p>

    
            
                
        <p>      which requires only matrix-vector product evaluations. Can&#39;t       be used with 
        <code class='verbatim'>method=&#39;bvls&#39;</code>
    .</p>

    
            
                
        <p>If None (default), the solver is chosen based on type of <code><a link href="#A" class='local'>A</a></code>.</p>

    
            
        </dd>
       
            
                <dt><a id="lsmr_tol">lsmr_tol</a> : None, float or &#39;auto&#39;, optional</dt>
            
        </dl>

        <dd>
            
                
        <p>Tolerance parameters &#39;atol&#39; and &#39;btol&#39; for <code><a link href="/p/scipy/1.5.0/api/scipy.sparse.linalg.isolve.lsmr.lsmr.html" class='exists'>scipy.sparse.linalg.lsmr</a></code>
         If None (default), it is set to 
        <code class='verbatim'>1e-2 * tol</code>
    . If &#39;auto&#39;, the tolerance will be adjusted based on the optimality of the current iterate, which can speed up the optimization process, but is not always reliable.</p>

    
            
        </dd>
       
            
                <dt><a id="max_iter">max_iter</a> : None or int, optional</dt>
            
        </dl>

        <dd>
            
                
        <p>Maximum number of iterations before termination. If None (default), it is set to 100 for 
        <code class='verbatim'>method=&#39;trf&#39;</code>
     or to the number of variables for 
        <code class='verbatim'>method=&#39;bvls&#39;</code>
     (not counting iterations for &#39;bvls&#39; initialization).</p>

    
            
        </dd>
       
            
                <dt><a id="verbose">verbose</a> : {0, 1, 2}, optional</dt>
            
        </dl>

        <dd>
            
                
        <p>Level of algorithm&#39;s verbosity:</p>

    
            
                
        <p>    * 0 : work silently (default).     * 1 : display a termination report.     * 2 : display progress during iterations.</p>

    
            
        </dd>
       

   </pre>
   


    
        <h3 id="section-Returns">Returns</h3>
    
    
       <dl>
           
            
                <dt>OptimizeResult with the following fields defined:</dt>
            
        </dl>

        <dd>
            
        </dd>
       
            
                <dt><a id="x">x</a> : ndarray, shape (n,)</dt>
            
        </dl>

        <dd>
            
                
        <p>Solution found.</p>

    
            
        </dd>
       
            
                <dt><a id="cost">cost</a> : float</dt>
            
        </dl>

        <dd>
            
                
        <p>Value of the cost function at the solution.</p>

    
            
        </dd>
       
            
                <dt><a id="fun">fun</a> : ndarray, shape (m,)</dt>
            
        </dl>

        <dd>
            
                
        <p>Vector of residuals at the solution.</p>

    
            
        </dd>
       
            
                <dt><a id="optimality">optimality</a> : float</dt>
            
        </dl>

        <dd>
            
                
        <p>First-order optimality measure. The exact meaning depends on <code><a link href="#method" class='local'>method</a></code>, refer to the description of <code><a link href="#tol" class='local'>tol</a></code> parameter.</p>

    
            
        </dd>
       
            
                <dt><a id="active_mask">active_mask</a> : ndarray of int, shape (n,)</dt>
            
        </dl>

        <dd>
            
                
        <p>Each component shows whether a corresponding constraint is active (that is, whether a variable is at the bound):</p>

    
            
                
        <p>    *  0 : a constraint is not active.     * -1 : a lower bound is active.     *  1 : an upper bound is active.</p>

    
            
                
        <p>Might be somewhat arbitrary for the <code><a link href="/p/scipy/1.5.0/api/scipy.optimize._lsq.trf.html" class='exists'>trf</a></code>
         method as it generates a sequence of strictly feasible iterates and active_mask is determined within a tolerance threshold.</p>

    
            
        </dd>
       
            
                <dt><a id="nit">nit</a> : int</dt>
            
        </dl>

        <dd>
            
                
        <p>Number of iterations. Zero if the unconstrained solution is optimal.</p>

    
            
        </dd>
       
            
                <dt><a id="status">status</a> : int</dt>
            
        </dl>

        <dd>
            
                
        <p>Reason for algorithm termination:</p>

    
            
                
          <!-- deflist -->
           <dl>
               
               <dt>
        <p>* -1 : the algorithm was not able to make progress on the last</p>

    <dt>
               <dd>

                       
        <p>iteration.</p>

    
                  
               <dd>
                 
           </dl>
       
            
                
        <p>    *  0 : the maximum number of iterations is exceeded.     *  1 : the first-order optimality measure is less than <code><a link href="#tol" class='local'>tol</a></code>.     *  2 : the relative change of the cost function is less than <code><a link href="#tol" class='local'>tol</a></code>.     *  3 : the unconstrained solution is optimal.</p>

    
            
        </dd>
       
            
                <dt><a id="message">message</a> : str</dt>
            
        </dl>

        <dd>
            
                
        <p>Verbal description of the termination reason.</p>

    
            
        </dd>
       
            
                <dt><a id="success">success</a> : bool</dt>
            
        </dl>

        <dd>
            
                
        <p>True if one of the convergence criteria is satisfied (<code><a link href="#status" class='local'>status</a></code> &gt; 0).</p>

    
            
        </dd>
       

   </pre>
   


    
    
       <dl>
           

   </pre>
   


    
    
       
   


    
    
       <dl>
           

   </pre>
   


    
    
       <dl>
           

   </pre>
   


    
    
       <dl>
           

   </pre>
   


    
    
       <dl>
           

   </pre>
   


    
    
       
   


    
        <h3 id="section-Notes">Notes</h3>
    
    
        <!-- rendering Notes -->
        
           
               
        <p>The algorithm first computes the unconstrained least-squares solution by <code><a link href="/p/numpy/1.20.0/api/numpy.linalg.lstsq.html" class='exists'>numpy.linalg.lstsq</a></code>
         or <code><a link href="/p/scipy/1.5.0/api/scipy.sparse.linalg.isolve.lsmr.lsmr.html" class='exists'>scipy.sparse.linalg.lsmr</a></code>
         depending on <code><a link href="#lsq_solver" class='local'>lsq_solver</a></code>. This solution is returned as optimal if it lies within the bounds.</p>

    
           
               
        <p>Method &#39;trf&#39; runs the adaptation of the algorithm described in [STIR]_ for a linear least-squares problem. The iterations are essentially the same as in the nonlinear least-squares algorithm, but as the quadratic function model is always accurate, we don&#39;t need to track or modify the radius of a trust region. The line search (backtracking) is used as a safety net when a selected step does not decrease the cost function. Read more detailed description of the algorithm in <code><a link href="/p/scipy/1.5.0/api/scipy.optimize._lsq.least_squares.least_squares.html" class='exists'>scipy.optimize.least_squares</a></code>
        .</p>

    
           
               
        <p>Method &#39;bvls&#39; runs a Python implementation of the algorithm described in [BVLS]_. The algorithm maintains active and free sets of variables, on each iteration chooses a new variable to move from the active set to the free set and then solves the unconstrained least-squares problem on free variables. This algorithm is guaranteed to give an accurate solution eventually, but may require up to n iterations for a problem with n variables. Additionally, an ad-hoc initialization procedure is implemented, that determines which variables to set free or active initially. It takes some number of iterations before actual BVLS starts, but can significantly reduce the number of further iterations.</p>

    
           
       
    


    
    
       
   



    <h3 id="section-Examples">Examples</h3>
        
                
        <p>In this example, a problem with a large sparse matrix and bounds on the variables is solved.</p>

    
            
            
         
                <pre class='highlight execed'><span class='nsl'>&gt;&gt;&gt; </span><span class="kn">from</span><span class=""> </span><span class="nn">scipy</span><span class="nn">.</span><span class="nn">sparse</span><span class=""> </span><span class="kn">import</span><span class=""> </span><span class="">rand</span><br><span class='nsl'>...&nbsp;</span><span class="kn">from</span><span class=""> </span><span class="nn">scipy</span><span class="nn">.</span><span class="nn">optimize</span><span class=""> </span><span class="kn">import</span><span class=""> </span><span class="">lsq_linear</span>
...</pre>
            
            
         
                <pre class='highlight execed'><span class='nsl'>&gt;&gt;&gt; </span><a class="foo ", href="/p/numpy/1.20.0/api/numpy.html">np</a><span class="o">.</span><a class="foo ", href="/p/numpy/1.20.0/api/numpy.random.html">random</a><span class="o">.</span><span class="">seed</span><span class="">(</span><span class="mi">0</span><span class="">)</span>
...</pre>
            
            
         
                <pre class='highlight execed'><span class='nsl'>&gt;&gt;&gt; </span><span class="">m</span><span class=""> </span><span class="o">=</span><span class=""> </span><span class="mi">20000</span><br><span class='nsl'>...&nbsp;</span><span class="">n</span><span class=""> </span><span class="o">=</span><span class=""> </span><span class="mi">10000</span>
...</pre>
            
            
         
                <pre class='highlight execed'><span class='nsl'>&gt;&gt;&gt; </span><span class="">A</span><span class=""> </span><span class="o">=</span><span class=""> </span><span class="">rand</span><span class="">(</span><span class="">m</span><span class="">,</span><span class=""> </span><span class="">n</span><span class="">,</span><span class=""> </span><span class="">density</span><span class="o">=</span><span class="mf">1e-4</span><span class="">)</span><br><span class='nsl'>...&nbsp;</span><span class="">b</span><span class=""> </span><span class="o">=</span><span class=""> </span><a class="foo ", href="/p/numpy/1.20.0/api/numpy.html">np</a><span class="o">.</span><a class="foo ", href="/p/numpy/1.20.0/api/numpy.random.html">random</a><span class="o">.</span><span class="">randn</span><span class="">(</span><span class="">m</span><span class="">)</span>
...</pre>
            
            
         
                <pre class='highlight execed'><span class='nsl'>&gt;&gt;&gt; </span><span class="">lb</span><span class=""> </span><span class="o">=</span><span class=""> </span><a class="foo ", href="/p/numpy/1.20.0/api/numpy.html">np</a><span class="o">.</span><a class="foo ", href="/p/numpy/1.20.0/api/numpy.random.html">random</a><span class="o">.</span><span class="">randn</span><span class="">(</span><span class="">n</span><span class="">)</span><br><span class='nsl'>...&nbsp;</span><span class="">ub</span><span class=""> </span><span class="o">=</span><span class=""> </span><span class="">lb</span><span class=""> </span><span class="o">+</span><span class=""> </span><span class="mi">1</span>
...</pre>
            
            
         
                <pre class='highlight execed'><span class='nsl'>&gt;&gt;&gt; </span><span class="">res</span><span class=""> </span><span class="o">=</span><span class=""> </span><span class="">lsq_linear</span><span class="">(</span><span class="">A</span><span class="">,</span><span class=""> </span><span class="">b</span><span class="">,</span><span class=""> </span><span class="">bounds</span><span class="o">=</span><span class="">(</span><span class="">lb</span><span class="">,</span><span class=""> </span><span class="">ub</span><span class="">)</span><span class="">,</span><span class=""> </span><span class="">lsmr_tol</span><span class="o">=</span><span class="s2">&#34;</span><span class="s2">auto</span><span class="s2">&#34;</span><span class="">,</span><span class=""> </span><span class="">verbose</span><span class="o">=</span><span class="mi">1</span><span class="">)</span>
# may vary
The relative change of the cost function is less than `tol`.
Number of iterations 16, initial cost 1.5039e+04, final cost 1.1112e+04,
first-order optimality 4.66e-08.</pre>
            
            
         
         See :
         
             <code><a link href="/p/scipy/1.5.0/api/scipy.optimize._lsq.trf.html" class='exists'>scipy.optimize._lsq.trf</a></code>
        
         
             <code><a link href="/p/scipy/1.5.0/api/scipy.optimize._lsq.lsq_linear.lsq_linear.html" class='exists'>scipy.optimize._lsq.lsq_linear.lsq_linear</a></code>
        
         
             <code><a link href="/p/numpy/1.20.0/api/numpy.random.html" class='exists'>numpy.random</a></code>
        
         
             <code><a link href="/p/scipy/1.5.0/api/scipy.sparse.linalg.isolve.lsmr.lsmr.html" class='exists'>scipy.sparse.linalg.isolve.lsmr.lsmr</a></code>
        
         
             <code><a link href="/p/scipy/1.5.0/api/scipy.optimize._lsq.least_squares.least_squares.html" class='exists'>scipy.optimize._lsq.least_squares.least_squares</a></code>
        
         
             <code><a link href="/p/numpy/1.20.0/api/numpy.linalg.lstsq.html" class='exists'>numpy.linalg.lstsq</a></code>
        
         
             <code><a link href="/p/numpy/1.20.0/api/numpy.html" class='exists'>numpy</a></code>
        
         
     
    
     <h3>Local connectivity graph</h3>
     <p>Hover to see nodes names; edges to Self not shown, Caped at 50 nodes.</p>

     <p> Using a canvas is more power efficient and can get hundred of nodes ; but does not allow hyperlinks; , arrows
     or text (beyond on hover) </p> 
     <canvas width="800" height="500"></canvas>
     <p> SVG is more flexible but power hungry; and does not scale well to 50 + nodes. </p> 

     <svg width="800" height="500"></svg>
     <p>All aboves nodes referred to, (or are referred from) current nodes; Edges from Self to other have been omitted (or all nodes would be connected to the central node "self" which is not useful). Nodes are colored by the library they belong to, and scaled with the number of references pointing them</p>



<hr>

To Be Done: </br>

File: /Users/bussonniermatthias/miniconda3/lib/python3.8/site-packages/scipy/optimize/_lsq/lsq_linear.py </br>
Line: 34 </br>
type: &lt;class &#39;function&#39;&gt; </br>
Commit: </br>
Tag: </br>
Link to the right github gitalab repository, file and line (maybe range?)</br>
</div>


    
    <script src="https://d3js.org/d3.v4.min.js"></script>
    <script src="https://d3js.org/d3-selection-multi.v1.js"></script>
        <style type="text/css">
        .node {}

        .link { stroke: #999; stroke-opacity: .6; stroke-width: 1px; }
    </style>
<script>

var canvas = document.querySelector("canvas"),
    context = canvas.getContext("2d"),
    width = canvas.width,
    height = canvas.height;
var searchRadius = 40;



var color = d3.scaleOrdinal()
    .range(d3.schemeCategory10);

var canvas_simulation = d3.forceSimulation()
    .force("charge", d3.forceManyBody().strength(-100))
    .force("link", d3.forceLink().distance(30).strength(0.1).iterations(1).id(function(d) { return d.id; }))
    .force("x", d3.forceX().strength(0.1))
    .force("y", d3.forceY().strength(0.2));


var canvas_graph = {};

(function() {

  var pages = d3.nest()
      .key(function(d) { return d.mod; })
      .entries(canvas_graph.nodes)
      .sort(function(a, b) { return b.values.length - a.values.length; });

  var c = color.domain(pages.map(function(d) { return d.key; }));

    

  canvas_simulation
      .nodes(canvas_graph.nodes)
      .on("tick", ticked);

  canvas_simulation.force("link")
      .links(canvas_graph.links);

  d3.select(canvas)
      .on("mousemove", mousemoved)
      .call(d3.drag()
          .container(canvas)
          .subject(dragsubject)
          .on("start", dragstarted)
          .on("drag", dragged)
          .on("end", dragended));

  function ticked() {
    context.clearRect(0, 0, width, height);
    context.save();
    context.translate(width / 2, height / 2);

    context.beginPath();
    canvas_graph.links.forEach(drawLink);
    context.strokeStyle = "#aaa";
    context.stroke();
    var margin = 10; 
    
    pages.forEach(function(page) {
      context.beginPath();
      page.values.forEach(drawNode);
      context.fillStyle = color(page.key);
      context.fill();
    });

    context.restore();

  }

  function dragsubject() {
    return canvas_simulation.find(d3.event.x - width / 2, d3.event.y - height / 2, searchRadius);
  }

  function mousemoved() {
    var a = this.parentNode, m = d3.mouse(this), d = canvas_simulation.find(m[0] - width / 2, m[1] - height / 2, searchRadius);
    if (!d) return a.removeAttribute("href"), a.removeAttribute("title");
    //a.setAttribute("href", "http://bl.ocks.org/" + (d.user ? d.user + "/" : "") + d.id);
    a.setAttribute("title", d.label );
  }
})();

function dragstarted() {
  if (!d3.event.active) canvas_simulation.alphaTarget(0.3).restart();
  d3.event.subject.fx = d3.event.subject.x;
  d3.event.subject.fy = d3.event.subject.y;
}

function dragged() {
  d3.event.subject.fx = d3.event.x;
  d3.event.subject.fy = d3.event.y;
}

function dragended() {
  if (!d3.event.active) canvas_simulation.alphaTarget(0);
  d3.event.subject.fx = null;
  d3.event.subject.fy = null;
}

function drawLink(d) {
  context.moveTo(d.source.x, d.source.y);
  context.lineTo(d.target.x, d.target.y);
   //context.moveTo(d.x + 3, d.y);
  //context.arc((d.target.x*9+d.source.x)/10, (d.target.y*9+d.source.y)/10, 2, 0, 2 * Math.PI);
}

function drawNode(d) {
  context.moveTo(d.x + 5, d.y);
  context.arc(d.x, d.y, d.val, 0, 2 * Math.PI);
}

</script>
<script type="text/javascript">
    var colors = d3.scaleOrdinal(d3.schemeCategory10);

    var svg = d3.select("svg");
    var width = svg.attr("width");
    var height = svg.attr("height");
    var node;
    var link;

    // syle for arrow head in the svg...
    svg.append('defs').append('marker')
        .attrs({'id':'arrowhead',
            'viewBox':'-0 -5 10 10',
            'refX':13,
            'refY':0,
            'orient':'auto',
            'markerWidth':13,
            'markerHeight':13,
            'xoverflow':'visible'})
        .append('svg:path')
        .attr('d', 'M 0,-5 L 10 ,0 L 0,5')
        .attr('fill', '#999')
        .style('stroke','none');


    var svg_simulation = d3.forceSimulation()
        .force("charge", d3.forceManyBody().strength(-100))
        .force("link", d3.forceLink().distance(80).strength(0.01).iterations(10).id(function(d) { return d.id; }))
        .force("x", d3.forceX(width/2).strength(0.04))
        .force("y", d3.forceY(height/2).strength(0.06));





    var svg_graph = {};
    (function (error, graph) {
            if (error) throw error;
        graph.nodes.forEach(function(d) { d.x = width*Math.random(); d.y = height*Math.random()});
        update(graph.links, graph.nodes);
        })(null, svg_graph);

    var edgelabels;

    function update(links, nodes) {
        link = svg.selectAll(".link")
            .data(links)
            .enter()
            .append("line")
            .attr("class", "link")
            .attr('marker-end','url(#arrowhead)');

        //link.append("title")
        //    .text(function (d) {return d.type;});

        edgepaths = svg.selectAll(".edgepath")
            .data(links)
            .enter()
            .append('path')
            .attrs({
                'class': 'edgepath',
                'fill-opacity': 0,
                'stroke-opacity': 0,
                'id': function (d, i) {return 'edgepath' + i}
            })
            .style("pointer-events", "none");

        edgelabels = svg.selectAll(".edgelabel")
            .data(links)
            .enter()
            .append('text')
            .style("pointer-events", "none")
            .attrs({
                'class': 'edgelabel',
                'id': function (d, i) {return 'edgelabel' + i},
                'font-size': 10,
                'fill': '#aaa'
            });

        edgelabels.append('textPath')
            .attr('xlink:href', function (d, i) {return '#edgepath' + i})
            .style("text-anchor", "middle")
            .style("pointer-events", "none")
            .attr("startOffset", "50%")
            .text(function (d) {return d.type});

        node = svg.selectAll(".node")
            .data(nodes)
            .enter()
            .append("g")
            .attr("class", "node")
            .call(d3.drag()
                    .on("start", dragstarted)
                    .on("drag", dragged)
                    .on("end", dragended)
            );

        node.append("a")
                .attr("xlink:href", function(node){return node.url})
            .append("circle")
                .attr("r", function(node){return node.val})
                .style("fill", function (d, i) {return colors(d.mod);})
                .style("stroke", "#FFF")

        node.append("title")
            .text(function (d) {return d.label;});

        node.append("text")
                //.attr("dx", function(node){return node.val+1})
                .attr("dy", +10)
                .attr("opacity", "0.5")
            .text(function (d) {arr = d.label.split('.'); return arr[arr.length-1]});

        svg_simulation
            .nodes(nodes)
            .on("tick", ticked);

        svg_simulation.force("link")
                .links(links)

    }

    function ticked() {
        link
            .attr("x1", function (d) {return d.source.x;})
            .attr("y1", function (d) {return d.source.y;})
            .attr("x2", function (d) {return d.target.x;})
            .attr("y2", function (d) {return d.target.y;});

        node
            .attr("transform", function (d) {return "translate(" + d.x + ", " + d.y + ")";});

        edgepaths.attr('d', function (d) {
            return 'M ' + d.source.x + ' ' + d.source.y + ' L ' + d.target.x + ' ' + d.target.y;
        });

        edgelabels.attr('transform', function (d) {
            if (d.target.x < d.source.x) {
                var bbox = this.getBBox();

                rx = bbox.x + bbox.width / 2;
                ry = bbox.y + bbox.height / 2;
                return 'rotate(180 ' + rx + ' ' + ry + ')';
            }
            else {
                return 'rotate(0)';
            }
        });
    }

    function dragstarted(d) {
        if (!d3.event.active) svg_simulation.alphaTarget(0.3).restart()
        d.fx = d.x;
        d.fy = d.y;
    }

    function dragged(d) {
        d.fx = d3.event.x;
        d.fy = d3.event.y;
    }

    function dragended(d) {
        if (!d3.event.active) svg_simulation.alphaTarget(0);
        d.fx = null;
        d.fy = null;
    }

</script>




</div>
</body>
</html>