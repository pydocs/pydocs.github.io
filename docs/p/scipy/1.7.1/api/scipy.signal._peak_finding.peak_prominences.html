<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
    <link rel="stylesheet" href="https://fonts.xz.style/serve/inter.css">
	<link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.8.1/css/all.css" integrity="sha384-50oBUHEmvpQ+1lW4y57PTFmhCaXp0ML5d60M1M7uH2+nqUivzIebhndOJK28anvf" crossorigin="anonymous">
    
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@exampledev/new.css@1.1.2/new.min.css">
    <script type="text/x-mathjax-config">
        // this should process only math inside  span with tex2jax_process class
    MathJax.Hub.Config({
        extensions: ["tex2jax.js"],
        jax: ["input/TeX", "output/HTML-CSS"],
        tex2jax: {
        inlineMath: [ ['$','$'], ["\\(","\\)"] ],
        displayMath: [ ['$$','$$'], ["\\[","\\]"] ],
        processEscapes: true
        },
        "HTML-CSS": { fonts: ["TeX"] }
    });
    </script>
    <script type="text/javascript" async
        src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/MathJax.js">
    </script>
<style>
body{
    font-family: 'Roboto', 'Helvetica Neue', 'Helvetica', 'Arial', sans-serif;
    color: #606c76;
    font-weight: 350;
    line-height: 1.6;
    max-width: 1000px;
    margin-left:0;

}
          .graph{border: 1px gray solid;}
          .foo:hover{text-decoration:underline}
          .foo{font-weight:bold; color:#4e4e4e}
          .exists{font-weight:bold; color:#4e4e4e;text-decoration:none;}
          .local{font-weight:bold; color:#1e6f04;text-decoration:none;}
          .exists:hover{text-decoration:underline;color:black}
          .missing,.missing:hover{color:darkred;text-decoration:none;font-weight:normal}
          .signature {font-size:100%; margin-bottom: 2rem; display: block; border:none; background-color: #FFFFFF;
              font-weight:600;}
          h1, h2, h3 {color: #4e4e4e; font-weight:400;
              margin-bottom: 1rem;border-bottom: 1px solid var(--nc-bg-3);
          }
          pre{border-radius:0;
              padding:0.6rem;
          border-left: 3px solid #AAA}
          dt {font-weight: 400;}

          header{
              box-shadow: rgba(0, 0, 0, 0.24) 0px 3px 8px;
              
              padding-top:0rem;
              padding-bottom:0rem;
              z-index: 2;
              padding-left: 0;
              position: fixed;
              top: 30px;
              left:0; 
              width: 100%;
              height: 42px;
              backdrop-filter: blur(5px);
              background-color: rgba(255, 255, 255, .15);
          }
          dd::before {
            content: '';
          }
          header > brand, header>:first-child {
              border-right: 1px solid #ccc;
              border-left: 1px solid #ccc;
              padding: 16px;
              padding-top: 0.5rem;
              padding-bottom: 0.5rem;
              display: inline-block; 
              width: 167px;
              

          }
          brand > a {color:#606c76}
          brand > i {
              padding-right: 0.5rem;

        }
          nav{display:inline-block;
              padding: 10px;
              padding-left: 1rem;

          }

          dd {
              margin-left: 1rem;
              border-left:  solid #ddd;
              padding-left: 1rem;
          }
          summary > h2 { display: inline }

          .sidenav {
                height: 100%; /* Full-height: remove this if you want "auto" height */
                width: 200px; /* Set the width of the sidebar */
                position: fixed; /* Fixed Sidebar (stay in place on scroll) */
                z-index: 1; /* Stay on top */
                top: 0; /* Stay at the top */
                left: 0;
                background-color: var(--nc-bg-1);; /* Black */
                border-right: thin solid #ccc;
                overflow-x: hidden; /* Disable horizontal scroll */
                padding-top: 3rem;
 
                box-shadow: rgba(0, 0, 0, 0.24) 0px 3px 8px;
                
          }

          .sidenav a {
            padding: 6px 8px 6px 16px;
            text-decoration: none;
            color: #818181;
            display: block;
          }
          .sidenav img {
              width: 160px;
              padding-left:20px;
              padding-right:20px;
              border-bottom: solid thin #DDD; 
              padding-bottom: .5rem;
              max-width: 100%;
          }
          .sidenav i {
              font-size: 100;
              padding-left: 3.5rem;
              padding-right: 3.5rem;
              padding-bottom: .5rem;
              border-bottom: solid thin #DDD; 

          }
          .container {
              padding-left: 210px;
              
              padding-top: 30px;

          }

          ::selection {
	/* Set background color for selected text */
                background: #59b4fd;
                color: var(--nc-ac-tx);
          }

          img {max-width: 40%;}

          pre.highlight.execed, .admonition {
            border-left: 3px solid #0070f3;
          }
          .admonition {
            padding-left: 1em;
          }
          .admonition > div {
            background-color: rgba(0, 123, 255, 0.1);
            position: relative;
            margin: 0 -1rem;
            padding: 0.4rem 0.1rem 0.4rem 1.5rem;
            font-weight: bold;
            text-transform: capitalize;
        }
          .note {color: #7d77d2}
          .warning {color: #af7b1a}
          .error {color: #f44336}
          pre.highlight.compiled {
            border-left: 3px solid #7d77d2;
          }
          pre.highlight.syntax_error, pre.highlight.exception_in_exec {
            border-left: 3px solid #f44336;
          }

        /* Dropdown Button */
/* The container <div> - needed to position the dropdown content */
.dropdown {
  position: relative;
  display: inline-block;
  margin-left: -4px;
}

nav  a {
    color: #606c76;
    text-decoration: none;

}

/* Dropdown Content (Hidden by Default) */
.dropdown-content {
  display: none;
  position: absolute;
  background-color: #f1f1f1;
  min-width: 160px;
  box-shadow: 0px 8px 16px 0px rgba(0,0,0,0.2);
  z-index: 1;
}

/* Links inside the dropdown */
.dropdown-content a {
  color: black;
  padding: 12px 16px;
  text-decoration: none;
  display: block;
}

/* Change color of dropdown links on hover */
.dropdown-content a:hover {background-color: #ddd;}

/* Show the dropdown menu on hover */
.dropdown:hover .dropdown-content {display: block;
    max-height: 80vh;
    overflow: scroll;}

/* Change the background color of the dropdown button when the dropdown content is shown */
.dropdown:hover .dropbtn {}


pre { line-height: 125%; }
td.linenos .normal { color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px; }
span.linenos { color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px; }
td.linenos .special { color: #000000; background-color: #ffffc0; padding-left: 5px; padding-right: 5px; }
span.linenos.special { color: #000000; background-color: #ffffc0; padding-left: 5px; padding-right: 5px; }
.highlight .hll { background-color: #ffffcc }
.highlight { background: #ffffff; }
.highlight .c { color: #888888 } /* Comment */
.highlight .err { color: #a61717; background-color: #e3d2d2 } /* Error */
.highlight .k { color: #008800; font-weight: bold } /* Keyword */
.highlight .ch { color: #888888 } /* Comment.Hashbang */
.highlight .cm { color: #888888 } /* Comment.Multiline */
.highlight .cp { color: #cc0000; font-weight: bold } /* Comment.Preproc */
.highlight .cpf { color: #888888 } /* Comment.PreprocFile */
.highlight .c1 { color: #888888 } /* Comment.Single */
.highlight .cs { color: #cc0000; font-weight: bold; background-color: #fff0f0 } /* Comment.Special */
.highlight .gd { color: #000000; background-color: #ffdddd } /* Generic.Deleted */
.highlight .ge { font-style: italic } /* Generic.Emph */
.highlight .gr { color: #aa0000 } /* Generic.Error */
.highlight .gh { color: #333333 } /* Generic.Heading */
.highlight .gi { color: #000000; background-color: #ddffdd } /* Generic.Inserted */
.highlight .go { color: #888888 } /* Generic.Output */
.highlight .gp { color: #555555 } /* Generic.Prompt */
.highlight .gs { font-weight: bold } /* Generic.Strong */
.highlight .gu { color: #666666 } /* Generic.Subheading */
.highlight .gt { color: #aa0000 } /* Generic.Traceback */
.highlight .kc { color: #008800; font-weight: bold } /* Keyword.Constant */
.highlight .kd { color: #008800; font-weight: bold } /* Keyword.Declaration */
.highlight .kn { color: #008800; font-weight: bold } /* Keyword.Namespace */
.highlight .kp { color: #008800 } /* Keyword.Pseudo */
.highlight .kr { color: #008800; font-weight: bold } /* Keyword.Reserved */
.highlight .kt { color: #888888; font-weight: bold } /* Keyword.Type */
.highlight .m { color: #0000DD; font-weight: bold } /* Literal.Number */
.highlight .s { color: #dd2200; background-color: #fff0f0 } /* Literal.String */
.highlight .na { color: #336699 } /* Name.Attribute */
.highlight .nb { color: #003388 } /* Name.Builtin */
.highlight .nc { color: #bb0066; font-weight: bold } /* Name.Class */
.highlight .no { color: #003366; font-weight: bold } /* Name.Constant */
.highlight .nd { color: #555555 } /* Name.Decorator */
.highlight .ne { color: #bb0066; font-weight: bold } /* Name.Exception */
.highlight .nf { color: #0066bb; font-weight: bold } /* Name.Function */
.highlight .nl { color: #336699; font-style: italic } /* Name.Label */
.highlight .nn { color: #bb0066; font-weight: bold } /* Name.Namespace */
.highlight .py { color: #336699; font-weight: bold } /* Name.Property */
.highlight .nt { color: #bb0066; font-weight: bold } /* Name.Tag */
.highlight .nv { color: #336699 } /* Name.Variable */
.highlight .ow { color: #008800 } /* Operator.Word */
.highlight .w { color: #bbbbbb } /* Text.Whitespace */
.highlight .mb { color: #0000DD; font-weight: bold } /* Literal.Number.Bin */
.highlight .mf { color: #0000DD; font-weight: bold } /* Literal.Number.Float */
.highlight .mh { color: #0000DD; font-weight: bold } /* Literal.Number.Hex */
.highlight .mi { color: #0000DD; font-weight: bold } /* Literal.Number.Integer */
.highlight .mo { color: #0000DD; font-weight: bold } /* Literal.Number.Oct */
.highlight .sa { color: #dd2200; background-color: #fff0f0 } /* Literal.String.Affix */
.highlight .sb { color: #dd2200; background-color: #fff0f0 } /* Literal.String.Backtick */
.highlight .sc { color: #dd2200; background-color: #fff0f0 } /* Literal.String.Char */
.highlight .dl { color: #dd2200; background-color: #fff0f0 } /* Literal.String.Delimiter */
.highlight .sd { color: #dd2200; background-color: #fff0f0 } /* Literal.String.Doc */
.highlight .s2 { color: #dd2200; background-color: #fff0f0 } /* Literal.String.Double */
.highlight .se { color: #0044dd; background-color: #fff0f0 } /* Literal.String.Escape */
.highlight .sh { color: #dd2200; background-color: #fff0f0 } /* Literal.String.Heredoc */
.highlight .si { color: #3333bb; background-color: #fff0f0 } /* Literal.String.Interpol */
.highlight .sx { color: #22bb22; background-color: #f0fff0 } /* Literal.String.Other */
.highlight .sr { color: #008800; background-color: #fff0ff } /* Literal.String.Regex */
.highlight .s1 { color: #dd2200; background-color: #fff0f0 } /* Literal.String.Single */
.highlight .ss { color: #aa6600; background-color: #fff0f0 } /* Literal.String.Symbol */
.highlight .bp { color: #003388 } /* Name.Builtin.Pseudo */
.highlight .fm { color: #0066bb; font-weight: bold } /* Name.Function.Magic */
.highlight .vc { color: #336699 } /* Name.Variable.Class */
.highlight .vg { color: #dd7700 } /* Name.Variable.Global */
.highlight .vi { color: #3333bb } /* Name.Variable.Instance */
.highlight .vm { color: #336699 } /* Name.Variable.Magic */
.highlight .il { color: #0000DD; font-weight: bold } /* Literal.Number.Integer.Long */

.nsl {
-webkit-touch-callout: none;
-webkit-user-select: none;
-khtml-user-select: none;
-moz-user-select: none;
-ms-user-select: none;
user-select: none;
}


.block_directive{

    border-left: thin solid var(--nc-lk-1);
    padding-bottom: 8px;
    padding-left: 12px;
}

.block_directive.head{

    border: thin solid var(--nc-lk-1);
}


.block_directive > p{
    margin-left: 2em;
    margin-top: 1em;
}
.head {
    font-family: monospace;
    color: var(--nc-lk-1);
}
</style>
</head>
<body class="tex2jax_ignore">
    <header>
            <brand><i class="fab fa-python"></i><a href='/'>Home</a></brand>
        <nav> / <a href='/' >p</a>  &nbsp;/&nbsp; 
                <div class="dropdown">
                <a href=scipy>scipy</a>&nbsp;/&nbsp;
                    <div class="dropdown-content">
                            <a href="/p/IPython/8.1.0.dev/api/IPython.html">IPython</a>
                            <a href="/p/astropy/5.0/api/astropy.html">astropy</a>
                            <a href="/p/dask/2021.10.0/api/dask.html">dask</a>
                            <a href="/p/distributed/2021.10.0/api/distributed.html">distributed</a>
                            <a href="/p/matplotlib/3.5.1/api/matplotlib.html">matplotlib</a>
                            <a href="/p/numpy/1.22.1/api/numpy.html">numpy</a>
                            <a href="/p/pandas/1.4.0/api/pandas.html">pandas</a>
                            <a href="/p/papyri/0.0.8/api/papyri.html">papyri</a>
                            <a href="/p/scipy/1.7.1/api/scipy.html">scipy</a>
                            <a href="/p/skimage/0.17.2/api/skimage.html">skimage</a>
                            
                     </div>
                </div>
                <div class="dropdown">
                <a href='/p/scipy/1.7.1/api/scipy.html'>1.7.1</a>&nbsp;/&nbsp;
                    <div class="dropdown-content">
                            <a href="/p/scipy/1.7.1/api/scipy.html">1.7.1</a>
                            
                    </div>
                </div>

                <div class="dropdown">
                    <a href='/p/scipy/1.7.1/api/scipy.html'>api</a>&nbsp;/&nbsp;
                    <div class="dropdown-content">
                        <a href="/p/scipy/1.7.1/api/scipy.html">API</a>
                        <a href="/p/scipy/1.7.1/gallery">Gallery</a>
                     </div>
                </div>

            
                
                    <div class="dropdown">
                        
                            <a class="dropbtn" href='scipy.html'>scipy</a>.
                        
                        
                    </div>
                
                
                    <div class="dropdown">
                        
                            <a class="dropbtn" href='scipy.signal.html'>signal</a>.
                        
                        
                            <div class="dropdown-content">
                            <a href="/p/?/?/api/scipy._lib.html">_lib</a>
                            <a href="/p/scipy/1.7.1/api/scipy.fft.html">fft</a>
                            <a href="/p/scipy/1.7.1/api/scipy.integrate.html">integrate</a>
                            <a href="/p/scipy/1.7.1/api/scipy.interpolate.html">interpolate</a>
                            <a href="/p/?/?/api/scipy.linalg.html">linalg</a>
                            <a href="/p/?/?/api/scipy.ndimage.html">ndimage</a>
                            <a href="/p/scipy/1.7.1/api/scipy.optimize.html">optimize</a>
                            <a href="/p/scipy/1.7.1/api/scipy.signal.html">signal</a>
                            <a href="/p/scipy/1.7.1/api/scipy.sparse.html">sparse</a>
                            <a href="/p/scipy/1.7.1/api/scipy.spatial.html">spatial</a>
                            <a href="/p/scipy/1.7.1/api/scipy.special.html">special</a>
                            <a href="/p/?/?/api/scipy.stats.html">stats</a>
                            
                            </div>
                        
                    </div>
                
                
                    <div class="dropdown">
                        
                            <a class="dropbtn" href='scipy.signal._peak_finding.html'>_peak_finding</a>.
                        
                        
                            <div class="dropdown-content">
                            <a href="/p/scipy/1.7.1/api/scipy.signal._arraytools.html">_arraytools</a>
                            <a href="/p/scipy/1.7.1/api/scipy.signal._max_len_seq.html">_max_len_seq</a>
                            <a href="/p/scipy/1.7.1/api/scipy.signal._max_len_seq_inner.html">_max_len_seq_inner</a>
                            <a href="/p/scipy/1.7.1/api/scipy.signal._peak_finding.html">_peak_finding</a>
                            <a href="/p/scipy/1.7.1/api/scipy.signal._peak_finding_utils.html">_peak_finding_utils</a>
                            <a href="/p/scipy/1.7.1/api/scipy.signal._savitzky_golay.html">_savitzky_golay</a>
                            <a href="/p/scipy/1.7.1/api/scipy.signal._sosfilt.html">_sosfilt</a>
                            <a href="/p/scipy/1.7.1/api/scipy.signal._spectral.html">_spectral</a>
                            <a href="/p/scipy/1.7.1/api/scipy.signal._upfirdn.html">_upfirdn</a>
                            <a href="/p/scipy/1.7.1/api/scipy.signal._upfirdn_apply.html">_upfirdn_apply</a>
                            <a href="/p/scipy/1.7.1/api/scipy.signal.barthann.html">barthann</a>
                            <a href="/p/scipy/1.7.1/api/scipy.signal.bartlett.html">bartlett</a>
                            <a href="/p/scipy/1.7.1/api/scipy.signal.blackman.html">blackman</a>
                            <a href="/p/scipy/1.7.1/api/scipy.signal.blackmanharris.html">blackmanharris</a>
                            <a href="/p/scipy/1.7.1/api/scipy.signal.bohman.html">bohman</a>
                            <a href="/p/scipy/1.7.1/api/scipy.signal.boxcar.html">boxcar</a>
                            <a href="/p/scipy/1.7.1/api/scipy.signal.bsplines.html">bsplines</a>
                            <a href="/p/scipy/1.7.1/api/scipy.signal.chebwin.html">chebwin</a>
                            <a href="/p/scipy/1.7.1/api/scipy.signal.cosine.html">cosine</a>
                            <a href="/p/scipy/1.7.1/api/scipy.signal.exponential.html">exponential</a>
                            <a href="/p/scipy/1.7.1/api/scipy.signal.filter_design.html">filter_design</a>
                            <a href="/p/scipy/1.7.1/api/scipy.signal.fir_filter_design.html">fir_filter_design</a>
                            <a href="/p/scipy/1.7.1/api/scipy.signal.flattop.html">flattop</a>
                            <a href="/p/scipy/1.7.1/api/scipy.signal.gaussian.html">gaussian</a>
                            <a href="/p/scipy/1.7.1/api/scipy.signal.general_gaussian.html">general_gaussian</a>
                            <a href="/p/scipy/1.7.1/api/scipy.signal.hamming.html">hamming</a>
                            <a href="/p/scipy/1.7.1/api/scipy.signal.hann.html">hann</a>
                            <a href="/p/scipy/1.7.1/api/scipy.signal.kaiser.html">kaiser</a>
                            <a href="/p/scipy/1.7.1/api/scipy.signal.lti_conversion.html">lti_conversion</a>
                            <a href="/p/scipy/1.7.1/api/scipy.signal.ltisys.html">ltisys</a>
                            <a href="/p/scipy/1.7.1/api/scipy.signal.nuttall.html">nuttall</a>
                            <a href="/p/scipy/1.7.1/api/scipy.signal.parzen.html">parzen</a>
                            <a href="/p/scipy/1.7.1/api/scipy.signal.signaltools.html">signaltools</a>
                            <a href="/p/scipy/1.7.1/api/scipy.signal.sigtools.html">sigtools</a>
                            <a href="/p/scipy/1.7.1/api/scipy.signal.spectral.html">spectral</a>
                            <a href="/p/scipy/1.7.1/api/scipy.signal.spline.html">spline</a>
                            <a href="/p/scipy/1.7.1/api/scipy.signal.triang.html">triang</a>
                            <a href="/p/scipy/1.7.1/api/scipy.signal.tukey.html">tukey</a>
                            <a href="/p/scipy/1.7.1/api/scipy.signal.waveforms.html">waveforms</a>
                            <a href="/p/scipy/1.7.1/api/scipy.signal.wavelets.html">wavelets</a>
                            <a href="/p/scipy/1.7.1/api/scipy.signal.windows.html">windows</a>
                            
                            </div>
                        
                    </div>
                
                
                    <div class="dropdown">
                        
                            <a class="dropbtn" href='scipy.signal._peak_finding.peak_prominences.html'>peak_prominences</a>
                        
                        
                            <div class="dropdown-content">
                            <a href="/p/scipy/1.7.1/api/scipy.signal._peak_finding._arg_peaks_as_expected.html">_arg_peaks_as_expected</a>
                            <a href="/p/scipy/1.7.1/api/scipy.signal._peak_finding._arg_wlen_as_expected.html">_arg_wlen_as_expected</a>
                            <a href="/p/scipy/1.7.1/api/scipy.signal._peak_finding._arg_x_as_expected.html">_arg_x_as_expected</a>
                            <a href="/p/scipy/1.7.1/api/scipy.signal._peak_finding._boolrelextrema.html">_boolrelextrema</a>
                            <a href="/p/scipy/1.7.1/api/scipy.signal._peak_finding._identify_ridge_lines.html">_identify_ridge_lines</a>
                            <a href="/p/scipy/1.7.1/api/scipy.signal._peak_finding._select_by_peak_threshold.html">_select_by_peak_threshold</a>
                            <a href="/p/scipy/1.7.1/api/scipy.signal._peak_finding._select_by_property.html">_select_by_property</a>
                            <a href="/p/scipy/1.7.1/api/scipy.signal._peak_finding._unpack_condition_args.html">_unpack_condition_args</a>
                            <a href="/p/scipy/1.7.1/api/scipy.signal._peak_finding.argrelextrema.html">argrelextrema</a>
                            <a href="/p/scipy/1.7.1/api/scipy.signal._peak_finding.argrelmax.html">argrelmax</a>
                            <a href="/p/scipy/1.7.1/api/scipy.signal._peak_finding.argrelmin.html">argrelmin</a>
                            <a href="/p/scipy/1.7.1/api/scipy.signal._peak_finding.find_peaks.html">find_peaks</a>
                            <a href="/p/scipy/1.7.1/api/scipy.signal._peak_finding.peak_prominences.html">peak_prominences</a>
                            <a href="/p/scipy/1.7.1/api/scipy.signal._peak_finding.peak_widths.html">peak_widths</a>
                            
                            </div>
                        
                    </div>
                </nav>
    </header>
<div class='container'>
    <div class="sidenav">
    
        <img src="/p/scipy/1.7.1/img/logo.png"/>
    
    <a href="#">Library: scipy</a>
    <a href="#">Version: 1.7.1</a>
    <a href="#">Authors:</a>
    <a href="#">PyPI:</a>
    <a href="#">Source</a>
    <a href="#">Homepage</a>
    <a href="#">Fundings</a>
    <a href="#">Stars</a>
    <a href="#">Forks</a>
    <a href="#">Related</a>
    <hr/>
    <a>Narrative Docs</a>
    <hr/>
    <a href="#section-Notes">Notes</a>

    <a href="#section-Parameters">Parameters</a>

    <a href="#section-Raises">Raises</a>

    <a href="#section-Returns">Returns</a>

    <a href="#section-Warnings">Warnings</a>

    <a href="#section-Warns">Warns</a>

    <a href="#section-backrefs">BackRef</a>
    

    </div>

    













    <code class='signature'>peak_prominences(x, peaks, wlen=None)</code>




    
    
       <dl>
           

   </pre>
   


    
    
        <!-- rendering Extended Summary -->
        
           
               
        <p>The prominence of a peak measures how much a peak stands out from the surrounding baseline of the signal and is defined as the vertical distance between the peak and its lowest contour line.</p>

    
           
       
    


    
    
       
   


    
        <h3 id="section-Notes">Notes</h3>
    
    
        <!-- rendering Notes -->
        
           
               
        <p>Strategy to compute a peak&#39;s prominence:</p>

    
           
               
           <ol>
               <li>
        <p>Extend a horizontal line from the current peak to the left and right    until the line either reaches the window border (see <code><a link href="#wlen" class='local'>wlen</a></code>) or    intersects the signal again at the slope of a higher peak. An    intersection with a peak of the same height is ignored.</p>

    </li>
               
               <li>
        <p>On each side find the minimal signal value within the interval defined    above. These points are the peak&#39;s bases.</p>

    </li>
               
               <li>
        <p>The higher one of the two bases marks the peak&#39;s lowest contour line. The    prominence can then be calculated as the vertical difference between the    peaks height itself and its lowest contour line.</p>

    </li>
               
            </ol>
       
           
               
        <p>Searching for the peak&#39;s bases can be slow for large <code><a link href="#x" class='local'>x</a></code> with periodic behavior because large chunks or even the full signal need to be evaluated for the first algorithmic step. This evaluation area can be limited with the parameter <code><a link href="#wlen" class='local'>wlen</a></code> which restricts the algorithm to a window around the current peak and can shorten the calculation time if the window length is short in relation to <code><a link href="#x" class='local'>x</a></code>. However, this may stop the algorithm from finding the true global contour line if the peak&#39;s true bases are outside this window. Instead, a higher contour line is found within the restricted window leading to a smaller calculated prominence. In practice, this is only relevant for the highest set of peaks in <code><a link href="#x" class='local'>x</a></code>. This behavior may even be used intentionally to calculate &#34;local&#34; prominences.</p>

    
           
               
            <div class='admonition'>
    <div>versionadded</div>
    
        
        <p>1.1.0 </p>

    
    
</div>

       
           
       
    


    
    
       <dl>
           

   </pre>
   


    
        <h3 id="section-Parameters">Parameters</h3>
    
    
       <dl>
           
            
                <dt><a id="x">x</a> : sequence</dt>
            
        </dl>

        <dd>
            
                
        <p>A signal with peaks.</p>

    
            
        </dd>
       
            
                <dt><a id="peaks">peaks</a> : sequence</dt>
            
        </dl>

        <dd>
            
                
        <p>Indices of peaks in <code><a link href="#x" class='local'>x</a></code>.</p>

    
            
        </dd>
       
            
                <dt><a id="wlen">wlen</a> : int, optional</dt>
            
        </dl>

        <dd>
            
                
        <p>A window length in samples that optionally limits the evaluated area for each peak to a subset of <code><a link href="#x" class='local'>x</a></code>. The peak is always placed in the middle of the window therefore the given length is rounded up to the next odd integer. This parameter can speed up the calculation (see Notes).</p>

    
            
        </dd>
       

   </pre>
   


    
        <h3 id="section-Raises">Raises</h3>
    
    
       <dl>
           
            
                <dt>ValueError</dt>
            
        </dl>

        <dd>
            
                
        <p>If a value in <code><a link href="#peaks" class='local'>peaks</a></code> is an invalid index for <code><a link href="#x" class='local'>x</a></code>.</p>

    
            
        </dd>
       

   </pre>
   


    
    
       
   


    
        <h3 id="section-Returns">Returns</h3>
    
    
       <dl>
           
            
                <dt><a id="prominences">prominences</a> : ndarray</dt>
            
        </dl>

        <dd>
            
                
        <p>The calculated prominences for each peak in <code><a link href="#peaks" class='local'>peaks</a></code>.</p>

    
            
        </dd>
       
            
                <dt><a id="left_bases, right_bases">left_bases, right_bases</a> : ndarray</dt>
            
        </dl>

        <dd>
            
                
        <p>The peaks&#39; bases as indices in <code><a link href="#x" class='local'>x</a></code> to the left and right of each peak. The higher base of each pair is a peak&#39;s lowest contour line.</p>

    
            
        </dd>
       

   </pre>
   


    
    
        <!-- rendering Summary -->
        
           
               
        <p>Calculate the prominence of each peak in a signal.</p>

    
           
       
    


    
        <h3 id="section-Warnings">Warnings</h3>
    
    
       
   


    
        <h3 id="section-Warns">Warns</h3>
    
    
       <dl>
           
            
                <dt>PeakPropertyWarning</dt>
            
        </dl>

        <dd>
            
                
        <p>For indices in <code><a link href="#peaks" class='local'>peaks</a></code> that don&#39;t point to valid local maxima in <code><a link href="#x" class='local'>x</a></code>, the returned prominence will be 0 and this warning is raised. This also happens if <code><a link href="#wlen" class='local'>wlen</a></code> is smaller than the plateau size of a peak.</p>

    
            
        </dd>
       

   </pre>
   


    
    
       <dl>
           

   </pre>
   



    <h3 id="section-Examples">Examples</h3>
        
                <span class='note'>This example is valid syntax, but we were not able to check execution</span><pre class='highlight compiled'><span class='nsl'>&gt;&gt;&gt; </span><span class="kn">from</span><span class=""> </span><a class="foo nn", href="/p/scipy/1.7.1/api/scipy.html">scipy</a><span class="nn">.</span><a class="foo nn", href="/p/scipy/1.7.1/api/scipy.signal.html">signal</a><span class=""> </span><span class="kn">import</span><span class=""> </span><a class="foo ", href="/p/scipy/1.7.1/api/scipy.signal._peak_finding.find_peaks.html">find_peaks</a><span class="">,</span><span class=""> </span><a class="foo ", href="/p/scipy/1.7.1/api/scipy.signal._peak_finding.peak_prominences.html">peak_prominences</a><br><span class='nsl'>...&nbsp;</span><span class="kn">import</span><span class=""> </span><a class="foo nn", href="/p/matplotlib/3.5.1/api/matplotlib.html">matplotlib</a><span class="nn">.</span><a class="foo nn", href="/p/matplotlib/3.5.1/api/matplotlib.pyplot.html">pyplot</a><span class=""> </span><span class="k">as</span><span class=""> </span><a class="foo nn", href="/p/matplotlib/3.5.1/api/matplotlib.pyplot.html">plt</a>
</pre>
            
            
         
                
        <p>Create a test signal with two overlayed harmonics</p>

    
            
            
         
                <span class='note'>This example is valid syntax, but we were not able to check execution</span><pre class='highlight compiled'><span class='nsl'>&gt;&gt;&gt; </span><span class="">x</span><span class=""> </span><span class="o">=</span><span class=""> </span><a class="foo ", href="/p/numpy/1.22.1/api/numpy.html">np</a><span class="o">.</span><a class="foo ", href="/p/numpy/1.22.1/api/numpy.linspace.html">linspace</a><span class="">(</span><span class="mi">0</span><span class="">,</span><span class=""> </span><span class="mi">6</span><span class=""> </span><span class="o">*</span><span class=""> </span><a class="foo ", href="/p/numpy/1.22.1/api/numpy.html">np</a><span class="o">.</span><span class="">pi</span><span class="">,</span><span class=""> </span><span class="mi">1000</span><span class="">)</span><br><span class='nsl'>...&nbsp;</span><span class="">x</span><span class=""> </span><span class="o">=</span><span class=""> </span><a class="foo ", href="/p/numpy/1.22.1/api/numpy.html">np</a><span class="o">.</span><span class="">sin</span><span class="">(</span><span class="">x</span><span class="">)</span><span class=""> </span><span class="o">+</span><span class=""> </span><span class="mf">0.6</span><span class=""> </span><span class="o">*</span><span class=""> </span><a class="foo ", href="/p/numpy/1.22.1/api/numpy.html">np</a><span class="o">.</span><span class="">sin</span><span class="">(</span><span class="mf">2.6</span><span class=""> </span><span class="o">*</span><span class=""> </span><span class="">x</span><span class="">)</span>
</pre>
            
            
         
                
        <p>Find all peaks and calculate prominences</p>

    
            
            
         
                <span class='note'>This example is valid syntax, but we were not able to check execution</span><pre class='highlight compiled'><span class='nsl'>&gt;&gt;&gt; </span><span class="">peaks</span><span class="">,</span><span class=""> </span><span class="">_</span><span class=""> </span><span class="o">=</span><span class=""> </span><a class="foo ", href="/p/scipy/1.7.1/api/scipy.signal._peak_finding.find_peaks.html">find_peaks</a><span class="">(</span><span class="">x</span><span class="">)</span><br><span class='nsl'>...&nbsp;</span><span class="">prominences</span><span class=""> </span><span class="o">=</span><span class=""> </span><a class="foo ", href="/p/scipy/1.7.1/api/scipy.signal._peak_finding.peak_prominences.html">peak_prominences</a><span class="">(</span><span class="">x</span><span class="">,</span><span class=""> </span><span class="">peaks</span><span class="">)</span><span class="">[</span><span class="mi">0</span><span class="">]</span><br><span class='nsl'>...&nbsp;</span><span class="">prominences</span>
array([1.24159486, 0.47840168, 0.28470524, 3.10716793, 0.284603  ,
       0.47822491, 2.48340261, 0.47822491])</pre>
            
            
         
                
        <p>Calculate the height of each peak&#39;s contour line and plot the results</p>

    
            
            
         
                <span class='note'>This example is valid syntax, but we were not able to check execution</span><pre class='highlight compiled'><span class='nsl'>&gt;&gt;&gt; </span><span class="">contour_heights</span><span class=""> </span><span class="o">=</span><span class=""> </span><span class="">x</span><span class="">[</span><span class="">peaks</span><span class="">]</span><span class=""> </span><span class="o">-</span><span class=""> </span><span class="">prominences</span><br><span class='nsl'>...&nbsp;</span><a class="foo ", href="/p/matplotlib/3.5.1/api/matplotlib.pyplot.html">plt</a><span class="o">.</span><a class="foo ", href="/p/matplotlib/3.5.1/api/matplotlib.pyplot.plot.html">plot</a><span class="">(</span><span class="">x</span><span class="">)</span><br><span class='nsl'>...&nbsp;</span><a class="foo ", href="/p/matplotlib/3.5.1/api/matplotlib.pyplot.html">plt</a><span class="o">.</span><a class="foo ", href="/p/matplotlib/3.5.1/api/matplotlib.pyplot.plot.html">plot</a><span class="">(</span><span class="">peaks</span><span class="">,</span><span class=""> </span><span class="">x</span><span class="">[</span><span class="">peaks</span><span class="">]</span><span class="">,</span><span class=""> </span><span class="s2">&#34;</span><span class="s2">x</span><span class="s2">&#34;</span><span class="">)</span><br><span class='nsl'>...&nbsp;</span><a class="foo ", href="/p/matplotlib/3.5.1/api/matplotlib.pyplot.html">plt</a><span class="o">.</span><a class="foo ", href="/p/matplotlib/3.5.1/api/matplotlib.pyplot.vlines.html">vlines</a><span class="">(</span><span class="">x</span><span class="o">=</span><span class="">peaks</span><span class="">,</span><span class=""> </span><span class="">ymin</span><span class="o">=</span><span class="">contour_heights</span><span class="">,</span><span class=""> </span><span class="">ymax</span><span class="o">=</span><span class="">x</span><span class="">[</span><span class="">peaks</span><span class="">]</span><span class="">)</span><br><span class='nsl'>...&nbsp;</span><a class="foo ", href="/p/matplotlib/3.5.1/api/matplotlib.pyplot.html">plt</a><span class="o">.</span><a class="foo ", href="/p/matplotlib/3.5.1/api/matplotlib.pyplot.show.html">show</a><span class="">(</span><span class="">)</span>
</pre>
            
            
         
                
        <p>Let&#39;s evaluate a second example that demonstrates several edge cases for one peak at index 5.</p>

    
            
            
         
                <span class='note'>This example is valid syntax, but we were not able to check execution</span><pre class='highlight compiled'><span class='nsl'>&gt;&gt;&gt; </span><a class="foo ", href="/p/numpy/1.22.1/api/numpy.ndarray.html">x</a><span class=""> </span><span class="o">=</span><span class=""> </span><a class="foo ", href="/p/numpy/1.22.1/api/numpy.html">np</a><span class="o">.</span><a class="foo ", href="/p/numpy/1.22.1/api/numpy.array.html">array</a><span class="">(</span><span class="">[</span><span class="mi">0</span><span class="">,</span><span class=""> </span><span class="mi">1</span><span class="">,</span><span class=""> </span><span class="mi">0</span><span class="">,</span><span class=""> </span><span class="mi">3</span><span class="">,</span><span class=""> </span><span class="mi">1</span><span class="">,</span><span class=""> </span><span class="mi">3</span><span class="">,</span><span class=""> </span><span class="mi">0</span><span class="">,</span><span class=""> </span><span class="mi">4</span><span class="">,</span><span class=""> </span><span class="mi">0</span><span class="">]</span><span class="">)</span><br><span class='nsl'>...&nbsp;</span><a class="foo ", href="/p/numpy/1.22.1/api/numpy.ndarray.html">peaks</a><span class=""> </span><span class="o">=</span><span class=""> </span><a class="foo ", href="/p/numpy/1.22.1/api/numpy.html">np</a><span class="o">.</span><a class="foo ", href="/p/numpy/1.22.1/api/numpy.array.html">array</a><span class="">(</span><span class="">[</span><span class="mi">5</span><span class="">]</span><span class="">)</span><br><span class='nsl'>...&nbsp;</span><a class="foo ", href="/p/matplotlib/3.5.1/api/matplotlib.pyplot.html">plt</a><span class="o">.</span><a class="foo ", href="/p/matplotlib/3.5.1/api/matplotlib.pyplot.plot.html">plot</a><span class="">(</span><a class="foo ", href="/p/numpy/1.22.1/api/numpy.ndarray.html">x</a><span class="">)</span><br><span class='nsl'>...&nbsp;</span><a class="foo ", href="/p/matplotlib/3.5.1/api/matplotlib.pyplot.html">plt</a><span class="o">.</span><a class="foo ", href="/p/matplotlib/3.5.1/api/matplotlib.pyplot.plot.html">plot</a><span class="">(</span><a class="foo ", href="/p/numpy/1.22.1/api/numpy.ndarray.html">peaks</a><span class="">,</span><span class=""> </span><a class="foo ", href="/p/numpy/1.22.1/api/numpy.ndarray.html">x</a><span class="">[</span><a class="foo ", href="/p/numpy/1.22.1/api/numpy.ndarray.html">peaks</a><span class="">]</span><span class="">,</span><span class=""> </span><span class="s2">&#34;</span><span class="s2">x</span><span class="s2">&#34;</span><span class="">)</span><br><span class='nsl'>...&nbsp;</span><a class="foo ", href="/p/matplotlib/3.5.1/api/matplotlib.pyplot.html">plt</a><span class="o">.</span><a class="foo ", href="/p/matplotlib/3.5.1/api/matplotlib.pyplot.show.html">show</a><span class="">(</span><span class="">)</span><br><span class='nsl'>...&nbsp;</span><a class="foo ", href="/p/scipy/1.7.1/api/scipy.signal._peak_finding.peak_prominences.html">peak_prominences</a><span class="">(</span><a class="foo ", href="/p/numpy/1.22.1/api/numpy.ndarray.html">x</a><span class="">,</span><span class=""> </span><a class="foo ", href="/p/numpy/1.22.1/api/numpy.ndarray.html">peaks</a><span class="">)</span><span class="">  </span><span class="c1"># -&gt; (prominences, left_bases, right_bases)</span>
(array([3.]), array([2]), array([6]))</pre>
            
            
         
                
        <p>Note how the peak at index 3 of the same height is not considered as a border while searching for the left base. Instead, two minima at 0 and 2 are found in which case the one closer to the evaluated peak is always chosen. On the right side, however, the base must be placed at 6 because the higher peak represents the right border to the evaluated area.</p>

    
            
            
         
                <span class='note'>This example is valid syntax, but we were not able to check execution</span><pre class='highlight compiled'><span class='nsl'>&gt;&gt;&gt; </span><a class="foo ", href="/p/scipy/1.7.1/api/scipy.signal._peak_finding.peak_prominences.html">peak_prominences</a><span class="">(</span><a class="foo ", href="/p/numpy/1.22.1/api/numpy.ndarray.html">x</a><span class="">,</span><span class=""> </span><a class="foo ", href="/p/numpy/1.22.1/api/numpy.ndarray.html">peaks</a><span class="">,</span><span class=""> </span><a class="foo ", href="/p/scipy/1.7.1/api/scipy.signal._peak_finding._arg_wlen_as_expected.html">wlen</a><span class="o">=</span><span class="mf">3.1</span><span class="">)</span>
(array([2.]), array([4]), array([6]))</pre>
            
            
         
                
        <p>Here, we restricted the algorithm to a window from 3 to 7 (the length is 5 samples because <code><a link href="/p/scipy/1.7.1/api/scipy.signal._peak_finding._arg_wlen_as_expected.html" class='exists'>wlen</a></code>
         was rounded up to the next odd integer). Thus, the only two candidates in the evaluated area are the two neighboring samples and a smaller prominence is calculated.</p>

    
            
            
         
         See :
         
             <code><a link href="/p/scipy/1.7.1/api/scipy.signal._peak_finding.find_peaks.html" class='exists'>scipy.signal._peak_finding.find_peaks</a></code>
        
         
             <code><a link href="/p/numpy/1.22.1/api/numpy.array.html" class='exists'>numpy.array</a></code>
        
         
             <code><a link href="/p/scipy/1.7.1/api/scipy.signal._peak_finding.peak_prominences.html" class='exists'>scipy.signal._peak_finding.peak_prominences</a></code>
        
         
             <code><a link href="/p/numpy/1.22.1/api/numpy.html" class='exists'>numpy</a></code>
        
         
             <code><a link href="/p/matplotlib/3.5.1/api/matplotlib.pyplot.plot.html" class='exists'>matplotlib.pyplot.plot</a></code>
        
         
             <code><a link href="/p/matplotlib/3.5.1/api/matplotlib.pyplot.html" class='exists'>matplotlib.pyplot</a></code>
        
         
             <code><a link href="/p/matplotlib/3.5.1/api/matplotlib.pyplot.show.html" class='exists'>matplotlib.pyplot.show</a></code>
        
         
             <code><a link href="/p/scipy/1.7.1/api/scipy.signal._peak_finding._arg_wlen_as_expected.html" class='exists'>scipy.signal._peak_finding._arg_wlen_as_expected</a></code>
        
         
             <code><a link href="/p/scipy/1.7.1/api/scipy.signal.html" class='exists'>scipy.signal</a></code>
        
         
             <code><a link href="/p/numpy/1.22.1/api/numpy.ndarray.html" class='exists'>numpy.ndarray</a></code>
        
         
             <code><a link href="/p/matplotlib/3.5.1/api/matplotlib.html" class='exists'>matplotlib</a></code>
        
         
             <code><a link href="/p/numpy/1.22.1/api/numpy.linspace.html" class='exists'>numpy.linspace</a></code>
        
         
             <code><a link href="/p/matplotlib/3.5.1/api/matplotlib.pyplot.vlines.html" class='exists'>matplotlib.pyplot.vlines</a></code>
        
         
             <code><a link href="/p/scipy/1.7.1/api/scipy.html" class='exists'>scipy</a></code>
        
         
     
    


    <h3 id='section-backrefs'>Back References</h3>
    <p>The following pages refer to to this document either explicitly or contain code examples using this.</p>

    
    
        <code><a link href="/p/scipy/1.7.1/api/scipy.signal._peak_finding._arg_peaks_as_expected.html" class='exists'>scipy.signal._peak_finding._arg_peaks_as_expected</a></code>
        
    
        <code><a link href="/p/scipy/1.7.1/api/scipy.signal._peak_finding._arg_wlen_as_expected.html" class='exists'>scipy.signal._peak_finding._arg_wlen_as_expected</a></code>
        
    
        <code><a link href="/p/scipy/1.7.1/api/scipy.signal._peak_finding._arg_x_as_expected.html" class='exists'>scipy.signal._peak_finding._arg_x_as_expected</a></code>
        
    
        <code><a link href="/p/scipy/1.7.1/api/scipy.signal._peak_finding.find_peaks.html" class='exists'>scipy.signal._peak_finding.find_peaks</a></code>
        
    
        <code><a link href="/p/scipy/1.7.1/api/scipy.signal._peak_finding.peak_prominences.html" class='exists'>scipy.signal._peak_finding.peak_prominences</a></code>
        
    
        <code><a link href="/p/scipy/1.7.1/api/scipy.signal._peak_finding.peak_widths.html" class='exists'>scipy.signal._peak_finding.peak_widths</a></code>
        
    
        <code><a link href="/p/scipy/1.7.1/api/scipy.signal._peak_finding_utils._peak_prominences.html" class='exists'>scipy.signal._peak_finding_utils._peak_prominences</a></code>
        
    
        <code><a link href="/p/scipy/1.7.1/api/scipy.signal._peak_finding_utils._peak_widths.html" class='exists'>scipy.signal._peak_finding_utils._peak_widths</a></code>
        
    
    
    



<h3>Local connectivity graph</h3>
<p>Hover to see nodes names; edges to Self not shown, Caped at 50 nodes.</p>

<p> Using a canvas is more power efficient and can get hundred of nodes ; but does not allow hyperlinks; , arrows
or text (beyond on hover) </p> 
<canvas class='graph' width="800" height="500"></canvas>
<p> SVG is more flexible but power hungry; and does not scale well to 50 + nodes. </p> 

<svg class='graph' width="600" height="500"></svg>

<p>All aboves nodes referred to, (or are referred from) current nodes; Edges from Self to other have been omitted
(or all nodes would be connected to the central node "self" which is not useful). Nodes are colored by the library
they belong to, and scaled with the number of references pointing them</p>


<hr>

To Be Done: </br>

File: /scipy/signal/_peak_finding.py </br>
Line: 319 </br>
type: &lt;class &#39;function&#39;&gt; </br>
Commit: </br>
Tag: </br>
Link to the right github gitalab repository, file and line (maybe range?)</br>
</div>


    
    <script src="https://d3js.org/d3.v4.min.js"></script>
    <script src="https://d3js.org/d3-selection-multi.v1.js"></script>
        <style type="text/css">
        .node {}

        .link { stroke: #999; stroke-opacity: .6; stroke-width: 1px; }
    </style>
<script>

var canvas = document.querySelector("canvas"),
    context = canvas.getContext("2d"),
    width = canvas.width,
    height = canvas.height;
var searchRadius = 40;



var color = d3.scaleOrdinal()
    .range(d3.schemeCategory10);

var canvas_simulation = d3.forceSimulation()
    .force("charge", d3.forceManyBody().strength(-100))
    .force("link", d3.forceLink().distance(30).strength(0.1).iterations(1).id(function(d) { return d.id; }))
    .force("x", d3.forceX().strength(0.1))
    .force("y", d3.forceY().strength(0.2));


var canvas_graph = {"nodes": [{"id": 1, "val": 30.93468988235943, "label": "numpy.ndarray", "mod": "numpy", "url": "/p/numpy/1.22.1/api/numpy.ndarray"}, {"id": 2, "val": 10.449489742783179, "label": "scipy.signal._peak_finding.peak_widths", "mod": "scipy", "url": "/p/scipy/1.7.1/api/scipy.signal._peak_finding.peak_widths"}, {"id": 3, "val": 31.108440016582687, "label": "scipy", "mod": "scipy", "url": "/p/scipy/1.7.1/api/scipy"}, {"id": 4, "val": 20.24744871391589, "label": "numpy.linspace", "mod": "numpy", "url": "/p/numpy/1.22.1/api/numpy.linspace"}, {"id": 5, "val": 8.0, "label": "scipy.signal._peak_finding_utils._peak_prominences", "mod": "scipy", "url": "/p/scipy/1.7.1/api/scipy.signal._peak_finding_utils._peak_prominences"}, {"id": 6, "val": 9.414213562373096, "label": "scipy.signal._peak_finding._arg_wlen_as_expected", "mod": "scipy", "url": "/p/scipy/1.7.1/api/scipy.signal._peak_finding._arg_wlen_as_expected"}, {"id": 7, "val": 33.80697580112788, "label": "matplotlib", "mod": "matplotlib", "url": "/p/matplotlib/3.5.1/api/matplotlib"}, {"id": 8, "val": 19.916375287812983, "label": "matplotlib.pyplot.show", "mod": "matplotlib", "url": "/p/matplotlib/3.5.1/api/matplotlib.pyplot.show"}, {"id": 9, "val": 10.64575131106459, "label": "scipy.signal._peak_finding.find_peaks", "mod": "scipy", "url": "/p/scipy/1.7.1/api/scipy.signal._peak_finding.find_peaks"}, {"id": 10, "val": 9.732050807568877, "label": "matplotlib.pyplot.vlines", "mod": "matplotlib", "url": "/p/matplotlib/3.5.1/api/matplotlib.pyplot.vlines"}, {"id": 11, "val": 8.0, "label": "scipy.signal._peak_finding_utils._peak_widths", "mod": "scipy", "url": "/p/scipy/1.7.1/api/scipy.signal._peak_finding_utils._peak_widths"}, {"id": 12, "val": 22.352700094407325, "label": "matplotlib.pyplot", "mod": "matplotlib", "url": "/p/matplotlib/3.5.1/api/matplotlib.pyplot"}, {"id": 13, "val": 21.820274961085254, "label": "scipy.signal", "mod": "scipy", "url": "/p/scipy/1.7.1/api/scipy.signal"}, {"id": 15, "val": 8.0, "label": "scipy.signal._peak_finding._arg_peaks_as_expected", "mod": "scipy", "url": "/p/scipy/1.7.1/api/scipy.signal._peak_finding._arg_peaks_as_expected"}, {"id": 16, "val": 30.93468988235943, "label": "numpy.array", "mod": "numpy", "url": "/p/numpy/1.22.1/api/numpy.array"}, {"id": 17, "val": 8.0, "label": "scipy.signal._peak_finding._arg_x_as_expected", "mod": "scipy", "url": "/p/scipy/1.7.1/api/scipy.signal._peak_finding._arg_x_as_expected"}, {"id": 18, "val": 42.95711658589707, "label": "numpy", "mod": "numpy", "url": "/p/numpy/1.22.1/api/numpy"}, {"id": 19, "val": 19.618950038622252, "label": "matplotlib.pyplot.plot", "mod": "matplotlib", "url": "/p/matplotlib/3.5.1/api/matplotlib.pyplot.plot"}], "links": [{"source": 9, "target": 17, "id": 2}, {"source": 9, "target": 2, "id": 8}, {"source": 2, "target": 15, "id": 17}, {"source": 2, "target": 6, "id": 18}, {"source": 2, "target": 17, "id": 19}, {"source": 2, "target": 9, "id": 20}, {"source": 2, "target": 11, "id": 22}, {"source": 9, "target": 17, "id": 23}, {"source": 9, "target": 2, "id": 29}, {"source": 16, "target": 1, "id": 272}, {"source": 18, "target": 1, "id": 979}, {"source": 18, "target": 9, "id": 1440}, {"source": 18, "target": 2, "id": 1442}, {"source": 19, "target": 4, "id": 1798}, {"source": 19, "target": 9, "id": 1837}, {"source": 19, "target": 2, "id": 1839}, {"source": 12, "target": 4, "id": 1938}, {"source": 12, "target": 9, "id": 1989}, {"source": 12, "target": 2, "id": 1991}, {"source": 8, "target": 4, "id": 2143}, {"source": 8, "target": 9, "id": 2194}, {"source": 8, "target": 2, "id": 2196}, {"source": 13, "target": 9, "id": 2299}, {"source": 13, "target": 2, "id": 2301}, {"source": 7, "target": 4, "id": 3463}, {"source": 7, "target": 9, "id": 3515}, {"source": 7, "target": 2, "id": 3517}, {"source": 4, "target": 9, "id": 3725}, {"source": 4, "target": 2, "id": 3727}, {"source": 10, "target": 9, "id": 3805}, {"source": 3, "target": 9, "id": 4029}, {"source": 3, "target": 2, "id": 4031}]};

(function() {

  var pages = d3.nest()
      .key(function(d) { return d.mod; })
      .entries(canvas_graph.nodes)
      .sort(function(a, b) { return b.values.length - a.values.length; });

  var c = color.domain(pages.map(function(d) { return d.key; }));

    

  canvas_simulation
      .nodes(canvas_graph.nodes)
      .on("tick", ticked);

  canvas_simulation.force("link")
      .links(canvas_graph.links);

  d3.select(canvas)
      .on("mousemove", mousemoved)
      .call(d3.drag()
          .container(canvas)
          .subject(dragsubject)
          .on("start", dragstarted)
          .on("drag", dragged)
          .on("end", dragended));

  function ticked() {
    context.clearRect(0, 0, width, height);
    context.save();
    context.translate(width / 2, height / 2);

    context.beginPath();
    canvas_graph.links.forEach(drawLink);
    context.strokeStyle = "#aaa";
    context.stroke();
    var margin = 10; 
    
    pages.forEach(function(page) {
      context.beginPath();
      page.values.forEach(drawNode);
      context.fillStyle = color(page.key);
      context.fill();
    });

    context.restore();

  }

  function dragsubject() {
    return canvas_simulation.find(d3.event.x - width / 2, d3.event.y - height / 2, searchRadius);
  }

  function mousemoved() {
    var a = this.parentNode, m = d3.mouse(this), d = canvas_simulation.find(m[0] - width / 2, m[1] - height / 2, searchRadius);
    if (!d) return a.removeAttribute("href"), a.removeAttribute("title");
    //a.setAttribute("href", "http://bl.ocks.org/" + (d.user ? d.user + "/" : "") + d.id);
    a.setAttribute("title", d.label );
  }
})();

function dragstarted() {
  if (!d3.event.active) canvas_simulation.alphaTarget(0.3).restart();
  d3.event.subject.fx = d3.event.subject.x;
  d3.event.subject.fy = d3.event.subject.y;
}

function dragged() {
  d3.event.subject.fx = d3.event.x;
  d3.event.subject.fy = d3.event.y;
}

function dragended() {
  if (!d3.event.active) canvas_simulation.alphaTarget(0);
  d3.event.subject.fx = null;
  d3.event.subject.fy = null;
}

function drawLink(d) {
  context.moveTo(d.source.x, d.source.y);
  context.lineTo(d.target.x, d.target.y);
   //context.moveTo(d.x + 3, d.y);
  //context.arc((d.target.x*9+d.source.x)/10, (d.target.y*9+d.source.y)/10, 2, 0, 2 * Math.PI);
}

function drawNode(d) {
  context.moveTo(d.x + 5, d.y);
  context.arc(d.x, d.y, d.val, 0, 2 * Math.PI);
}

</script>
<script type="text/javascript">
    var colors = d3.scaleOrdinal(d3.schemeCategory10);

    var svg = d3.select("svg");
    var width = svg.attr("width");
    var height = svg.attr("height");
    var node;
    var link;

    // syle for arrow head in the svg...
    svg.append('defs').append('marker')
        .attrs({'id':'arrowhead',
            'viewBox':'-0 -5 10 10',
            'refX':13,
            'refY':0,
            'orient':'auto',
            'markerWidth':13,
            'markerHeight':13,
            'xoverflow':'visible'})
        .append('svg:path')
        .attr('d', 'M 0,-5 L 10 ,0 L 0,5')
        .attr('fill', '#999')
        .style('stroke','none');


    var svg_simulation = d3.forceSimulation()
        .force("charge", d3.forceManyBody().strength(-100))
        .force("link", d3.forceLink().distance(80).strength(0.01).iterations(10).id(function(d) { return d.id; }))
        .force("x", d3.forceX(width/2).strength(0.04))
        .force("y", d3.forceY(height/2).strength(0.06));





    var svg_graph = {"nodes": [{"id": 1, "val": 30.93468988235943, "label": "numpy.ndarray", "mod": "numpy", "url": "/p/numpy/1.22.1/api/numpy.ndarray"}, {"id": 2, "val": 10.449489742783179, "label": "scipy.signal._peak_finding.peak_widths", "mod": "scipy", "url": "/p/scipy/1.7.1/api/scipy.signal._peak_finding.peak_widths"}, {"id": 3, "val": 31.108440016582687, "label": "scipy", "mod": "scipy", "url": "/p/scipy/1.7.1/api/scipy"}, {"id": 4, "val": 20.24744871391589, "label": "numpy.linspace", "mod": "numpy", "url": "/p/numpy/1.22.1/api/numpy.linspace"}, {"id": 5, "val": 8.0, "label": "scipy.signal._peak_finding_utils._peak_prominences", "mod": "scipy", "url": "/p/scipy/1.7.1/api/scipy.signal._peak_finding_utils._peak_prominences"}, {"id": 6, "val": 9.414213562373096, "label": "scipy.signal._peak_finding._arg_wlen_as_expected", "mod": "scipy", "url": "/p/scipy/1.7.1/api/scipy.signal._peak_finding._arg_wlen_as_expected"}, {"id": 7, "val": 33.80697580112788, "label": "matplotlib", "mod": "matplotlib", "url": "/p/matplotlib/3.5.1/api/matplotlib"}, {"id": 8, "val": 19.916375287812983, "label": "matplotlib.pyplot.show", "mod": "matplotlib", "url": "/p/matplotlib/3.5.1/api/matplotlib.pyplot.show"}, {"id": 9, "val": 10.64575131106459, "label": "scipy.signal._peak_finding.find_peaks", "mod": "scipy", "url": "/p/scipy/1.7.1/api/scipy.signal._peak_finding.find_peaks"}, {"id": 10, "val": 9.732050807568877, "label": "matplotlib.pyplot.vlines", "mod": "matplotlib", "url": "/p/matplotlib/3.5.1/api/matplotlib.pyplot.vlines"}, {"id": 11, "val": 8.0, "label": "scipy.signal._peak_finding_utils._peak_widths", "mod": "scipy", "url": "/p/scipy/1.7.1/api/scipy.signal._peak_finding_utils._peak_widths"}, {"id": 12, "val": 22.352700094407325, "label": "matplotlib.pyplot", "mod": "matplotlib", "url": "/p/matplotlib/3.5.1/api/matplotlib.pyplot"}, {"id": 13, "val": 21.820274961085254, "label": "scipy.signal", "mod": "scipy", "url": "/p/scipy/1.7.1/api/scipy.signal"}, {"id": 15, "val": 8.0, "label": "scipy.signal._peak_finding._arg_peaks_as_expected", "mod": "scipy", "url": "/p/scipy/1.7.1/api/scipy.signal._peak_finding._arg_peaks_as_expected"}, {"id": 16, "val": 30.93468988235943, "label": "numpy.array", "mod": "numpy", "url": "/p/numpy/1.22.1/api/numpy.array"}, {"id": 17, "val": 8.0, "label": "scipy.signal._peak_finding._arg_x_as_expected", "mod": "scipy", "url": "/p/scipy/1.7.1/api/scipy.signal._peak_finding._arg_x_as_expected"}, {"id": 18, "val": 42.95711658589707, "label": "numpy", "mod": "numpy", "url": "/p/numpy/1.22.1/api/numpy"}, {"id": 19, "val": 19.618950038622252, "label": "matplotlib.pyplot.plot", "mod": "matplotlib", "url": "/p/matplotlib/3.5.1/api/matplotlib.pyplot.plot"}], "links": [{"source": 9, "target": 17, "id": 2}, {"source": 9, "target": 2, "id": 8}, {"source": 2, "target": 15, "id": 17}, {"source": 2, "target": 6, "id": 18}, {"source": 2, "target": 17, "id": 19}, {"source": 2, "target": 9, "id": 20}, {"source": 2, "target": 11, "id": 22}, {"source": 9, "target": 17, "id": 23}, {"source": 9, "target": 2, "id": 29}, {"source": 16, "target": 1, "id": 272}, {"source": 18, "target": 1, "id": 979}, {"source": 18, "target": 9, "id": 1440}, {"source": 18, "target": 2, "id": 1442}, {"source": 19, "target": 4, "id": 1798}, {"source": 19, "target": 9, "id": 1837}, {"source": 19, "target": 2, "id": 1839}, {"source": 12, "target": 4, "id": 1938}, {"source": 12, "target": 9, "id": 1989}, {"source": 12, "target": 2, "id": 1991}, {"source": 8, "target": 4, "id": 2143}, {"source": 8, "target": 9, "id": 2194}, {"source": 8, "target": 2, "id": 2196}, {"source": 13, "target": 9, "id": 2299}, {"source": 13, "target": 2, "id": 2301}, {"source": 7, "target": 4, "id": 3463}, {"source": 7, "target": 9, "id": 3515}, {"source": 7, "target": 2, "id": 3517}, {"source": 4, "target": 9, "id": 3725}, {"source": 4, "target": 2, "id": 3727}, {"source": 10, "target": 9, "id": 3805}, {"source": 3, "target": 9, "id": 4029}, {"source": 3, "target": 2, "id": 4031}]};
    (function (error, graph) {
            if (error) throw error;
        graph.nodes.forEach(function(d) { d.x = width*Math.random(); d.y = height*Math.random()});
        update(graph.links, graph.nodes);
        })(null, svg_graph);

    var edgelabels;

    function update(links, nodes) {
        link = svg.selectAll(".link")
            .data(links)
            .enter()
            .append("line")
            .attr("class", "link")
            .attr('marker-end','url(#arrowhead)');

        //link.append("title")
        //    .text(function (d) {return d.type;});

        edgepaths = svg.selectAll(".edgepath")
            .data(links)
            .enter()
            .append('path')
            .attrs({
                'class': 'edgepath',
                'fill-opacity': 0,
                'stroke-opacity': 0,
                'id': function (d, i) {return 'edgepath' + i}
            })
            .style("pointer-events", "none");

        edgelabels = svg.selectAll(".edgelabel")
            .data(links)
            .enter()
            .append('text')
            .style("pointer-events", "none")
            .attrs({
                'class': 'edgelabel',
                'id': function (d, i) {return 'edgelabel' + i},
                'font-size': 10,
                'fill': '#aaa'
            });

        edgelabels.append('textPath')
            .attr('xlink:href', function (d, i) {return '#edgepath' + i})
            .style("text-anchor", "middle")
            .style("pointer-events", "none")
            .attr("startOffset", "50%")
            .text(function (d) {return d.type});

        node = svg.selectAll(".node")
            .data(nodes)
            .enter()
            .append("g")
            .attr("class", "node")
            .call(d3.drag()
                    .on("start", dragstarted)
                    .on("drag", dragged)
                    .on("end", dragended)
            );

        node.append("a")
                .attr("xlink:href", function(node){return node.url})
            .append("circle")
                .attr("r", function(node){return node.val})
                .style("fill", function (d, i) {return colors(d.mod);})
                .style("stroke", "#FFF")

        node.append("title")
            .text(function (d) {return d.label;});

        node.append("text")
                //.attr("dx", function(node){return node.val+1})
                .attr("dy", +10)
                .attr("opacity", "0.5")
            .text(function (d) {arr = d.label.split('.'); return arr[arr.length-1]});

        svg_simulation
            .nodes(nodes)
            .on("tick", ticked);

        svg_simulation.force("link")
                .links(links)

    }

    function ticked() {
        link
            .attr("x1", function (d) {return d.source.x;})
            .attr("y1", function (d) {return d.source.y;})
            .attr("x2", function (d) {return d.target.x;})
            .attr("y2", function (d) {return d.target.y;});

        node
            .attr("transform", function (d) {return "translate(" + d.x + ", " + d.y + ")";});

        edgepaths.attr('d', function (d) {
            return 'M ' + d.source.x + ' ' + d.source.y + ' L ' + d.target.x + ' ' + d.target.y;
        });

        edgelabels.attr('transform', function (d) {
            if (d.target.x < d.source.x) {
                var bbox = this.getBBox();

                rx = bbox.x + bbox.width / 2;
                ry = bbox.y + bbox.height / 2;
                return 'rotate(180 ' + rx + ' ' + ry + ')';
            }
            else {
                return 'rotate(0)';
            }
        });
    }

    function dragstarted(d) {
        if (!d3.event.active) svg_simulation.alphaTarget(0.3).restart()
        d.fx = d.x;
        d.fy = d.y;
    }

    function dragged(d) {
        d.fx = d3.event.x;
        d.fy = d3.event.y;
    }

    function dragended(d) {
        if (!d3.event.active) svg_simulation.alphaTarget(0);
        d.fx = null;
        d.fy = null;
    }

</script>




</div>
</body>
</html>