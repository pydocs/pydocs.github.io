<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <link rel="icon" href="/favicon.ico" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
    <link rel="stylesheet"
          href="https://use.fontawesome.com/releases/v5.8.1/css/all.css"
          integrity="sha384-50oBUHEmvpQ+1lW4y57PTFmhCaXp0ML5d60M1M7uH2+nqUivzIebhndOJK28anvf"
          crossorigin="anonymous">
    
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@exampledev/new.css@1.1.2/new.min.css">
    <script type="text/x-mathjax-config">
      // this should process only math inside  span with tex2jax_process class
      MathJax.Hub.Config({
          extensions: ["tex2jax.js"],
          jax: ["input/TeX", "output/HTML-CSS"],
          tex2jax: {
          inlineMath: [ ['$','$'], ["\\(","\\)"] ],
          displayMath: [ ['$$','$$'], ["\\[","\\]"] ],
          processEscapes: true
          },
          "HTML-CSS": { fonts: ["TeX"] }
      });
    </script>
    <script async
        src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/MathJax.js">
    </script>
    <link rel="stylesheet" href="/papyri.css">
    <link rel="stylesheet" href="/pygments.css">
<style>

    header > brand {
        /*border-right: 1px solid #ccc;
          border-left: 1px solid #ccc;*/
        margin-left: 15px;
        padding: 0px;
        display: inline-block; 
        width: 67px;
    }

    brand > a {
        text-decoration: None;

    }
    brand >a> img {
            display: inline-block;
    margin: 0;
    padding: 0;
    position: relative;
    bottom: -10px;

   }
    .container {
       max-width: 800px;
       padding-left: 210px;
       padding-top: 30px;
    }
</style>
</head><body class="tex2jax_ignore">
    <header>
        <brand><a href='/'><img src='/favicon.ico'/></a></brand>
        <nav> / <a href='/' >p</a>  &nbsp;/&nbsp; 
                <div class="dropdown">
                <a href=skimage>skimage</a>&nbsp;/&nbsp;
                    <div class="dropdown-content">
<a href="/p/IPython/8.2.0/api/IPython.html">IPython</a>
<a href="/p/astropy/5.0/api/astropy.html">astropy</a>
<a href="/p/dask/2021.10.0/api/dask.html">dask</a>
<a href="/p/distributed/2021.10.0/api/distributed.html">distributed</a>
<a href="/p/matplotlib/3.5.1/api/matplotlib.html">matplotlib</a>
<a href="/p/networkx/2.7.2rc1.dev0/api/networkx.html">networkx</a>
<a href="/p/numpy/1.22.3/api/numpy.html">numpy</a>
<a href="/p/pandas/1.4.1/api/pandas.html">pandas</a>
<a href="/p/papyri/0.0.8/api/papyri.html">papyri</a>
<a href="/p/scipy/1.8.0/api/scipy.html">scipy</a>
<a href="/p/skimage/0.17.2/api/skimage.html">skimage</a>
                     </div>
                </div>
                <div class="dropdown">
                <a href='/p/skimage/0.17.2/api/skimage.html'>0.17.2</a>&nbsp;/&nbsp;
                    <div class="dropdown-content">
<a href="/p/skimage/0.17.2/api/skimage.html">0.17.2</a>
                    </div>
                </div>

                <div class="dropdown">
                    <a href='/p/skimage/0.17.2/api/skimage.html'>API</a>&nbsp;/&nbsp;
                    <div class="dropdown-content">
                        <a href="/p/skimage/0.17.2/api/skimage.html">API</a>
                        <a href="/p/skimage/0.17.2/gallery">Gallery</a>
                        <a href="/p/skimage/0.17.2/examples">Examples</a>
                        <a href="/p/skimage/0.17.2/docs">Narrative</a>
                     </div>
                </div>

                    <div class="dropdown">
                            <a class="dropbtn" href='skimage.html'>skimage</a>.                    </div><!--end dropdown-->
                    <div class="dropdown">
                            <a class="dropbtn" href='skimage.restoration.html'>restoration</a>.                            <div class="dropdown-content">
<a href="/p/skimage/0.17.2/api/skimage._raise_build_error.html">_raise_build_error</a>
<a href="/p/skimage/0.17.2/api/skimage._shared.html">_shared</a>
<a href="/p/skimage/0.17.2/api/skimage.color.html">color</a>
<a href="/p/skimage/0.17.2/api/skimage.data.html">data</a>
<a href="/p/skimage/0.17.2/api/skimage.draw.html">draw</a>
<a href="/p/skimage/0.17.2/api/skimage.exposure.html">exposure</a>
<a href="/p/skimage/0.17.2/api/skimage.feature.html">feature</a>
<a href="/p/skimage/0.17.2/api/skimage.filters.html">filters</a>
<a href="/p/skimage/0.17.2/api/skimage.graph.html">graph</a>
<a href="/p/skimage/0.17.2/api/skimage.io.html">io</a>
<a href="/p/skimage/0.17.2/api/skimage.measure.html">measure</a>
<a href="/p/skimage/0.17.2/api/skimage.metrics.html">metrics</a>
<a href="/p/skimage/0.17.2/api/skimage.morphology.html">morphology</a>
<a href="/p/skimage/0.17.2/api/skimage.restoration.html">restoration</a>
<a href="/p/skimage/0.17.2/api/skimage.segmentation.html">segmentation</a>
<a href="/p/skimage/0.17.2/api/skimage.transform.html">transform</a>
<a href="/p/skimage/0.17.2/api/skimage.util.html">util</a>
<a href="/p/skimage/0.17.2/api/skimage.viewer.html">viewer</a>
                            </div>
                    </div><!--end dropdown-->
                    <div class="dropdown">
                            <a class="dropbtn" href='skimage.restoration.deconvolution.html'>deconvolution</a>.                            <div class="dropdown-content">
<a href="/p/skimage/0.17.2/api/skimage.restoration._cycle_spin.html">_cycle_spin</a>
<a href="/p/skimage/0.17.2/api/skimage.restoration._denoise.html">_denoise</a>
<a href="/p/skimage/0.17.2/api/skimage.restoration._denoise_cy.html">_denoise_cy</a>
<a href="/p/skimage/0.17.2/api/skimage.restoration._nl_means_denoising.html">_nl_means_denoising</a>
<a href="/p/skimage/0.17.2/api/skimage.restoration._unwrap_1d.html">_unwrap_1d</a>
<a href="/p/skimage/0.17.2/api/skimage.restoration._unwrap_2d.html">_unwrap_2d</a>
<a href="/p/skimage/0.17.2/api/skimage.restoration._unwrap_3d.html">_unwrap_3d</a>
<a href="/p/skimage/0.17.2/api/skimage.restoration.deconvolution.html">deconvolution</a>
<a href="/p/skimage/0.17.2/api/skimage.restoration.inpaint.html">inpaint</a>
<a href="/p/skimage/0.17.2/api/skimage.restoration.j_invariant.html">j_invariant</a>
<a href="/p/skimage/0.17.2/api/skimage.restoration.non_local_means.html">non_local_means</a>
<a href="/p/skimage/0.17.2/api/skimage.restoration.uft.html">uft</a>
<a href="/p/skimage/0.17.2/api/skimage.restoration.unwrap.html">unwrap</a>
                            </div>
                    </div><!--end dropdown-->
                    <div class="dropdown">
                            <a class="dropbtn" href='skimage.restoration.deconvolution.wiener.html'>wiener</a>                            <div class="dropdown-content">
<a href="/p/skimage/0.17.2/api/skimage.restoration.deconvolution.richardson_lucy.html">richardson_lucy</a>
<a href="/p/skimage/0.17.2/api/skimage.restoration.deconvolution.unsupervised_wiener.html">unsupervised_wiener</a>
<a href="/p/skimage/0.17.2/api/skimage.restoration.deconvolution.wiener.html">wiener</a>
                            </div>
                    </div><!--end dropdown-->
</nav>
    </header>
<div class='container'>
    <div class="sidenav">
        <img src="/p/skimage/0.17.2/img/skimage-logo.png"/>
    <a href="#">skimage</a>
    <a href="#">0.17.2</a>
    <hr/>
    <hr/>
<a href="#section-Notes">Notes</a><a href="#section-Parameters">Parameters</a><a href="#section-Returns">Returns</a>    </div><!--end sidenav-->







<code class='signature'>wiener(image, psf, balance, reg=None, is_real=True, clip=True)</code><!-- rendering Extended Summary -->
                       <p>Return the deconvolution with a Wiener-Hunt approach (i.e. with Fourier diagonalisation).</p>

<h3 id="section-Notes">Notes</h3>
<!-- rendering Notes -->
                       <p>This function applies the Wiener filter to a noisy and degraded image by an impulse response (or PSF). If the data model is</p>

                       <span class="tex2jax_process">$$y = Hx + n$$</span>

               <p>where         <span class="tex2jax_process">$n$</span>
 is noise,         <span class="tex2jax_process">$H$</span>
 the PSF and         <span class="tex2jax_process">$x$</span>
 the unknown original image, the Wiener filter is</p>

                       <span class="tex2jax_process">$$\hat x = F^\dagger (|\Lambda_H|^2 + \lambda |\Lambda_D|^2)
\Lambda_H^\dagger F y$$</span>

               <p>where         <span class="tex2jax_process">$F$</span>
 and         <span class="tex2jax_process">$F^\dagger$</span>
 are the Fourier and inverse Fourier transforms respectively,         <span class="tex2jax_process">$\Lambda_H$</span>
 the transfer function (or the Fourier transform of the PSF, see [Hunt] below) and         <span class="tex2jax_process">$\Lambda_D$</span>
 the filter to penalize the restored image frequencies (Laplacian by default, that is penalization of high frequency). The parameter         <span class="tex2jax_process">$\lambda$</span>
 tunes the balance between the data (that tends to increase high frequency, even those coming from noise), and the regularization.</p>

               <p>These methods are then specific to a prior model. Consequently, the application or the true image nature must corresponds to the prior model. By default, the prior model (Laplacian) introduce image smoothness or pixel correlation. It can also be interpreted as high-frequency penalization to compensate the instability of the solution with respect to the data (sometimes called noise amplification or &#34;explosive&#34; solution).</p>

               <p>Finally, the use of Fourier space implies a circulant property of         <span class="tex2jax_process">$H$</span>
, see [Hunt].</p>

<h3 id="section-Parameters">Parameters</h3>
<dl>
<dt><a id="image">image</a> : (M, N) ndarray</dt>
<dd>
<p>Input degraded image</p>

</dd>
<dt><a id="psf">psf</a> : ndarray</dt>
<dd>
<p>Point Spread Function. This is assumed to be the impulse response (input image space) if the data-type is real, or the transfer function (Fourier space) if the data-type is complex. There is no constraints on the shape of the impulse response. The transfer function must be of shape <code class='not-implemented'>:None:None:`(M, N)`</code> if <code class='not-implemented'>:None:None:`is_real is True`</code>, <code class='not-implemented'>:None:None:`(M, N // 2 + 1)`</code> otherwise (see <code class='not-implemented'>:None:None:`np.fft.rfftn`</code>).</p>

</dd>
<dt><a id="balance">balance</a> : float</dt>
<dd>
<p>The regularisation parameter value that tunes the balance between the data adequacy that improve frequency restoration and the prior adequacy that reduce frequency restoration (to avoid noise artifacts).</p>

</dd>
<dt><a id="reg">reg</a> : ndarray, optional</dt>
<dd>
<p>The regularisation operator. The Laplacian by default. It can be an impulse response or a transfer function, as for the psf. Shape constraint is the same as for the <code class='not-implemented'>:None:None:`psf`</code> parameter.</p>

</dd>
<dt><a id="is_real">is_real</a> : boolean, optional</dt>
<dd>
<p>True by default. Specify if         <code class='verbatim'>psf</code>
 and         <code class='verbatim'>reg</code>
 are provided with hermitian hypothesis, that is only half of the frequency plane is provided (due to the redundancy of Fourier transform of real signal). It&#39;s apply only if         <code class='verbatim'>psf</code>
 and/or         <code class='verbatim'>reg</code>
 are provided as transfer function.  For the hermitian property see         <code class='verbatim'>uft</code>
 module or         <code class='verbatim'>np.fft.rfftn</code>
.</p>

</dd>
<dt><a id="clip">clip</a> : boolean, optional</dt>
<dd>
<p>True by default. If True, pixel values of the result above 1 or under -1 are thresholded for skimage pipeline compatibility.</p>

</dd>
</dl>

<h3 id="section-Returns">Returns</h3>
<dl>
<dt><a id="im_deconv">im_deconv</a> : (M, N) ndarray</dt>
<dd>
<p>The deconvolved image.</p>

</dd>
</dl>

<!-- rendering Summary -->
                       <p>Wiener-Hunt deconvolution</p>

<h3 id="section-Examples">Examples</h3>
<span class='note'>This example is valid syntax, but we were not able to check execution</span><pre class='highlight compiled'><span class='nsl'>&gt;&gt;&gt; </span><span class="kn">from</span><span class=""> </span><a class="foo nn" href="/p/skimage/0.17.2/api/skimage.html">skimage</a><span class=""> </span><span class="kn">import</span><span class=""> </span><a class="foo " href="/p/skimage/0.17.2/api/skimage.color.html">color</a><span class="">,</span><span class=""> </span><a class="foo " href="/p/skimage/0.17.2/api/skimage.data.html">data</a><span class="">,</span><span class=""> </span><a class="foo " href="/p/skimage/0.17.2/api/skimage.restoration.html">restoration</a><br><span class='nsl'>...&nbsp;</span><span class="">img</span><span class=""> </span><span class="o">=</span><span class=""> </span><a class="foo " href="/p/skimage/0.17.2/api/skimage.color.html">color</a><span class="o">.</span><a class="foo " href="/p/skimage/0.17.2/api/skimage.color.colorconv.rgb2gray.html">rgb2gray</a><span class="">(</span><a class="foo " href="/p/skimage/0.17.2/api/skimage.data.html">data</a><span class="o">.</span><a class="foo " href="/p/skimage/0.17.2/api/skimage.data.astronaut.html">astronaut</a><span class="">(</span><span class="">)</span><span class="">)</span><br><span class='nsl'>...&nbsp;</span><span class="kn">from</span><span class=""> </span><a class="foo nn" href="/p/scipy/*/api/scipy.html">scipy</a><span class="nn">.</span><a class="foo nn" href="/p/scipy/*/api/scipy.signal.html">signal</a><span class=""> </span><span class="kn">import</span><span class=""> </span><a class="foo " href="/p/scipy/*/api/scipy.signal._signaltools.convolve2d.html">convolve2d</a><br><span class='nsl'>...&nbsp;</span><a class="foo " href="/p/builtins/*/api/builtins.int.html">psf</a><span class=""> </span><span class="o">=</span><span class=""> </span><a class="foo " href="/p/numpy/*/api/numpy.html">np</a><span class="o">.</span><a class="foo " href="/p/numpy/*/api/numpy.ones.html">ones</a><span class="">(</span><span class="">(</span><span class="mi">5</span><span class="">,</span><span class=""> </span><span class="mi">5</span><span class="">)</span><span class="">)</span><span class=""> </span><span class="o">/</span><span class=""> </span><span class="mi">25</span><br><span class='nsl'>...&nbsp;</span><span class="">img</span><span class=""> </span><span class="o">=</span><span class=""> </span><a class="foo " href="/p/scipy/*/api/scipy.signal._signaltools.convolve2d.html">convolve2d</a><span class="">(</span><span class="">img</span><span class="">,</span><span class=""> </span><a class="foo " href="/p/builtins/*/api/builtins.int.html">psf</a><span class="">,</span><span class=""> </span><span class="s1">&#39;</span><span class="s1">same</span><span class="s1">&#39;</span><span class="">)</span><br><span class='nsl'>...&nbsp;</span><a class="foo " href="/p/builtins/*/api/builtins.float.html">img</a><span class=""> </span><span class="o">+</span><span class="o">=</span><span class=""> </span><span class="mf">0.1</span><span class=""> </span><span class="o">*</span><span class=""> </span><span class="">img</span><span class="o">.</span><span class="">std</span><span class="">(</span><span class="">)</span><span class=""> </span><span class="o">*</span><span class=""> </span><a class="foo " href="/p/numpy/*/api/numpy.html">np</a><span class="o">.</span><a class="foo " href="/p/numpy/*/api/numpy.random.html">random</a><span class="o">.</span><a class="foo " href="/p/builtins/*/api/builtins.RandomState.standard_normal.html">standard_normal</a><span class="">(</span><span class="">img</span><span class="o">.</span><span class="">shape</span><span class="">)</span><br><span class='nsl'>...&nbsp;</span><span class="">deconvolved_img</span><span class=""> </span><span class="o">=</span><span class=""> </span><a class="foo " href="/p/skimage/0.17.2/api/skimage.restoration.html">restoration</a><span class="o">.</span><a class="foo " href="/p/skimage/0.17.2/api/skimage.restoration.deconvolution.wiener.html">wiener</a><span class="">(</span><a class="foo " href="/p/builtins/*/api/builtins.float.html">img</a><span class="">,</span><span class=""> </span><a class="foo " href="/p/builtins/*/api/builtins.int.html">psf</a><span class="">,</span><span class=""> </span><span class="mi">1100</span><span class="">)</span>
</pre>
            
         See :
    


<h3>Local connectivity graph</h3>
<p>Hover to see nodes names; edges to Self not shown, Caped at 50 nodes.</p>

<p> Using a canvas is more power efficient and can get hundred of nodes ; but does not allow hyperlinks; , arrows
or text (beyond on hover) </p> 
<canvas class='graph' width="800" height="500"></canvas>
<p> SVG is more flexible but power hungry; and does not scale well to 50 + nodes. </p> 

<svg class='graph' width="600" height="500"></svg>

<p>All aboves nodes referred to, (or are referred from) current nodes; Edges from Self to other have been omitted
(or all nodes would be connected to the central node "self" which is not useful). Nodes are colored by the library
they belong to, and scaled with the number of references pointing them</p>

<hr>

    File: /skimage/restoration/deconvolution.py#13
<br/>

type: &lt;class &#39;function&#39;&gt; <br/>
Commit: <br/>

        <script src="https://d3js.org/d3.v4.min.js"></script>
    <script src="https://d3js.org/d3-selection-multi.v1.js"></script>
    <style type="text/css">
        .node {};
        .link { stroke: #999; stroke-opacity: .6; stroke-width: 1px; };
    </style>
<script>
    window._data_graph = {"nodes": [], "links": []};
</script>
<script type="text/javascript" src='/graph_canvas.js'></script>
<script type="text/javascript" src='/graph_svg.js'></script>


</div>
</body>
</html>