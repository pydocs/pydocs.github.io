<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <link rel="icon" href="/favicon.ico" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
    <link rel="stylesheet"
          href="https://use.fontawesome.com/releases/v5.8.1/css/all.css"
          integrity="sha384-50oBUHEmvpQ+1lW4y57PTFmhCaXp0ML5d60M1M7uH2+nqUivzIebhndOJK28anvf"
          crossorigin="anonymous">
    
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@exampledev/new.css@1.1.2/new.min.css">
    <script type="text/x-mathjax-config">
      // this should process only math inside  span with tex2jax_process class
      MathJax.Hub.Config({
          extensions: ["tex2jax.js"],
          jax: ["input/TeX", "output/HTML-CSS"],
          tex2jax: {
          inlineMath: [ ['$','$'], ["\\(","\\)"] ],
          displayMath: [ ['$$','$$'], ["\\[","\\]"] ],
          processEscapes: true
          },
          "HTML-CSS": { fonts: ["TeX"] }
      });
    </script>
    <script async
        src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/MathJax.js">
    </script>
    <link rel="stylesheet" href="/papyri.css">
    <link rel="stylesheet" href="/pygments.css">
<style>

    header > brand {
        /*border-right: 1px solid #ccc;
          border-left: 1px solid #ccc;*/
        margin-left: 15px;
        padding: 0px;
        display: inline-block; 
        width: 67px;
    }

    brand > a {
        text-decoration: None;

    }
    brand >a> img {
            display: inline-block;
    margin: 0;
    padding: 0;
    position: relative;
    bottom: -10px;

   }
    .container {
       max-width: 800px;
       padding-left: 210px;
       padding-top: 30px;
    }
</style>
</head><body class="tex2jax_ignore">
    <header>
        <brand><a href='/'><img src='/favicon.ico'/></a></brand>
        <nav> / <a href='/' >p</a>  &nbsp;/&nbsp; 
                <div class="dropdown">
                <a href=skimage>skimage</a>&nbsp;/&nbsp;
                    <div class="dropdown-content">
<a href="/p/IPython/8.3.0/api/IPython.html">IPython</a>
<a href="/p/astropy/5.0/api/astropy.html">astropy</a>
<a href="/p/dask/2021.10.0/api/dask.html">dask</a>
<a href="/p/distributed/2021.10.0/api/distributed.html">distributed</a>
<a href="/p/matplotlib/3.5.1/api/matplotlib.html">matplotlib</a>
<a href="/p/networkx/2.7.2rc1.dev0/api/networkx.html">networkx</a>
<a href="/p/numpy/1.22.3/api/numpy.html">numpy</a>
<a href="/p/pandas/1.4.1/api/pandas.html">pandas</a>
<a href="/p/papyri/0.0.8/api/papyri.html">papyri</a>
<a href="/p/scipy/1.8.0/api/scipy.html">scipy</a>
<a href="/p/skimage/0.17.2/api/skimage.html">skimage</a>
                     </div>
                </div>
                <div class="dropdown">
                <a href='/p/skimage/0.17.2/api/skimage.html'>0.17.2</a>&nbsp;/&nbsp;
                    <div class="dropdown-content">
<a href="/p/skimage/0.17.2/api/skimage.html">0.17.2</a>
                    </div>
                </div>

                <div class="dropdown">
                    <a href='/p/skimage/0.17.2/api/skimage.html'>API</a>&nbsp;/&nbsp;
                    <div class="dropdown-content">
                        <a href="/p/skimage/0.17.2/api/skimage.html">API</a>
                        <a href="/p/skimage/0.17.2/gallery">Gallery</a>
                        <a href="/p/skimage/0.17.2/examples">Examples</a>
                        <a href="/p/skimage/0.17.2/docs">Narrative</a>
                     </div>
                </div>

                    <div class="dropdown">
                            <a class="dropbtn" href='skimage.html'>skimage</a>.                    </div><!--end dropdown-->
                    <div class="dropdown">
                            <a class="dropbtn" href='skimage.morphology.html'>morphology</a>.                            <div class="dropdown-content">
<a href="/p/skimage/0.17.2/api/skimage._raise_build_error.html">_raise_build_error</a>
<a href="/p/skimage/0.17.2/api/skimage._shared.html">_shared</a>
<a href="/p/skimage/0.17.2/api/skimage.color.html">color</a>
<a href="/p/skimage/0.17.2/api/skimage.data.html">data</a>
<a href="/p/skimage/0.17.2/api/skimage.draw.html">draw</a>
<a href="/p/skimage/0.17.2/api/skimage.exposure.html">exposure</a>
<a href="/p/skimage/0.17.2/api/skimage.feature.html">feature</a>
<a href="/p/skimage/0.17.2/api/skimage.filters.html">filters</a>
<a href="/p/skimage/0.17.2/api/skimage.graph.html">graph</a>
<a href="/p/skimage/0.17.2/api/skimage.io.html">io</a>
<a href="/p/skimage/0.17.2/api/skimage.measure.html">measure</a>
<a href="/p/skimage/0.17.2/api/skimage.metrics.html">metrics</a>
<a href="/p/skimage/0.17.2/api/skimage.morphology.html">morphology</a>
<a href="/p/skimage/0.17.2/api/skimage.restoration.html">restoration</a>
<a href="/p/skimage/0.17.2/api/skimage.segmentation.html">segmentation</a>
<a href="/p/skimage/0.17.2/api/skimage.transform.html">transform</a>
<a href="/p/skimage/0.17.2/api/skimage.util.html">util</a>
<a href="/p/skimage/0.17.2/api/skimage.viewer.html">viewer</a>
                            </div>
                    </div><!--end dropdown-->
                    <div class="dropdown">
                            <a class="dropbtn" href='skimage.morphology.extrema.html'>extrema</a>.                            <div class="dropdown-content">
<a href="/p/skimage/0.17.2/api/skimage.morphology._convex_hull.html">_convex_hull</a>
<a href="/p/skimage/0.17.2/api/skimage.morphology._deprecated.html">_deprecated</a>
<a href="/p/skimage/0.17.2/api/skimage.morphology._extrema_cy.html">_extrema_cy</a>
<a href="/p/skimage/0.17.2/api/skimage.morphology._flood_fill.html">_flood_fill</a>
<a href="/p/skimage/0.17.2/api/skimage.morphology._flood_fill_cy.html">_flood_fill_cy</a>
<a href="/p/skimage/0.17.2/api/skimage.morphology._max_tree.html">_max_tree</a>
<a href="/p/skimage/0.17.2/api/skimage.morphology._skeletonize.html">_skeletonize</a>
<a href="/p/skimage/0.17.2/api/skimage.morphology._skeletonize_cy.html">_skeletonize_cy</a>
<a href="/p/skimage/0.17.2/api/skimage.morphology._util.html">_util</a>
<a href="/p/skimage/0.17.2/api/skimage.morphology.binary.html">binary</a>
<a href="/p/skimage/0.17.2/api/skimage.morphology.convex_hull.html">convex_hull</a>
<a href="/p/skimage/0.17.2/api/skimage.morphology.extrema.html">extrema</a>
<a href="/p/skimage/0.17.2/api/skimage.morphology.grey.html">grey</a>
<a href="/p/skimage/0.17.2/api/skimage.morphology.greyreconstruct.html">greyreconstruct</a>
<a href="/p/?/?/?/skimage.morphology.max_tree.html.html">max_tree</a>
<a href="/p/skimage/0.17.2/api/skimage.morphology.misc.html">misc</a>
<a href="/p/skimage/0.17.2/api/skimage.morphology.selem.html">selem</a>
                            </div>
                    </div><!--end dropdown-->
                    <div class="dropdown">
                            <a class="dropbtn" href='skimage.morphology.extrema.h_maxima.html'>h_maxima</a>                            <div class="dropdown-content">
<a href="/p/skimage/0.17.2/api/skimage.morphology.extrema._add_constant_clip.html">_add_constant_clip</a>
<a href="/p/skimage/0.17.2/api/skimage.morphology.extrema._subtract_constant_clip.html">_subtract_constant_clip</a>
<a href="/p/skimage/0.17.2/api/skimage.morphology.extrema.h_maxima.html">h_maxima</a>
<a href="/p/skimage/0.17.2/api/skimage.morphology.extrema.h_minima.html">h_minima</a>
<a href="/p/skimage/0.17.2/api/skimage.morphology.extrema.local_maxima.html">local_maxima</a>
<a href="/p/skimage/0.17.2/api/skimage.morphology.extrema.local_minima.html">local_minima</a>
                            </div>
                    </div><!--end dropdown-->
</nav>
    </header>
    <div class='container'>

    <div class="sidenav">
        <img src="/p/skimage/0.17.2/img/skimage-logo.png"/>
    <a href="#">skimage</a>
    <a href="#">0.17.2</a>
    <hr/>
    <hr/>
<a href="#section-Parameters">Parameters</a><a href="#section-Returns">Returns</a><a href="#section-backrefs">BackRef</a>
    </div><!--end sidenav-->







<code class='signature'>h_maxima(image, h, selem=None)</code><!-- rendering Extended Summary -->
                       <p>The local maxima are defined as connected sets of pixels with equal grey level strictly greater than the grey level of all pixels in direct neighborhood of the set.</p>

               <p>A local maximum M of height h is a local maximum for which there is at least one path joining M with a higher maximum on which the minimal value is f(M) - h (i.e. the values along the path are not decreasing by more than h with respect to the maximum&#39;s value) and no path for which the minimal value is greater.</p>

<!-- rendering Notes -->
        <h3 id="section-Parameters">Parameters</h3>
<dl>
<dt><a id="image">image</a> : ndarray</dt>
<dd>
<p>The input image for which the maxima are to be calculated.</p>

</dd>
<dt><a id="h">h</a> : unsigned integer</dt>
<dd>
<p>The minimal height of all extracted maxima.</p>

</dd>
<dt><a id="selem">selem</a> : ndarray, optional</dt>
<dd>
<p>The neighborhood expressed as an n-D array of 1&#39;s and 0&#39;s. Default is the ball of radius 1 according to the maximum norm (i.e. a 3x3 square for 2D images, a 3x3x3 cube for 3D images, etc.)</p>

</dd>
</dl>

<h3 id="section-Returns">Returns</h3>
<dl>
<dt><a id="h_max">h_max</a> : ndarray</dt>
<dd>
<p>The maxima of height &gt;= h. The resulting image is a binary image, where pixels belonging to the selected maxima take value 1, the others take value 0.</p>

</dd>
</dl>

<!-- rendering Summary -->
                       <p>Determine all maxima of the image with height &gt;= h.</p>

<h3> See Also</h3>
<dl>
            <dt><code><a href="/p/skimage/0.17.2/api/skimage.morphology.extrema.h_minima.html" class='exists'>skimage.morphology.extrema.h_minima</a></code>
</dt>
            <!-- This See also will be incorrect as the SeeAlsoItems are improperly deserialised. -->
            <dd></dd>
        </dl>
<dl>
            <dt><code><a href="/p/skimage/0.17.2/api/skimage.morphology.extrema.local_maxima.html" class='exists'>skimage.morphology.extrema.local_maxima</a></code>
</dt>
            <!-- This See also will be incorrect as the SeeAlsoItems are improperly deserialised. -->
            <dd></dd>
        </dl>
<dl>
            <dt><code><a href="/p/skimage/0.17.2/api/skimage.morphology.extrema.local_minima.html" class='exists'>skimage.morphology.extrema.local_minima</a></code>
</dt>
            <!-- This See also will be incorrect as the SeeAlsoItems are improperly deserialised. -->
            <dd></dd>
        </dl>
<h3 id="section-Examples">Examples</h3>
<span class='note'>This example is valid syntax, but we were not able to check execution</span><pre class='highlight compiled'><span class='nsl'>&gt;&gt;&gt; </span><span class="kn">import</span><span class=""> </span><a class="foo nn" href="/p/numpy/*/api/numpy.html">numpy</a><span class=""> </span><span class="k">as</span><span class=""> </span><a class="foo nn" href="/p/numpy/*/api/numpy.html">np</a><br><span class='nsl'>...&nbsp;</span><span class="kn">from</span><span class=""> </span><a class="foo nn" href="/p/skimage/0.17.2/api/skimage.html">skimage</a><span class="nn">.</span><a class="foo nn" href="/p/skimage/0.17.2/api/skimage.morphology.html">morphology</a><span class=""> </span><span class="kn">import</span><span class=""> </span><a class="foo " href="/p/skimage/0.17.2/api/skimage.morphology.extrema.html">extrema</a>
</pre>
            
                <p>We create an image (quadratic function with a maximum in the center and 4 additional constant maxima. The heights of the maxima are: 1, 21, 41, 61, 81</p>

            
<span class='note'>This example is valid syntax, but we were not able to check execution</span><pre class='highlight compiled'><span class='nsl'>&gt;&gt;&gt; </span><a class="foo " href="/p/builtins/*/api/builtins.int.html">w</a><span class=""> </span><span class="o">=</span><span class=""> </span><span class="mi">10</span><br><span class='nsl'>...&nbsp;</span><a class="foo " href="/p/numpy/*/api/numpy.ndarray.html">x</a><span class="">,</span><span class=""> </span><span class="">y</span><span class=""> </span><span class="o">=</span><span class=""> </span><a class="foo " href="/p/numpy/*/api/numpy.html">np</a><span class="o">.</span><a class="foo " href="/p/numpy/*/api/numpy.lib.index_tricks.MGridClass.html">mgrid</a><span class="">[</span><span class="mi">0</span><span class="">:</span><a class="foo " href="/p/builtins/*/api/builtins.int.html">w</a><span class="">,</span><span class="mi">0</span><span class="">:</span><a class="foo " href="/p/builtins/*/api/builtins.int.html">w</a><span class="">]</span><br><span class='nsl'>...&nbsp;</span><a class="foo " href="/p/builtins/*/api/builtins.NoneType.html">f</a><span class=""> </span><span class="o">=</span><span class=""> </span><span class="mi">20</span><span class=""> </span><span class="o">-</span><span class=""> </span><span class="mf">0.2</span><span class="o">*</span><span class="">(</span><span class="">(</span><a class="foo " href="/p/numpy/*/api/numpy.ndarray.html">x</a><span class=""> </span><span class="o">-</span><span class=""> </span><a class="foo " href="/p/builtins/*/api/builtins.int.html">w</a><span class="o">/</span><span class="mi">2</span><span class="">)</span><span class="o">*</span><span class="o">*</span><span class="mi">2</span><span class=""> </span><span class="o">+</span><span class=""> </span><span class="">(</span><span class="">y</span><span class="o">-</span><a class="foo " href="/p/builtins/*/api/builtins.int.html">w</a><span class="o">/</span><span class="mi">2</span><span class="">)</span><span class="o">*</span><span class="o">*</span><span class="mi">2</span><span class="">)</span><br><span class='nsl'>...&nbsp;</span><a class="foo " href="/p/builtins/*/api/builtins.NoneType.html">f</a><span class="">[</span><span class="mi">2</span><span class="">:</span><span class="mi">4</span><span class="">,</span><span class="mi">2</span><span class="">:</span><span class="mi">4</span><span class="">]</span><span class=""> </span><span class="o">=</span><span class=""> </span><span class="mi">40</span><span class="">;</span><span class=""> </span><a class="foo " href="/p/builtins/*/api/builtins.NoneType.html">f</a><span class="">[</span><span class="mi">2</span><span class="">:</span><span class="mi">4</span><span class="">,</span><span class="mi">7</span><span class="">:</span><span class="mi">9</span><span class="">]</span><span class=""> </span><span class="o">=</span><span class=""> </span><span class="mi">60</span><span class="">;</span><span class=""> </span><a class="foo " href="/p/builtins/*/api/builtins.NoneType.html">f</a><span class="">[</span><span class="mi">7</span><span class="">:</span><span class="mi">9</span><span class="">,</span><span class="mi">2</span><span class="">:</span><span class="mi">4</span><span class="">]</span><span class=""> </span><span class="o">=</span><span class=""> </span><span class="mi">80</span><span class="">;</span><span class=""> </span><a class="foo " href="/p/builtins/*/api/builtins.NoneType.html">f</a><span class="">[</span><span class="mi">7</span><span class="">:</span><span class="mi">9</span><span class="">,</span><span class="mi">7</span><span class="">:</span><span class="mi">9</span><span class="">]</span><span class=""> </span><span class="o">=</span><span class=""> </span><span class="mi">100</span><br><span class='nsl'>...&nbsp;</span><a class="foo " href="/p/numpy/*/api/numpy.ndarray.html">f</a><span class=""> </span><span class="o">=</span><span class=""> </span><a class="foo " href="/p/builtins/*/api/builtins.NoneType.html">f</a><span class="o">.</span><a class="foo " href="/p/numpy/*/api/numpy.ndarray.astype.html">astype</a><span class="">(</span><a class="foo " href="/p/numpy/*/api/numpy.html">np</a><span class="o">.</span><span class="">int</span><span class="">)</span>
</pre>
            
                <p>We can calculate all maxima with a height of at least 40:</p>

            
<span class='note'>This example is valid syntax, but we were not able to check execution</span><pre class='highlight compiled'><span class='nsl'>&gt;&gt;&gt; </span><a class="foo " href="/p/numpy/*/api/numpy.ndarray.html">maxima</a><span class=""> </span><span class="o">=</span><span class=""> </span><a class="foo " href="/p/skimage/0.17.2/api/skimage.morphology.extrema.html">extrema</a><span class="o">.</span><a class="foo " href="/p/skimage/0.17.2/api/skimage.morphology.extrema.h_maxima.html">h_maxima</a><span class="">(</span><a class="foo " href="/p/numpy/*/api/numpy.ndarray.html">f</a><span class="">,</span><span class=""> </span><span class="mi">40</span><span class="">)</span>
</pre>
            
                <p>The resulting image will contain 3 local maxima.</p>

            
         See :
    

    <h3 id='section-backrefs'>Back References</h3>
    <p>The following pages refer to to this document either explicitly or contain code examples using this.</p>

        <code><a link href="/p/skimage/0.17.2/api/skimage.morphology.extrema.h_maxima.html" class='exists'>skimage.morphology.extrema.h_maxima</a></code>
        <code><a link href="/p/skimage/0.17.2/api/skimage.morphology.extrema.local_minima.html" class='exists'>skimage.morphology.extrema.local_minima</a></code>
        <code><a link href="/p/skimage/0.17.2/api/skimage.morphology.extrema.local_maxima.html" class='exists'>skimage.morphology.extrema.local_maxima</a></code>
        <code><a link href="/p/skimage/0.17.2/api/skimage.morphology.extrema.h_minima.html" class='exists'>skimage.morphology.extrema.h_minima</a></code>

<h3>Local connectivity graph</h3>
<p>Hover to see nodes names; edges to Self not shown, Caped at 50 nodes.</p>

<p> Using a canvas is more power efficient and can get hundred of nodes ; but does not allow hyperlinks; , arrows
or text (beyond on hover) </p> 
<canvas class='graph' width="800" height="500"></canvas>
<p> SVG is more flexible but power hungry; and does not scale well to 50 + nodes. </p> 

<svg class='graph' width="600" height="500"></svg>

<p>All aboves nodes referred to, (or are referred from) current nodes; Edges from Self to other have been omitted
(or all nodes would be connected to the central node "self" which is not useful). Nodes are colored by the library
they belong to, and scaled with the number of references pointing them</p>

<hr>

    File: /skimage/morphology/extrema.py#48
<br/>

type: &lt;class &#39;function&#39;&gt; <br/>
Commit: <br/>

        <script src="https://d3js.org/d3.v4.min.js"></script>
    <script src="https://d3js.org/d3-selection-multi.v1.js"></script>
    <style type="text/css">
        .node {};
        .link { stroke: #999; stroke-opacity: .6; stroke-width: 1px; };
    </style>
<script>
    window._data_graph = {"nodes": [{"id": 1, "val": 10.0, "label": "skimage.morphology.extrema.local_minima", "mod": "skimage", "url": "/p/skimage/0.17.2/api/skimage.morphology.extrema.local_minima"}, {"id": 2, "val": 9.414213562373096, "label": "skimage.morphology.extrema", "mod": "skimage", "url": "/p/skimage/0.17.2/api/skimage.morphology.extrema"}, {"id": 3, "val": 10.449489742783179, "label": "skimage.morphology.extrema.local_maxima", "mod": "skimage", "url": "/p/skimage/0.17.2/api/skimage.morphology.extrema.local_maxima"}, {"id": 4, "val": 42.02939905434711, "label": "numpy", "mod": "numpy", "url": "/p/numpy/1.22.3/api/numpy"}, {"id": 5, "val": 12.79583152331272, "label": "numpy.ndarray.astype", "mod": "numpy", "url": "/p/numpy/*/api/numpy.ndarray.astype"}, {"id": 6, "val": 14.403124237432849, "label": "skimage.morphology", "mod": "skimage", "url": "/p/skimage/0.17.2/api/skimage.morphology"}, {"id": 7, "val": 20.922847983320086, "label": "skimage", "mod": "skimage", "url": "/p/skimage/0.17.2/api/skimage"}, {"id": 8, "val": 11.74165738677394, "label": "numpy.lib.index_tricks.MGridClass", "mod": "numpy", "url": "/p/numpy/1.22.3/api/numpy.lib.index_tricks.MGridClass"}, {"id": 9, "val": 24.703293088490067, "label": "builtins.int", "mod": "builtins", "url": "/p/builtins/*/api/builtins.int"}, {"id": 10, "val": 17.899494936611667, "label": "builtins.NoneType", "mod": "builtins", "url": "/p/builtins/*/api/builtins.NoneType"}, {"id": 11, "val": 10.0, "label": "skimage.morphology.extrema.h_minima", "mod": "skimage", "url": "/p/skimage/0.17.2/api/skimage.morphology.extrema.h_minima"}, {"id": 12, "val": 35.49545416973504, "label": "numpy.ndarray", "mod": "numpy", "url": "/p/numpy/1.22.3/api/numpy.ndarray"}], "links": [{"source": 12, "target": 3, "id": 25}, {"source": 12, "target": 1, "id": 30}, {"source": 12, "target": 11, "id": 504}, {"source": 6, "target": 3, "id": 778}, {"source": 6, "target": 1, "id": 780}, {"source": 6, "target": 11, "id": 783}, {"source": 4, "target": 3, "id": 837}, {"source": 4, "target": 1, "id": 844}, {"source": 4, "target": 12, "id": 1075}, {"source": 4, "target": 8, "id": 1548}, {"source": 4, "target": 11, "id": 1553}, {"source": 8, "target": 11, "id": 1963}, {"source": 3, "target": 1, "id": 1971}, {"source": 3, "target": 11, "id": 1972}, {"source": 10, "target": 11, "id": 2046}, {"source": 1, "target": 3, "id": 2075}, {"source": 1, "target": 11, "id": 2076}, {"source": 9, "target": 3, "id": 2116}, {"source": 9, "target": 1, "id": 2118}, {"source": 9, "target": 11, "id": 2272}, {"source": 9, "target": 12, "id": 2347}, {"source": 7, "target": 3, "id": 2376}, {"source": 7, "target": 1, "id": 2378}, {"source": 7, "target": 11, "id": 2467}, {"source": 11, "target": 1, "id": 2524}, {"source": 11, "target": 3, "id": 2525}, {"source": 5, "target": 11, "id": 2539}, {"source": 2, "target": 11, "id": 2555}]};
</script>
<script type="text/javascript" src='/graph_canvas.js'></script>
<script type="text/javascript" src='/graph_svg.js'></script>


</div>
</body>
</html>