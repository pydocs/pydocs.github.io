<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <link rel="icon" href="/favicon.ico" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
    <link rel="stylesheet"
          href="https://use.fontawesome.com/releases/v5.8.1/css/all.css"
          integrity="sha384-50oBUHEmvpQ+1lW4y57PTFmhCaXp0ML5d60M1M7uH2+nqUivzIebhndOJK28anvf"
          crossorigin="anonymous">
    
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@exampledev/new.css@1.1.2/new.min.css">
    <script type="text/x-mathjax-config">
      // this should process only math inside  span with tex2jax_process class
      MathJax.Hub.Config({
          extensions: ["tex2jax.js"],
          jax: ["input/TeX", "output/HTML-CSS"],
          tex2jax: {
          inlineMath: [ ['$','$'], ["\\(","\\)"] ],
          displayMath: [ ['$$','$$'], ["\\[","\\]"] ],
          processEscapes: true
          },
          "HTML-CSS": { fonts: ["TeX"] }
      });
    </script>
    <script async
        src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/MathJax.js">
    </script>
    <link rel="stylesheet" href="/papyri.css">
    <link rel="stylesheet" href="/pygments.css">
<style>

    header > brand {
        /*border-right: 1px solid #ccc;
          border-left: 1px solid #ccc;*/
        margin-left: 15px;
        padding: 0px;
        display: inline-block; 
        width: 67px;
    }

    brand > a {
        text-decoration: None;

    }
    brand >a> img {
            display: inline-block;
    margin: 0;
    padding: 0;
    position: relative;
    bottom: -10px;

   }
    .container {
       max-width: 800px;
       padding-left: 210px;
       padding-top: 30px;
    }
</style>
</head><body class="tex2jax_ignore">
    <header>
        <brand><a href='/'><img src='/favicon.ico'/></a></brand>
        <nav> / <a href='/' >p</a>  &nbsp;/&nbsp; 
                <div class="dropdown">
                <a href=skimage>skimage</a>&nbsp;/&nbsp;
                    <div class="dropdown-content">
<a href="/p/IPython/8.3.0/api/IPython.html">IPython</a>
<a href="/p/astropy/5.0/api/astropy.html">astropy</a>
<a href="/p/dask/2021.10.0/api/dask.html">dask</a>
<a href="/p/distributed/2021.10.0/api/distributed.html">distributed</a>
<a href="/p/matplotlib/3.5.1/api/matplotlib.html">matplotlib</a>
<a href="/p/networkx/2.7.2rc1.dev0/api/networkx.html">networkx</a>
<a href="/p/numpy/1.22.3/api/numpy.html">numpy</a>
<a href="/p/pandas/1.4.1/api/pandas.html">pandas</a>
<a href="/p/papyri/0.0.8/api/papyri.html">papyri</a>
<a href="/p/scipy/1.8.0/api/scipy.html">scipy</a>
<a href="/p/skimage/0.17.2/api/skimage.html">skimage</a>
                     </div>
                </div>
                <div class="dropdown">
                <a href='/p/skimage/0.17.2/api/skimage.html'>0.17.2</a>&nbsp;/&nbsp;
                    <div class="dropdown-content">
<a href="/p/skimage/0.17.2/api/skimage.html">0.17.2</a>
                    </div>
                </div>

                <div class="dropdown">
                    <a href='/p/skimage/0.17.2/api/skimage.html'>API</a>&nbsp;/&nbsp;
                    <div class="dropdown-content">
                        <a href="/p/skimage/0.17.2/api/skimage.html">API</a>
                        <a href="/p/skimage/0.17.2/gallery">Gallery</a>
                        <a href="/p/skimage/0.17.2/examples">Examples</a>
                        <a href="/p/skimage/0.17.2/docs">Narrative</a>
                     </div>
                </div>

                    <div class="dropdown">
                            <a class="dropbtn" href='skimage.html'>skimage</a>.                    </div><!--end dropdown-->
                    <div class="dropdown">
                            <a class="dropbtn" href='skimage.restoration.html'>restoration</a>.                            <div class="dropdown-content">
<a href="/p/skimage/0.17.2/api/skimage._raise_build_error.html">_raise_build_error</a>
<a href="/p/skimage/0.17.2/api/skimage._shared.html">_shared</a>
<a href="/p/skimage/0.17.2/api/skimage.color.html">color</a>
<a href="/p/skimage/0.17.2/api/skimage.data.html">data</a>
<a href="/p/skimage/0.17.2/api/skimage.draw.html">draw</a>
<a href="/p/skimage/0.17.2/api/skimage.exposure.html">exposure</a>
<a href="/p/skimage/0.17.2/api/skimage.feature.html">feature</a>
<a href="/p/skimage/0.17.2/api/skimage.filters.html">filters</a>
<a href="/p/skimage/0.17.2/api/skimage.graph.html">graph</a>
<a href="/p/skimage/0.17.2/api/skimage.io.html">io</a>
<a href="/p/skimage/0.17.2/api/skimage.measure.html">measure</a>
<a href="/p/skimage/0.17.2/api/skimage.metrics.html">metrics</a>
<a href="/p/skimage/0.17.2/api/skimage.morphology.html">morphology</a>
<a href="/p/skimage/0.17.2/api/skimage.restoration.html">restoration</a>
<a href="/p/skimage/0.17.2/api/skimage.segmentation.html">segmentation</a>
<a href="/p/skimage/0.17.2/api/skimage.transform.html">transform</a>
<a href="/p/skimage/0.17.2/api/skimage.util.html">util</a>
<a href="/p/skimage/0.17.2/api/skimage.viewer.html">viewer</a>
                            </div>
                    </div><!--end dropdown-->
                    <div class="dropdown">
                            <a class="dropbtn" href='skimage.restoration.non_local_means.html'>non_local_means</a>.                            <div class="dropdown-content">
<a href="/p/skimage/0.17.2/api/skimage.restoration._cycle_spin.html">_cycle_spin</a>
<a href="/p/skimage/0.17.2/api/skimage.restoration._denoise.html">_denoise</a>
<a href="/p/skimage/0.17.2/api/skimage.restoration._denoise_cy.html">_denoise_cy</a>
<a href="/p/skimage/0.17.2/api/skimage.restoration._nl_means_denoising.html">_nl_means_denoising</a>
<a href="/p/skimage/0.17.2/api/skimage.restoration._unwrap_1d.html">_unwrap_1d</a>
<a href="/p/skimage/0.17.2/api/skimage.restoration._unwrap_2d.html">_unwrap_2d</a>
<a href="/p/skimage/0.17.2/api/skimage.restoration._unwrap_3d.html">_unwrap_3d</a>
<a href="/p/skimage/0.17.2/api/skimage.restoration.deconvolution.html">deconvolution</a>
<a href="/p/skimage/0.17.2/api/skimage.restoration.inpaint.html">inpaint</a>
<a href="/p/skimage/0.17.2/api/skimage.restoration.j_invariant.html">j_invariant</a>
<a href="/p/skimage/0.17.2/api/skimage.restoration.non_local_means.html">non_local_means</a>
<a href="/p/skimage/0.17.2/api/skimage.restoration.uft.html">uft</a>
<a href="/p/skimage/0.17.2/api/skimage.restoration.unwrap.html">unwrap</a>
                            </div>
                    </div><!--end dropdown-->
                    <div class="dropdown">
                            <a class="dropbtn" href='skimage.restoration.non_local_means.denoise_nl_means.html'>denoise_nl_means</a>                            <div class="dropdown-content">
<a href="/p/skimage/0.17.2/api/skimage.restoration.non_local_means.denoise_nl_means.html">denoise_nl_means</a>
                            </div>
                    </div><!--end dropdown-->
</nav>
    </header>
    <div class='container'>

    <div class="sidenav">
        <img src="/p/skimage/0.17.2/img/skimage-logo.png"/>
    <a href="#">skimage</a>
    <a href="#">0.17.2</a>
    <hr/>
    <hr/>
<a href="#section-Notes">Notes</a><a href="#section-Parameters">Parameters</a><a href="#section-Returns">Returns</a><a href="#section-backrefs">BackRef</a>
    </div><!--end sidenav-->







<code class='signature'>denoise_nl_means(image, patch_size=7, patch_distance=11, h=0.1, multichannel=False, fast_mode=True, sigma=0.0, *, preserve_range=None)</code><!-- rendering Extended Summary -->
        <h3 id="section-Notes">Notes</h3>
<!-- rendering Notes -->
                       <p>The non-local means algorithm is well suited for denoising images with specific textures. The principle of the algorithm is to average the value of a given pixel with values of other pixels in a limited neighbourhood, provided that the <em>patches</em> centered on the other pixels are similar enough to the patch centered on the pixel of interest.</p>

               <p>In the original version of the algorithm , corresponding to         <code class='verbatim'>fast=False</code>
, the computational complexity is::      </p>

               <pre>image.size * patch_size ** image.ndim * patch_distance ** image.ndim</pre>
               <p>Hence, changing the size of patches or their maximal distance has a strong effect on computing times, especially for 3-D images.</p>

               <p>However, the default behavior corresponds to         <code class='verbatim'>fast_mode=True</code>
, for which another version of non-local means  is used, corresponding to a complexity of::      </p>

               <pre>image.size * patch_distance ** image.ndim</pre>
               <p>The computing time depends only weakly on the patch size, thanks to the computation of the integral of patches distances for a given shift, that reduces the number of operations . Therefore, this algorithm executes faster than the classic algorithm (        <code class='verbatim'>fast_mode=False</code>
), at the expense of using twice as much memory. This implementation has been proven to be more efficient compared to other alternatives, see e.g. .</p>

               <p>Compared to the classic algorithm, all pixels of a patch contribute to the distance to another patch with the same weight, no matter their distance to the center of the patch. This coarser computation of the distance can result in a slightly poorer denoising performance. Moreover, for small images (images with a linear size that is only a few times the patch size), the classic algorithm can be faster due to boundary effects.</p>

               <p>The image is padded using the <code class='not-implemented'>:None:None:`reflect`</code> mode of <code><a href="/p/numpy/*/api/numpy.pad.html.html" class='exists'>skimage.util.pad</a></code>
 before denoising.</p>

               <p>If the noise standard deviation, <code class='not-implemented'>:None:None:`sigma`</code>, is provided a more robust computation of patch weights is used.  Subtracting the known noise variance from the computed patch distances improves the estimates of patch similarity, giving a moderate improvement to denoising performance . It was also mentioned as an option for the fast variant of the algorithm in .</p>

               <p>When <code class='not-implemented'>:None:None:`sigma`</code> is provided, a smaller <code><a href="#h" class='local'>h</a></code> should typically be used to avoid oversmoothing.  The optimal value for <code><a href="#h" class='local'>h</a></code> depends on the image content and noise level, but a reasonable starting point is         <code class='verbatim'>h = 0.8 * sigma</code>
 when <code class='not-implemented'>:None:None:`fast_mode`</code> is <code class='not-implemented'>:None:None:`True`</code>, or         <code class='verbatim'>h = 0.6 * sigma</code>
 when <code class='not-implemented'>:None:None:`fast_mode`</code> is <code class='not-implemented'>:None:None:`False`</code>.</p>

<h3 id="section-Parameters">Parameters</h3>
<dl>
<dt><a id="image">image</a> : 2D or 3D ndarray</dt>
<dd>
<p>Input image to be denoised, which can be 2D or 3D, and grayscale or RGB (for 2D images only, see         <code class='verbatim'>multichannel</code>
 parameter).</p>

</dd>
<dt><a id="patch_size">patch_size</a> : int, optional</dt>
<dd>
<p>Size of patches used for denoising.</p>

</dd>
<dt><a id="patch_distance">patch_distance</a> : int, optional</dt>
<dd>
<p>Maximal distance in pixels where to search patches used for denoising.</p>

</dd>
<dt><a id="h">h</a> : float, optional</dt>
<dd>
<p>Cut-off distance (in gray levels). The higher h, the more permissive one is in accepting patches. A higher h results in a smoother image, at the expense of blurring features. For a Gaussian noise of standard deviation sigma, a rule of thumb is to choose the value of h to be sigma of slightly less.</p>

</dd>
<dt><a id="multichannel">multichannel</a> : bool, optional</dt>
<dd>
<p>Whether the last axis of the image is to be interpreted as multiple channels or another spatial dimension.</p>

</dd>
<dt><a id="fast_mode">fast_mode</a> : bool, optional</dt>
<dd>
<p>If True (default value), a fast version of the non-local means algorithm is used. If False, the original version of non-local means is used. See the Notes section for more details about the algorithms.</p>

</dd>
<dt><a id="sigma">sigma</a> : float, optional</dt>
<dd>
<p>The standard deviation of the (Gaussian) noise.  If provided, a more robust computation of patch weights is computed that takes the expected noise variance into account (see Notes below).</p>

</dd>
<dt><a id="preserve_range">preserve_range</a> : bool, optional</dt>
<dd>
<p>Whether to keep the original range of values. Otherwise, the input image is converted according to the conventions of <code><a href="/p/skimage/0.17.2/api/skimage.util.dtype.img_as_float.html" class='exists'>img_as_float</a></code>
. Also see https://scikit-image.org/docs/dev/user_guide/data_types.html</p>

</dd>
</dl>

<h3 id="section-Returns">Returns</h3>
<dl>
<dt><a id="result">result</a> : ndarray</dt>
<dd>
<p>Denoised image, of same shape as <code class='not-implemented'>:None:None:`image`</code>.</p>

</dd>
</dl>

<!-- rendering Summary -->
                       <p>Perform non-local means denoising on 2-D or 3-D grayscale images, and 2-D RGB images.</p>

<h3 id="section-Examples">Examples</h3>
<span class='note'>This example is valid syntax, but we were not able to check execution</span><pre class='highlight compiled'><span class='nsl'>&gt;&gt;&gt; </span><a class="foo " href="/p/numpy/*/api/numpy.ndarray.html">a</a><span class=""> </span><span class="o">=</span><span class=""> </span><a class="foo " href="/p/numpy/*/api/numpy.html">np</a><span class="o">.</span><a class="foo " href="/p/numpy/*/api/numpy.zeros.html">zeros</a><span class="">(</span><span class="">(</span><span class="mi">40</span><span class="">,</span><span class=""> </span><span class="mi">40</span><span class="">)</span><span class="">)</span><br><span class='nsl'>...&nbsp;</span><a class="foo " href="/p/numpy/*/api/numpy.ndarray.html">a</a><span class="">[</span><span class="mi">10</span><span class="">:</span><span class="o">-</span><span class="mi">10</span><span class="">,</span><span class=""> </span><span class="mi">10</span><span class="">:</span><span class="o">-</span><span class="mi">10</span><span class="">]</span><span class=""> </span><span class="o">=</span><span class=""> </span><span class="mf">1.</span><br><span class='nsl'>...&nbsp;</span><a class="foo " href="/p/builtins/*/api/builtins.float.html">a</a><span class=""> </span><span class="o">+</span><span class="o">=</span><span class=""> </span><span class="mf">0.3</span><span class=""> </span><span class="o">*</span><span class=""> </span><a class="foo " href="/p/numpy/*/api/numpy.html">np</a><span class="o">.</span><a class="foo " href="/p/numpy/*/api/numpy.random.html">random</a><span class="o">.</span><a class="foo " href="/p/builtins/*/api/builtins.RandomState.randn.html">randn</a><span class="">(</span><span class="o">*</span><a class="foo " href="/p/numpy/*/api/numpy.ndarray.html">a</a><span class="o">.</span><a class="foo " href="/p/numpy/*/api/numpy.ndarray.shape.html">shape</a><span class="">)</span><br><span class='nsl'>...&nbsp;</span><span class="">denoised_a</span><span class=""> </span><span class="o">=</span><span class=""> </span><a class="foo " href="/p/skimage/0.17.2/api/skimage.restoration.non_local_means.denoise_nl_means.html">denoise_nl_means</a><span class="">(</span><a class="foo " href="/p/builtins/*/api/builtins.float.html">a</a><span class="">,</span><span class=""> </span><span class="mi">7</span><span class="">,</span><span class=""> </span><span class="mi">5</span><span class="">,</span><span class=""> </span><span class="mf">0.1</span><span class="">)</span>
</pre>
            
         See :
    

    <h3 id='section-backrefs'>Back References</h3>
    <p>The following pages refer to to this document either explicitly or contain code examples using this.</p>

        <code><a link href="/p/skimage/0.17.2/api/skimage.restoration.non_local_means.denoise_nl_means.html" class='exists'>skimage.restoration.non_local_means.denoise_nl_means</a></code>

<h3>Local connectivity graph</h3>
<p>Hover to see nodes names; edges to Self not shown, Caped at 50 nodes.</p>

<p> Using a canvas is more power efficient and can get hundred of nodes ; but does not allow hyperlinks; , arrows
or text (beyond on hover) </p> 
<canvas class='graph' width="800" height="500"></canvas>
<p> SVG is more flexible but power hungry; and does not scale well to 50 + nodes. </p> 

<svg class='graph' width="600" height="500"></svg>

<p>All aboves nodes referred to, (or are referred from) current nodes; Edges from Self to other have been omitted
(or all nodes would be connected to the central node "self" which is not useful). Nodes are colored by the library
they belong to, and scaled with the number of references pointing them</p>

<hr>

    File: /skimage/restoration/non_local_means.py#11
<br/>

type: &lt;class &#39;function&#39;&gt; <br/>
Commit: <br/>

        <script src="https://d3js.org/d3.v4.min.js"></script>
    <script src="https://d3js.org/d3-selection-multi.v1.js"></script>
    <style type="text/css">
        .node {};
        .link { stroke: #999; stroke-opacity: .6; stroke-width: 1px; };
    </style>
<script>
    window._data_graph = {"nodes": [{"id": 1, "val": 18.0, "label": "numpy.random", "mod": "numpy", "url": "/p/numpy/*/api/numpy.random"}, {"id": 2, "val": 12.582575694955839, "label": "skimage.util.dtype.img_as_float", "mod": "skimage", "url": "/p/skimage/0.17.2/api/skimage.util.dtype.img_as_float"}, {"id": 3, "val": 12.0, "label": "numpy.pad", "mod": "numpy", "url": "/p/numpy/1.22.3/api/numpy.pad"}, {"id": 5, "val": 42.02939905434711, "label": "numpy", "mod": "numpy", "url": "/p/numpy/1.22.3/api/numpy"}, {"id": 6, "val": 14.782329983125269, "label": "numpy.ndarray.shape", "mod": "numpy", "url": "/p/numpy/*/api/numpy.ndarray.shape"}, {"id": 7, "val": 12.79583152331272, "label": "builtins.RandomState.randn", "mod": "builtins", "url": "/p/builtins/*/api/builtins.RandomState.randn"}, {"id": 8, "val": 18.862780491200215, "label": "numpy.zeros", "mod": "numpy", "url": "/p/numpy/1.22.3/api/numpy.zeros"}, {"id": 9, "val": 35.49545416973504, "label": "numpy.ndarray", "mod": "numpy", "url": "/p/numpy/1.22.3/api/numpy.ndarray"}, {"id": 10, "val": 27.05255888325765, "label": "builtins.float", "mod": "builtins", "url": "/p/builtins/*/api/builtins.float"}], "links": [{"source": 9, "target": 3, "id": 475}, {"source": 5, "target": 9, "id": 1034}, {"source": 5, "target": 3, "id": 1472}, {"source": 5, "target": 8, "id": 1777}, {"source": 8, "target": 9, "id": 2050}, {"source": 10, "target": 9, "id": 2148}]};
</script>
<script type="text/javascript" src='/graph_canvas.js'></script>
<script type="text/javascript" src='/graph_svg.js'></script>


</div>
</body>
</html>