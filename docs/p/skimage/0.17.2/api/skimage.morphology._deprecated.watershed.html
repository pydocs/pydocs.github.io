<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <link rel="icon" href="/favicon.ico" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
    <link rel="stylesheet"
          href="https://use.fontawesome.com/releases/v5.8.1/css/all.css"
          integrity="sha384-50oBUHEmvpQ+1lW4y57PTFmhCaXp0ML5d60M1M7uH2+nqUivzIebhndOJK28anvf"
          crossorigin="anonymous">
    
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@exampledev/new.css@1.1.2/new.min.css">
    <script type="text/x-mathjax-config">
      // this should process only math inside  span with tex2jax_process class
      MathJax.Hub.Config({
          extensions: ["tex2jax.js"],
          jax: ["input/TeX", "output/HTML-CSS"],
          tex2jax: {
          inlineMath: [ ['$','$'], ["\\(","\\)"] ],
          displayMath: [ ['$$','$$'], ["\\[","\\]"] ],
          processEscapes: true
          },
          "HTML-CSS": { fonts: ["TeX"] }
      });
    </script>
    <script async
        src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/MathJax.js">
    </script>
    <link rel="stylesheet" href="/papyri.css">
    <link rel="stylesheet" href="/pygments.css">
<style>

    header > brand {
        /*border-right: 1px solid #ccc;
          border-left: 1px solid #ccc;*/
        margin-left: 15px;
        padding: 0px;
        display: inline-block; 
        width: 67px;
    }

    brand > a {
        text-decoration: None;

    }
    brand >a> img {
            display: inline-block;
    margin: 0;
    padding: 0;
    position: relative;
    bottom: -10px;

   }
    .container {
       max-width: 800px;
       padding-left: 210px;
       padding-top: 30px;
    }
</style>
</head><body class="tex2jax_ignore">
    <header>
        <brand><a href='/'><img src='/favicon.ico'/></a></brand>
        <nav> / <a href='/' >p</a>  &nbsp;/&nbsp; 
                <div class="dropdown">
                <a href=skimage>skimage</a>&nbsp;/&nbsp;
                    <div class="dropdown-content">
<a href="/p/IPython/8.2.0/api/IPython.html">IPython</a>
<a href="/p/astropy/5.0/api/astropy.html">astropy</a>
<a href="/p/dask/2021.10.0/api/dask.html">dask</a>
<a href="/p/distributed/2021.10.0/api/distributed.html">distributed</a>
<a href="/p/matplotlib/3.5.1/api/matplotlib.html">matplotlib</a>
<a href="/p/networkx/2.7.2rc1.dev0/api/networkx.html">networkx</a>
<a href="/p/numpy/1.22.3/api/numpy.html">numpy</a>
<a href="/p/pandas/1.4.1/api/pandas.html">pandas</a>
<a href="/p/papyri/0.0.8/api/papyri.html">papyri</a>
<a href="/p/scipy/1.8.0/api/scipy.html">scipy</a>
<a href="/p/skimage/0.17.2/api/skimage.html">skimage</a>
                     </div>
                </div>
                <div class="dropdown">
                <a href='/p/skimage/0.17.2/api/skimage.html'>0.17.2</a>&nbsp;/&nbsp;
                    <div class="dropdown-content">
<a href="/p/skimage/0.17.2/api/skimage.html">0.17.2</a>
                    </div>
                </div>

                <div class="dropdown">
                    <a href='/p/skimage/0.17.2/api/skimage.html'>API</a>&nbsp;/&nbsp;
                    <div class="dropdown-content">
                        <a href="/p/skimage/0.17.2/api/skimage.html">API</a>
                        <a href="/p/skimage/0.17.2/gallery">Gallery</a>
                        <a href="/p/skimage/0.17.2/examples">Examples</a>
                        <a href="/p/skimage/0.17.2/docs">Narrative</a>
                     </div>
                </div>

                    <div class="dropdown">
                            <a class="dropbtn" href='skimage.html'>skimage</a>.                    </div><!--end dropdown-->
                    <div class="dropdown">
                            <a class="dropbtn" href='skimage.morphology.html'>morphology</a>.                            <div class="dropdown-content">
<a href="/p/skimage/0.17.2/api/skimage._raise_build_error.html">_raise_build_error</a>
<a href="/p/skimage/0.17.2/api/skimage._shared.html">_shared</a>
<a href="/p/skimage/0.17.2/api/skimage.color.html">color</a>
<a href="/p/skimage/0.17.2/api/skimage.data.html">data</a>
<a href="/p/skimage/0.17.2/api/skimage.draw.html">draw</a>
<a href="/p/skimage/0.17.2/api/skimage.exposure.html">exposure</a>
<a href="/p/skimage/0.17.2/api/skimage.feature.html">feature</a>
<a href="/p/skimage/0.17.2/api/skimage.filters.html">filters</a>
<a href="/p/skimage/0.17.2/api/skimage.graph.html">graph</a>
<a href="/p/skimage/0.17.2/api/skimage.io.html">io</a>
<a href="/p/skimage/0.17.2/api/skimage.measure.html">measure</a>
<a href="/p/skimage/0.17.2/api/skimage.metrics.html">metrics</a>
<a href="/p/skimage/0.17.2/api/skimage.morphology.html">morphology</a>
<a href="/p/skimage/0.17.2/api/skimage.restoration.html">restoration</a>
<a href="/p/skimage/0.17.2/api/skimage.segmentation.html">segmentation</a>
<a href="/p/skimage/0.17.2/api/skimage.transform.html">transform</a>
<a href="/p/skimage/0.17.2/api/skimage.util.html">util</a>
<a href="/p/skimage/0.17.2/api/skimage.viewer.html">viewer</a>
                            </div>
                    </div><!--end dropdown-->
                    <div class="dropdown">
                            <a class="dropbtn" href='skimage.morphology._deprecated.html'>_deprecated</a>.                            <div class="dropdown-content">
<a href="/p/skimage/0.17.2/api/skimage.morphology._convex_hull.html">_convex_hull</a>
<a href="/p/skimage/0.17.2/api/skimage.morphology._deprecated.html">_deprecated</a>
<a href="/p/skimage/0.17.2/api/skimage.morphology._extrema_cy.html">_extrema_cy</a>
<a href="/p/skimage/0.17.2/api/skimage.morphology._flood_fill.html">_flood_fill</a>
<a href="/p/skimage/0.17.2/api/skimage.morphology._flood_fill_cy.html">_flood_fill_cy</a>
<a href="/p/skimage/0.17.2/api/skimage.morphology._max_tree.html">_max_tree</a>
<a href="/p/skimage/0.17.2/api/skimage.morphology._skeletonize.html">_skeletonize</a>
<a href="/p/skimage/0.17.2/api/skimage.morphology._skeletonize_cy.html">_skeletonize_cy</a>
<a href="/p/skimage/0.17.2/api/skimage.morphology._util.html">_util</a>
<a href="/p/skimage/0.17.2/api/skimage.morphology.binary.html">binary</a>
<a href="/p/skimage/0.17.2/api/skimage.morphology.convex_hull.html">convex_hull</a>
<a href="/p/skimage/0.17.2/api/skimage.morphology.extrema.html">extrema</a>
<a href="/p/skimage/0.17.2/api/skimage.morphology.grey.html">grey</a>
<a href="/p/skimage/0.17.2/api/skimage.morphology.greyreconstruct.html">greyreconstruct</a>
<a href="/p/?/?/?/skimage.morphology.max_tree.html.html">max_tree</a>
<a href="/p/skimage/0.17.2/api/skimage.morphology.misc.html">misc</a>
<a href="/p/skimage/0.17.2/api/skimage.morphology.selem.html">selem</a>
                            </div>
                    </div><!--end dropdown-->
                    <div class="dropdown">
                            <a class="dropbtn" href='skimage.morphology._deprecated.watershed.html'>watershed</a>                            <div class="dropdown-content">
<a href="/p/skimage/0.17.2/api/skimage.morphology._deprecated.watershed.html">watershed</a>
                            </div>
                    </div><!--end dropdown-->
</nav>
    </header>
<div class='container'>
    <div class="sidenav">
        <img src="/p/skimage/0.17.2/img/skimage-logo.png"/>
    <a href="#">skimage</a>
    <a href="#">0.17.2</a>
    <hr/>
    <hr/>
<a href="#section-Notes">Notes</a><a href="#section-Parameters">Parameters</a><a href="#section-Returns">Returns</a><a href="#section-backrefs">BackRef</a>
    </div><!--end sidenav-->







<code class='signature'>watershed(image, markers=None, connectivity=1, offset=None, mask=None, compactness=0, watershed_line=False)</code><!-- rendering Extended Summary -->
                       <p>Find watershed basins in <code><a href="#image" class='local'>image</a></code> flooded from given <code><a href="#markers" class='local'>markers</a></code>.</p>


<h3 id="section-Notes">Notes</h3>
<!-- rendering Notes -->
                       <p>This function implements a watershed algorithm   that apportions pixels into marked basins. The algorithm uses a priority queue to hold the pixels with the metric for the priority queue being pixel value, then the time of entry into the queue - this settles ties in favor of the closest marker. Some ideas taken from Soille, &#34;Automated Basin Delineation from Digital Elevation Models Using Mathematical Morphology&#34;, Signal Processing 20 (1990) 171-182 The most important insight in the paper is that entry time onto the queue solves two problems: a pixel should be assigned to the neighbor with the largest gradient or, if there is no gradient, pixels on a plateau should be split between markers on opposite sides. This implementation converts all arguments to specific, lowest common denominator types, then passes these to a C algorithm. Markers can be determined manually, or automatically using for example the local minima of the gradient of the image, or the local maxima of the distance function to the background for separating overlapping objects (see example).</p>


<h3 id="section-Parameters">Parameters</h3>
<dl>
<dt><a id="image">image</a> : ndarray (2-D, 3-D, ...) of integers</dt>
<dd>
<p>Data array where the lowest value points are labeled first.</p>

</dd>
<dt><a id="markers">markers</a> : int, or ndarray of int, same shape as `image`, optional</dt>
<dd>
<p>The desired number of markers, or an array marking the basins with the values to be assigned in the label matrix. Zero means not a marker. If         <code class='verbatim'>None</code>
 (no markers given), the local minima of the image are used as markers.</p>

</dd>
<dt><a id="connectivity">connectivity</a> : ndarray, optional</dt>
<dd>
<p>An array with the same number of dimensions as <code><a href="#image" class='local'>image</a></code> whose non-zero elements indicate neighbors for connection. Following the scipy convention, default is a one-connected array of the dimension of the image.</p>

</dd>
<dt><a id="offset">offset</a> : array_like of shape image.ndim, optional</dt>
<dd>
<p>offset of the connectivity (one offset per dimension)</p>

</dd>
<dt><a id="mask">mask</a> : ndarray of bools or 0s and 1s, optional</dt>
<dd>
<p>Array of same shape as <code><a href="#image" class='local'>image</a></code>. Only points at which mask == True will be labeled.</p>

</dd>
<dt><a id="compactness">compactness</a> : float, optional</dt>
<dd>
<p>Use compact watershed  with given compactness parameter. Higher values result in more regularly-shaped watershed basins.</p>

</dd>
<dt><a id="watershed_line">watershed_line</a> : bool, optional</dt>
<dd>
<p>If watershed_line is True, a one-pixel wide line separates the regions obtained by the watershed algorithm. The line has the label 0.</p>

</dd>
</dl>

<h3 id="section-Returns">Returns</h3>
<dl>
<dt>out: ndarray</dt>
<dd>
<p>A labeled matrix of the same type and shape as markers</p>

</dd>
</dl>

<!-- rendering Summary -->
                       <p><strong>Deprecated function</strong>. Use         <code class='verbatim'>skimage.segmentation.watershed</code>
 instead.</p>


<h3 id="section-Examples">Examples</h3>
                <p>The watershed algorithm is useful to separate overlapping objects.</p>

            
                <p>We first generate an initial image with two overlapping circles:</p>

            
<span class='note'>This example is valid syntax, but we were not able to check execution</span><pre class='highlight compiled'><span class='nsl'>&gt;&gt;&gt; </span><span class="kn">import</span><span class=""> </span><a class="foo nn" href="/p/numpy/1.22.3/api/numpy.html">numpy</a><span class=""> </span><span class="k">as</span><span class=""> </span><a class="foo nn" href="/p/numpy/1.22.3/api/numpy.html">np</a><br><span class='nsl'>...&nbsp;</span><span class="">x</span><span class="">,</span><span class=""> </span><span class="">y</span><span class=""> </span><span class="o">=</span><span class=""> </span><a class="foo " href="/p/numpy/1.22.3/api/numpy.html">np</a><span class="o">.</span><span class="">indices</span><span class="">(</span><span class="">(</span><span class="mi">80</span><span class="">,</span><span class=""> </span><span class="mi">80</span><span class="">)</span><span class="">)</span><br><span class='nsl'>...&nbsp;</span><span class="">x1</span><span class="">,</span><span class=""> </span><span class="">y1</span><span class="">,</span><span class=""> </span><a class="foo " href="/p/skimage/0.17.2/api/skimage.feature.corner._image_orthogonal_matrix22_eigvals.html">x2</a><span class="">,</span><span class=""> </span><span class="">y2</span><span class=""> </span><span class="o">=</span><span class=""> </span><span class="mi">28</span><span class="">,</span><span class=""> </span><span class="mi">28</span><span class="">,</span><span class=""> </span><span class="mi">44</span><span class="">,</span><span class=""> </span><span class="mi">52</span><br><span class='nsl'>...&nbsp;</span><span class="">r1</span><span class="">,</span><span class=""> </span><span class="">r2</span><span class=""> </span><span class="o">=</span><span class=""> </span><span class="mi">16</span><span class="">,</span><span class=""> </span><a class="foo mi" href="/p/skimage/0.17.2/api/skimage.color.delta_e.deltaE_ciede2000.html">20</a><br><span class='nsl'>...&nbsp;</span><span class="">mask_circle1</span><span class=""> </span><span class="o">=</span><span class=""> </span><span class="">(</span><span class="">x</span><span class=""> </span><span class="o">-</span><span class=""> </span><span class="">x1</span><span class="">)</span><span class="o">*</span><span class="o">*</span><span class="mi">2</span><span class=""> </span><span class="o">+</span><span class=""> </span><span class="">(</span><span class="">y</span><span class=""> </span><span class="o">-</span><span class=""> </span><span class="">y1</span><span class="">)</span><span class="o">*</span><span class="o">*</span><span class="mi">2</span><span class=""> </span><a class="foo o" href="/p/skimage/0.17.2/api/skimage.io.collection.imread_collection_wrapper.&lt;locals&gt;.imread_collection.html">&lt;</a><span class=""> </span><span class="">r1</span><span class="o">*</span><span class="o">*</span><span class="mi">2</span><br><span class='nsl'>...&nbsp;</span><span class="">mask_circle2</span><span class=""> </span><span class="o">=</span><span class=""> </span><span class="">(</span><span class="">x</span><span class=""> </span><span class="o">-</span><span class=""> </span><a class="foo " href="/p/skimage/0.17.2/api/skimage.feature.corner._image_orthogonal_matrix22_eigvals.html">x2</a><span class="">)</span><span class="o">*</span><span class="o">*</span><span class="mi">2</span><span class=""> </span><span class="o">+</span><span class=""> </span><span class="">(</span><span class="">y</span><span class=""> </span><span class="o">-</span><span class=""> </span><span class="">y2</span><span class="">)</span><span class="o">*</span><span class="o">*</span><span class="mi">2</span><span class=""> </span><a class="foo o" href="/p/skimage/0.17.2/api/skimage.io.collection.imread_collection_wrapper.&lt;locals&gt;.imread_collection.html">&lt;</a><span class=""> </span><span class="">r2</span><span class="o">*</span><span class="o">*</span><span class="mi">2</span><br><span class='nsl'>...&nbsp;</span><span class="">image</span><span class=""> </span><span class="o">=</span><span class=""> </span><a class="foo " href="/p/numpy/1.22.3/api/numpy.html">np</a><span class="o">.</span><a class="foo " href="/p/numpy/1.22.3/api/numpy.ufunc.html">logical_or</a><span class="">(</span><span class="">mask_circle1</span><span class="">,</span><span class=""> </span><span class="">mask_circle2</span><span class="">)</span>
</pre>
            
                <p>Next, we want to separate the two circles. We generate markers at the maxima of the distance to the background:</p>

            
<span class='note'>This example is valid syntax, but we were not able to check execution</span><pre class='highlight compiled'><span class='nsl'>&gt;&gt;&gt; </span><span class="kn">from</span><span class=""> </span><a class="foo nn" href="/p/scipy/1.8.0/api/scipy.html">scipy</a><span class=""> </span><span class="kn">import</span><span class=""> </span><a class="foo " href="/p/skimage/0.17.2/api/skimage.transform._geometric._to_ndimage_mode.html">ndimage</a><span class=""> </span><span class="k">as</span><span class=""> </span><span class="">ndi</span><br><span class='nsl'>...&nbsp;</span><span class="">distance</span><span class=""> </span><span class="o">=</span><span class=""> </span><span class="">ndi</span><span class="o">.</span><span class="">distance_transform_edt</span><span class="">(</span><span class="">image</span><span class="">)</span><br><span class='nsl'>...&nbsp;</span><span class="kn">from</span><span class=""> </span><a class="foo nn" href="/p/skimage/0.17.2/api/skimage.html">skimage</a><span class="nn">.</span><a class="foo nn" href="/p/skimage/0.17.2/api/skimage.feature.html">feature</a><span class=""> </span><span class="kn">import</span><span class=""> </span><span class="">peak_local_max</span><br><span class='nsl'>...&nbsp;</span><span class="">local_maxi</span><span class=""> </span><span class="o">=</span><span class=""> </span><span class="">peak_local_max</span><span class="">(</span><span class="">distance</span><span class="">,</span><span class=""> </span><span class="">labels</span><span class="o">=</span><span class="">image</span><span class="">,</span><br><span class='nsl'>...&nbsp;</span><span class="">                            </span><span class="">footprint</span><span class="o">=</span><a class="foo " href="/p/numpy/1.22.3/api/numpy.html">np</a><span class="o">.</span><span class="">ones</span><span class="">(</span><span class="">(</span><span class="mi">3</span><span class="">,</span><span class=""> </span><span class="mi">3</span><span class="">)</span><span class="">)</span><span class="">,</span><br><span class='nsl'>...&nbsp;</span><span class="">                            </span><span class="">indices</span><span class="o">=</span><span class="kc">False</span><span class="">)</span><br><span class='nsl'>...&nbsp;</span><span class="">markers</span><span class=""> </span><span class="o">=</span><span class=""> </span><span class="">ndi</span><span class="o">.</span><a class="foo " href="/p/skimage/0.17.2/api/skimage.measure._label.label.html">label</a><span class="">(</span><span class="">local_maxi</span><span class="">)</span><span class="">[</span><a class="foo mi" href="/p/skimage/0.17.2/api/skimage.color.delta_e.deltaE_ciede2000.html">0</a><span class="">]</span>
</pre>
            
                <p>Finally, we run the watershed on the image and markers:</p>

            
<span class='note'>This example is valid syntax, but we were not able to check execution</span><pre class='highlight compiled'><span class='nsl'>&gt;&gt;&gt; </span><span class="">labels</span><span class=""> </span><span class="o">=</span><span class=""> </span><a class="foo " href="/p/skimage/0.17.2/api/skimage.morphology._deprecated.watershed.html">watershed</a><span class="">(</span><span class="o">-</span><span class="">distance</span><span class="">,</span><span class=""> </span><span class="">markers</span><span class="">,</span><span class=""> </span><span class="">mask</span><span class="o">=</span><span class="">image</span><span class="">)</span><span class="">  </span><span class="c1"># doctest: +SKIP</span>
</pre>
            
                <p>The algorithm works also for 3-D images, and can be used for example to separate overlapping spheres.</p>

            
         See :
    

    <h3 id='section-backrefs'>Back References</h3>
    <p>The following pages refer to to this document either explicitly or contain code examples using this.</p>

        <code><a link href="/p/skimage/0.17.2/api/skimage.morphology._deprecated.watershed.html" class='exists'>skimage.morphology._deprecated.watershed</a></code>

<h3>Local connectivity graph</h3>
<p>Hover to see nodes names; edges to Self not shown, Caped at 50 nodes.</p>

<p> Using a canvas is more power efficient and can get hundred of nodes ; but does not allow hyperlinks; , arrows
or text (beyond on hover) </p> 
<canvas class='graph' width="800" height="500"></canvas>
<p> SVG is more flexible but power hungry; and does not scale well to 50 + nodes. </p> 

<svg class='graph' width="600" height="500"></svg>

<p>All aboves nodes referred to, (or are referred from) current nodes; Edges from Self to other have been omitted
(or all nodes would be connected to the central node "self" which is not useful). Nodes are colored by the library
they belong to, and scaled with the number of references pointing them</p>

<hr>

    File: /skimage/morphology/_deprecated.py#4
<br/>

type: &lt;class &#39;function&#39;&gt; <br/>
Commit: <br/>

        <script src="https://d3js.org/d3.v4.min.js"></script>
    <script src="https://d3js.org/d3-selection-multi.v1.js"></script>
    <style type="text/css">
        .node {};
        .link { stroke: #999; stroke-opacity: .6; stroke-width: 1px; };
    </style>
<script>
    window._data_graph = {"nodes": [{"id": 1, "val": 13.099019513592784, "label": "skimage.feature", "mod": "skimage", "url": "/p/skimage/0.17.2/api/skimage.feature"}, {"id": 2, "val": 9.732050807568877, "label": "skimage.feature.corner._image_orthogonal_matrix22_eigvals", "mod": "skimage", "url": "/p/skimage/0.17.2/api/skimage.feature.corner._image_orthogonal_matrix22_eigvals"}, {"id": 3, "val": 18.0, "label": "skimage.color.delta_e.deltaE_ciede2000", "mod": "skimage", "url": "/p/skimage/0.17.2/api/skimage.color.delta_e.deltaE_ciede2000"}, {"id": 4, "val": 10.64575131106459, "label": "skimage.measure._label.label", "mod": "skimage", "url": "/p/skimage/0.17.2/api/skimage.measure._label.label"}, {"id": 5, "val": 10.449489742783179, "label": "skimage.transform._geometric._to_ndimage_mode", "mod": "skimage", "url": "/p/skimage/0.17.2/api/skimage.transform._geometric._to_ndimage_mode"}, {"id": 6, "val": 45.57658845611187, "label": "numpy", "mod": "numpy", "url": "/p/numpy/1.22.3/api/numpy"}, {"id": 8, "val": 20.688577540449522, "label": "numpy.ufunc", "mod": "numpy", "url": "/p/numpy/1.22.3/api/numpy.ufunc"}, {"id": 9, "val": 20.96148139681572, "label": "skimage", "mod": "skimage", "url": "/p/skimage/0.17.2/api/skimage"}, {"id": 10, "val": 12.898979485566356, "label": "skimage.io.collection.imread_collection_wrapper.<locals>.imread_collection", "mod": "skimage", "url": "/p/skimage/0.17.2/api/skimage.io.collection.imread_collection_wrapper.<locals>.imread_collection"}, {"id": 11, "val": 32.331050121192874, "label": "scipy", "mod": "scipy", "url": "/p/scipy/1.8.0/api/scipy"}], "links": [{"source": 6, "target": 4, "id": 156}, {"source": 3, "target": 4, "id": 1487}]};
</script>
<script type="text/javascript" src='/graph_canvas.js'></script>
<script type="text/javascript" src='/graph_svg.js'></script>


</div>
</body>
</html>