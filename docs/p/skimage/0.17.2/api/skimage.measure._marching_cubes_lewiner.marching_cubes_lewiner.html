<!doctypehtml><html lang=en><meta charset=UTF-8><meta content=width=device-width,initial-scale=1.0 name=viewport><title>Document</title><link href=https://fonts.xz.style/serve/inter.css rel=stylesheet><link crossorigin=anonymous href=https://use.fontawesome.com/releases/v5.8.1/css/all.css integrity=sha384-50oBUHEmvpQ+1lW4y57PTFmhCaXp0ML5d60M1M7uH2+nqUivzIebhndOJK28anvf rel=stylesheet><link href=https://cdn.jsdelivr.net/npm/@exampledev/new.css@1.1.2/new.min.css rel=stylesheet><script type=text/x-mathjax-config>
        // this should process only math inside  span with tex2jax_process class
    MathJax.Hub.Config({
        extensions: ["tex2jax.js"],
        jax: ["input/TeX", "output/HTML-CSS"],
        tex2jax: {
        inlineMath: [ ['$','$'], ["\\(","\\)"] ],
        displayMath: [ ['$$','$$'], ["\\[","\\]"] ],
        processEscapes: true
        },
        "HTML-CSS": { fonts: ["TeX"] }
    });
    </script><script async src=https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/MathJax.js></script><link href=/papyri.css rel=stylesheet><style>header > brand, header>:first-child {
        border-right: 1px solid #ccc;
        border-left: 1px solid #ccc;
        padding: 16px;
        padding-top: 0.5rem;
        padding-bottom: 0.5rem;
        display: inline-block; 
        width: 167px;
    }
    pre { line-height: 125%; }
td.linenos .normal { color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px; }
span.linenos { color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px; }
td.linenos .special { color: #000000; background-color: #ffffc0; padding-left: 5px; padding-right: 5px; }
span.linenos.special { color: #000000; background-color: #ffffc0; padding-left: 5px; padding-right: 5px; }
.highlight .hll { background-color: #ffffcc }
.highlight { background: #ffffff; }
.highlight .c { color: #888888 } /* Comment */
.highlight .err { color: #a61717; background-color: #e3d2d2 } /* Error */
.highlight .k { color: #008800; font-weight: bold } /* Keyword */
.highlight .ch { color: #888888 } /* Comment.Hashbang */
.highlight .cm { color: #888888 } /* Comment.Multiline */
.highlight .cp { color: #cc0000; font-weight: bold } /* Comment.Preproc */
.highlight .cpf { color: #888888 } /* Comment.PreprocFile */
.highlight .c1 { color: #888888 } /* Comment.Single */
.highlight .cs { color: #cc0000; font-weight: bold; background-color: #fff0f0 } /* Comment.Special */
.highlight .gd { color: #000000; background-color: #ffdddd } /* Generic.Deleted */
.highlight .ge { font-style: italic } /* Generic.Emph */
.highlight .gr { color: #aa0000 } /* Generic.Error */
.highlight .gh { color: #333333 } /* Generic.Heading */
.highlight .gi { color: #000000; background-color: #ddffdd } /* Generic.Inserted */
.highlight .go { color: #888888 } /* Generic.Output */
.highlight .gp { color: #555555 } /* Generic.Prompt */
.highlight .gs { font-weight: bold } /* Generic.Strong */
.highlight .gu { color: #666666 } /* Generic.Subheading */
.highlight .gt { color: #aa0000 } /* Generic.Traceback */
.highlight .kc { color: #008800; font-weight: bold } /* Keyword.Constant */
.highlight .kd { color: #008800; font-weight: bold } /* Keyword.Declaration */
.highlight .kn { color: #008800; font-weight: bold } /* Keyword.Namespace */
.highlight .kp { color: #008800 } /* Keyword.Pseudo */
.highlight .kr { color: #008800; font-weight: bold } /* Keyword.Reserved */
.highlight .kt { color: #888888; font-weight: bold } /* Keyword.Type */
.highlight .m { color: #0000DD; font-weight: bold } /* Literal.Number */
.highlight .s { color: #dd2200; background-color: #fff0f0 } /* Literal.String */
.highlight .na { color: #336699 } /* Name.Attribute */
.highlight .nb { color: #003388 } /* Name.Builtin */
.highlight .nc { color: #bb0066; font-weight: bold } /* Name.Class */
.highlight .no { color: #003366; font-weight: bold } /* Name.Constant */
.highlight .nd { color: #555555 } /* Name.Decorator */
.highlight .ne { color: #bb0066; font-weight: bold } /* Name.Exception */
.highlight .nf { color: #0066bb; font-weight: bold } /* Name.Function */
.highlight .nl { color: #336699; font-style: italic } /* Name.Label */
.highlight .nn { color: #bb0066; font-weight: bold } /* Name.Namespace */
.highlight .py { color: #336699; font-weight: bold } /* Name.Property */
.highlight .nt { color: #bb0066; font-weight: bold } /* Name.Tag */
.highlight .nv { color: #336699 } /* Name.Variable */
.highlight .ow { color: #008800 } /* Operator.Word */
.highlight .w { color: #bbbbbb } /* Text.Whitespace */
.highlight .mb { color: #0000DD; font-weight: bold } /* Literal.Number.Bin */
.highlight .mf { color: #0000DD; font-weight: bold } /* Literal.Number.Float */
.highlight .mh { color: #0000DD; font-weight: bold } /* Literal.Number.Hex */
.highlight .mi { color: #0000DD; font-weight: bold } /* Literal.Number.Integer */
.highlight .mo { color: #0000DD; font-weight: bold } /* Literal.Number.Oct */
.highlight .sa { color: #dd2200; background-color: #fff0f0 } /* Literal.String.Affix */
.highlight .sb { color: #dd2200; background-color: #fff0f0 } /* Literal.String.Backtick */
.highlight .sc { color: #dd2200; background-color: #fff0f0 } /* Literal.String.Char */
.highlight .dl { color: #dd2200; background-color: #fff0f0 } /* Literal.String.Delimiter */
.highlight .sd { color: #dd2200; background-color: #fff0f0 } /* Literal.String.Doc */
.highlight .s2 { color: #dd2200; background-color: #fff0f0 } /* Literal.String.Double */
.highlight .se { color: #0044dd; background-color: #fff0f0 } /* Literal.String.Escape */
.highlight .sh { color: #dd2200; background-color: #fff0f0 } /* Literal.String.Heredoc */
.highlight .si { color: #3333bb; background-color: #fff0f0 } /* Literal.String.Interpol */
.highlight .sx { color: #22bb22; background-color: #f0fff0 } /* Literal.String.Other */
.highlight .sr { color: #008800; background-color: #fff0ff } /* Literal.String.Regex */
.highlight .s1 { color: #dd2200; background-color: #fff0f0 } /* Literal.String.Single */
.highlight .ss { color: #aa6600; background-color: #fff0f0 } /* Literal.String.Symbol */
.highlight .bp { color: #003388 } /* Name.Builtin.Pseudo */
.highlight .fm { color: #0066bb; font-weight: bold } /* Name.Function.Magic */
.highlight .vc { color: #336699 } /* Name.Variable.Class */
.highlight .vg { color: #dd7700 } /* Name.Variable.Global */
.highlight .vi { color: #3333bb } /* Name.Variable.Instance */
.highlight .vm { color: #336699 } /* Name.Variable.Magic */
.highlight .il { color: #0000DD; font-weight: bold } /* Literal.Number.Integer.Long */</style></head><body class=tex2jax_ignore><header><brand><i class="fab fa-python"></i><a href=/>Home</a></brand><nav>/ <a href=/>p</a>  /  <div class=dropdown><a href=skimage>skimage</a> /  <div class=dropdown-content><a href=/p/IPython/8.2.0.dev/api/IPython.html>IPython</a><a href=/p/astropy/5.0/api/astropy.html>astropy</a><a href=/p/dask/2021.10.0/api/dask.html>dask</a><a href=/p/distributed/2021.10.0/api/distributed.html>distributed</a><a href=/p/matplotlib/3.5.1/api/matplotlib.html>matplotlib</a><a href=/p/networkx/2.7.2rc1.dev0/api/networkx.html>networkx</a><a href=/p/numpy/1.22.3/api/numpy.html>numpy</a><a href=/p/pandas/1.4.1/api/pandas.html>pandas</a><a href=/p/papyri/0.0.8/api/papyri.html>papyri</a><a href=/p/scipy/1.8.0/api/scipy.html>scipy</a><a href=/p/skimage/0.17.2/api/skimage.html>skimage</a></div></div><div class=dropdown><a href=/p/skimage/0.17.2/api/skimage.html>0.17.2</a> /  <div class=dropdown-content><a href=/p/skimage/0.17.2/api/skimage.html>0.17.2</a></div></div><div class=dropdown><a href=/p/skimage/0.17.2/api/skimage.html>api</a> /  <div class=dropdown-content><a href=/p/skimage/0.17.2/api/skimage.html>API</a><a href=/p/skimage/0.17.2/gallery>Gallery</a><a href=/p/skimage/0.17.2/examples>Examples</a></div></div><div class=dropdown><a class=dropbtn href=skimage.html>skimage</a>.</div><div class=dropdown><a class=dropbtn href=skimage.measure.html>measure</a>. <div class=dropdown-content><a href=/p/skimage/0.17.2/api/skimage._raise_build_error.html>_raise_build_error</a><a href=/p/skimage/0.17.2/api/skimage._shared.html>_shared</a><a href=/p/skimage/0.17.2/api/skimage.color.html>color</a><a href=/p/skimage/0.17.2/api/skimage.data.html>data</a><a href=/p/skimage/0.17.2/api/skimage.draw.html>draw</a><a href=/p/skimage/0.17.2/api/skimage.exposure.html>exposure</a><a href=/p/skimage/0.17.2/api/skimage.feature.html>feature</a><a href=/p/skimage/0.17.2/api/skimage.filters.html>filters</a><a href=/p/skimage/0.17.2/api/skimage.graph.html>graph</a><a href=/p/skimage/0.17.2/api/skimage.io.html>io</a><a href=/p/skimage/0.17.2/api/skimage.measure.html>measure</a><a href=/p/skimage/0.17.2/api/skimage.metrics.html>metrics</a><a href=/p/skimage/0.17.2/api/skimage.morphology.html>morphology</a><a href=/p/skimage/0.17.2/api/skimage.restoration.html>restoration</a><a href=/p/skimage/0.17.2/api/skimage.segmentation.html>segmentation</a><a href=/p/skimage/0.17.2/api/skimage.transform.html>transform</a><a href=/p/skimage/0.17.2/api/skimage.util.html>util</a><a href=/p/skimage/0.17.2/api/skimage.viewer.html>viewer</a></div></div><div class=dropdown><a class=dropbtn href=skimage.measure._marching_cubes_lewiner.html>_marching_cubes_lewiner</a>. <div class=dropdown-content><a href=/p/skimage/0.17.2/api/skimage.measure._ccomp.html>_ccomp</a><a href=/p/skimage/0.17.2/api/skimage.measure._find_contours.html>_find_contours</a><a href=/p/skimage/0.17.2/api/skimage.measure._find_contours_cy.html>_find_contours_cy</a><a href=/p/skimage/0.17.2/api/skimage.measure._label.html>_label</a><a href=/p/skimage/0.17.2/api/skimage.measure._marching_cubes_classic.html>_marching_cubes_classic</a><a href=/p/skimage/0.17.2/api/skimage.measure._marching_cubes_classic_cy.html>_marching_cubes_classic_cy</a><a href=/p/skimage/0.17.2/api/skimage.measure._marching_cubes_lewiner.html>_marching_cubes_lewiner</a><a href=/p/skimage/0.17.2/api/skimage.measure._marching_cubes_lewiner_cy.html>_marching_cubes_lewiner_cy</a><a href=/p/skimage/0.17.2/api/skimage.measure._marching_cubes_lewiner_luts.html>_marching_cubes_lewiner_luts</a><a href=/p/skimage/0.17.2/api/skimage.measure._moments.html>_moments</a><a href=/p/skimage/0.17.2/api/skimage.measure._moments_cy.html>_moments_cy</a><a href=/p/skimage/0.17.2/api/skimage.measure._pnpoly.html>_pnpoly</a><a href=/p/skimage/0.17.2/api/skimage.measure._polygon.html>_polygon</a><a href=/p/skimage/0.17.2/api/skimage.measure._regionprops.html>_regionprops</a><a href=/p/skimage/0.17.2/api/skimage.measure._structural_similarity.html>_structural_similarity</a><a href=/p/skimage/0.17.2/api/skimage.measure.block.html>block</a><a href=/p/skimage/0.17.2/api/skimage.measure.entropy.html>entropy</a><a href=/p/skimage/0.17.2/api/skimage.measure.fit.html>fit</a><a href=/p/skimage/0.17.2/api/skimage.measure.pnpoly.html>pnpoly</a><a href=/p/skimage/0.17.2/api/skimage.measure.profile.html>profile</a><a href=/p/skimage/0.17.2/api/skimage.measure.simple_metrics.html>simple_metrics</a></div></div><div class=dropdown><a class=dropbtn href=skimage.measure._marching_cubes_lewiner.marching_cubes_lewiner.html>marching_cubes_lewiner</a><div class=dropdown-content><a href=/p/skimage/0.17.2/api/skimage.measure._marching_cubes_lewiner._get_mc_luts.html>_get_mc_luts</a><a href=/p/skimage/0.17.2/api/skimage.measure._marching_cubes_lewiner._marching_cubes_lewiner.html>_marching_cubes_lewiner</a><a href=/p/skimage/0.17.2/api/skimage.measure._marching_cubes_lewiner._to_array.html>_to_array</a><a href=/p/skimage/0.17.2/api/skimage.measure._marching_cubes_lewiner.marching_cubes.html>marching_cubes</a><a href=/p/skimage/0.17.2/api/skimage.measure._marching_cubes_lewiner.marching_cubes_lewiner.html>marching_cubes_lewiner</a></div></div></nav></header><div class=container><div class=sidenav><img src=/p/skimage/0.17.2/img/logo.png><a href=#>skimage</a><a href=#>0.17.2</a><hr><hr><a href=#section-Notes>Notes</a><a href=#section-Parameters>Parameters</a><a href=#section-Returns>Returns</a></div><code class=signature>marching_cubes_lewiner(volume, level=None, spacing=(1.0, 1.0, 1.0), gradient_direction='descent', step_size=1, allow_degenerate=True, use_classic=False, mask=None)</code><p>In contrast to <code class=verbatim>marching_cubes_classic()</code> , this algorithm is faster, resolves ambiguities, and guarantees topologically correct results. Therefore, this algorithm generally a better choice, unless there is a specific need for the classic algorithm.</p><h3 id=section-Notes>Notes</h3><p>The algorithm [1] is an improved version of Chernyaev's Marching Cubes 33 algorithm. It is an efficient algorithm that relies on heavy use of lookup tables to handle the many different cases, keeping the algorithm relatively easy. This implementation is written in Cython, ported from Lewiner's C++ implementation.</p><p>To quantify the area of an isosurface generated by this algorithm, pass verts and faces to <code><a class=exists href=/p/skimage/*/api/skimage.measure._marching_cubes_classic.mesh_surface_area.html link>skimage.measure.mesh_surface_area</a></code> .</p><p>Regarding visualization of algorithm output, to contour a volume named <code>:None:None:`myvolume`</code> about the level 0.0, using the <code class=verbatim>mayavi</code> package::</p><pre>>>> from mayavi import mlab # doctest: +SKIP
>>> verts, faces, normals, values = marching_cubes_lewiner(myvolume, 0.0) # doctest: +SKIP
>>> mlab.triangular_mesh([vert[0] for vert in verts],
...                      [vert[1] for vert in verts],
...                      [vert[2] for vert in verts],
...                      faces) # doctest: +SKIP
>>> mlab.show() # doctest: +SKIP</pre><p>Similarly using the <code class=verbatim>visvis</code> package::</p><pre>>>> import visvis as vv # doctest: +SKIP
>>> verts, faces, normals, values = marching_cubes_lewiner(myvolume, 0.0) # doctest: +SKIP
>>> vv.mesh(np.fliplr(verts), faces, normals, values) # doctest: +SKIP
>>> vv.use().Run() # doctest: +SKIP</pre><h3 id=section-Parameters>Parameters</h3><dl><dt><a id=volume>volume</a> : (M, N, P) array</dt><dd><p>Input data volume to find isosurfaces. Will internally be converted to float32 if necessary.</p></dd><dt><a id=level>level</a> : float</dt><dd><p>Contour value to search for isosurfaces in <code><a class=local href=#volume link>volume</a></code>. If not given or None, the average of the min and max of vol is used.</p></dd><dt><a id=spacing>spacing</a> : length-3 tuple of floats</dt><dd><p>Voxel spacing in spatial dimensions corresponding to numpy array indexing dimensions (M, N, P) as in <code><a class=local href=#volume link>volume</a></code>.</p></dd><dt><a id=gradient_direction>gradient_direction</a> : string</dt><dd><p>Controls if the mesh was generated from an isosurface with gradient descent toward objects of interest (the default), or the opposite, considering the <em>left-hand</em> rule. The two options are: * descent : Object was greater than exterior * ascent : Exterior was greater than object</p></dd><dt><a id=step_size>step_size</a> : int</dt><dd><p>Step size in voxels. Default 1. Larger steps yield faster but coarser results. The result will always be topologically correct though.</p></dd><dt><a id=allow_degenerate>allow_degenerate</a> : bool</dt><dd><p>Whether to allow degenerate (i.e. zero-area) triangles in the end-result. Default True. If False, degenerate triangles are removed, at the cost of making the algorithm slower.</p></dd><dt><a id=use_classic>use_classic</a> : bool</dt><dd><p>If given and True, the classic marching cubes by Lorensen (1987) is used. This option is included for reference purposes. Note that this algorithm has ambiguities and is not guaranteed to produce a topologically correct result. The results with using this option are <em>not</em> generally the same as the <code class=verbatim>marching_cubes_classic()</code> function.</p></dd><dt><a id=mask>mask</a> : (M, N, P) array</dt><dd><p>Boolean array. The marching cube algorithm will be computed only on True elements. This will save computational time when interfaces are located within certain region of the volume M, N, P-e.g. the top half of the cube-and also allow to compute finite surfaces-i.e. open surfaces that do not end at the border of the cube.</p></dd></dl><h3 id=section-Returns>Returns</h3><dl><dt><a id=verts>verts</a> : (V, 3) array</dt><dd><p>Spatial coordinates for V unique mesh vertices. Coordinate order matches input <code><a class=local href=#volume link>volume</a></code> (M, N, P).</p></dd><dt><a id=faces>faces</a> : (F, 3) array</dt><dd><p>Define triangular faces via referencing vertex indices from <code class=verbatim>verts</code> . This algorithm specifically outputs triangles, so each face has exactly three indices.</p></dd><dt><a id=normals>normals</a> : (V, 3) array</dt><dd><p>The normal direction at each vertex, as calculated from the data.</p></dd><dt><a id=values>values</a> : (V, ) array</dt><dd><p>Gives a measure for the maximum value of the data in the local region near each vertex. This can be used by visualization tools to apply a colormap to the mesh.</p></dd></dl><p>Lewiner marching cubes algorithm to find surfaces in 3d volumetric data.</p><h3 id=section-Examples>Examples</h3> See : <h3>Local connectivity graph</h3><p>Hover to see nodes names; edges to Self not shown, Caped at 50 nodes.</p><p>Using a canvas is more power efficient and can get hundred of nodes ; but does not allow hyperlinks; , arrows or text (beyond on hover)</p><canvas class=graph height=500 width=800></canvas><p>SVG is more flexible but power hungry; and does not scale well to 50 + nodes.</p><svg class=graph height=500 width=600></svg><p>All aboves nodes referred to, (or are referred from) current nodes; Edges from Self to other have been omitted (or all nodes would be connected to the central node "self" which is not useful). Nodes are colored by the library they belong to, and scaled with the number of references pointing them</p><hr> File: /skimage/measure/_marching_cubes_lewiner.py#147 <br> type: &LTclass 'function'> <br> Commit: <br><script src=https://d3js.org/d3.v4.min.js></script><script src=https://d3js.org/d3-selection-multi.v1.js></script><style>.node {};
        .link { stroke: #999; stroke-opacity: .6; stroke-width: 1px; };</style><script>window._data_graph={nodes:[{id:1,val:9.732050807568877,label:"skimage.measure._marching_cubes_classic.mesh_surface_area",mod:"skimage",url:"/p/skimage/*/api/skimage.measure._marching_cubes_classic.mesh_surface_area"}],links:[]};</script><script src=/graph_canvas.js></script><script src=/graph_svg.js></script></div></body></html>