<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
    <link rel="stylesheet" href="https://fonts.xz.style/serve/inter.css">
	<link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.8.1/css/all.css" integrity="sha384-50oBUHEmvpQ+1lW4y57PTFmhCaXp0ML5d60M1M7uH2+nqUivzIebhndOJK28anvf" crossorigin="anonymous">
    
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@exampledev/new.css@1.1.2/new.min.css">
    <script type="text/x-mathjax-config">
        // this should process only math inside  span with tex2jax_process class
    MathJax.Hub.Config({
        extensions: ["tex2jax.js"],
        jax: ["input/TeX", "output/HTML-CSS"],
        tex2jax: {
        inlineMath: [ ['$','$'], ["\\(","\\)"] ],
        displayMath: [ ['$$','$$'], ["\\[","\\]"] ],
        processEscapes: true
        },
        "HTML-CSS": { fonts: ["TeX"] }
    });
    </script>
    <script type="text/javascript" async
        src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/MathJax.js">
    </script>
<style>
body{
    font-family: 'Roboto', 'Helvetica Neue', 'Helvetica', 'Arial', sans-serif;
    color: #606c76;
    font-weight: 350;
    line-height: 1.6;
    max-width: 1000px;
    margin-left:0;

}
          .graph{border: 1px gray solid;}
          .foo:hover{text-decoration:underline}
          .foo{font-weight:bold; color:#4e4e4e}
          .exists{font-weight:bold; color:#4e4e4e;text-decoration:none;}
          .local{font-weight:bold; color:#1e6f04;text-decoration:none;}
          .exists:hover{text-decoration:underline;color:black}
          .missing,.missing:hover{color:darkred;text-decoration:none;font-weight:normal}
          .signature {font-size:100%; margin-bottom: 2rem; display: block; border:none; background-color: #FFFFFF;
              font-weight:600;}
          h1, h2, h3 {color: #4e4e4e; font-weight:400;
              margin-bottom: 1rem;border-bottom: 1px solid var(--nc-bg-3);
          }
          pre{border-radius:0;
              padding:0.6rem;
          border-left: 3px solid #AAA}
          dt {font-weight: 400;}

          header{
              box-shadow: rgba(0, 0, 0, 0.24) 0px 3px 8px;
              
              padding-top:0rem;
              padding-bottom:0rem;
              z-index: 2;
              padding-left: 0;
              position: fixed;
              top: 30px;
              left:0; 
              width: 100%;
              height: 42px;
              backdrop-filter: blur(5px);
              background-color: rgba(255, 255, 255, .15);
          }
          dd::before {
            content: '';
          }
          header > brand, header>:first-child {
              border-right: 1px solid #ccc;
              border-left: 1px solid #ccc;
              padding: 16px;
              padding-top: 0.5rem;
              padding-bottom: 0.5rem;
              display: inline-block; 
              width: 167px;
              

          }
          brand > a {color:#606c76}
          brand > i {
              padding-right: 0.5rem;

        }
          nav{display:inline-block;
              padding: 10px;
              padding-left: 1rem;

          }

          dd {
              margin-left: 1rem;
              border-left:  solid #ddd;
              padding-left: 1rem;
          }
          summary > h2 { display: inline }

          .sidenav {
                height: 100%; /* Full-height: remove this if you want "auto" height */
                width: 200px; /* Set the width of the sidebar */
                position: fixed; /* Fixed Sidebar (stay in place on scroll) */
                z-index: 1; /* Stay on top */
                top: 0; /* Stay at the top */
                left: 0;
                background-color: var(--nc-bg-1);; /* Black */
                border-right: thin solid #ccc;
                overflow-x: hidden; /* Disable horizontal scroll */
                padding-top: 3rem;
 
                box-shadow: rgba(0, 0, 0, 0.24) 0px 3px 8px;
                
          }

          .sidenav a {
            padding: 6px 8px 6px 16px;
            text-decoration: none;
            color: #818181;
            display: block;
          }
          .sidenav img {
              width: 160px;
              padding-left:20px;
              padding-right:20px;
              border-bottom: solid thin #DDD; 
              padding-bottom: .5rem;
              max-width: 100%;
          }
          .sidenav i {
              font-size: 100;
              padding-left: 3.5rem;
              padding-right: 3.5rem;
              padding-bottom: .5rem;
              border-bottom: solid thin #DDD; 

          }
          .container {
              padding-left: 210px;
              
              padding-top: 30px;

          }

          ::selection {
	/* Set background color for selected text */
                background: #59b4fd;
                color: var(--nc-ac-tx);
          }

          img {max-width: 40%;}

          pre.highlight.execed, .admonition {
            border-left: 3px solid #0070f3;
          }
          .admonition {
            padding-left: 1em;
          }
          .admonition > div {
            background-color: rgba(0, 123, 255, 0.1);
            position: relative;
            margin: 0 -1rem;
            padding: 0.4rem 0.1rem 0.4rem 1.5rem;
            font-weight: bold;
            text-transform: capitalize;
        }
          .note {color: #7d77d2}
          .warning {color: #af7b1a}
          .error {color: #f44336}
          pre.highlight.compiled {
            border-left: 3px solid #7d77d2;
          }
          pre.highlight.syntax_error, pre.highlight.exception_in_exec {
            border-left: 3px solid #f44336;
          }

        /* Dropdown Button */
/* The container <div> - needed to position the dropdown content */
.dropdown {
  position: relative;
  display: inline-block;
  margin-left: -4px;
}

nav  a {
    color: #606c76;
    text-decoration: none;

}

/* Dropdown Content (Hidden by Default) */
.dropdown-content {
  display: none;
  position: absolute;
  background-color: #f1f1f1;
  min-width: 160px;
  box-shadow: 0px 8px 16px 0px rgba(0,0,0,0.2);
  z-index: 1;
}

/* Links inside the dropdown */
.dropdown-content a {
  color: black;
  padding: 12px 16px;
  text-decoration: none;
  display: block;
}

/* Change color of dropdown links on hover */
.dropdown-content a:hover {background-color: #ddd;}

/* Show the dropdown menu on hover */
.dropdown:hover .dropdown-content {display: block;
    max-height: 80vh;
    overflow: scroll;}

/* Change the background color of the dropdown button when the dropdown content is shown */
.dropdown:hover .dropbtn {}


pre { line-height: 125%; }
td.linenos .normal { color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px; }
span.linenos { color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px; }
td.linenos .special { color: #000000; background-color: #ffffc0; padding-left: 5px; padding-right: 5px; }
span.linenos.special { color: #000000; background-color: #ffffc0; padding-left: 5px; padding-right: 5px; }
.highlight .hll { background-color: #ffffcc }
.highlight { background: #ffffff; }
.highlight .c { color: #888888 } /* Comment */
.highlight .err { color: #a61717; background-color: #e3d2d2 } /* Error */
.highlight .k { color: #008800; font-weight: bold } /* Keyword */
.highlight .ch { color: #888888 } /* Comment.Hashbang */
.highlight .cm { color: #888888 } /* Comment.Multiline */
.highlight .cp { color: #cc0000; font-weight: bold } /* Comment.Preproc */
.highlight .cpf { color: #888888 } /* Comment.PreprocFile */
.highlight .c1 { color: #888888 } /* Comment.Single */
.highlight .cs { color: #cc0000; font-weight: bold; background-color: #fff0f0 } /* Comment.Special */
.highlight .gd { color: #000000; background-color: #ffdddd } /* Generic.Deleted */
.highlight .ge { font-style: italic } /* Generic.Emph */
.highlight .gr { color: #aa0000 } /* Generic.Error */
.highlight .gh { color: #333333 } /* Generic.Heading */
.highlight .gi { color: #000000; background-color: #ddffdd } /* Generic.Inserted */
.highlight .go { color: #888888 } /* Generic.Output */
.highlight .gp { color: #555555 } /* Generic.Prompt */
.highlight .gs { font-weight: bold } /* Generic.Strong */
.highlight .gu { color: #666666 } /* Generic.Subheading */
.highlight .gt { color: #aa0000 } /* Generic.Traceback */
.highlight .kc { color: #008800; font-weight: bold } /* Keyword.Constant */
.highlight .kd { color: #008800; font-weight: bold } /* Keyword.Declaration */
.highlight .kn { color: #008800; font-weight: bold } /* Keyword.Namespace */
.highlight .kp { color: #008800 } /* Keyword.Pseudo */
.highlight .kr { color: #008800; font-weight: bold } /* Keyword.Reserved */
.highlight .kt { color: #888888; font-weight: bold } /* Keyword.Type */
.highlight .m { color: #0000DD; font-weight: bold } /* Literal.Number */
.highlight .s { color: #dd2200; background-color: #fff0f0 } /* Literal.String */
.highlight .na { color: #336699 } /* Name.Attribute */
.highlight .nb { color: #003388 } /* Name.Builtin */
.highlight .nc { color: #bb0066; font-weight: bold } /* Name.Class */
.highlight .no { color: #003366; font-weight: bold } /* Name.Constant */
.highlight .nd { color: #555555 } /* Name.Decorator */
.highlight .ne { color: #bb0066; font-weight: bold } /* Name.Exception */
.highlight .nf { color: #0066bb; font-weight: bold } /* Name.Function */
.highlight .nl { color: #336699; font-style: italic } /* Name.Label */
.highlight .nn { color: #bb0066; font-weight: bold } /* Name.Namespace */
.highlight .py { color: #336699; font-weight: bold } /* Name.Property */
.highlight .nt { color: #bb0066; font-weight: bold } /* Name.Tag */
.highlight .nv { color: #336699 } /* Name.Variable */
.highlight .ow { color: #008800 } /* Operator.Word */
.highlight .w { color: #bbbbbb } /* Text.Whitespace */
.highlight .mb { color: #0000DD; font-weight: bold } /* Literal.Number.Bin */
.highlight .mf { color: #0000DD; font-weight: bold } /* Literal.Number.Float */
.highlight .mh { color: #0000DD; font-weight: bold } /* Literal.Number.Hex */
.highlight .mi { color: #0000DD; font-weight: bold } /* Literal.Number.Integer */
.highlight .mo { color: #0000DD; font-weight: bold } /* Literal.Number.Oct */
.highlight .sa { color: #dd2200; background-color: #fff0f0 } /* Literal.String.Affix */
.highlight .sb { color: #dd2200; background-color: #fff0f0 } /* Literal.String.Backtick */
.highlight .sc { color: #dd2200; background-color: #fff0f0 } /* Literal.String.Char */
.highlight .dl { color: #dd2200; background-color: #fff0f0 } /* Literal.String.Delimiter */
.highlight .sd { color: #dd2200; background-color: #fff0f0 } /* Literal.String.Doc */
.highlight .s2 { color: #dd2200; background-color: #fff0f0 } /* Literal.String.Double */
.highlight .se { color: #0044dd; background-color: #fff0f0 } /* Literal.String.Escape */
.highlight .sh { color: #dd2200; background-color: #fff0f0 } /* Literal.String.Heredoc */
.highlight .si { color: #3333bb; background-color: #fff0f0 } /* Literal.String.Interpol */
.highlight .sx { color: #22bb22; background-color: #f0fff0 } /* Literal.String.Other */
.highlight .sr { color: #008800; background-color: #fff0ff } /* Literal.String.Regex */
.highlight .s1 { color: #dd2200; background-color: #fff0f0 } /* Literal.String.Single */
.highlight .ss { color: #aa6600; background-color: #fff0f0 } /* Literal.String.Symbol */
.highlight .bp { color: #003388 } /* Name.Builtin.Pseudo */
.highlight .fm { color: #0066bb; font-weight: bold } /* Name.Function.Magic */
.highlight .vc { color: #336699 } /* Name.Variable.Class */
.highlight .vg { color: #dd7700 } /* Name.Variable.Global */
.highlight .vi { color: #3333bb } /* Name.Variable.Instance */
.highlight .vm { color: #336699 } /* Name.Variable.Magic */
.highlight .il { color: #0000DD; font-weight: bold } /* Literal.Number.Integer.Long */

.nsl {
-webkit-touch-callout: none;
-webkit-user-select: none;
-khtml-user-select: none;
-moz-user-select: none;
-ms-user-select: none;
user-select: none;
}


.block_directive{

    border-left: thin solid var(--nc-lk-1);
    padding-bottom: 8px;
    padding-left: 12px;
}

.block_directive.head{

    border: thin solid var(--nc-lk-1);
}


.block_directive > p{
    margin-left: 2em;
    margin-top: 1em;
}
.head {
    font-family: monospace;
    color: var(--nc-lk-1);
}
</style>
</head>
<body class="tex2jax_ignore">
    <header>
            <brand><i class="fab fa-python"></i><a href='/'>Home</a></brand>
        <nav> / <a href='/' >p</a>  &nbsp;/&nbsp; 
                <div class="dropdown">
                <a href=dask>dask</a>&nbsp;/&nbsp;
                    <div class="dropdown-content">
                            <a href="/p/IPython/8.0.0.dev/api/IPython.html">IPython</a>
                            <a href="/p/astropy/5.0/api/astropy.html">astropy</a>
                            <a href="/p/dask/2021.10.0/api/dask.html">dask</a>
                            <a href="/p/distributed/2021.01.1+9.g613b3c820/api/distributed.html">distributed</a>
                            <a href="/p/matplotlib/3.5.0/api/matplotlib.html">matplotlib</a>
                            <a href="/p/numpy/1.21.3/api/numpy.html">numpy</a>
                            <a href="/p/pandas/1.3.4/api/pandas.html">pandas</a>
                            <a href="/p/papyri/0.0.8/api/papyri.html">papyri</a>
                            <a href="/p/scipy/1.7.1/api/scipy.html">scipy</a>
                            <a href="/p/skimage/0.18.3/api/skimage.html">skimage</a>
                            <a href="/p/xarray/0.17.0/api/xarray.html">xarray</a>
                            
                     </div>
                </div>
                <div class="dropdown">
                <a href='/p/dask/2021.10.0/api/dask.html'>2021.10.0</a>&nbsp;/&nbsp;
                    <div class="dropdown-content">
                            <a href="/p/dask/2021.10.0/api/dask.html">2021.10.0</a>
                            
                    </div>
                </div>

                <div class="dropdown">
                    <a href='/p/dask/2021.10.0/api/dask.html'>api</a>&nbsp;/&nbsp;
                    <div class="dropdown-content">
                        <a href="/p/dask/2021.10.0/api/dask.html">API</a>
                        <a href="/p/dask/2021.10.0/gallery">Gallery</a>
                     </div>
                </div>

            
                
                    <div class="dropdown">
                        
                            <a class="dropbtn" href='dask.html'>dask</a>.
                        
                        
                    </div>
                
                
                    <div class="dropdown">
                        
                            <a class="dropbtn" href='dask.utils.html'>utils</a>.
                        
                        
                            <div class="dropdown-content">
                            <a href="/p/dask/2021.10.0/api/dask._version.html">_version</a>
                            <a href="/p/dask/2021.10.0/api/dask.array.html">array</a>
                            <a href="/p/dask/2021.10.0/api/dask.base.html">base</a>
                            <a href="/p/dask/2021.10.0/api/dask.blockwise.html">blockwise</a>
                            <a href="/p/dask/2021.10.0/api/dask.callbacks.html">callbacks</a>
                            <a href="/p/dask/2021.10.0/api/dask.compatibility.html">compatibility</a>
                            <a href="/p/dask/2021.10.0/api/dask.config.html">config</a>
                            <a href="/p/dask/2021.10.0/api/dask.context.html">context</a>
                            <a href="/p/dask/2021.10.0/api/dask.core.html">core</a>
                            <a href="/p/dask/2021.10.0/api/dask.datasets.html">datasets</a>
                            <a href="/p/?/?/api/dask.delayed.html">delayed</a>
                            <a href="/p/dask/2021.10.0/api/dask.hashing.html">hashing</a>
                            <a href="/p/dask/2021.10.0/api/dask.highlevelgraph.html">highlevelgraph</a>
                            <a href="/p/dask/2021.10.0/api/dask.layers.html">layers</a>
                            <a href="/p/dask/2021.10.0/api/dask.local.html">local</a>
                            <a href="/p/dask/2021.10.0/api/dask.multiprocessing.html">multiprocessing</a>
                            <a href="/p/dask/2021.10.0/api/dask.optimization.html">optimization</a>
                            <a href="/p/dask/2021.10.0/api/dask.order.html">order</a>
                            <a href="/p/dask/2021.10.0/api/dask.sizeof.html">sizeof</a>
                            <a href="/p/dask/2021.10.0/api/dask.system.html">system</a>
                            <a href="/p/dask/2021.10.0/api/dask.threaded.html">threaded</a>
                            <a href="/p/dask/2021.10.0/api/dask.utils.html">utils</a>
                            <a href="/p/dask/2021.10.0/api/dask.utils_test.html">utils_test</a>
                            <a href="/p/dask/2021.10.0/api/dask.widgets.html">widgets</a>
                            
                            </div>
                        
                    </div>
                
                
                    <div class="dropdown">
                        
                            <a class="dropbtn" href='dask.utils.einsum.html'>einsum</a>
                        
                        
                            <div class="dropdown-content">
                            <a href="/p/?/?/api/dask.utils.Dispatch.html">Dispatch</a>
                            <a href="/p/dask/2021.10.0/api/dask.utils.IndexCallable.html">IndexCallable</a>
                            <a href="/p/dask/2021.10.0/api/dask.utils.K.html">K</a>
                            <a href="/p/dask/2021.10.0/api/dask.utils.MethodCache.html">MethodCache</a>
                            <a href="/p/dask/2021.10.0/api/dask.utils.OperatorMethodMixin.html">OperatorMethodMixin</a>
                            <a href="/p/dask/2021.10.0/api/dask.utils.V.html">V</a>
                            <a href="/p/dask/2021.10.0/api/dask.utils._deprecated.html">_deprecated</a>
                            <a href="/p/dask/2021.10.0/api/dask.utils._derived_from.html">_derived_from</a>
                            <a href="/p/dask/2021.10.0/api/dask.utils.asciitable.html">asciitable</a>
                            <a href="/p/dask/2021.10.0/api/dask.utils.cached_property.html">cached_property</a>
                            <a href="/p/dask/2021.10.0/api/dask.utils.concatenate.html">concatenate</a>
                            <a href="/p/dask/2021.10.0/api/dask.utils.concrete.html">concrete</a>
                            <a href="/p/dask/2021.10.0/api/dask.utils.deepmap.html">deepmap</a>
                            <a href="/p/dask/2021.10.0/api/dask.utils.derived_from.html">derived_from</a>
                            <a href="/p/dask/2021.10.0/api/dask.utils.digit.html">digit</a>
                            <a href="/p/dask/2021.10.0/api/dask.utils.divide.html">divide</a>
                            <a href="/p/dask/2021.10.0/api/dask.utils.einsum.html">einsum</a>
                            <a href="/p/dask/2021.10.0/api/dask.utils.empty.html">empty</a>
                            <a href="/p/dask/2021.10.0/api/dask.utils.ensure_bytes.html">ensure_bytes</a>
                            <a href="/p/dask/2021.10.0/api/dask.utils.ensure_dict.html">ensure_dict</a>
                            <a href="/p/dask/2021.10.0/api/dask.utils.ensure_not_exists.html">ensure_not_exists</a>
                            <a href="/p/dask/2021.10.0/api/dask.utils.ensure_unicode.html">ensure_unicode</a>
                            <a href="/p/dask/2021.10.0/api/dask.utils.factors.html">factors</a>
                            <a href="/p/dask/2021.10.0/api/dask.utils.filetexts.html">filetexts</a>
                            <a href="/p/dask/2021.10.0/api/dask.utils.format_bytes.html">format_bytes</a>
                            <a href="/p/dask/2021.10.0/api/dask.utils.format_time.html">format_time</a>
                            <a href="/p/dask/2021.10.0/api/dask.utils.format_time_ago.html">format_time_ago</a>
                            <a href="/p/dask/2021.10.0/api/dask.utils.funcname.html">funcname</a>
                            <a href="/p/dask/2021.10.0/api/dask.utils.get_named_args.html">get_named_args</a>
                            <a href="/p/dask/2021.10.0/api/dask.utils.get_scheduler_lock.html">get_scheduler_lock</a>
                            <a href="/p/dask/2021.10.0/api/dask.utils.getargspec.html">getargspec</a>
                            <a href="/p/dask/2021.10.0/api/dask.utils.ignore_warning.html">ignore_warning</a>
                            <a href="/p/dask/2021.10.0/api/dask.utils.import_required.html">import_required</a>
                            <a href="/p/dask/2021.10.0/api/dask.utils.insert.html">insert</a>
                            <a href="/p/dask/2021.10.0/api/dask.utils.is_arraylike.html">is_arraylike</a>
                            <a href="/p/dask/2021.10.0/api/dask.utils.is_dataframe_like.html">is_dataframe_like</a>
                            <a href="/p/dask/2021.10.0/api/dask.utils.is_index_like.html">is_index_like</a>
                            <a href="/p/dask/2021.10.0/api/dask.utils.is_integer.html">is_integer</a>
                            <a href="/p/dask/2021.10.0/api/dask.utils.is_series_like.html">is_series_like</a>
                            <a href="/p/dask/2021.10.0/api/dask.utils.itemgetter.html">itemgetter</a>
                            <a href="/p/dask/2021.10.0/api/dask.utils.iter_chunks.html">iter_chunks</a>
                            <a href="/p/dask/2021.10.0/api/dask.utils.key_split.html">key_split</a>
                            <a href="/p/dask/2021.10.0/api/dask.utils.methodcaller.html">methodcaller</a>
                            <a href="/p/dask/2021.10.0/api/dask.utils.natural_sort_key.html">natural_sort_key</a>
                            <a href="/p/dask/2021.10.0/api/dask.utils.ndeepmap.html">ndeepmap</a>
                            <a href="/p/dask/2021.10.0/api/dask.utils.parse_bytes.html">parse_bytes</a>
                            <a href="/p/dask/2021.10.0/api/dask.utils.parse_timedelta.html">parse_timedelta</a>
                            <a href="/p/dask/2021.10.0/api/dask.utils.partial_by_order.html">partial_by_order</a>
                            <a href="/p/dask/2021.10.0/api/dask.utils.percentile.html">percentile</a>
                            <a href="/p/dask/2021.10.0/api/dask.utils.pseudorandom.html">pseudorandom</a>
                            <a href="/p/dask/2021.10.0/api/dask.utils.random_state_data.html">random_state_data</a>
                            <a href="/p/dask/2021.10.0/api/dask.utils.stringify.html">stringify</a>
                            <a href="/p/dask/2021.10.0/api/dask.utils.stringify_collection_keys.html">stringify_collection_keys</a>
                            <a href="/p/dask/2021.10.0/api/dask.utils.takes_multiple_arguments.html">takes_multiple_arguments</a>
                            <a href="/p/dask/2021.10.0/api/dask.utils.tensordot.html">tensordot</a>
                            <a href="/p/dask/2021.10.0/api/dask.utils.tmpdir.html">tmpdir</a>
                            <a href="/p/dask/2021.10.0/api/dask.utils.tmpfile.html">tmpfile</a>
                            <a href="/p/dask/2021.10.0/api/dask.utils.typename.html">typename</a>
                            <a href="/p/dask/2021.10.0/api/dask.utils.unsupported_arguments.html">unsupported_arguments</a>
                            
                            </div>
                        
                    </div>
                </nav>
    </header>
<div class='container'>
    <div class="sidenav">
    
        <img src="/p/dask/2021.10.0/img/logo.png"/>
    
    <a href="#">Library: dask</a>
    <a href="#">Version: 2021.10.0</a>
    <a href="#">Authors:</a>
    <a href="#">PyPI:</a>
    <a href="#">Source</a>
    <a href="#">Homepage</a>
    <a href="#">Fundings</a>
    <a href="#">Stars</a>
    <a href="#">Forks</a>
    <a href="#">Related</a>
    <hr/>
    <a>Narrative Docs</a>
    <hr/>
    <a href="#section-Notes">Notes</a>

    <a href="#section-Parameters">Parameters</a>

    <a href="#section-Returns">Returns</a>

    <a href="#section-backrefs">BackRef</a>
    

    </div>

    













    <code class='signature'>einsum(subscripts, *operands, out=None, dtype=None, order=&#39;K&#39;, casting=&#39;safe&#39;, optimize=False)</code>




    
    
       <dl>
           

   </pre>
   


    
    
        <!-- rendering Extended Summary -->
        
           
               
        <p>Using the Einstein summation convention, many common multi-dimensional, linear algebraic array operations can be represented in a simple fashion. In <em>implicit</em> mode <code><a link href="/p/dask/2021.10.0/api/dask.utils.einsum.html" class='exists'>einsum</a></code>
         computes these values.</p>

    
           
               
        <p>In <em>explicit</em> mode, <code><a link href="/p/dask/2021.10.0/api/dask.utils.einsum.html" class='exists'>einsum</a></code>
         provides further flexibility to compute other array operations that might not be considered classical Einstein summation operations, by disabling, or forcing summation over specified subscript labels.</p>

    
           
               
        <p>See the notes and examples for clarification.</p>

    
           
       
    


    
    
       
   


    
        <h3 id="section-Notes">Notes</h3>
    
    
        <!-- rendering Notes -->
        
           
               
            <div class='admonition'>
    <div>versionadded</div>
    
        
        <p>1.6.0 </p>

    
    
</div>

       
           
               
        <p>The Einstein summation convention can be used to compute many multi-dimensional, linear algebraic array operations. <code><a link href="/p/dask/2021.10.0/api/dask.utils.einsum.html" class='exists'>einsum</a></code>
         provides a succinct way of representing these.</p>

    
           
               
        <p>A non-exhaustive list of these operations, which can be computed by <code><a link href="/p/dask/2021.10.0/api/dask.utils.einsum.html" class='exists'>einsum</a></code>
        , is shown below along with examples:</p>

    
           
               
           <ul>
               <li>
        <p>Trace of an array, <code>:None:func:`numpy.trace`</code>.</p>

    </li>
               
               <li>
        <p>Return a diagonal, <code>:None:func:`numpy.diag`</code>.</p>

    </li>
               
               <li>
        <p>Array axis summations, <code>:None:func:`numpy.sum`</code>.</p>

    </li>
               
               <li>
        <p>Transpositions and permutations, <code>:None:func:`numpy.transpose`</code>.</p>

    </li>
               
               <li>
        <p>Matrix multiplication and dot product, <code>:None:func:`numpy.matmul`</code> <code>:None:func:`numpy.dot`</code>.</p>

    </li>
               
               <li>
        <p>Vector inner and outer products, <code>:None:func:`numpy.inner`</code> <code>:None:func:`numpy.outer`</code>.</p>

    </li>
               
               <li>
        <p>Broadcasting, element-wise and scalar multiplication, <code>:None:func:`numpy.multiply`</code>.</p>

    </li>
               
               <li>
        <p>Tensor contractions, <code>:None:func:`numpy.tensordot`</code>.</p>

    </li>
               
               <li>
        <p>Chained array operations, in efficient calculation order, <code>:None:func:`numpy.einsum_path`</code>.</p>

    </li>
               
            </ul>
       
           
               
        <p>The subscripts string is a comma-separated list of subscript labels, where each label refers to a dimension of the corresponding operand. Whenever a label is repeated it is summed, so 
        <code class='verbatim'>np.einsum(&#39;i,i&#39;, a, b)</code>
     is equivalent to <code><a link href="/p/numpy/1.21.3/api/numpy.inner.html" class='exists'>np.inner(a,b)</a></code>
        . If a label appears only once, it is not summed, so 
        <code class='verbatim'>np.einsum(&#39;i&#39;, a)</code>
     produces a view of 
        <code class='verbatim'>a</code>
     with no changes. A further example 
        <code class='verbatim'>np.einsum(&#39;ij,jk&#39;, a, b)</code>
     describes traditional matrix multiplication and is equivalent to <code>:None:func:`np.matmul(a,b) &lt;numpy.matmul&gt;`</code>. Repeated subscript labels in one operand take the diagonal. For example, 
        <code class='verbatim'>np.einsum(&#39;ii&#39;, a)</code>
     is equivalent to <code><a link href="/p/numpy/1.21.3/api/numpy.trace.html" class='exists'>np.trace(a)</a></code>
        .</p>

    
           
               
        <p>In <em>implicit mode</em>, the chosen subscripts are important since the axes of the output are reordered alphabetically.  This means that 
        <code class='verbatim'>np.einsum(&#39;ij&#39;, a)</code>
     doesn&#39;t affect a 2D array, while 
        <code class='verbatim'>np.einsum(&#39;ji&#39;, a)</code>
     takes its transpose. Additionally, 
        <code class='verbatim'>np.einsum(&#39;ij,jk&#39;, a, b)</code>
     returns a matrix multiplication, while, 
        <code class='verbatim'>np.einsum(&#39;ij,jh&#39;, a, b)</code>
     returns the transpose of the multiplication since subscript &#39;h&#39; precedes subscript &#39;i&#39;.</p>

    
           
               
        <p>In <em>explicit mode</em> the output can be directly controlled by specifying output subscript labels.  This requires the identifier &#39;-&gt;&#39; as well as the list of output subscript labels. This feature increases the flexibility of the function since summing can be disabled or forced when required. The call 
        <code class='verbatim'>np.einsum(&#39;i-&gt;&#39;, a)</code>
     is like <code><a link href="/p/numpy/1.21.3/api/numpy.sum.html" class='exists'>np.sum(a, axis=-1)</a></code>
        , and 
        <code class='verbatim'>np.einsum(&#39;ii-&gt;i&#39;, a)</code>
     is like <code><a link href="/p/numpy/1.21.3/api/numpy.diag.html" class='exists'>np.diag(a)</a></code>
        . The difference is that <code><a link href="/p/dask/2021.10.0/api/dask.utils.einsum.html" class='exists'>einsum</a></code>
         does not allow broadcasting by default. Additionally 
        <code class='verbatim'>np.einsum(&#39;ij,jh-&gt;ih&#39;, a, b)</code>
     directly specifies the order of the output subscript labels and therefore returns matrix multiplication, unlike the example above in implicit mode.</p>

    
           
               
        <p>To enable and control broadcasting, use an ellipsis.  Default NumPy-style broadcasting is done by adding an ellipsis to the left of each term, like 
        <code class='verbatim'>np.einsum(&#39;...ii-&gt;...i&#39;, a)</code>
    . To take the trace along the first and last axes, you can do 
        <code class='verbatim'>np.einsum(&#39;i...i&#39;, a)</code>
    , or to do a matrix-matrix product with the left-most indices instead of rightmost, one can do 
        <code class='verbatim'>np.einsum(&#39;ij...,jk...-&gt;ik...&#39;, a, b)</code>
    .</p>

    
           
               
        <p>When there is only one operand, no axes are summed, and no output parameter is provided, a view into the operand is returned instead of a new array.  Thus, taking the diagonal as 
        <code class='verbatim'>np.einsum(&#39;ii-&gt;i&#39;, a)</code>
     produces a view (changed in version 1.10.0).</p>

    
           
               
        <p><code><a link href="/p/dask/2021.10.0/api/dask.utils.einsum.html" class='exists'>einsum</a></code>
         also provides an alternative way to provide the subscripts and operands as 
        <code class='verbatim'>einsum(op0, sublist0, op1, sublist1, ..., [sublistout])</code>
    . If the output shape is not provided in this format <code><a link href="/p/dask/2021.10.0/api/dask.utils.einsum.html" class='exists'>einsum</a></code>
         will be calculated in implicit mode, otherwise it will be performed explicitly. The examples below have corresponding <code><a link href="/p/dask/2021.10.0/api/dask.utils.einsum.html" class='exists'>einsum</a></code>
         calls with the two parameter methods.</p>

    
           
               
            <div class='admonition'>
    <div>versionadded</div>
    
        
        <p>1.10.0 </p>

    
    
</div>

       
           
               
        <p>Views returned from einsum are now writeable whenever the input array is writeable. For example, 
        <code class='verbatim'>np.einsum(&#39;ijk...-&gt;kji...&#39;, a)</code>
     will now have the same effect as <code><a link href="/p/numpy/1.21.3/api/numpy.swapaxes.html" class='exists'>np.swapaxes(a, 0, 2)</a></code>
         and 
        <code class='verbatim'>np.einsum(&#39;ii-&gt;i&#39;, a)</code>
     will return a writeable view of the diagonal of a 2D array.</p>

    
           
               
            <div class='admonition'>
    <div>versionadded</div>
    
        
        <p>1.12.0 </p>

    
    
</div>

       
           
               
        <p>Added the 
        <code class='verbatim'>optimize</code>
     argument which will optimize the contraction order of an einsum expression. For a contraction with three or more operands this can greatly increase the computational efficiency at the cost of a larger memory footprint during computation.</p>

    
           
               
        <p>Typically a &#39;greedy&#39; algorithm is applied which empirical tests have shown returns the optimal path in the majority of cases. In some cases &#39;optimal&#39; will return the superlative path through a more expensive, exhaustive search. For iterative calculations it may be advisable to calculate the optimal path once and reuse that path by supplying it as an argument. An example is given below.</p>

    
           
               
        <p>See <code><a link href="/p/numpy/1.21.3/api/numpy.einsum_path.html" class='exists'>numpy.einsum_path</a></code>
         for more details.</p>

    
           
       
    


    
    
       <dl>
           

   </pre>
   


    
        <h3 id="section-Parameters">Parameters</h3>
    
    
       <dl>
           
            
                <dt><a id="subscripts">subscripts</a> : str</dt>
            
        </dl>

        <dd>
            
                
        <p>Specifies the subscripts for summation as comma separated list of subscript labels. An implicit (classical Einstein summation) calculation is performed unless the explicit indicator &#39;-&gt;&#39; is included as well as subscript labels of the precise output form.</p>

    
            
        </dd>
       
            
                <dt><a id="operands">operands</a> : list of array_like</dt>
            
        </dl>

        <dd>
            
                
        <p>These are the arrays for the operation.</p>

    
            
        </dd>
       
            
                <dt><a id="out">out</a> : ndarray, optional</dt>
            
        </dl>

        <dd>
            
                
        <p>If provided, the calculation is done into this array.</p>

    
            
        </dd>
       
            
                <dt><a id="dtype">dtype</a> : {data-type, None}, optional</dt>
            
        </dl>

        <dd>
            
                
        <p>If provided, forces the calculation to use the data type specified. Note that you may have to also give a more liberal <code><a link href="#casting" class='local'>casting</a></code> parameter to allow the conversions. Default is None.</p>

    
            
        </dd>
       
            
                <dt><a id="order">order</a> : {&#39;C&#39;, &#39;F&#39;, &#39;A&#39;, &#39;K&#39;}, optional</dt>
            
        </dl>

        <dd>
            
                
        <p>Controls the memory layout of the output. &#39;C&#39; means it should be C contiguous. &#39;F&#39; means it should be Fortran contiguous, &#39;A&#39; means it should be &#39;F&#39; if the inputs are all &#39;F&#39;, &#39;C&#39; otherwise. &#39;K&#39; means it should be as close to the layout as the inputs as is possible, including arbitrarily permuted axes. Default is &#39;K&#39;.</p>

    
            
        </dd>
       
            
                <dt><a id="casting">casting</a> : {&#39;no&#39;, &#39;equiv&#39;, &#39;safe&#39;, &#39;same_kind&#39;, &#39;unsafe&#39;}, optional</dt>
            
        </dl>

        <dd>
            
                
        <p>Controls what kind of data casting may occur.  Setting this to &#39;unsafe&#39; is not recommended, as it can adversely affect accumulations.</p>

    
            
                
            <pre>* &#39;no&#39; means the data types should not be cast at all.
* &#39;equiv&#39; means only byte-order changes are allowed.
* &#39;safe&#39; means only casts which can preserve values are allowed.
* &#39;same_kind&#39; means only safe casts or casts within a kind,
  like float64 to float32, are allowed.
* &#39;unsafe&#39; means any data conversions may be done.
</pre>

       
            
                
        <p>Default is &#39;safe&#39;.</p>

    
            
        </dd>
       
            
                <dt><a id="optimize">optimize</a> : {False, True, &#39;greedy&#39;, &#39;optimal&#39;}, optional</dt>
            
        </dl>

        <dd>
            
                
        <p>Controls if intermediate optimization should occur. No optimization will occur if False and True will default to the &#39;greedy&#39; algorithm. Also accepts an explicit contraction list from the 
        <code class='verbatim'>np.einsum_path</code>
     function. See 
        <code class='verbatim'>np.einsum_path</code>
     for more details. Defaults to False.</p>

    
            
        </dd>
       

   </pre>
   


    
    
       <dl>
           

   </pre>
   


    
    
       
   


    
        <h3 id="section-Returns">Returns</h3>
    
    
       <dl>
           
            
                <dt><a id="output">output</a> : ndarray</dt>
            
        </dl>

        <dd>
            
                
        <p>The calculation based on the Einstein summation convention.</p>

    
            
        </dd>
       

   </pre>
   


    
    
        <!-- rendering Summary -->
        
           
               
        <p>Evaluates the Einstein summation convention on the operands.</p>

    
           
       
    


    
    
       
   


    
    
       <dl>
           

   </pre>
   


    
    
       <dl>
           

   </pre>
   



    <h3 id="section-Examples">Examples</h3>
        
                <pre class='highlight execed'><span class='nsl'>&gt;&gt;&gt; </span><span class="">a</span><span class=""> </span><span class="o">=</span><span class=""> </span><span class="">np</span><span class="o">.</span><a class="foo ", href="/p/dask/2021.10.0/api/dask.array.creation.arange.html">arange</a><span class="">(</span><span class="mi">25</span><span class="">)</span><span class="o">.</span><a class="foo ", href="/p/dask/2021.10.0/api/dask.array.core.Array.reshape.html">reshape</a><span class="">(</span><span class="mi">5</span><span class="">,</span><span class="mi">5</span><span class="">)</span><br><span class='nsl'>...&nbsp;</span><span class="">b</span><span class=""> </span><span class="o">=</span><span class=""> </span><span class="">np</span><span class="o">.</span><a class="foo ", href="/p/dask/2021.10.0/api/dask.array.creation.arange.html">arange</a><span class="">(</span><span class="mi">5</span><span class="">)</span><br><span class='nsl'>...&nbsp;</span><span class="">c</span><span class=""> </span><span class="o">=</span><span class=""> </span><span class="">np</span><span class="o">.</span><a class="foo ", href="/p/dask/2021.10.0/api/dask.array.creation.arange.html">arange</a><span class="">(</span><span class="mi">6</span><span class="">)</span><span class="o">.</span><a class="foo ", href="/p/dask/2021.10.0/api/dask.array.core.Array.reshape.html">reshape</a><span class="">(</span><span class="mi">2</span><span class="">,</span><span class="mi">3</span><span class="">)</span>
</pre>
            
            
         
                
        <p>Trace of a matrix:</p>

    
            
            
         
                <pre class='highlight execed'><span class='nsl'>&gt;&gt;&gt; </span><span class="">np</span><span class="o">.</span><a class="foo ", href="/p/dask/2021.10.0/api/dask.utils.einsum.html">einsum</a><span class="">(</span><span class="s1">&#39;</span><a class="foo s1", href="/p/dask/2021.10.0/api/dask.utils.asciitable.html">ii</a><span class="s1">&#39;</span><span class="">,</span><span class=""> </span><span class="">a</span><span class="">)</span>
60</pre>
            
            
         
                <pre class='highlight execed'><span class='nsl'>&gt;&gt;&gt; </span><span class="">np</span><span class="o">.</span><a class="foo ", href="/p/dask/2021.10.0/api/dask.utils.einsum.html">einsum</a><span class="">(</span><span class="">a</span><span class="">,</span><span class=""> </span><span class="">[</span><a class="foo mi", href="/p/dask/2021.10.0/api/dask.array.ufunc.log10.html">0</a><span class="">,</span><a class="foo mi", href="/p/dask/2021.10.0/api/dask.array.ufunc.log10.html">0</a><span class="">]</span><span class="">)</span>
60</pre>
            
            
         
                <pre class='highlight execed'><span class='nsl'>&gt;&gt;&gt; </span><span class="">np</span><span class="o">.</span><span class="">trace</span><span class="">(</span><span class="">a</span><span class="">)</span>
60</pre>
            
            
         
                
        <p>Extract the diagonal (requires explicit form):</p>

    
            
            
         
                <pre class='highlight execed'><span class='nsl'>&gt;&gt;&gt; </span><span class="">np</span><span class="o">.</span><a class="foo ", href="/p/dask/2021.10.0/api/dask.utils.einsum.html">einsum</a><span class="">(</span><span class="s1">&#39;</span><span class="s1">ii-&gt;i</span><span class="s1">&#39;</span><span class="">,</span><span class=""> </span><span class="">a</span><span class="">)</span>
array([ 0,  6, 12, 18, 24])</pre>
            
            
         
                <pre class='highlight execed'><span class='nsl'>&gt;&gt;&gt; </span><span class="">np</span><span class="o">.</span><a class="foo ", href="/p/dask/2021.10.0/api/dask.utils.einsum.html">einsum</a><span class="">(</span><span class="">a</span><span class="">,</span><span class=""> </span><span class="">[</span><a class="foo mi", href="/p/dask/2021.10.0/api/dask.array.ufunc.log10.html">0</a><span class="">,</span><a class="foo mi", href="/p/dask/2021.10.0/api/dask.array.ufunc.log10.html">0</a><span class="">]</span><span class="">,</span><span class=""> </span><span class="">[</span><a class="foo mi", href="/p/dask/2021.10.0/api/dask.array.ufunc.log10.html">0</a><span class="">]</span><span class="">)</span>
array([ 0,  6, 12, 18, 24])</pre>
            
            
         
                <pre class='highlight execed'><span class='nsl'>&gt;&gt;&gt; </span><span class="">np</span><span class="o">.</span><a class="foo ", href="/p/dask/2021.10.0/api/dask.array.creation.diag.html">diag</a><span class="">(</span><span class="">a</span><span class="">)</span>
array([ 0,  6, 12, 18, 24])</pre>
            
            
         
                
        <p>Sum over an axis (requires explicit form):</p>

    
            
            
         
                <pre class='highlight execed'><span class='nsl'>&gt;&gt;&gt; </span><span class="">np</span><span class="o">.</span><a class="foo ", href="/p/dask/2021.10.0/api/dask.utils.einsum.html">einsum</a><span class="">(</span><span class="s1">&#39;</span><span class="s1">ij-&gt;i</span><span class="s1">&#39;</span><span class="">,</span><span class=""> </span><span class="">a</span><span class="">)</span>
array([ 10,  35,  60,  85, 110])</pre>
            
            
         
                <pre class='highlight execed'><span class='nsl'>&gt;&gt;&gt; </span><span class="">np</span><span class="o">.</span><a class="foo ", href="/p/dask/2021.10.0/api/dask.utils.einsum.html">einsum</a><span class="">(</span><span class="">a</span><span class="">,</span><span class=""> </span><span class="">[</span><a class="foo mi", href="/p/dask/2021.10.0/api/dask.array.ufunc.log10.html">0</a><span class="">,</span><span class="mi">1</span><span class="">]</span><span class="">,</span><span class=""> </span><span class="">[</span><a class="foo mi", href="/p/dask/2021.10.0/api/dask.array.ufunc.log10.html">0</a><span class="">]</span><span class="">)</span>
array([ 10,  35,  60,  85, 110])</pre>
            
            
         
                <pre class='highlight execed'><span class='nsl'>&gt;&gt;&gt; </span><span class="">np</span><span class="o">.</span><span class="">sum</span><span class="">(</span><span class="">a</span><span class="">,</span><span class=""> </span><span class="">axis</span><span class="o">=</span><span class="mi">1</span><span class="">)</span>
array([ 10,  35,  60,  85, 110])</pre>
            
            
         
                
        <p>For higher dimensional arrays summing a single axis can be done with ellipsis:</p>

    
            
            
         
                <pre class='highlight execed'><span class='nsl'>&gt;&gt;&gt; </span><span class="">np</span><span class="o">.</span><a class="foo ", href="/p/dask/2021.10.0/api/dask.utils.einsum.html">einsum</a><span class="">(</span><span class="s1">&#39;</span><span class="s1">...j-&gt;...</span><span class="s1">&#39;</span><span class="">,</span><span class=""> </span><span class="">a</span><span class="">)</span>
array([ 10,  35,  60,  85, 110])</pre>
            
            
         
                <pre class='highlight execed'><span class='nsl'>&gt;&gt;&gt; </span><span class="">np</span><span class="o">.</span><a class="foo ", href="/p/dask/2021.10.0/api/dask.utils.einsum.html">einsum</a><span class="">(</span><span class="">a</span><span class="">,</span><span class=""> </span><span class="">[</span><span class="bp">Ellipsis</span><span class="">,</span><span class="mi">1</span><span class="">]</span><span class="">,</span><span class=""> </span><span class="">[</span><span class="bp">Ellipsis</span><span class="">]</span><span class="">)</span>
array([ 10,  35,  60,  85, 110])</pre>
            
            
         
                
        <p>Compute a matrix transpose, or reorder any number of axes:</p>

    
            
            
         
                <pre class='highlight execed'><span class='nsl'>&gt;&gt;&gt; </span><span class="">np</span><span class="o">.</span><a class="foo ", href="/p/dask/2021.10.0/api/dask.utils.einsum.html">einsum</a><span class="">(</span><span class="s1">&#39;</span><span class="s1">ji</span><span class="s1">&#39;</span><span class="">,</span><span class=""> </span><span class="">c</span><span class="">)</span>
array([[0, 3],
       [1, 4],
       [2, 5]])</pre>
            
            
         
                <pre class='highlight execed'><span class='nsl'>&gt;&gt;&gt; </span><span class="">np</span><span class="o">.</span><a class="foo ", href="/p/dask/2021.10.0/api/dask.utils.einsum.html">einsum</a><span class="">(</span><span class="s1">&#39;</span><span class="s1">ij-&gt;ji</span><span class="s1">&#39;</span><span class="">,</span><span class=""> </span><span class="">c</span><span class="">)</span>
array([[0, 3],
       [1, 4],
       [2, 5]])</pre>
            
            
         
                <pre class='highlight execed'><span class='nsl'>&gt;&gt;&gt; </span><span class="">np</span><span class="o">.</span><a class="foo ", href="/p/dask/2021.10.0/api/dask.utils.einsum.html">einsum</a><span class="">(</span><span class="">c</span><span class="">,</span><span class=""> </span><span class="">[</span><span class="mi">1</span><span class="">,</span><a class="foo mi", href="/p/dask/2021.10.0/api/dask.array.ufunc.log10.html">0</a><span class="">]</span><span class="">)</span>
array([[0, 3],
       [1, 4],
       [2, 5]])</pre>
            
            
         
                <pre class='highlight execed'><span class='nsl'>&gt;&gt;&gt; </span><span class="">np</span><span class="o">.</span><span class="">transpose</span><span class="">(</span><span class="">c</span><span class="">)</span>
array([[0, 3],
       [1, 4],
       [2, 5]])</pre>
            
            
         
                
        <p>Vector inner products:</p>

    
            
            
         
                <pre class='highlight execed'><span class='nsl'>&gt;&gt;&gt; </span><span class="">np</span><span class="o">.</span><a class="foo ", href="/p/dask/2021.10.0/api/dask.utils.einsum.html">einsum</a><span class="">(</span><span class="s1">&#39;</span><span class="s1">i,i</span><span class="s1">&#39;</span><span class="">,</span><span class=""> </span><span class="">b</span><span class="">,</span><span class=""> </span><span class="">b</span><span class="">)</span>
30</pre>
            
            
         
                <pre class='highlight execed'><span class='nsl'>&gt;&gt;&gt; </span><span class="">np</span><span class="o">.</span><a class="foo ", href="/p/dask/2021.10.0/api/dask.utils.einsum.html">einsum</a><span class="">(</span><span class="">b</span><span class="">,</span><span class=""> </span><span class="">[</span><a class="foo mi", href="/p/dask/2021.10.0/api/dask.array.ufunc.log10.html">0</a><span class="">]</span><span class="">,</span><span class=""> </span><span class="">b</span><span class="">,</span><span class=""> </span><span class="">[</span><a class="foo mi", href="/p/dask/2021.10.0/api/dask.array.ufunc.log10.html">0</a><span class="">]</span><span class="">)</span>
30</pre>
            
            
         
                <pre class='highlight execed'><span class='nsl'>&gt;&gt;&gt; </span><span class="">np</span><span class="o">.</span><span class="">inner</span><span class="">(</span><span class="">b</span><span class="">,</span><span class="">b</span><span class="">)</span>
30</pre>
            
            
         
                
        <p>Matrix vector multiplication:</p>

    
            
            
         
                <pre class='highlight execed'><span class='nsl'>&gt;&gt;&gt; </span><span class="">np</span><span class="o">.</span><a class="foo ", href="/p/dask/2021.10.0/api/dask.utils.einsum.html">einsum</a><span class="">(</span><span class="s1">&#39;</span><span class="s1">ij,j</span><span class="s1">&#39;</span><span class="">,</span><span class=""> </span><span class="">a</span><span class="">,</span><span class=""> </span><span class="">b</span><span class="">)</span>
array([ 30,  80, 130, 180, 230])</pre>
            
            
         
                <pre class='highlight execed'><span class='nsl'>&gt;&gt;&gt; </span><span class="">np</span><span class="o">.</span><a class="foo ", href="/p/dask/2021.10.0/api/dask.utils.einsum.html">einsum</a><span class="">(</span><span class="">a</span><span class="">,</span><span class=""> </span><span class="">[</span><a class="foo mi", href="/p/dask/2021.10.0/api/dask.array.ufunc.log10.html">0</a><span class="">,</span><span class="mi">1</span><span class="">]</span><span class="">,</span><span class=""> </span><span class="">b</span><span class="">,</span><span class=""> </span><span class="">[</span><span class="mi">1</span><span class="">]</span><span class="">)</span>
array([ 30,  80, 130, 180, 230])</pre>
            
            
         
                <pre class='highlight execed'><span class='nsl'>&gt;&gt;&gt; </span><span class="">np</span><span class="o">.</span><span class="">dot</span><span class="">(</span><span class="">a</span><span class="">,</span><span class=""> </span><span class="">b</span><span class="">)</span>
array([ 30,  80, 130, 180, 230])</pre>
            
            
         
                <pre class='highlight execed'><span class='nsl'>&gt;&gt;&gt; </span><span class="">np</span><span class="o">.</span><a class="foo ", href="/p/dask/2021.10.0/api/dask.utils.einsum.html">einsum</a><span class="">(</span><span class="s1">&#39;</span><span class="s1">...j,j</span><span class="s1">&#39;</span><span class="">,</span><span class=""> </span><span class="">a</span><span class="">,</span><span class=""> </span><span class="">b</span><span class="">)</span>
array([ 30,  80, 130, 180, 230])</pre>
            
            
         
                
        <p>Broadcasting and scalar multiplication:</p>

    
            
            
         
                <pre class='highlight execed'><span class='nsl'>&gt;&gt;&gt; </span><span class="">np</span><span class="o">.</span><a class="foo ", href="/p/dask/2021.10.0/api/dask.utils.einsum.html">einsum</a><span class="">(</span><span class="s1">&#39;</span><span class="s1">..., ...</span><span class="s1">&#39;</span><span class="">,</span><span class=""> </span><span class="mi">3</span><span class="">,</span><span class=""> </span><span class="">c</span><span class="">)</span>
array([[ 0,  3,  6],
       [ 9, 12, 15]])</pre>
            
            
         
                <pre class='highlight execed'><span class='nsl'>&gt;&gt;&gt; </span><span class="">np</span><span class="o">.</span><a class="foo ", href="/p/dask/2021.10.0/api/dask.utils.einsum.html">einsum</a><span class="">(</span><span class="s1">&#39;</span><span class="s1">,ij</span><span class="s1">&#39;</span><span class="">,</span><span class=""> </span><span class="mi">3</span><span class="">,</span><span class=""> </span><span class="">c</span><span class="">)</span>
array([[ 0,  3,  6],
       [ 9, 12, 15]])</pre>
            
            
         
                <pre class='highlight execed'><span class='nsl'>&gt;&gt;&gt; </span><span class="">np</span><span class="o">.</span><a class="foo ", href="/p/dask/2021.10.0/api/dask.utils.einsum.html">einsum</a><span class="">(</span><span class="mi">3</span><span class="">,</span><span class=""> </span><span class="">[</span><span class="bp">Ellipsis</span><span class="">]</span><span class="">,</span><span class=""> </span><span class="">c</span><span class="">,</span><span class=""> </span><span class="">[</span><span class="bp">Ellipsis</span><span class="">]</span><span class="">)</span>
array([[ 0,  3,  6],
       [ 9, 12, 15]])</pre>
            
            
         
                <pre class='highlight execed'><span class='nsl'>&gt;&gt;&gt; </span><span class="">np</span><span class="o">.</span><a class="foo ", href="/p/dask/2021.10.0/api/dask.array.ufunc.multiply.html">multiply</a><span class="">(</span><span class="mi">3</span><span class="">,</span><span class=""> </span><span class="">c</span><span class="">)</span>
array([[ 0,  3,  6],
       [ 9, 12, 15]])</pre>
            
            
         
                
        <p>Vector outer product:</p>

    
            
            
         
                <pre class='highlight execed'><span class='nsl'>&gt;&gt;&gt; </span><span class="">np</span><span class="o">.</span><a class="foo ", href="/p/dask/2021.10.0/api/dask.utils.einsum.html">einsum</a><span class="">(</span><span class="s1">&#39;</span><span class="s1">i,j</span><span class="s1">&#39;</span><span class="">,</span><span class=""> </span><span class="">np</span><span class="o">.</span><a class="foo ", href="/p/dask/2021.10.0/api/dask.array.creation.arange.html">arange</a><span class="">(</span><span class="mi">2</span><span class="">)</span><span class="o">+</span><span class="mi">1</span><span class="">,</span><span class=""> </span><span class="">b</span><span class="">)</span>
array([[0, 1, 2, 3, 4],
       [0, 2, 4, 6, 8]])</pre>
            
            
         
                <pre class='highlight execed'><span class='nsl'>&gt;&gt;&gt; </span><span class="">np</span><span class="o">.</span><a class="foo ", href="/p/dask/2021.10.0/api/dask.utils.einsum.html">einsum</a><span class="">(</span><span class="">np</span><span class="o">.</span><a class="foo ", href="/p/dask/2021.10.0/api/dask.array.creation.arange.html">arange</a><span class="">(</span><span class="mi">2</span><span class="">)</span><span class="o">+</span><span class="mi">1</span><span class="">,</span><span class=""> </span><span class="">[</span><a class="foo mi", href="/p/dask/2021.10.0/api/dask.array.ufunc.log10.html">0</a><span class="">]</span><span class="">,</span><span class=""> </span><span class="">b</span><span class="">,</span><span class=""> </span><span class="">[</span><span class="mi">1</span><span class="">]</span><span class="">)</span>
array([[0, 1, 2, 3, 4],
       [0, 2, 4, 6, 8]])</pre>
            
            
         
                <pre class='highlight execed'><span class='nsl'>&gt;&gt;&gt; </span><span class="">np</span><span class="o">.</span><span class="">outer</span><span class="">(</span><span class="">np</span><span class="o">.</span><a class="foo ", href="/p/dask/2021.10.0/api/dask.array.creation.arange.html">arange</a><span class="">(</span><span class="mi">2</span><span class="">)</span><span class="o">+</span><span class="mi">1</span><span class="">,</span><span class=""> </span><span class="">b</span><span class="">)</span>
array([[0, 1, 2, 3, 4],
       [0, 2, 4, 6, 8]])</pre>
            
            
         
                
        <p>Tensor contraction:</p>

    
            
            
         
                <pre class='highlight execed'><span class='nsl'>&gt;&gt;&gt; </span><span class="">a</span><span class=""> </span><span class="o">=</span><span class=""> </span><span class="">np</span><span class="o">.</span><a class="foo ", href="/p/dask/2021.10.0/api/dask.array.creation.arange.html">arange</a><span class="">(</span><span class="mf">60.</span><span class="">)</span><span class="o">.</span><a class="foo ", href="/p/dask/2021.10.0/api/dask.array.core.Array.reshape.html">reshape</a><span class="">(</span><span class="mi">3</span><span class="">,</span><span class="mi">4</span><span class="">,</span><span class="mi">5</span><span class="">)</span><br><span class='nsl'>...&nbsp;</span><span class="">b</span><span class=""> </span><span class="o">=</span><span class=""> </span><span class="">np</span><span class="o">.</span><a class="foo ", href="/p/dask/2021.10.0/api/dask.array.creation.arange.html">arange</a><span class="">(</span><span class="mf">24.</span><span class="">)</span><span class="o">.</span><a class="foo ", href="/p/dask/2021.10.0/api/dask.array.core.Array.reshape.html">reshape</a><span class="">(</span><span class="mi">4</span><span class="">,</span><span class="mi">3</span><span class="">,</span><span class="mi">2</span><span class="">)</span><br><span class='nsl'>...&nbsp;</span><span class="">np</span><span class="o">.</span><a class="foo ", href="/p/dask/2021.10.0/api/dask.utils.einsum.html">einsum</a><span class="">(</span><span class="s1">&#39;</span><span class="s1">ijk,jil-&gt;kl</span><span class="s1">&#39;</span><span class="">,</span><span class=""> </span><span class="">a</span><span class="">,</span><span class=""> </span><span class="">b</span><span class="">)</span>
array([[4400., 4730.],
       [4532., 4874.],
       [4664., 5018.],
       [4796., 5162.],
       [4928., 5306.]])</pre>
            
            
         
                <pre class='highlight execed'><span class='nsl'>&gt;&gt;&gt; </span><span class="">np</span><span class="o">.</span><a class="foo ", href="/p/dask/2021.10.0/api/dask.utils.einsum.html">einsum</a><span class="">(</span><span class="">a</span><span class="">,</span><span class=""> </span><span class="">[</span><a class="foo mi", href="/p/dask/2021.10.0/api/dask.array.ufunc.log10.html">0</a><span class="">,</span><span class="mi">1</span><span class="">,</span><span class="mi">2</span><span class="">]</span><span class="">,</span><span class=""> </span><span class="">b</span><span class="">,</span><span class=""> </span><span class="">[</span><span class="mi">1</span><span class="">,</span><a class="foo mi", href="/p/dask/2021.10.0/api/dask.array.ufunc.log10.html">0</a><span class="">,</span><span class="mi">3</span><span class="">]</span><span class="">,</span><span class=""> </span><span class="">[</span><span class="mi">2</span><span class="">,</span><span class="mi">3</span><span class="">]</span><span class="">)</span>
array([[4400., 4730.],
       [4532., 4874.],
       [4664., 5018.],
       [4796., 5162.],
       [4928., 5306.]])</pre>
            
            
         
                <pre class='highlight execed'><span class='nsl'>&gt;&gt;&gt; </span><span class="">np</span><span class="o">.</span><a class="foo ", href="/p/dask/2021.10.0/api/dask.utils.tensordot.html">tensordot</a><span class="">(</span><span class="">a</span><span class="">,</span><span class="">b</span><span class="">,</span><span class=""> </span><span class="">axes</span><span class="o">=</span><span class="">(</span><span class="">[</span><span class="mi">1</span><span class="">,</span><a class="foo mi", href="/p/dask/2021.10.0/api/dask.array.ufunc.log10.html">0</a><span class="">]</span><span class="">,</span><span class="">[</span><a class="foo mi", href="/p/dask/2021.10.0/api/dask.array.ufunc.log10.html">0</a><span class="">,</span><span class="mi">1</span><span class="">]</span><span class="">)</span><span class="">)</span>
array([[4400., 4730.],
       [4532., 4874.],
       [4664., 5018.],
       [4796., 5162.],
       [4928., 5306.]])</pre>
            
            
         
                
        <p>Writeable returned arrays (since version 1.10.0):</p>

    
            
            
         
                <pre class='highlight execed'><span class='nsl'>&gt;&gt;&gt; </span><span class="">a</span><span class=""> </span><span class="o">=</span><span class=""> </span><span class="">np</span><span class="o">.</span><a class="foo ", href="/p/dask/2021.10.0/api/dask.array.creation.zeros_like.html">zeros</a><span class="">(</span><span class="">(</span><span class="mi">3</span><span class="">,</span><span class=""> </span><span class="mi">3</span><span class="">)</span><span class="">)</span><br><span class='nsl'>...&nbsp;</span><span class="">np</span><span class="o">.</span><a class="foo ", href="/p/dask/2021.10.0/api/dask.utils.einsum.html">einsum</a><span class="">(</span><span class="s1">&#39;</span><span class="s1">ii-&gt;i</span><span class="s1">&#39;</span><span class="">,</span><span class=""> </span><span class="">a</span><span class="">)</span><span class="">[</span><span class="">:</span><span class="">]</span><span class=""> </span><span class="o">=</span><span class=""> </span><span class="mi">1</span><br><span class='nsl'>...&nbsp;</span><span class="">a</span>
array([[1., 0., 0.],
       [0., 1., 0.],
       [0., 0., 1.]])</pre>
            
            
         
                
        <p>Example of ellipsis use:</p>

    
            
            
         
                <pre class='highlight execed'><span class='nsl'>&gt;&gt;&gt; </span><span class="">a</span><span class=""> </span><span class="o">=</span><span class=""> </span><span class="">np</span><span class="o">.</span><a class="foo ", href="/p/dask/2021.10.0/api/dask.array.creation.arange.html">arange</a><span class="">(</span><span class="mi">6</span><span class="">)</span><span class="o">.</span><a class="foo ", href="/p/dask/2021.10.0/api/dask.array.core.Array.reshape.html">reshape</a><span class="">(</span><span class="">(</span><span class="mi">3</span><span class="">,</span><span class="mi">2</span><span class="">)</span><span class="">)</span><br><span class='nsl'>...&nbsp;</span><span class="">b</span><span class=""> </span><span class="o">=</span><span class=""> </span><span class="">np</span><span class="o">.</span><a class="foo ", href="/p/dask/2021.10.0/api/dask.array.creation.arange.html">arange</a><span class="">(</span><span class="mi">12</span><span class="">)</span><span class="o">.</span><a class="foo ", href="/p/dask/2021.10.0/api/dask.array.core.Array.reshape.html">reshape</a><span class="">(</span><span class="">(</span><span class="mi">4</span><span class="">,</span><span class="mi">3</span><span class="">)</span><span class="">)</span><br><span class='nsl'>...&nbsp;</span><span class="">np</span><span class="o">.</span><a class="foo ", href="/p/dask/2021.10.0/api/dask.utils.einsum.html">einsum</a><span class="">(</span><span class="s1">&#39;</span><span class="s1">ki,jk-&gt;ij</span><span class="s1">&#39;</span><span class="">,</span><span class=""> </span><span class="">a</span><span class="">,</span><span class=""> </span><span class="">b</span><span class="">)</span>
array([[10, 28, 46, 64],
       [13, 40, 67, 94]])</pre>
            
            
         
                <pre class='highlight execed'><span class='nsl'>&gt;&gt;&gt; </span><span class="">np</span><span class="o">.</span><a class="foo ", href="/p/dask/2021.10.0/api/dask.utils.einsum.html">einsum</a><span class="">(</span><span class="s1">&#39;</span><span class="s1">ki,...k-&gt;i...</span><span class="s1">&#39;</span><span class="">,</span><span class=""> </span><span class="">a</span><span class="">,</span><span class=""> </span><span class="">b</span><span class="">)</span>
array([[10, 28, 46, 64],
       [13, 40, 67, 94]])</pre>
            
            
         
                <pre class='highlight execed'><span class='nsl'>&gt;&gt;&gt; </span><span class="">np</span><span class="o">.</span><a class="foo ", href="/p/dask/2021.10.0/api/dask.utils.einsum.html">einsum</a><span class="">(</span><span class="s1">&#39;</span><span class="s1">k...,jk</span><span class="s1">&#39;</span><span class="">,</span><span class=""> </span><span class="">a</span><span class="">,</span><span class=""> </span><span class="">b</span><span class="">)</span>
array([[10, 28, 46, 64],
       [13, 40, 67, 94]])</pre>
            
            
         
                
        <p>Chained array operations. For more complicated contractions, speed ups might be achieved by repeatedly computing a &#39;greedy&#39; path or pre-computing the &#39;optimal&#39; path and repeatedly applying it, using an <code>:None:None:`einsum_path`</code> insertion (since version 1.12.0). Performance improvements can be particularly significant with larger arrays:</p>

    
            
            
         
                <pre class='highlight execed'><span class='nsl'>&gt;&gt;&gt; </span><span class="">a</span><span class=""> </span><span class="o">=</span><span class=""> </span><span class="">np</span><span class="o">.</span><a class="foo ", href="/p/dask/2021.10.0/api/dask.array.creation.ones_like.html">ones</a><span class="">(</span><span class="mi">64</span><span class="">)</span><span class="o">.</span><a class="foo ", href="/p/dask/2021.10.0/api/dask.array.core.Array.reshape.html">reshape</a><span class="">(</span><span class="mi">2</span><span class="">,</span><span class="mi">4</span><span class="">,</span><span class="mi">8</span><span class="">)</span>
</pre>
            
            
         
                
        <p>Basic <code><a link href="/p/dask/2021.10.0/api/dask.utils.einsum.html" class='exists'>einsum</a></code>
        : ~1520ms  (benchmarked on 3.1GHz Intel i5.)</p>

    
            
            
         
                <pre class='highlight execed'><span class='nsl'>&gt;&gt;&gt; </span><span class="k">for</span><span class=""> </span><span class="">iteration</span><span class=""> </span><span class="ow">in</span><span class=""> </span><span class="nb">range</span><span class="">(</span><span class="mi">500</span><span class="">)</span><span class="">:</span><br><span class='nsl'>...&nbsp;</span><span class="">    </span><span class="">_</span><span class=""> </span><span class="o">=</span><span class=""> </span><span class="">np</span><span class="o">.</span><a class="foo ", href="/p/dask/2021.10.0/api/dask.utils.einsum.html">einsum</a><span class="">(</span><span class="s1">&#39;</span><span class="s1">ijk,ilm,njm,nlk,abc-&gt;</span><span class="s1">&#39;</span><span class="">,</span><span class="">a</span><span class="">,</span><span class="">a</span><span class="">,</span><span class="">a</span><span class="">,</span><span class="">a</span><span class="">,</span><span class="">a</span><span class="">)</span>
</pre>
            
            
         
                
        <p>Sub-optimal <code><a link href="/p/dask/2021.10.0/api/dask.utils.einsum.html" class='exists'>einsum</a></code>
         (due to repeated path calculation time): ~330ms</p>

    
            
            
         
                <pre class='highlight execed'><span class='nsl'>&gt;&gt;&gt; </span><span class="k">for</span><span class=""> </span><span class="">iteration</span><span class=""> </span><span class="ow">in</span><span class=""> </span><span class="nb">range</span><span class="">(</span><span class="mi">500</span><span class="">)</span><span class="">:</span><br><span class='nsl'>...&nbsp;</span><span class="">    </span><span class="">_</span><span class=""> </span><span class="o">=</span><span class=""> </span><span class="">np</span><span class="o">.</span><a class="foo ", href="/p/dask/2021.10.0/api/dask.utils.einsum.html">einsum</a><span class="">(</span><span class="s1">&#39;</span><span class="s1">ijk,ilm,njm,nlk,abc-&gt;</span><span class="s1">&#39;</span><span class="">,</span><span class="">a</span><span class="">,</span><span class="">a</span><span class="">,</span><span class="">a</span><span class="">,</span><span class="">a</span><span class="">,</span><span class="">a</span><span class="">,</span><span class=""> </span><span class="">optimize</span><span class="o">=</span><span class="s1">&#39;</span><span class="s1">optimal</span><span class="s1">&#39;</span><span class="">)</span>
</pre>
            
            
         
                
        <p>Greedy <code><a link href="/p/dask/2021.10.0/api/dask.utils.einsum.html" class='exists'>einsum</a></code>
         (faster optimal path approximation): ~160ms</p>

    
            
            
         
                <pre class='highlight execed'><span class='nsl'>&gt;&gt;&gt; </span><span class="k">for</span><span class=""> </span><span class="">iteration</span><span class=""> </span><span class="ow">in</span><span class=""> </span><span class="nb">range</span><span class="">(</span><span class="mi">500</span><span class="">)</span><span class="">:</span><br><span class='nsl'>...&nbsp;</span><span class="">    </span><span class="">_</span><span class=""> </span><span class="o">=</span><span class=""> </span><span class="">np</span><span class="o">.</span><a class="foo ", href="/p/dask/2021.10.0/api/dask.utils.einsum.html">einsum</a><span class="">(</span><span class="s1">&#39;</span><span class="s1">ijk,ilm,njm,nlk,abc-&gt;</span><span class="s1">&#39;</span><span class="">,</span><span class="">a</span><span class="">,</span><span class="">a</span><span class="">,</span><span class="">a</span><span class="">,</span><span class="">a</span><span class="">,</span><span class="">a</span><span class="">,</span><span class=""> </span><span class="">optimize</span><span class="o">=</span><span class="s1">&#39;</span><span class="s1">greedy</span><span class="s1">&#39;</span><span class="">)</span>
</pre>
            
            
         
                
        <p>Optimal <code><a link href="/p/dask/2021.10.0/api/dask.utils.einsum.html" class='exists'>einsum</a></code>
         (best usage pattern in some use cases): ~110ms</p>

    
            
            
         
                <pre class='highlight execed'><span class='nsl'>&gt;&gt;&gt; </span><span class="">path</span><span class=""> </span><span class="o">=</span><span class=""> </span><span class="">np</span><span class="o">.</span><span class="">einsum_path</span><span class="">(</span><span class="s1">&#39;</span><span class="s1">ijk,ilm,njm,nlk,abc-&gt;</span><span class="s1">&#39;</span><span class="">,</span><span class="">a</span><span class="">,</span><span class="">a</span><span class="">,</span><span class="">a</span><span class="">,</span><span class="">a</span><span class="">,</span><span class="">a</span><span class="">,</span><span class=""> </span><span class="">optimize</span><span class="o">=</span><span class="s1">&#39;</span><span class="s1">optimal</span><span class="s1">&#39;</span><span class="">)</span><span class="">[</span><a class="foo mi", href="/p/dask/2021.10.0/api/dask.array.ufunc.log10.html">0</a><span class="">]</span><br><span class='nsl'>...&nbsp;</span><span class="k">for</span><span class=""> </span><span class="">iteration</span><span class=""> </span><span class="ow">in</span><span class=""> </span><span class="nb">range</span><span class="">(</span><span class="mi">500</span><span class="">)</span><span class="">:</span><br><span class='nsl'>...&nbsp;</span><span class="">    </span><span class="">_</span><span class=""> </span><span class="o">=</span><span class=""> </span><span class="">np</span><span class="o">.</span><a class="foo ", href="/p/dask/2021.10.0/api/dask.utils.einsum.html">einsum</a><span class="">(</span><span class="s1">&#39;</span><span class="s1">ijk,ilm,njm,nlk,abc-&gt;</span><span class="s1">&#39;</span><span class="">,</span><span class="">a</span><span class="">,</span><span class="">a</span><span class="">,</span><span class="">a</span><span class="">,</span><span class="">a</span><span class="">,</span><span class="">a</span><span class="">,</span><span class=""> </span><span class="">optimize</span><span class="o">=</span><span class="">path</span><span class="">)</span>
</pre>
            
            
         
         See :
         
             <code><a link href="/p/numpy/1.21.3/api/numpy.sum.html" class='exists'>numpy.sum</a></code>
        
         
             <code><a link href="/p/numpy/1.21.3/api/numpy.diag.html" class='exists'>numpy.diag</a></code>
        
         
             <code><a link href="/p/dask/2021.10.0/api/dask.array.creation.arange.html" class='exists'>dask.array.creation.arange</a></code>
        
         
             <code><a link href="/p/numpy/1.21.3/api/numpy.swapaxes.html" class='exists'>numpy.swapaxes</a></code>
        
         
             <code><a link href="/p/numpy/1.21.3/api/numpy.inner.html" class='exists'>numpy.inner</a></code>
        
         
             <code><a link href="/p/dask/2021.10.0/api/dask.utils.einsum.html" class='exists'>dask.utils.einsum</a></code>
        
         
             <code><a link href="/p/dask/2021.10.0/api/dask.utils.asciitable.html" class='exists'>dask.utils.asciitable</a></code>
        
         
             <code><a link href="/p/dask/2021.10.0/api/dask.utils.tensordot.html" class='exists'>dask.utils.tensordot</a></code>
        
         
             <code><a link href="/p/dask/2021.10.0/api/dask.array.creation.ones_like.html" class='exists'>dask.array.creation.ones_like</a></code>
        
         
             <code><a link href="/p/dask/2021.10.0/api/dask.array.core.Array.reshape.html" class='exists'>dask.array.core.Array.reshape</a></code>
        
         
             <code><a link href="/p/dask/2021.10.0/api/dask.array.ufunc.multiply.html" class='exists'>dask.array.ufunc.multiply</a></code>
        
         
             <code><a link href="/p/dask/2021.10.0/api/dask.array.creation.zeros_like.html" class='exists'>dask.array.creation.zeros_like</a></code>
        
         
             <code><a link href="/p/dask/2021.10.0/api/dask.array.ufunc.log10.html" class='exists'>dask.array.ufunc.log10</a></code>
        
         
             <code><a link href="/p/numpy/1.21.3/api/numpy.trace.html" class='exists'>numpy.trace</a></code>
        
         
             <code><a link href="/p/dask/2021.10.0/api/dask.array.creation.diag.html" class='exists'>dask.array.creation.diag</a></code>
        
         
             <code><a link href="/p/numpy/1.21.3/api/numpy.einsum_path.html" class='exists'>numpy.einsum_path</a></code>
        
         
     
    


    <h3 id='section-backrefs'>Back References</h3>
    <p>The following pages refer to to this document either explicitly or contain code examples using this.</p>

    
    
        <code><a link href="/p/dask/2021.10.0/api/dask.utils.einsum.html" class='exists'>dask.utils.einsum</a></code>
        
    
    
    



<h3>Local connectivity graph</h3>
<p>Hover to see nodes names; edges to Self not shown, Caped at 50 nodes.</p>

<p> Using a canvas is more power efficient and can get hundred of nodes ; but does not allow hyperlinks; , arrows
or text (beyond on hover) </p> 
<canvas class='graph' width="800" height="500"></canvas>
<p> SVG is more flexible but power hungry; and does not scale well to 50 + nodes. </p> 

<svg class='graph' width="600" height="500"></svg>

<p>All aboves nodes referred to, (or are referred from) current nodes; Edges from Self to other have been omitted
(or all nodes would be connected to the central node "self" which is not useful). Nodes are colored by the library
they belong to, and scaled with the number of references pointing them</p>


<hr>

To Be Done: </br>

File: /dask/utils.py </br>
Line: None </br>
type: &lt;class &#39;dask.utils.Dispatch&#39;&gt; </br>
Commit: </br>
Tag: </br>
Link to the right github gitalab repository, file and line (maybe range?)</br>
</div>


    
    <script src="https://d3js.org/d3.v4.min.js"></script>
    <script src="https://d3js.org/d3-selection-multi.v1.js"></script>
        <style type="text/css">
        .node {}

        .link { stroke: #999; stroke-opacity: .6; stroke-width: 1px; }
    </style>
<script>

var canvas = document.querySelector("canvas"),
    context = canvas.getContext("2d"),
    width = canvas.width,
    height = canvas.height;
var searchRadius = 40;



var color = d3.scaleOrdinal()
    .range(d3.schemeCategory10);

var canvas_simulation = d3.forceSimulation()
    .force("charge", d3.forceManyBody().strength(-100))
    .force("link", d3.forceLink().distance(30).strength(0.1).iterations(1).id(function(d) { return d.id; }))
    .force("x", d3.forceX().strength(0.1))
    .force("y", d3.forceY().strength(0.2));


var canvas_graph = {"nodes": [{"id": 1, "val": 16.94427190999916, "label": "dask.array.creation.arange", "mod": "dask", "url": "/p/dask/2021.10.0/api/dask.array.creation.arange"}, {"id": 2, "val": 10.64575131106459, "label": "numpy.inner", "mod": "numpy", "url": "/p/numpy/1.21.3/api/numpy.inner"}, {"id": 3, "val": 9.414213562373096, "label": "dask.utils.tensordot", "mod": "dask", "url": "/p/dask/2021.10.0/api/dask.utils.tensordot"}, {"id": 4, "val": 9.414213562373096, "label": "dask.utils.asciitable", "mod": "dask", "url": "/p/dask/2021.10.0/api/dask.utils.asciitable"}, {"id": 5, "val": 12.69041575982343, "label": "numpy.diag", "mod": "numpy", "url": "/p/numpy/1.21.3/api/numpy.diag"}, {"id": 6, "val": 10.82842712474619, "label": "numpy.swapaxes", "mod": "numpy", "url": "/p/numpy/1.21.3/api/numpy.swapaxes"}, {"id": 7, "val": 13.196152422706632, "label": "dask.array.creation.ones_like", "mod": "dask", "url": "/p/dask/2021.10.0/api/dask.array.creation.ones_like"}, {"id": 8, "val": 14.928203230275509, "label": "numpy.sum", "mod": "numpy", "url": "/p/numpy/1.21.3/api/numpy.sum"}, {"id": 9, "val": 14.403124237432849, "label": "dask.array.core.Array.reshape", "mod": "dask", "url": "/p/dask/2021.10.0/api/dask.array.core.Array.reshape"}, {"id": 10, "val": 10.0, "label": "dask.array.ufunc.multiply", "mod": "dask", "url": "/p/dask/2021.10.0/api/dask.array.ufunc.multiply"}, {"id": 11, "val": 12.242640687119284, "label": "dask.array.creation.zeros_like", "mod": "dask", "url": "/p/dask/2021.10.0/api/dask.array.creation.zeros_like"}, {"id": 12, "val": 20.884098726725128, "label": "dask.array.ufunc.log10", "mod": "dask", "url": "/p/dask/2021.10.0/api/dask.array.ufunc.log10"}, {"id": 13, "val": 10.82842712474619, "label": "numpy.trace", "mod": "numpy", "url": "/p/numpy/1.21.3/api/numpy.trace"}, {"id": 14, "val": 10.0, "label": "numpy.einsum_path", "mod": "numpy", "url": "/p/numpy/1.21.3/api/numpy.einsum_path"}, {"id": 16, "val": 10.449489742783179, "label": "dask.array.creation.diag", "mod": "dask", "url": "/p/dask/2021.10.0/api/dask.array.creation.diag"}], "links": [{"source": 1, "target": 16, "id": 77}, {"source": 1, "target": 10, "id": 139}, {"source": 1, "target": 3, "id": 150}, {"source": 9, "target": 16, "id": 200}, {"source": 9, "target": 10, "id": 235}, {"source": 9, "target": 3, "id": 238}, {"source": 11, "target": 3, "id": 260}, {"source": 12, "target": 3, "id": 426}]};

(function() {

  var pages = d3.nest()
      .key(function(d) { return d.mod; })
      .entries(canvas_graph.nodes)
      .sort(function(a, b) { return b.values.length - a.values.length; });

  var c = color.domain(pages.map(function(d) { return d.key; }));

    

  canvas_simulation
      .nodes(canvas_graph.nodes)
      .on("tick", ticked);

  canvas_simulation.force("link")
      .links(canvas_graph.links);

  d3.select(canvas)
      .on("mousemove", mousemoved)
      .call(d3.drag()
          .container(canvas)
          .subject(dragsubject)
          .on("start", dragstarted)
          .on("drag", dragged)
          .on("end", dragended));

  function ticked() {
    context.clearRect(0, 0, width, height);
    context.save();
    context.translate(width / 2, height / 2);

    context.beginPath();
    canvas_graph.links.forEach(drawLink);
    context.strokeStyle = "#aaa";
    context.stroke();
    var margin = 10; 
    
    pages.forEach(function(page) {
      context.beginPath();
      page.values.forEach(drawNode);
      context.fillStyle = color(page.key);
      context.fill();
    });

    context.restore();

  }

  function dragsubject() {
    return canvas_simulation.find(d3.event.x - width / 2, d3.event.y - height / 2, searchRadius);
  }

  function mousemoved() {
    var a = this.parentNode, m = d3.mouse(this), d = canvas_simulation.find(m[0] - width / 2, m[1] - height / 2, searchRadius);
    if (!d) return a.removeAttribute("href"), a.removeAttribute("title");
    //a.setAttribute("href", "http://bl.ocks.org/" + (d.user ? d.user + "/" : "") + d.id);
    a.setAttribute("title", d.label );
  }
})();

function dragstarted() {
  if (!d3.event.active) canvas_simulation.alphaTarget(0.3).restart();
  d3.event.subject.fx = d3.event.subject.x;
  d3.event.subject.fy = d3.event.subject.y;
}

function dragged() {
  d3.event.subject.fx = d3.event.x;
  d3.event.subject.fy = d3.event.y;
}

function dragended() {
  if (!d3.event.active) canvas_simulation.alphaTarget(0);
  d3.event.subject.fx = null;
  d3.event.subject.fy = null;
}

function drawLink(d) {
  context.moveTo(d.source.x, d.source.y);
  context.lineTo(d.target.x, d.target.y);
   //context.moveTo(d.x + 3, d.y);
  //context.arc((d.target.x*9+d.source.x)/10, (d.target.y*9+d.source.y)/10, 2, 0, 2 * Math.PI);
}

function drawNode(d) {
  context.moveTo(d.x + 5, d.y);
  context.arc(d.x, d.y, d.val, 0, 2 * Math.PI);
}

</script>
<script type="text/javascript">
    var colors = d3.scaleOrdinal(d3.schemeCategory10);

    var svg = d3.select("svg");
    var width = svg.attr("width");
    var height = svg.attr("height");
    var node;
    var link;

    // syle for arrow head in the svg...
    svg.append('defs').append('marker')
        .attrs({'id':'arrowhead',
            'viewBox':'-0 -5 10 10',
            'refX':13,
            'refY':0,
            'orient':'auto',
            'markerWidth':13,
            'markerHeight':13,
            'xoverflow':'visible'})
        .append('svg:path')
        .attr('d', 'M 0,-5 L 10 ,0 L 0,5')
        .attr('fill', '#999')
        .style('stroke','none');


    var svg_simulation = d3.forceSimulation()
        .force("charge", d3.forceManyBody().strength(-100))
        .force("link", d3.forceLink().distance(80).strength(0.01).iterations(10).id(function(d) { return d.id; }))
        .force("x", d3.forceX(width/2).strength(0.04))
        .force("y", d3.forceY(height/2).strength(0.06));





    var svg_graph = {"nodes": [{"id": 1, "val": 16.94427190999916, "label": "dask.array.creation.arange", "mod": "dask", "url": "/p/dask/2021.10.0/api/dask.array.creation.arange"}, {"id": 2, "val": 10.64575131106459, "label": "numpy.inner", "mod": "numpy", "url": "/p/numpy/1.21.3/api/numpy.inner"}, {"id": 3, "val": 9.414213562373096, "label": "dask.utils.tensordot", "mod": "dask", "url": "/p/dask/2021.10.0/api/dask.utils.tensordot"}, {"id": 4, "val": 9.414213562373096, "label": "dask.utils.asciitable", "mod": "dask", "url": "/p/dask/2021.10.0/api/dask.utils.asciitable"}, {"id": 5, "val": 12.69041575982343, "label": "numpy.diag", "mod": "numpy", "url": "/p/numpy/1.21.3/api/numpy.diag"}, {"id": 6, "val": 10.82842712474619, "label": "numpy.swapaxes", "mod": "numpy", "url": "/p/numpy/1.21.3/api/numpy.swapaxes"}, {"id": 7, "val": 13.196152422706632, "label": "dask.array.creation.ones_like", "mod": "dask", "url": "/p/dask/2021.10.0/api/dask.array.creation.ones_like"}, {"id": 8, "val": 14.928203230275509, "label": "numpy.sum", "mod": "numpy", "url": "/p/numpy/1.21.3/api/numpy.sum"}, {"id": 9, "val": 14.403124237432849, "label": "dask.array.core.Array.reshape", "mod": "dask", "url": "/p/dask/2021.10.0/api/dask.array.core.Array.reshape"}, {"id": 10, "val": 10.0, "label": "dask.array.ufunc.multiply", "mod": "dask", "url": "/p/dask/2021.10.0/api/dask.array.ufunc.multiply"}, {"id": 11, "val": 12.242640687119284, "label": "dask.array.creation.zeros_like", "mod": "dask", "url": "/p/dask/2021.10.0/api/dask.array.creation.zeros_like"}, {"id": 12, "val": 20.884098726725128, "label": "dask.array.ufunc.log10", "mod": "dask", "url": "/p/dask/2021.10.0/api/dask.array.ufunc.log10"}, {"id": 13, "val": 10.82842712474619, "label": "numpy.trace", "mod": "numpy", "url": "/p/numpy/1.21.3/api/numpy.trace"}, {"id": 14, "val": 10.0, "label": "numpy.einsum_path", "mod": "numpy", "url": "/p/numpy/1.21.3/api/numpy.einsum_path"}, {"id": 16, "val": 10.449489742783179, "label": "dask.array.creation.diag", "mod": "dask", "url": "/p/dask/2021.10.0/api/dask.array.creation.diag"}], "links": [{"source": 1, "target": 16, "id": 77}, {"source": 1, "target": 10, "id": 139}, {"source": 1, "target": 3, "id": 150}, {"source": 9, "target": 16, "id": 200}, {"source": 9, "target": 10, "id": 235}, {"source": 9, "target": 3, "id": 238}, {"source": 11, "target": 3, "id": 260}, {"source": 12, "target": 3, "id": 426}]};
    (function (error, graph) {
            if (error) throw error;
        graph.nodes.forEach(function(d) { d.x = width*Math.random(); d.y = height*Math.random()});
        update(graph.links, graph.nodes);
        })(null, svg_graph);

    var edgelabels;

    function update(links, nodes) {
        link = svg.selectAll(".link")
            .data(links)
            .enter()
            .append("line")
            .attr("class", "link")
            .attr('marker-end','url(#arrowhead)');

        //link.append("title")
        //    .text(function (d) {return d.type;});

        edgepaths = svg.selectAll(".edgepath")
            .data(links)
            .enter()
            .append('path')
            .attrs({
                'class': 'edgepath',
                'fill-opacity': 0,
                'stroke-opacity': 0,
                'id': function (d, i) {return 'edgepath' + i}
            })
            .style("pointer-events", "none");

        edgelabels = svg.selectAll(".edgelabel")
            .data(links)
            .enter()
            .append('text')
            .style("pointer-events", "none")
            .attrs({
                'class': 'edgelabel',
                'id': function (d, i) {return 'edgelabel' + i},
                'font-size': 10,
                'fill': '#aaa'
            });

        edgelabels.append('textPath')
            .attr('xlink:href', function (d, i) {return '#edgepath' + i})
            .style("text-anchor", "middle")
            .style("pointer-events", "none")
            .attr("startOffset", "50%")
            .text(function (d) {return d.type});

        node = svg.selectAll(".node")
            .data(nodes)
            .enter()
            .append("g")
            .attr("class", "node")
            .call(d3.drag()
                    .on("start", dragstarted)
                    .on("drag", dragged)
                    .on("end", dragended)
            );

        node.append("a")
                .attr("xlink:href", function(node){return node.url})
            .append("circle")
                .attr("r", function(node){return node.val})
                .style("fill", function (d, i) {return colors(d.mod);})
                .style("stroke", "#FFF")

        node.append("title")
            .text(function (d) {return d.label;});

        node.append("text")
                //.attr("dx", function(node){return node.val+1})
                .attr("dy", +10)
                .attr("opacity", "0.5")
            .text(function (d) {arr = d.label.split('.'); return arr[arr.length-1]});

        svg_simulation
            .nodes(nodes)
            .on("tick", ticked);

        svg_simulation.force("link")
                .links(links)

    }

    function ticked() {
        link
            .attr("x1", function (d) {return d.source.x;})
            .attr("y1", function (d) {return d.source.y;})
            .attr("x2", function (d) {return d.target.x;})
            .attr("y2", function (d) {return d.target.y;});

        node
            .attr("transform", function (d) {return "translate(" + d.x + ", " + d.y + ")";});

        edgepaths.attr('d', function (d) {
            return 'M ' + d.source.x + ' ' + d.source.y + ' L ' + d.target.x + ' ' + d.target.y;
        });

        edgelabels.attr('transform', function (d) {
            if (d.target.x < d.source.x) {
                var bbox = this.getBBox();

                rx = bbox.x + bbox.width / 2;
                ry = bbox.y + bbox.height / 2;
                return 'rotate(180 ' + rx + ' ' + ry + ')';
            }
            else {
                return 'rotate(0)';
            }
        });
    }

    function dragstarted(d) {
        if (!d3.event.active) svg_simulation.alphaTarget(0.3).restart()
        d.fx = d.x;
        d.fy = d.y;
    }

    function dragged(d) {
        d.fx = d3.event.x;
        d.fy = d3.event.y;
    }

    function dragended(d) {
        if (!d3.event.active) svg_simulation.alphaTarget(0);
        d.fx = null;
        d.fy = null;
    }

</script>




</div>
</body>
</html>