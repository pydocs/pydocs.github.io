<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <link rel="icon" href="/favicon.ico" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
    <link rel="stylesheet"
          href="https://use.fontawesome.com/releases/v5.8.1/css/all.css"
          integrity="sha384-50oBUHEmvpQ+1lW4y57PTFmhCaXp0ML5d60M1M7uH2+nqUivzIebhndOJK28anvf"
          crossorigin="anonymous">
    
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@exampledev/new.css@1.1.2/new.min.css">
    <script type="text/x-mathjax-config">
      // this should process only math inside  span with tex2jax_process class
      MathJax.Hub.Config({
          extensions: ["tex2jax.js"],
          jax: ["input/TeX", "output/HTML-CSS"],
          tex2jax: {
          inlineMath: [ ['$','$'], ["\\(","\\)"] ],
          displayMath: [ ['$$','$$'], ["\\[","\\]"] ],
          processEscapes: true
          },
          "HTML-CSS": { fonts: ["TeX"] }
      });
    </script>
    <script async
        src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/MathJax.js">
    </script>
    <link rel="stylesheet" href="/papyri.css">
    <link rel="stylesheet" href="/pygments.css">
<style>

    header > brand {
        /*border-right: 1px solid #ccc;
          border-left: 1px solid #ccc;*/
        margin-left: 15px;
        padding: 0px;
        display: inline-block; 
        width: 67px;
    }

    brand > a {
        text-decoration: None;

    }
    brand >a> img {
            display: inline-block;
    margin: 0;
    padding: 0;
    position: relative;
    bottom: -10px;

   }
    .container {
       max-width: 800px;
       padding-left: 210px;
       padding-top: 30px;
    }
</style>
</head><body class="tex2jax_ignore">
    <header>
        <brand><a href='/'><img src='/favicon.ico'/></a></brand>
        <nav> / <a href='/' >p</a>  &nbsp;/&nbsp; 
                <div class="dropdown">
                <a href=astropy>astropy</a>&nbsp;/&nbsp;
                    <div class="dropdown-content">
<a href="/p/IPython/8.2.0/api/IPython.html">IPython</a>
<a href="/p/astropy/5.0/api/astropy.html">astropy</a>
<a href="/p/dask/2021.10.0/api/dask.html">dask</a>
<a href="/p/distributed/2021.10.0/api/distributed.html">distributed</a>
<a href="/p/matplotlib/3.5.1/api/matplotlib.html">matplotlib</a>
<a href="/p/networkx/2.7.2rc1.dev0/api/networkx.html">networkx</a>
<a href="/p/numpy/1.22.3/api/numpy.html">numpy</a>
<a href="/p/pandas/1.4.1/api/pandas.html">pandas</a>
<a href="/p/papyri/0.0.8/api/papyri.html">papyri</a>
<a href="/p/scipy/1.8.0/api/scipy.html">scipy</a>
<a href="/p/skimage/0.17.2/api/skimage.html">skimage</a>
                     </div>
                </div>
                <div class="dropdown">
                <a href='/p/astropy/5.0/api/astropy.html'>5.0</a>&nbsp;/&nbsp;
                    <div class="dropdown-content">
<a href="/p/astropy/5.0/api/astropy.html">5.0</a>
                    </div>
                </div>

                <div class="dropdown">
                    <a href='/p/astropy/5.0/api/astropy.html'>API</a>&nbsp;/&nbsp;
                    <div class="dropdown-content">
                        <a href="/p/astropy/5.0/api/astropy.html">API</a>
                        <a href="/p/astropy/5.0/gallery">Gallery</a>
                        <a href="/p/astropy/5.0/examples">Examples</a>
                        <a href="/p/astropy/5.0/docs">Narrative</a>
                     </div>
                </div>

                    <div class="dropdown">
                            <a class="dropbtn" href='astropy.html'>astropy</a>.                    </div><!--end dropdown-->
                    <div class="dropdown">
                            <a class="dropbtn" href='astropy.io.html'>io</a>.                            <div class="dropdown-content">
<a href="/p/?/?/?/astropy.TestRunnerBase.html.html">TestRunnerBase</a>
<a href="/p/astropy/5.0/api/astropy.astronomical_constants.html">astronomical_constants</a>
<a href="/p/astropy/5.0/api/astropy.config.html">config</a>
<a href="/p/astropy/5.0/api/astropy.extern.html">extern</a>
<a href="/p/astropy/5.0/api/astropy.io.html">io</a>
<a href="/p/astropy/5.0/api/astropy.logger.html">logger</a>
<a href="/p/astropy/5.0/api/astropy.online_help.html">online_help</a>
<a href="/p/astropy/5.0/api/astropy.physical_constants.html">physical_constants</a>
<a href="/p/astropy/5.0/api/astropy.tests.html">tests</a>
<a href="/p/astropy/5.0/api/astropy.utils.html">utils</a>
<a href="/p/astropy/5.0/api/astropy.version.html">version</a>
                            </div>
                    </div><!--end dropdown-->
                    <div class="dropdown">
                            <a class="dropbtn" href='astropy.io.fits.html'>fits</a>.                            <div class="dropdown-content">
<a href="/p/astropy/5.0/api/astropy.io.fits.html">fits</a>
                            </div>
                    </div><!--end dropdown-->
                    <div class="dropdown">
                            <a class="dropbtn" href='astropy.io.fits.hdu.html'>hdu</a>.                            <div class="dropdown-content">
<a href="/p/astropy/5.0/api/astropy.io.fits.Conf.html">Conf</a>
<a href="/p/astropy/5.0/api/astropy.io.fits._utils.html">_utils</a>
<a href="/p/astropy/5.0/api/astropy.io.fits.card.html">card</a>
<a href="/p/astropy/5.0/api/astropy.io.fits.column.html">column</a>
<a href="/p/astropy/5.0/api/astropy.io.fits.compression.html">compression</a>
<a href="/p/astropy/5.0/api/astropy.io.fits.convenience.html">convenience</a>
<a href="/p/astropy/5.0/api/astropy.io.fits.diff.html">diff</a>
<a href="/p/astropy/5.0/api/astropy.io.fits.file.html">file</a>
<a href="/p/astropy/5.0/api/astropy.io.fits.fitsrec.html">fitsrec</a>
<a href="/p/astropy/5.0/api/astropy.io.fits.hdu.html">hdu</a>
<a href="/p/astropy/5.0/api/astropy.io.fits.header.html">header</a>
<a href="/p/astropy/5.0/api/astropy.io.fits.util.html">util</a>
<a href="/p/astropy/5.0/api/astropy.io.fits.verify.html">verify</a>
                            </div>
                    </div><!--end dropdown-->
                    <div class="dropdown">
                            <a class="dropbtn" href='astropy.io.fits.hdu.compressed.html'>compressed</a>.                            <div class="dropdown-content">
<a href="/p/astropy/5.0/api/astropy.io.fits.hdu.base.html">base</a>
<a href="/p/astropy/5.0/api/astropy.io.fits.hdu.compressed.html">compressed</a>
<a href="/p/astropy/5.0/api/astropy.io.fits.hdu.groups.html">groups</a>
<a href="/p/astropy/5.0/api/astropy.io.fits.hdu.hdulist.html">hdulist</a>
<a href="/p/astropy/5.0/api/astropy.io.fits.hdu.image.html">image</a>
<a href="/p/astropy/5.0/api/astropy.io.fits.hdu.nonstandard.html">nonstandard</a>
<a href="/p/astropy/5.0/api/astropy.io.fits.hdu.streaming.html">streaming</a>
<a href="/p/astropy/5.0/api/astropy.io.fits.hdu.table.html">table</a>
                            </div>
                    </div><!--end dropdown-->
                    <div class="dropdown">
                            <a class="dropbtn" href='astropy.io.fits.hdu.compressed.CompImageHDU.html'>CompImageHDU</a>.                            <div class="dropdown-content">
<a href="/p/astropy/5.0/api/astropy.io.fits.hdu.compressed.CompImageHDU.html">CompImageHDU</a>
<a href="/p/astropy/5.0/api/astropy.io.fits.hdu.compressed.CompImageHeader.html">CompImageHeader</a>
                            </div>
                    </div><!--end dropdown-->
                    <div class="dropdown">
                            <a class="dropbtn" href='astropy.io.fits.hdu.compressed.CompImageHDU.__init__.html'>__init__</a>                            <div class="dropdown-content">
<a href="/p/astropy/5.0/api/astropy.io.fits.hdu.compressed.CompImageHDU.__init__.html">__init__</a>
<a href="/p/astropy/5.0/api/astropy.io.fits.hdu.compressed.CompImageHDU._close.html">_close</a>
<a href="/p/astropy/5.0/api/astropy.io.fits.hdu.compressed.CompImageHDU._dtype_for_bitpix.html">_dtype_for_bitpix</a>
<a href="/p/astropy/5.0/api/astropy.io.fits.hdu.compressed.CompImageHDU._generate_dither_seed.html">_generate_dither_seed</a>
<a href="/p/astropy/5.0/api/astropy.io.fits.hdu.compressed.CompImageHDU._prewriteto.html">_prewriteto</a>
<a href="/p/astropy/5.0/api/astropy.io.fits.hdu.compressed.CompImageHDU._remove_unnecessary_default_extnames.html">_remove_unnecessary_default_extnames</a>
<a href="/p/astropy/5.0/api/astropy.io.fits.hdu.compressed.CompImageHDU._summary.html">_summary</a>
<a href="/p/astropy/5.0/api/astropy.io.fits.hdu.compressed.CompImageHDU._update_compressed_data.html">_update_compressed_data</a>
<a href="/p/astropy/5.0/api/astropy.io.fits.hdu.compressed.CompImageHDU._update_header_data.html">_update_header_data</a>
<a href="/p/astropy/5.0/api/astropy.io.fits.hdu.compressed.CompImageHDU._update_header_scale_info.html">_update_header_scale_info</a>
<a href="/p/astropy/5.0/api/astropy.io.fits.hdu.compressed.CompImageHDU._writedata.html">_writedata</a>
<a href="/p/astropy/5.0/api/astropy.io.fits.hdu.compressed.CompImageHDU._writeheader.html">_writeheader</a>
<a href="/p/astropy/5.0/api/astropy.io.fits.hdu.compressed.CompImageHDU.scale.html">scale</a>
                            </div>
                    </div><!--end dropdown-->
</nav>
    </header>
<div class='container'>
    <div class="sidenav">
        <img src="/p/astropy/5.0/img/astropy_project_logo.svg"/>
    <a href="#">astropy</a>
    <a href="#">5.0</a>
    <hr/>
    <hr/>
<a href="#section-Notes">Notes</a><a href="#section-Parameters">Parameters</a>    </div><!--end sidenav-->







<code class='signature'>__init__(self, data=None, header=None, name=None, compression_type=&#39;RICE_1&#39;, tile_size=None, hcomp_scale=0, hcomp_smooth=0, quantize_level=16.0, quantize_method=-1, dither_seed=0, do_not_scale_image_data=False, uint=False, scale_back=False, **kwargs)</code><!-- rendering Extended Summary -->
        <h3 id="section-Notes">Notes</h3>
<!-- rendering Notes -->
                       <p>The astropy.io.fits package supports 2 methods of image compression:</p>

                           <blockquote>           <ol>               <li>               <p>The entire FITS file may be externally compressed with the gzip        or pkzip utility programs, producing a         <code class='verbatim'>*.gz</code>
 or         <code class='verbatim'>*.zip</code>
        file, respectively.  When reading compressed files of this type,        Astropy first uncompresses the entire file into a temporary file        before performing the requested read operations.  The        astropy.io.fits package does not support writing to these types        of compressed files.  This type of compression is supported in        the         <code class='verbatim'>_File</code>
 class, not in the <code><a href="/p/astropy/5.0/api/astropy.io.fits.hdu.compressed.CompImageHDU.html" class='exists'>CompImageHDU</a></code>
 class.  The file        compression type is recognized by the         <code class='verbatim'>.gz</code>
 or         <code class='verbatim'>.zip</code>
 file        name extension.</p>

</li>
               <li>               <p>The <code><a href="/p/astropy/5.0/api/astropy.io.fits.hdu.compressed.CompImageHDU.html" class='exists'>CompImageHDU</a></code>
 class supports the FITS tiled image        compression convention in which the image is subdivided into a        grid of rectangular tiles, and each tile of pixels is        individually compressed.  The details of this FITS compression        convention are described at the <a link href="https://fits.gsfc.nasa.gov/registry/tilecompression.html" class='external'>FITS Support Office web site</a>.        Basically, the compressed image tiles are stored in rows of a        variable length array column in a FITS binary table.  The        astropy.io.fits recognizes that this binary table extension        contains an image and treats it as if it were an image        extension.  Under this tile-compression format, FITS header        keywords remain uncompressed.  At this time, Astropy does not        support the ability to extract and uncompress sections of the        image without having to uncompress the entire image.</p>

</li>
            </ol>
</blockquote>

               <p>The astropy.io.fits package supports 3 general-purpose compression algorithms plus one other special-purpose compression technique that is designed for data masks with positive integer pixel values.  The 3 general purpose algorithms are GZIP, Rice, and HCOMPRESS, and the special-purpose technique is the IRAF pixel list compression technique (PLIO).  The         <code class='verbatim'>compression_type</code>
 parameter defines the compression algorithm to be used.</p>

               <p>The FITS image can be subdivided into any desired rectangular grid of compression tiles.  With the GZIP, Rice, and PLIO algorithms, the default is to take each row of the image as a tile.  The HCOMPRESS algorithm is inherently 2-dimensional in nature, so the default in this case is to take 16 rows of the image per tile.  In most cases, it makes little difference what tiling pattern is used, so the default tiles are usually adequate.  In the case of very small images, it could be more efficient to compress the whole image as a single tile.  Note that the image dimensions are not required to be an integer multiple of the tile dimensions; if not, then the tiles at the edges of the image will be smaller than the other tiles.  The         <code class='verbatim'>tile_size</code>
 parameter may be provided as a list of tile sizes, one for each dimension in the image. For example a         <code class='verbatim'>tile_size</code>
 value of         <code class='verbatim'>[100,100]</code>
 would divide a 300 X 300 image into 9 100 X 100 tiles.</p>

               <p>The 4 supported image compression algorithms are all &#39;lossless&#39; when applied to integer FITS images; the pixel values are preserved exactly with no loss of information during the compression and uncompression process.  In addition, the HCOMPRESS algorithm supports a &#39;lossy&#39; compression mode that will produce larger amount of image compression. This is achieved by specifying a non-zero value for the         <code class='verbatim'>hcomp_scale</code>
 parameter.  Since the amount of compression that is achieved depends directly on the RMS noise in the image, it is usually more convenient to specify the         <code class='verbatim'>hcomp_scale</code>
 factor relative to the RMS noise. Setting         <code class='verbatim'>hcomp_scale = 2.5</code>
 means use a scale factor that is 2.5 times the calculated RMS noise in the image tile.  In some cases it may be desirable to specify the exact scaling to be used, instead of specifying it relative to the calculated noise value.  This may be done by specifying the negative of the desired scale value (typically in the range -2 to -100).</p>

               <p>Very high compression factors (of 100 or more) can be achieved by using large         <code class='verbatim'>hcomp_scale</code>
 values, however, this can produce undesirable &#39;blocky&#39; artifacts in the compressed image.  A variation of the HCOMPRESS algorithm (called HSCOMPRESS) can be used in this case to apply a small amount of smoothing of the image when it is uncompressed to help cover up these artifacts.  This smoothing is purely cosmetic and does not cause any significant change to the image pixel values. Setting the         <code class='verbatim'>hcomp_smooth</code>
 parameter to 1 will engage the smoothing algorithm.</p>

               <p>Floating point FITS images (which have         <code class='verbatim'>BITPIX</code>
 = -32 or -64) usually contain too much &#39;noise&#39; in the least significant bits of the mantissa of the pixel values to be effectively compressed with any lossless algorithm.  Consequently, floating point images are first quantized into scaled integer pixel values (and thus throwing away much of the noise) before being compressed with the specified algorithm (either GZIP, RICE, or HCOMPRESS).  This technique produces much higher compression factors than simply using the GZIP utility to externally compress the whole FITS file, but it also means that the original floating point value pixel values are not exactly preserved.  When done properly, this integer scaling technique will only discard the insignificant noise while still preserving all the real information in the image.  The amount of precision that is retained in the pixel values is controlled by the         <code class='verbatim'>quantize_level</code>
 parameter.  Larger values will result in compressed images whose pixels more closely match the floating point pixel values, but at the same time the amount of compression that is achieved will be reduced.  Users should experiment with different values for this parameter to determine the optimal value that preserves all the useful information in the image, without needlessly preserving all the &#39;noise&#39; which will hurt the compression efficiency.</p>

               <p>The default value for the         <code class='verbatim'>quantize_level</code>
 scale factor is 16, which means that scaled integer pixel values will be quantized such that the difference between adjacent integer values will be 1/16th of the noise level in the image background.  An optimized algorithm is used to accurately estimate the noise in the image.  As an example, if the RMS noise in the background pixels of an image = 32.0, then the spacing between adjacent scaled integer pixel values will equal 2.0 by default. Note that the RMS noise is independently calculated for each tile of the image, so the resulting integer scaling factor may fluctuate slightly for each tile.  In some cases, it may be desirable to specify the exact quantization level to be used, instead of specifying it relative to the calculated noise value.  This may be done by specifying the negative of desired quantization level for the value of         <code class='verbatim'>quantize_level</code>
.  In the previous example, one could specify         <code class='verbatim'>quantize_level = -2.0</code>
 so that the quantized integer levels differ by 2.0.  Larger negative values for         <code class='verbatim'>quantize_level</code>
 means that the levels are more coarsely-spaced, and will produce higher compression factors.</p>

               <p>The quantization algorithm can also apply one of two random dithering methods in order to reduce bias in the measured intensity of background regions.  The default method, specified with the constant         <code class='verbatim'>SUBTRACTIVE_DITHER_1</code>
 adds dithering to the zero-point of the quantization array itself rather than adding noise to the actual image. The random noise is added on a pixel-by-pixel basis, so in order restore each pixel from its integer value to its floating point value it is necessary to replay the same sequence of random numbers for each pixel (see below).  The other method,         <code class='verbatim'>SUBTRACTIVE_DITHER_2</code>
, is exactly like the first except that before dithering any pixel with a floating point value of         <code class='verbatim'>0.0</code>
 is replaced with the special integer value         <code class='verbatim'>-2147483647</code>
.  When the image is uncompressed, pixels with this value are restored back to         <code class='verbatim'>0.0</code>
 exactly.  Finally, a value of         <code class='verbatim'>NO_DITHER</code>
 disables dithering entirely.</p>

               <p>As mentioned above, when using the subtractive dithering algorithm it is necessary to be able to generate a (pseudo-)random sequence of noise for each pixel, and replay that same sequence upon decompressing.  To facilitate this, a random seed between 1 and 10000 (inclusive) is used to seed a random number generator, and that seed is stored in the         <code class='verbatim'>ZDITHER0</code>
 keyword in the header of the compressed HDU.  In order to use that seed to generate the same sequence of random numbers the same random number generator must be used at compression and decompression time; for that reason the tiled image convention provides an implementation of a very simple pseudo-random number generator.  The seed itself can be provided in one of three ways, controllable by the         <code class='verbatim'>dither_seed</code>
 argument:  It may be specified manually, or it may be generated arbitrarily based on the system&#39;s clock (        <code class='verbatim'>DITHER_SEED_CLOCK</code>
) or based on a checksum of the pixels in the image&#39;s first tile (        <code class='verbatim'>DITHER_SEED_CHECKSUM</code>
).  The clock-based method is the default, and is sufficient to ensure that the value is reasonably &#34;arbitrary&#34; and that the same seed is unlikely to be generated sequentially.  The checksum method, on the other hand, ensures that the same seed is used every time for a specific image. This is particularly useful for software testing as it ensures that the same image will always use the same seed.</p>

<h3 id="section-Parameters">Parameters</h3>
<dl>
<dt><a id="data">data</a> : array, optional</dt>
<dd>
<p>Uncompressed image data</p>

</dd>
<dt><a id="header">header</a> : `~astropy.io.fits.Header`, optional</dt>
<dd>
<p>Header to be associated with the image; when reading the HDU from a file (data=DELAYED), the header read from the file</p>

</dd>
<dt><a id="name">name</a> : str, optional</dt>
<dd>
<p>The         <code class='verbatim'>EXTNAME</code>
 value; if this value is <code class='not-implemented'>:None:None:`None`</code>, then the name from the input image header will be used; if there is no name in the input image header then the default name         <code class='verbatim'>COMPRESSED_IMAGE</code>
 is used.</p>

</dd>
<dt><a id="compression_type">compression_type</a> : str, optional</dt>
<dd>
<p>Compression algorithm: one of         <code class='verbatim'>&#39;RICE_1&#39;</code>
,         <code class='verbatim'>&#39;RICE_ONE&#39;</code>
,         <code class='verbatim'>&#39;PLIO_1&#39;</code>
,         <code class='verbatim'>&#39;GZIP_1&#39;</code>
,         <code class='verbatim'>&#39;GZIP_2&#39;</code>
,         <code class='verbatim'>&#39;HCOMPRESS_1&#39;</code>
</p>

</dd>
<dt><a id="tile_size">tile_size</a> : int, optional</dt>
<dd>
<p>Compression tile sizes.  Default treats each row of image as a tile.</p>

</dd>
<dt><a id="hcomp_scale">hcomp_scale</a> : float, optional</dt>
<dd>
<p>HCOMPRESS scale parameter</p>

</dd>
<dt><a id="hcomp_smooth">hcomp_smooth</a> : float, optional</dt>
<dd>
<p>HCOMPRESS smooth parameter</p>

</dd>
<dt><a id="quantize_level">quantize_level</a> : float, optional</dt>
<dd>
<p>Floating point quantization level; see note below</p>

</dd>
<dt><a id="quantize_method">quantize_method</a> : int, optional</dt>
<dd>
<p>Floating point quantization dithering method; can be either         <code class='verbatim'>NO_DITHER</code>
 (-1; default),         <code class='verbatim'>SUBTRACTIVE_DITHER_1</code>
 (1), or         <code class='verbatim'>SUBTRACTIVE_DITHER_2</code>
 (2); see note below</p>

</dd>
<dt><a id="dither_seed">dither_seed</a> : int, optional</dt>
<dd>
<p>Random seed to use for dithering; can be either an integer in the range 1 to 1000 (inclusive),         <code class='verbatim'>DITHER_SEED_CLOCK</code>
 (0; default), or         <code class='verbatim'>DITHER_SEED_CHECKSUM</code>
 (-1); see note below</p>

</dd>
</dl>

<!-- rendering Summary -->
        <h3 id="section-Examples">Examples</h3>
         See :
    


<h3>Local connectivity graph</h3>
<p>Hover to see nodes names; edges to Self not shown, Caped at 50 nodes.</p>

<p> Using a canvas is more power efficient and can get hundred of nodes ; but does not allow hyperlinks; , arrows
or text (beyond on hover) </p> 
<canvas class='graph' width="800" height="500"></canvas>
<p> SVG is more flexible but power hungry; and does not scale well to 50 + nodes. </p> 

<svg class='graph' width="600" height="500"></svg>

<p>All aboves nodes referred to, (or are referred from) current nodes; Edges from Self to other have been omitted
(or all nodes would be connected to the central node "self" which is not useful). Nodes are colored by the library
they belong to, and scaled with the number of references pointing them</p>

<hr>

    File: /astropy/io/fits/hdu/compressed.py#396
<br/>

type: &lt;class &#39;function&#39;&gt; <br/>
Commit: <br/>

        <script src="https://d3js.org/d3.v4.min.js"></script>
    <script src="https://d3js.org/d3-selection-multi.v1.js"></script>
    <style type="text/css">
        .node {};
        .link { stroke: #999; stroke-opacity: .6; stroke-width: 1px; };
    </style>
<script>
    window._data_graph = {"nodes": [], "links": []};
</script>
<script type="text/javascript" src='/graph_canvas.js'></script>
<script type="text/javascript" src='/graph_svg.js'></script>


</div>
</body>
</html>