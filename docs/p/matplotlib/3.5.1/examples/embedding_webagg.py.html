<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <link rel="icon" href="/favicon.ico" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
    <link rel="stylesheet" href="https://fonts.xz.style/serve/inter.css">
    <link rel="stylesheet"
          href="https://use.fontawesome.com/releases/v5.8.1/css/all.css"
          integrity="sha384-50oBUHEmvpQ+1lW4y57PTFmhCaXp0ML5d60M1M7uH2+nqUivzIebhndOJK28anvf"
          crossorigin="anonymous">
    
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@exampledev/new.css@1.1.2/new.min.css">
    <script type="text/x-mathjax-config">
        // this should process only math inside  span with tex2jax_process class
    MathJax.Hub.Config({
        extensions: ["tex2jax.js"],
        jax: ["input/TeX", "output/HTML-CSS"],
        tex2jax: {
        inlineMath: [ ['$','$'], ["\\(","\\)"] ],
        displayMath: [ ['$$','$$'], ["\\[","\\]"] ],
        processEscapes: true
        },
        "HTML-CSS": { fonts: ["TeX"] }
    });
    </script>
    <script async
        src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/MathJax.js">
    </script>
    <link rel="stylesheet" href="/papyri.css">
    <link rel="stylesheet" href="/pygments.css">
<style>

    header > brand {
        /*border-right: 1px solid #ccc;
          border-left: 1px solid #ccc;*/
        margin-left: 15px;
        padding: 0px;
        display: inline-block; 
        width: 67px;
    }

    brand > a {
        text-decoration: None;

    }
    brand >a> img {
            display: inline-block;
    margin: 0;
    padding: 0;
    position: relative;
    bottom: -10px;

   }
    .container {
       max-width: 800px;
       padding-left: 210px;
       padding-top: 30px;
    }
</style>
</head><body class="tex2jax_ignore">
    <header>
        <brand><a href='/'><img src='/favicon.ico'/></a></brand>
        <nav> / <a href='/' >p</a>  &nbsp;/&nbsp; 
                <div class="dropdown">
                <a href=matplotlib>matplotlib</a>&nbsp;/&nbsp;
                    <div class="dropdown-content">
<a href="/p/dask/2021.10.0/api/dask.html.html">dask</a>
<a href="/p/IPython/8.3.0.dev/api/IPython.html.html">IPython</a>
<a href="/p/skimage/0.17.2/api/skimage.html.html">skimage</a>
<a href="/p/pandas/1.4.1/api/pandas.html.html">pandas</a>
<a href="/p/papyri/0.0.8/api/papyri.html.html">papyri</a>
<a href="/p/distributed/2021.10.0/api/distributed.html.html">distributed</a>
<a href="/p/astropy/5.0/api/astropy.html.html">astropy</a>
<a href="/p/matplotlib/3.5.1/api/matplotlib.html.html">matplotlib</a>
<a href="/p/networkx/2.7.2rc1.dev0/api/networkx.html.html">networkx</a>
<a href="/p/numpy/1.22.3/api/numpy.html.html">numpy</a>
<a href="/p/scipy/1.8.0/api/scipy.html.html">scipy</a>
                     </div>
                </div>
                <div class="dropdown">
                <a href='/p/matplotlib/3.5.1/api/matplotlib.html'>3.5.1</a>&nbsp;/&nbsp;
                    <div class="dropdown-content">
<a href="/p/matplotlib/3.5.1/api/matplotlib.html">3.5.1</a>
                    </div>
                </div>

                <div class="dropdown">
                    <a href='/p/matplotlib/3.5.1/api/matplotlib.html'>Examples</a>&nbsp;/&nbsp;
                    <div class="dropdown-content">
                        <a href="/p/matplotlib/3.5.1/api/matplotlib.html">API</a>
                        <a href="/p/matplotlib/3.5.1/gallery">Gallery</a>
                        <a href="/p/matplotlib/3.5.1/examples">Examples</a>
                        <a href="/p/matplotlib/3.5.1/docs">Narrative</a>
                     </div>
                </div>

                    <div class="dropdown">
                            <a class="dropbtn" href='.html'>matplotlib</a>                    </div><!--end dropdown-->
</nav>
    </header>
<div class='container'>
    <div class="sidenav">
        <img src="/p/matplotlib/3.5.1/img/matplotlib_logo.png"/>
    <a href="#">matplotlib</a>
    <a href="#">3.5.1</a>
    <hr/>
    <hr/>
    </div><!--end sidenav-->



<pre class='highlight None'><span class='nsl'>&gt;&gt;&gt; </span><span class="sd">&#34;&#34;&#34;
This example demonstrates how to embed matplotlib WebAgg interactive
plotting in your own web application and framework.  It is not
necessary to do all this if you merely want to display a plot in a
browser or use matplotlib&#39;s built-in Tornado-based server &#34;on the
side&#34;.

The framework being used must support web sockets.
&#34;&#34;&#34;</span><br><span class='nsl'>...&nbsp;</span><br><span class='nsl'>...&nbsp;</span><span class="kn">import</span><span class=""> </span><span class="nn">io</span><br><span class='nsl'>...&nbsp;</span><br><span class='nsl'>...&nbsp;</span><span class="k">try</span><span class="">:</span><br><span class='nsl'>...&nbsp;</span><span class="">    </span><span class="kn">import</span><span class=""> </span><span class="nn">tornado</span><br><span class='nsl'>...&nbsp;</span><span class="k">except</span><span class=""> </span><span class="ne">ImportError</span><span class="">:</span><br><span class='nsl'>...&nbsp;</span><span class="">    </span><span class="k">raise</span><span class=""> </span><span class="ne">RuntimeError</span><span class="">(</span><span class="s2">&#34;</span><span class="s2">This example requires tornado.</span><span class="s2">&#34;</span><span class="">)</span><br><span class='nsl'>...&nbsp;</span><span class="kn">import</span><span class=""> </span><span class="nn">tornado</span><span class="nn">.</span><span class="nn">web</span><br><span class='nsl'>...&nbsp;</span><span class="kn">import</span><span class=""> </span><span class="nn">tornado</span><span class="nn">.</span><span class="nn">httpserver</span><br><span class='nsl'>...&nbsp;</span><span class="kn">import</span><span class=""> </span><span class="nn">tornado</span><span class="nn">.</span><span class="nn">ioloop</span><br><span class='nsl'>...&nbsp;</span><span class="kn">import</span><span class=""> </span><span class="nn">tornado</span><span class="nn">.</span><span class="nn">websocket</span><br><span class='nsl'>...&nbsp;</span><br><span class='nsl'>...&nbsp;</span><br><span class='nsl'>...&nbsp;</span><span class="kn">from</span><span class=""> </span><a class="foo nn" href="/p/matplotlib/3.5.1/api/matplotlib.html">matplotlib</a><span class="nn">.</span><span class="nn">backends</span><span class="nn">.</span><span class="nn">backend_webagg_core</span><span class=""> </span><span class="kn">import</span><span class=""> </span><span class="">(</span><br><span class='nsl'>...&nbsp;</span><span class="">    </span><span class="">FigureManagerWebAgg</span><span class="">,</span><span class=""> </span><span class="">new_figure_manager_given_figure</span><span class="">)</span><br><span class='nsl'>...&nbsp;</span><span class="kn">from</span><span class=""> </span><a class="foo nn" href="/p/matplotlib/3.5.1/api/matplotlib.html">matplotlib</a><span class="nn">.</span><span class="nn">figure</span><span class=""> </span><span class="kn">import</span><span class=""> </span><span class="">Figure</span><br><span class='nsl'>...&nbsp;</span><br><span class='nsl'>...&nbsp;</span><span class="kn">import</span><span class=""> </span><a class="foo nn" href="/p/numpy/1.22.3/api/numpy.html">numpy</a><span class=""> </span><span class="k">as</span><span class=""> </span><span class="nn">np</span><br><span class='nsl'>...&nbsp;</span><br><span class='nsl'>...&nbsp;</span><span class="kn">import</span><span class=""> </span><span class="nn">json</span><br><span class='nsl'>...&nbsp;</span><br><span class='nsl'>...&nbsp;</span><br><span class='nsl'>...&nbsp;</span><span class="k">def</span><span class=""> </span><span class="nf">create_figure</span><span class="">(</span><span class="">)</span><span class="">:</span><br><span class='nsl'>...&nbsp;</span><span class="">    </span><span class="sd">&#34;&#34;&#34;
    Creates a simple example figure.
    &#34;&#34;&#34;</span><br><span class='nsl'>...&nbsp;</span><span class="">    </span><span class="">fig</span><span class=""> </span><span class="o">=</span><span class=""> </span><span class="">Figure</span><span class="">(</span><span class="">)</span><br><span class='nsl'>...&nbsp;</span><span class="">    </span><span class="">a</span><span class=""> </span><span class="o">=</span><span class=""> </span><span class="">fig</span><span class="o">.</span><span class="">add_subplot</span><span class="">(</span><span class="mi">111</span><span class="">)</span><br><span class='nsl'>...&nbsp;</span><span class="">    </span><span class="">t</span><span class=""> </span><span class="o">=</span><span class=""> </span><span class="">np</span><span class="o">.</span><span class="">arange</span><span class="">(</span><span class="mf">0.0</span><span class="">,</span><span class=""> </span><span class="mf">3.0</span><span class="">,</span><span class=""> </span><span class="mf">0.01</span><span class="">)</span><br><span class='nsl'>...&nbsp;</span><span class="">    </span><span class="">s</span><span class=""> </span><span class="o">=</span><span class=""> </span><span class="">np</span><span class="o">.</span><span class="">sin</span><span class="">(</span><span class="mi">2</span><span class=""> </span><span class="o">*</span><span class=""> </span><span class="">np</span><span class="o">.</span><span class="">pi</span><span class=""> </span><span class="o">*</span><span class=""> </span><span class="">t</span><span class="">)</span><br><span class='nsl'>...&nbsp;</span><span class="">    </span><span class="">a</span><span class="o">.</span><span class="">plot</span><span class="">(</span><span class="">t</span><span class="">,</span><span class=""> </span><span class="">s</span><span class="">)</span><br><span class='nsl'>...&nbsp;</span><span class="">    </span><span class="k">return</span><span class=""> </span><span class="">fig</span><br><span class='nsl'>...&nbsp;</span><br><span class='nsl'>...&nbsp;</span><br><span class='nsl'>...&nbsp;</span><span class="c1"># The following is the content of the web page.  You would normally</span><br><span class='nsl'>...&nbsp;</span><span class="c1"># generate this using some sort of template facility in your web</span><br><span class='nsl'>...&nbsp;</span><span class="c1"># framework, but here we just use Python string formatting.</span><br><span class='nsl'>...&nbsp;</span><span class="">html_content</span><span class=""> </span><span class="o">=</span><span class=""> </span><span class="s2">&#34;&#34;&#34;</span><br><span class='nsl'>...&nbsp;</span><span class="s2">&lt;html&gt;</span><br><span class='nsl'>...&nbsp;</span><span class="s2">  &lt;head&gt;</span><br><span class='nsl'>...&nbsp;</span><span class="s2">    &lt;!-- TODO: There should be a way to include all of the required javascript</span><br><span class='nsl'>...&nbsp;</span><span class="s2">               and CSS so matplotlib can add to the set in the future if it</span><br><span class='nsl'>...&nbsp;</span><span class="s2">               needs to. --&gt;</span><br><span class='nsl'>...&nbsp;</span><span class="s2">    &lt;link rel=</span><span class="s2">&#34;</span><span class="s2">stylesheet</span><span class="s2">&#34;</span><span class="s2"> href=</span><span class="s2">&#34;</span><span class="s2">_static/css/page.css</span><span class="s2">&#34;</span><span class="s2"> type=</span><span class="s2">&#34;</span><span class="s2">text/css</span><span class="s2">&#34;</span><span class="s2">&gt;</span><br><span class='nsl'>...&nbsp;</span><span class="s2">    &lt;link rel=</span><span class="s2">&#34;</span><span class="s2">stylesheet</span><span class="s2">&#34;</span><span class="s2"> href=</span><span class="s2">&#34;</span><span class="s2">_static/css/boilerplate.css</span><span class="s2">&#34;</span><span class="s2"> type=</span><span class="s2">&#34;</span><span class="s2">text/css</span><span class="s2">&#34;</span><span class="s2"> /&gt;</span><br><span class='nsl'>...&nbsp;</span><span class="s2">    &lt;link rel=</span><span class="s2">&#34;</span><span class="s2">stylesheet</span><span class="s2">&#34;</span><span class="s2"> href=</span><span class="s2">&#34;</span><span class="s2">_static/css/fbm.css</span><span class="s2">&#34;</span><span class="s2"> type=</span><span class="s2">&#34;</span><span class="s2">text/css</span><span class="s2">&#34;</span><span class="s2"> /&gt;</span><br><span class='nsl'>...&nbsp;</span><span class="s2">    &lt;link rel=</span><span class="s2">&#34;</span><span class="s2">stylesheet</span><span class="s2">&#34;</span><span class="s2"> href=</span><span class="s2">&#34;</span><span class="s2">_static/jquery/css/themes/base/jquery-ui.min.css</span><span class="s2">&#34;</span><span class="s2"> &gt;</span><br><span class='nsl'>...&nbsp;</span><span class="s2">    &lt;script src=</span><span class="s2">&#34;</span><span class="s2">_static/jquery/js/jquery-1.7.1.min.js</span><span class="s2">&#34;</span><span class="s2">&gt;&lt;/script&gt;</span><br><span class='nsl'>...&nbsp;</span><span class="s2">    &lt;script src=</span><span class="s2">&#34;</span><span class="s2">_static/jquery/js/jquery-ui.min.js</span><span class="s2">&#34;</span><span class="s2">&gt;&lt;/script&gt;</span><br><span class='nsl'>...&nbsp;</span><span class="s2">    &lt;script src=</span><span class="s2">&#34;</span><span class="s2">mpl.js</span><span class="s2">&#34;</span><span class="s2">&gt;&lt;/script&gt;</span><br><span class='nsl'>...&nbsp;</span><br><span class='nsl'>...&nbsp;</span><span class="s2">    &lt;script&gt;</span><br><span class='nsl'>...&nbsp;</span><span class="s2">      /* This is a callback that is called when the user saves</span><br><span class='nsl'>...&nbsp;</span><span class="s2">         (downloads) a file.  Its purpose is really to map from a</span><br><span class='nsl'>...&nbsp;</span><span class="s2">         figure and file format to a url in the application. */</span><br><span class='nsl'>...&nbsp;</span><span class="s2">      function ondownload(figure, format) </span><span class="s2">{</span><br><span class='nsl'>...&nbsp;</span><span class="s2">        window.open(</span><span class="s2">&#39;</span><span class="s2">download.</span><span class="s2">&#39;</span><span class="s2"> + format, </span><span class="s2">&#39;</span><span class="s2">_blank</span><span class="s2">&#39;</span><span class="s2">);</span><br><span class='nsl'>...&nbsp;</span><span class="s2">      };</span><br><span class='nsl'>...&nbsp;</span><br><span class='nsl'>...&nbsp;</span><span class="s2">      $(document).ready(</span><br><span class='nsl'>...&nbsp;</span><span class="s2">        function() </span><span class="s2">{</span><br><span class='nsl'>...&nbsp;</span><span class="s2">          /* It is up to the application to provide a websocket that the figure</span><br><span class='nsl'>...&nbsp;</span><span class="s2">             will use to communicate to the server.  This websocket object can</span><br><span class='nsl'>...&nbsp;</span><span class="s2">             also be a </span><span class="s2">&#34;</span><span class="s2">fake</span><span class="s2">&#34;</span><span class="s2"> websocket that underneath multiplexes messages</span><br><span class='nsl'>...&nbsp;</span><span class="s2">             from multiple figures, if necessary. */</span><br><span class='nsl'>...&nbsp;</span><span class="s2">          var websocket_type = mpl.get_websocket_type();</span><br><span class='nsl'>...&nbsp;</span><span class="s2">          var websocket = new websocket_type(</span><span class="s2">&#34;</span><span class="si">%(ws_uri)s</span><span class="s2">ws</span><span class="s2">&#34;</span><span class="s2">);</span><br><span class='nsl'>...&nbsp;</span><br><span class='nsl'>...&nbsp;</span><span class="s2">          // mpl.figure creates a new figure on the webpage.</span><br><span class='nsl'>...&nbsp;</span><span class="s2">          var fig = new mpl.figure(</span><br><span class='nsl'>...&nbsp;</span><span class="s2">              // A unique numeric identifier for the figure</span><br><span class='nsl'>...&nbsp;</span><span class="s2">              </span><span class="si">%(fig_id)s</span><span class="s2">,</span><br><span class='nsl'>...&nbsp;</span><span class="s2">              // A websocket object (or something that behaves like one)</span><br><span class='nsl'>...&nbsp;</span><span class="s2">              websocket,</span><br><span class='nsl'>...&nbsp;</span><span class="s2">              // A function called when a file type is selected for download</span><br><span class='nsl'>...&nbsp;</span><span class="s2">              ondownload,</span><br><span class='nsl'>...&nbsp;</span><span class="s2">              // The HTML element in which to place the figure</span><br><span class='nsl'>...&nbsp;</span><span class="s2">              $(</span><span class="s2">&#39;</span><span class="s2">div#figure</span><span class="s2">&#39;</span><span class="s2">));</span><br><span class='nsl'>...&nbsp;</span><span class="s2">        }</span><br><span class='nsl'>...&nbsp;</span><span class="s2">      );</span><br><span class='nsl'>...&nbsp;</span><span class="s2">    &lt;/script&gt;</span><br><span class='nsl'>...&nbsp;</span><br><span class='nsl'>...&nbsp;</span><span class="s2">    &lt;title&gt;matplotlib&lt;/title&gt;</span><br><span class='nsl'>...&nbsp;</span><span class="s2">  &lt;/head&gt;</span><br><span class='nsl'>...&nbsp;</span><br><span class='nsl'>...&nbsp;</span><span class="s2">  &lt;body&gt;</span><br><span class='nsl'>...&nbsp;</span><span class="s2">    &lt;div id=</span><span class="s2">&#34;</span><span class="s2">figure</span><span class="s2">&#34;</span><span class="s2">&gt;</span><br><span class='nsl'>...&nbsp;</span><span class="s2">    &lt;/div&gt;</span><br><span class='nsl'>...&nbsp;</span><span class="s2">  &lt;/body&gt;</span><br><span class='nsl'>...&nbsp;</span><span class="s2">&lt;/html&gt;</span><br><span class='nsl'>...&nbsp;</span><span class="s2">&#34;&#34;&#34;</span><br><span class='nsl'>...&nbsp;</span><br><span class='nsl'>...&nbsp;</span><br><span class='nsl'>...&nbsp;</span><span class="k">class</span><span class=""> </span><span class="nc">MyApplication</span><span class="">(</span><span class="">tornado</span><span class="o">.</span><span class="">web</span><span class="o">.</span><span class="">Application</span><span class="">)</span><span class="">:</span><br><span class='nsl'>...&nbsp;</span><span class="">    </span><span class="k">class</span><span class=""> </span><span class="nc">MainPage</span><span class="">(</span><span class="">tornado</span><span class="o">.</span><span class="">web</span><span class="o">.</span><span class="">RequestHandler</span><span class="">)</span><span class="">:</span><br><span class='nsl'>...&nbsp;</span><span class="">        </span><span class="sd">&#34;&#34;&#34;
        Serves the main HTML page.
        &#34;&#34;&#34;</span><br><span class='nsl'>...&nbsp;</span><span class="">        </span><span class="k">def</span><span class=""> </span><span class="nf">get</span><span class="">(</span><span class="bp">self</span><span class="">)</span><span class="">:</span><br><span class='nsl'>...&nbsp;</span><span class="">            </span><span class="">manager</span><span class=""> </span><span class="o">=</span><span class=""> </span><span class="bp">self</span><span class="o">.</span><span class="">application</span><span class="o">.</span><span class="">manager</span><br><span class='nsl'>...&nbsp;</span><span class="">            </span><span class="">ws_uri</span><span class=""> </span><span class="o">=</span><span class=""> </span><span class="s2">&#34;</span><span class="s2">ws://</span><span class="si">{req.host}</span><span class="s2">/</span><span class="s2">&#34;</span><span class="o">.</span><span class="">format</span><span class="">(</span><span class="">req</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="">request</span><span class="">)</span><br><span class='nsl'>...&nbsp;</span><span class="">            </span><span class="">content</span><span class=""> </span><span class="o">=</span><span class=""> </span><span class="">html_content</span><span class=""> </span><span class="o">%</span><span class=""> </span><span class="">{</span><br><span class='nsl'>...&nbsp;</span><span class="">                </span><span class="s2">&#34;</span><span class="s2">ws_uri</span><span class="s2">&#34;</span><span class="">:</span><span class=""> </span><span class="">ws_uri</span><span class="">,</span><span class=""> </span><span class="s2">&#34;</span><span class="s2">fig_id</span><span class="s2">&#34;</span><span class="">:</span><span class=""> </span><span class="">manager</span><span class="o">.</span><span class="">num</span><span class="">}</span><br><span class='nsl'>...&nbsp;</span><span class="">            </span><span class="bp">self</span><span class="o">.</span><span class="">write</span><span class="">(</span><span class="">content</span><span class="">)</span><br><span class='nsl'>...&nbsp;</span><br><span class='nsl'>...&nbsp;</span><span class="">    </span><span class="k">class</span><span class=""> </span><span class="nc">MplJs</span><span class="">(</span><span class="">tornado</span><span class="o">.</span><span class="">web</span><span class="o">.</span><span class="">RequestHandler</span><span class="">)</span><span class="">:</span><br><span class='nsl'>...&nbsp;</span><span class="">        </span><span class="sd">&#34;&#34;&#34;
        Serves the generated matplotlib javascript file.  The content
        is dynamically generated based on which toolbar functions the
        user has defined.  Call `FigureManagerWebAgg` to get its
        content.
        &#34;&#34;&#34;</span><br><span class='nsl'>...&nbsp;</span><span class="">        </span><span class="k">def</span><span class=""> </span><span class="nf">get</span><span class="">(</span><span class="bp">self</span><span class="">)</span><span class="">:</span><br><span class='nsl'>...&nbsp;</span><span class="">            </span><span class="bp">self</span><span class="o">.</span><span class="">set_header</span><span class="">(</span><span class="s1">&#39;</span><span class="s1">Content-Type</span><span class="s1">&#39;</span><span class="">,</span><span class=""> </span><span class="s1">&#39;</span><span class="s1">application/javascript</span><span class="s1">&#39;</span><span class="">)</span><br><span class='nsl'>...&nbsp;</span><span class="">            </span><span class="">js_content</span><span class=""> </span><span class="o">=</span><span class=""> </span><span class="">FigureManagerWebAgg</span><span class="o">.</span><span class="">get_javascript</span><span class="">(</span><span class="">)</span><br><span class='nsl'>...&nbsp;</span><br><span class='nsl'>...&nbsp;</span><span class="">            </span><span class="bp">self</span><span class="o">.</span><span class="">write</span><span class="">(</span><span class="">js_content</span><span class="">)</span><br><span class='nsl'>...&nbsp;</span><br><span class='nsl'>...&nbsp;</span><span class="">    </span><span class="k">class</span><span class=""> </span><span class="nc">Download</span><span class="">(</span><span class="">tornado</span><span class="o">.</span><span class="">web</span><span class="o">.</span><span class="">RequestHandler</span><span class="">)</span><span class="">:</span><br><span class='nsl'>...&nbsp;</span><span class="">        </span><span class="sd">&#34;&#34;&#34;
        Handles downloading of the figure in various file formats.
        &#34;&#34;&#34;</span><br><span class='nsl'>...&nbsp;</span><span class="">        </span><span class="k">def</span><span class=""> </span><span class="nf">get</span><span class="">(</span><span class="bp">self</span><span class="">,</span><span class=""> </span><span class="">fmt</span><span class="">)</span><span class="">:</span><br><span class='nsl'>...&nbsp;</span><span class="">            </span><span class="">manager</span><span class=""> </span><span class="o">=</span><span class=""> </span><span class="bp">self</span><span class="o">.</span><span class="">application</span><span class="o">.</span><span class="">manager</span><br><span class='nsl'>...&nbsp;</span><br><span class='nsl'>...&nbsp;</span><span class="">            </span><span class="">mimetypes</span><span class=""> </span><span class="o">=</span><span class=""> </span><span class="">{</span><br><span class='nsl'>...&nbsp;</span><span class="">                </span><span class="s1">&#39;</span><span class="s1">ps</span><span class="s1">&#39;</span><span class="">:</span><span class=""> </span><span class="s1">&#39;</span><span class="s1">application/postscript</span><span class="s1">&#39;</span><span class="">,</span><br><span class='nsl'>...&nbsp;</span><span class="">                </span><span class="s1">&#39;</span><span class="s1">eps</span><span class="s1">&#39;</span><span class="">:</span><span class=""> </span><span class="s1">&#39;</span><span class="s1">application/postscript</span><span class="s1">&#39;</span><span class="">,</span><br><span class='nsl'>...&nbsp;</span><span class="">                </span><span class="s1">&#39;</span><span class="s1">pdf</span><span class="s1">&#39;</span><span class="">:</span><span class=""> </span><span class="s1">&#39;</span><span class="s1">application/pdf</span><span class="s1">&#39;</span><span class="">,</span><br><span class='nsl'>...&nbsp;</span><span class="">                </span><span class="s1">&#39;</span><span class="s1">svg</span><span class="s1">&#39;</span><span class="">:</span><span class=""> </span><span class="s1">&#39;</span><span class="s1">image/svg+xml</span><span class="s1">&#39;</span><span class="">,</span><br><span class='nsl'>...&nbsp;</span><span class="">                </span><span class="s1">&#39;</span><span class="s1">png</span><span class="s1">&#39;</span><span class="">:</span><span class=""> </span><span class="s1">&#39;</span><span class="s1">image/png</span><span class="s1">&#39;</span><span class="">,</span><br><span class='nsl'>...&nbsp;</span><span class="">                </span><span class="s1">&#39;</span><span class="s1">jpeg</span><span class="s1">&#39;</span><span class="">:</span><span class=""> </span><span class="s1">&#39;</span><span class="s1">image/jpeg</span><span class="s1">&#39;</span><span class="">,</span><br><span class='nsl'>...&nbsp;</span><span class="">                </span><span class="s1">&#39;</span><span class="s1">tif</span><span class="s1">&#39;</span><span class="">:</span><span class=""> </span><span class="s1">&#39;</span><span class="s1">image/tiff</span><span class="s1">&#39;</span><span class="">,</span><br><span class='nsl'>...&nbsp;</span><span class="">                </span><span class="s1">&#39;</span><span class="s1">emf</span><span class="s1">&#39;</span><span class="">:</span><span class=""> </span><span class="s1">&#39;</span><span class="s1">application/emf</span><span class="s1">&#39;</span><br><span class='nsl'>...&nbsp;</span><span class="">            </span><span class="">}</span><br><span class='nsl'>...&nbsp;</span><br><span class='nsl'>...&nbsp;</span><span class="">            </span><span class="bp">self</span><span class="o">.</span><span class="">set_header</span><span class="">(</span><span class="s1">&#39;</span><span class="s1">Content-Type</span><span class="s1">&#39;</span><span class="">,</span><span class=""> </span><span class="">mimetypes</span><span class="o">.</span><span class="">get</span><span class="">(</span><span class="">fmt</span><span class="">,</span><span class=""> </span><span class="s1">&#39;</span><span class="s1">binary</span><span class="s1">&#39;</span><span class="">)</span><span class="">)</span><br><span class='nsl'>...&nbsp;</span><br><span class='nsl'>...&nbsp;</span><span class="">            </span><span class="">buff</span><span class=""> </span><span class="o">=</span><span class=""> </span><span class="">io</span><span class="o">.</span><span class="">BytesIO</span><span class="">(</span><span class="">)</span><br><span class='nsl'>...&nbsp;</span><span class="">            </span><span class="">manager</span><span class="o">.</span><span class="">canvas</span><span class="o">.</span><span class="">print_figure</span><span class="">(</span><span class="">buff</span><span class="">,</span><span class=""> </span><span class="nb">format</span><span class="o">=</span><span class="">fmt</span><span class="">)</span><br><span class='nsl'>...&nbsp;</span><span class="">            </span><span class="bp">self</span><span class="o">.</span><span class="">write</span><span class="">(</span><span class="">buff</span><span class="o">.</span><span class="">getvalue</span><span class="">(</span><span class="">)</span><span class="">)</span><br><span class='nsl'>...&nbsp;</span><br><span class='nsl'>...&nbsp;</span><span class="">    </span><span class="k">class</span><span class=""> </span><span class="nc">WebSocket</span><span class="">(</span><span class="">tornado</span><span class="o">.</span><span class="">websocket</span><span class="o">.</span><span class="">WebSocketHandler</span><span class="">)</span><span class="">:</span><br><span class='nsl'>...&nbsp;</span><span class="">        </span><span class="sd">&#34;&#34;&#34;
        A websocket for interactive communication between the plot in
        the browser and the server.

        In addition to the methods required by tornado, it is required to
        have two callback methods:

            - ``send_json(json_content)`` is called by matplotlib when
              it needs to send json to the browser.  `json_content` is
              a JSON tree (Python dictionary), and it is the responsibility
              of this implementation to encode it as a string to send over
              the socket.

            - ``send_binary(blob)`` is called to send binary image data
              to the browser.
        &#34;&#34;&#34;</span><br><span class='nsl'>...&nbsp;</span><span class="">        </span><span class="">supports_binary</span><span class=""> </span><span class="o">=</span><span class=""> </span><span class="kc">True</span><br><span class='nsl'>...&nbsp;</span><br><span class='nsl'>...&nbsp;</span><span class="">        </span><span class="k">def</span><span class=""> </span><span class="nf">open</span><span class="">(</span><span class="bp">self</span><span class="">)</span><span class="">:</span><br><span class='nsl'>...&nbsp;</span><span class="">            </span><span class="c1"># Register the websocket with the FigureManager.</span><br><span class='nsl'>...&nbsp;</span><span class="">            </span><span class="">manager</span><span class=""> </span><span class="o">=</span><span class=""> </span><span class="bp">self</span><span class="o">.</span><span class="">application</span><span class="o">.</span><span class="">manager</span><br><span class='nsl'>...&nbsp;</span><span class="">            </span><span class="">manager</span><span class="o">.</span><span class="">add_web_socket</span><span class="">(</span><span class="bp">self</span><span class="">)</span><br><span class='nsl'>...&nbsp;</span><span class="">            </span><span class="k">if</span><span class=""> </span><span class="nb">hasattr</span><span class="">(</span><span class="bp">self</span><span class="">,</span><span class=""> </span><span class="s1">&#39;</span><span class="s1">set_nodelay</span><span class="s1">&#39;</span><span class="">)</span><span class="">:</span><br><span class='nsl'>...&nbsp;</span><span class="">                </span><span class="bp">self</span><span class="o">.</span><span class="">set_nodelay</span><span class="">(</span><span class="kc">True</span><span class="">)</span><br><span class='nsl'>...&nbsp;</span><br><span class='nsl'>...&nbsp;</span><span class="">        </span><span class="k">def</span><span class=""> </span><span class="nf">on_close</span><span class="">(</span><span class="bp">self</span><span class="">)</span><span class="">:</span><br><span class='nsl'>...&nbsp;</span><span class="">            </span><span class="c1"># When the socket is closed, deregister the websocket with</span><br><span class='nsl'>...&nbsp;</span><span class="">            </span><span class="c1"># the FigureManager.</span><br><span class='nsl'>...&nbsp;</span><span class="">            </span><span class="">manager</span><span class=""> </span><span class="o">=</span><span class=""> </span><span class="bp">self</span><span class="o">.</span><span class="">application</span><span class="o">.</span><span class="">manager</span><br><span class='nsl'>...&nbsp;</span><span class="">            </span><span class="">manager</span><span class="o">.</span><span class="">remove_web_socket</span><span class="">(</span><span class="bp">self</span><span class="">)</span><br><span class='nsl'>...&nbsp;</span><br><span class='nsl'>...&nbsp;</span><span class="">        </span><span class="k">def</span><span class=""> </span><span class="nf">on_message</span><span class="">(</span><span class="bp">self</span><span class="">,</span><span class=""> </span><span class="">message</span><span class="">)</span><span class="">:</span><br><span class='nsl'>...&nbsp;</span><span class="">            </span><span class="c1"># The &#39;supports_binary&#39; message is relevant to the</span><br><span class='nsl'>...&nbsp;</span><span class="">            </span><span class="c1"># websocket itself.  The other messages get passed along</span><br><span class='nsl'>...&nbsp;</span><span class="">            </span><span class="c1"># to matplotlib as-is.</span><br><span class='nsl'>...&nbsp;</span><br><span class='nsl'>...&nbsp;</span><span class="">            </span><span class="c1"># Every message has a &#34;type&#34; and a &#34;figure_id&#34;.</span><br><span class='nsl'>...&nbsp;</span><span class="">            </span><span class="">message</span><span class=""> </span><span class="o">=</span><span class=""> </span><span class="">json</span><span class="o">.</span><span class="">loads</span><span class="">(</span><span class="">message</span><span class="">)</span><br><span class='nsl'>...&nbsp;</span><span class="">            </span><span class="k">if</span><span class=""> </span><span class="">message</span><span class="">[</span><span class="s1">&#39;</span><span class="s1">type</span><span class="s1">&#39;</span><span class="">]</span><span class=""> </span><span class="o">==</span><span class=""> </span><span class="s1">&#39;</span><span class="s1">supports_binary</span><span class="s1">&#39;</span><span class="">:</span><br><span class='nsl'>...&nbsp;</span><span class="">                </span><span class="bp">self</span><span class="o">.</span><span class="">supports_binary</span><span class=""> </span><span class="o">=</span><span class=""> </span><span class="">message</span><span class="">[</span><span class="s1">&#39;</span><span class="s1">value</span><span class="s1">&#39;</span><span class="">]</span><br><span class='nsl'>...&nbsp;</span><span class="">            </span><span class="k">else</span><span class="">:</span><br><span class='nsl'>...&nbsp;</span><span class="">                </span><span class="">manager</span><span class=""> </span><span class="o">=</span><span class=""> </span><span class="bp">self</span><span class="o">.</span><span class="">application</span><span class="o">.</span><span class="">manager</span><br><span class='nsl'>...&nbsp;</span><span class="">                </span><span class="">manager</span><span class="o">.</span><span class="">handle_json</span><span class="">(</span><span class="">message</span><span class="">)</span><br><span class='nsl'>...&nbsp;</span><br><span class='nsl'>...&nbsp;</span><span class="">        </span><span class="k">def</span><span class=""> </span><span class="nf">send_json</span><span class="">(</span><span class="bp">self</span><span class="">,</span><span class=""> </span><span class="">content</span><span class="">)</span><span class="">:</span><br><span class='nsl'>...&nbsp;</span><span class="">            </span><span class="bp">self</span><span class="o">.</span><span class="">write_message</span><span class="">(</span><span class="">json</span><span class="o">.</span><span class="">dumps</span><span class="">(</span><span class="">content</span><span class="">)</span><span class="">)</span><br><span class='nsl'>...&nbsp;</span><br><span class='nsl'>...&nbsp;</span><span class="">        </span><span class="k">def</span><span class=""> </span><span class="nf">send_binary</span><span class="">(</span><span class="bp">self</span><span class="">,</span><span class=""> </span><span class="">blob</span><span class="">)</span><span class="">:</span><br><span class='nsl'>...&nbsp;</span><span class="">            </span><span class="k">if</span><span class=""> </span><span class="bp">self</span><span class="o">.</span><span class="">supports_binary</span><span class="">:</span><br><span class='nsl'>...&nbsp;</span><span class="">                </span><span class="bp">self</span><span class="o">.</span><span class="">write_message</span><span class="">(</span><span class="">blob</span><span class="">,</span><span class=""> </span><span class="">binary</span><span class="o">=</span><span class="kc">True</span><span class="">)</span><br><span class='nsl'>...&nbsp;</span><span class="">            </span><span class="k">else</span><span class="">:</span><br><span class='nsl'>...&nbsp;</span><span class="">                </span><span class="">data_uri</span><span class=""> </span><span class="o">=</span><span class=""> </span><span class="s2">&#34;</span><span class="s2">data:image/png;base64,</span><span class="si">{0}</span><span class="s2">&#34;</span><span class="o">.</span><span class="">format</span><span class="">(</span><br><span class='nsl'>...&nbsp;</span><span class="">                    </span><span class="">blob</span><span class="o">.</span><span class="">encode</span><span class="">(</span><span class="s1">&#39;</span><span class="s1">base64</span><span class="s1">&#39;</span><span class="">)</span><span class="o">.</span><span class="">replace</span><span class="">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="">,</span><span class=""> </span><span class="s1">&#39;</span><span class="s1">&#39;</span><span class="">)</span><span class="">)</span><br><span class='nsl'>...&nbsp;</span><span class="">                </span><span class="bp">self</span><span class="o">.</span><span class="">write_message</span><span class="">(</span><span class="">data_uri</span><span class="">)</span><br><span class='nsl'>...&nbsp;</span><br><span class='nsl'>...&nbsp;</span><span class="">    </span><span class="k">def</span><span class=""> </span><span class="fm">__init__</span><span class="">(</span><span class="bp">self</span><span class="">,</span><span class=""> </span><span class="">figure</span><span class="">)</span><span class="">:</span><br><span class='nsl'>...&nbsp;</span><span class="">        </span><span class="bp">self</span><span class="o">.</span><span class="">figure</span><span class=""> </span><span class="o">=</span><span class=""> </span><span class="">figure</span><br><span class='nsl'>...&nbsp;</span><span class="">        </span><span class="bp">self</span><span class="o">.</span><span class="">manager</span><span class=""> </span><span class="o">=</span><span class=""> </span><span class="">new_figure_manager_given_figure</span><span class="">(</span><br><span class='nsl'>...&nbsp;</span><span class="">            </span><span class="nb">id</span><span class="">(</span><span class="">figure</span><span class="">)</span><span class="">,</span><span class=""> </span><span class="">figure</span><span class="">)</span><br><span class='nsl'>...&nbsp;</span><br><span class='nsl'>...&nbsp;</span><span class="">        </span><span class="nb">super</span><span class="">(</span><span class="">MyApplication</span><span class="">,</span><span class=""> </span><span class="bp">self</span><span class="">)</span><span class="o">.</span><span class="fm">__init__</span><span class="">(</span><span class="">[</span><br><span class='nsl'>...&nbsp;</span><span class="">            </span><span class="c1"># Static files for the CSS and JS</span><br><span class='nsl'>...&nbsp;</span><span class="">            </span><span class="">(</span><span class="sa">r</span><span class="s1">&#39;</span><span class="s1">/_static/(.*)</span><span class="s1">&#39;</span><span class="">,</span><br><span class='nsl'>...&nbsp;</span><span class="">             </span><span class="">tornado</span><span class="o">.</span><span class="">web</span><span class="o">.</span><span class="">StaticFileHandler</span><span class="">,</span><br><span class='nsl'>...&nbsp;</span><span class="">             </span><span class="">{</span><span class="s1">&#39;</span><span class="s1">path</span><span class="s1">&#39;</span><span class="">:</span><span class=""> </span><span class="">FigureManagerWebAgg</span><span class="o">.</span><span class="">get_static_file_path</span><span class="">(</span><span class="">)</span><span class="">}</span><span class="">)</span><span class="">,</span><br><span class='nsl'>...&nbsp;</span><br><span class='nsl'>...&nbsp;</span><span class="">            </span><span class="c1"># The page that contains all of the pieces</span><br><span class='nsl'>...&nbsp;</span><span class="">            </span><span class="">(</span><span class="s1">&#39;</span><span class="s1">/</span><span class="s1">&#39;</span><span class="">,</span><span class=""> </span><span class="bp">self</span><span class="o">.</span><span class="">MainPage</span><span class="">)</span><span class="">,</span><br><span class='nsl'>...&nbsp;</span><br><span class='nsl'>...&nbsp;</span><span class="">            </span><span class="">(</span><span class="s1">&#39;</span><span class="s1">/mpl.js</span><span class="s1">&#39;</span><span class="">,</span><span class=""> </span><span class="bp">self</span><span class="o">.</span><span class="">MplJs</span><span class="">)</span><span class="">,</span><br><span class='nsl'>...&nbsp;</span><br><span class='nsl'>...&nbsp;</span><span class="">            </span><span class="c1"># Sends images and events to the browser, and receives</span><br><span class='nsl'>...&nbsp;</span><span class="">            </span><span class="c1"># events from the browser</span><br><span class='nsl'>...&nbsp;</span><span class="">            </span><span class="">(</span><span class="s1">&#39;</span><span class="s1">/ws</span><span class="s1">&#39;</span><span class="">,</span><span class=""> </span><span class="bp">self</span><span class="o">.</span><span class="">WebSocket</span><span class="">)</span><span class="">,</span><br><span class='nsl'>...&nbsp;</span><br><span class='nsl'>...&nbsp;</span><span class="">            </span><span class="c1"># Handles the downloading (i.e., saving) of static images</span><br><span class='nsl'>...&nbsp;</span><span class="">            </span><span class="">(</span><span class="sa">r</span><span class="s1">&#39;</span><span class="s1">/download.([a-z0-9.]+)</span><span class="s1">&#39;</span><span class="">,</span><span class=""> </span><span class="bp">self</span><span class="o">.</span><span class="">Download</span><span class="">)</span><span class="">,</span><br><span class='nsl'>...&nbsp;</span><span class="">        </span><span class="">]</span><span class="">)</span><br><span class='nsl'>...&nbsp;</span><br><span class='nsl'>...&nbsp;</span><br><span class='nsl'>...&nbsp;</span><span class="k">if</span><span class=""> </span><span class="vm">__name__</span><span class=""> </span><span class="o">==</span><span class=""> </span><span class="s2">&#34;</span><span class="s2">__main__</span><span class="s2">&#34;</span><span class="">:</span><br><span class='nsl'>...&nbsp;</span><span class="">    </span><span class="">figure</span><span class=""> </span><span class="o">=</span><span class=""> </span><span class="">create_figure</span><span class="">(</span><span class="">)</span><br><span class='nsl'>...&nbsp;</span><span class="">    </span><span class="">application</span><span class=""> </span><span class="o">=</span><span class=""> </span><span class="">MyApplication</span><span class="">(</span><span class="">figure</span><span class="">)</span><br><span class='nsl'>...&nbsp;</span><br><span class='nsl'>...&nbsp;</span><span class="">    </span><span class="">http_server</span><span class=""> </span><span class="o">=</span><span class=""> </span><span class="">tornado</span><span class="o">.</span><span class="">httpserver</span><span class="o">.</span><span class="">HTTPServer</span><span class="">(</span><span class="">application</span><span class="">)</span><br><span class='nsl'>...&nbsp;</span><span class="">    </span><span class="">http_server</span><span class="o">.</span><span class="">listen</span><span class="">(</span><span class="mi">8080</span><span class="">)</span><br><span class='nsl'>...&nbsp;</span><br><span class='nsl'>...&nbsp;</span><span class="">    </span><span class="nb">print</span><span class="">(</span><span class="s2">&#34;</span><span class="s2">http://127.0.0.1:8080/</span><span class="s2">&#34;</span><span class="">)</span><br><span class='nsl'>...&nbsp;</span><span class="">    </span><span class="nb">print</span><span class="">(</span><span class="s2">&#34;</span><span class="s2">Press Ctrl+C to quit</span><span class="s2">&#34;</span><span class="">)</span><br><span class='nsl'>...&nbsp;</span><br><span class='nsl'>...&nbsp;</span><span class="">    </span><span class="">tornado</span><span class="o">.</span><span class="">ioloop</span><span class="o">.</span><span class="">IOLoop</span><span class="o">.</span><span class="">instance</span><span class="">(</span><span class="">)</span><span class="o">.</span><span class="">start</span><span class="">(</span><span class="">)</span><br><span class='nsl'>...&nbsp;</span>
</pre>
       




</div>
</body>
</html>