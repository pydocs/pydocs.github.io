<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <link rel="icon" href="/favicon.ico" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
    <link rel="stylesheet"
          href="https://use.fontawesome.com/releases/v5.8.1/css/all.css"
          integrity="sha384-50oBUHEmvpQ+1lW4y57PTFmhCaXp0ML5d60M1M7uH2+nqUivzIebhndOJK28anvf"
          crossorigin="anonymous">
    
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@exampledev/new.css@1.1.2/new.min.css">
    <script type="text/x-mathjax-config">
      // this should process only math inside  span with tex2jax_process class
      MathJax.Hub.Config({
          extensions: ["tex2jax.js"],
          jax: ["input/TeX", "output/HTML-CSS"],
          tex2jax: {
          inlineMath: [ ['$','$'], ["\\(","\\)"] ],
          displayMath: [ ['$$','$$'], ["\\[","\\]"] ],
          processEscapes: true
          },
          "HTML-CSS": { fonts: ["TeX"] }
      });
    </script>
    <script async
        src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/MathJax.js">
    </script>
    <link rel="stylesheet" href="/papyri.css">
    <link rel="stylesheet" href="/pygments.css">
<style>

    header > brand {
        /*border-right: 1px solid #ccc;
          border-left: 1px solid #ccc;*/
        margin-left: 15px;
        padding: 0px;
        display: inline-block; 
        width: 67px;
    }

    brand > a {
        text-decoration: None;

    }
    brand >a> img {
            display: inline-block;
    margin: 0;
    padding: 0;
    position: relative;
    bottom: -10px;

   }
    .container {
       max-width: 800px;
       padding-left: 210px;
       padding-top: 30px;
    }
</style>
</head><body class="tex2jax_ignore">
    <header>
        <brand><a href='/'><img src='/favicon.ico'/></a></brand>
        <nav> / <a href='/' >p</a>  &nbsp;/&nbsp; 
                <div class="dropdown">
                <a href=matplotlib>matplotlib</a>&nbsp;/&nbsp;
                    <div class="dropdown-content">
<a href="/p/dask/2021.10.0/api/dask.html.html">dask</a>
<a href="/p/IPython/8.2.0/api/IPython.html.html">IPython</a>
<a href="/p/skimage/0.17.2/api/skimage.html.html">skimage</a>
<a href="/p/pandas/1.4.1/api/pandas.html.html">pandas</a>
<a href="/p/papyri/0.0.8/api/papyri.html.html">papyri</a>
<a href="/p/distributed/2021.10.0/api/distributed.html.html">distributed</a>
<a href="/p/astropy/5.0/api/astropy.html.html">astropy</a>
<a href="/p/matplotlib/3.5.1/api/matplotlib.html.html">matplotlib</a>
<a href="/p/networkx/2.7.2rc1.dev0/api/networkx.html.html">networkx</a>
<a href="/p/numpy/1.22.3/api/numpy.html.html">numpy</a>
<a href="/p/scipy/1.8.0/api/scipy.html.html">scipy</a>
                     </div>
                </div>
                <div class="dropdown">
                <a href='/p/matplotlib/3.5.1/api/matplotlib.html'>3.5.1</a>&nbsp;/&nbsp;
                    <div class="dropdown-content">
<a href="/p/matplotlib/3.5.1/api/matplotlib.html">3.5.1</a>
                    </div>
                </div>

                <div class="dropdown">
                    <a href='/p/matplotlib/3.5.1/api/matplotlib.html'>Examples</a>&nbsp;/&nbsp;
                    <div class="dropdown-content">
                        <a href="/p/matplotlib/3.5.1/api/matplotlib.html">API</a>
                        <a href="/p/matplotlib/3.5.1/gallery">Gallery</a>
                        <a href="/p/matplotlib/3.5.1/examples">Examples</a>
                        <a href="/p/matplotlib/3.5.1/docs">Narrative</a>
                     </div>
                </div>

                    <div class="dropdown">
                            <a class="dropbtn" href='.html'>matplotlib</a>                    </div><!--end dropdown-->
</nav>
    </header>
<div class='container'>
    <div class="sidenav">
        <img src="/p/matplotlib/3.5.1/img/matplotlib_logo.png"/>
    <a href="#">matplotlib</a>
    <a href="#">3.5.1</a>
    <hr/>
    <hr/>
    </div><!--end sidenav-->



<pre class='highlight execed'><span class='nsl'>&gt;&gt;&gt; </span><span class="sd">&#34;&#34;&#34;
===========================
Creating annotated heatmaps
===========================

It is often desirable to show data which depends on two independent
variables as a color coded image plot. This is often referred to as a
heatmap. If the data is categorical, this would be called a categorical
heatmap.

Matplotlib&#39;s `~matplotlib.axes.Axes.imshow` function makes
production of such plots particularly easy.

The following examples show how to create a heatmap with annotations.
We will start with an easy example and expand it to be usable as a
universal function.
&#34;&#34;&#34;</span><br><span class='nsl'>...&nbsp;</span><br><span class='nsl'>...&nbsp;</span><br><span class='nsl'>...&nbsp;</span><span class="c1">##############################################################################</span><br><span class='nsl'>...&nbsp;</span><span class="c1">#</span><br><span class='nsl'>...&nbsp;</span><span class="c1"># A simple categorical heatmap</span><br><span class='nsl'>...&nbsp;</span><span class="c1"># ----------------------------</span><br><span class='nsl'>...&nbsp;</span><span class="c1">#</span><br><span class='nsl'>...&nbsp;</span><span class="c1"># We may start by defining some data. What we need is a 2D list or array</span><br><span class='nsl'>...&nbsp;</span><span class="c1"># which defines the data to color code. We then also need two lists or arrays</span><br><span class='nsl'>...&nbsp;</span><span class="c1"># of categories; of course the number of elements in those lists</span><br><span class='nsl'>...&nbsp;</span><span class="c1"># need to match the data along the respective axes.</span><br><span class='nsl'>...&nbsp;</span><span class="c1"># The heatmap itself is an `~matplotlib.axes.Axes.imshow` plot</span><br><span class='nsl'>...&nbsp;</span><span class="c1"># with the labels set to the categories we have.</span><br><span class='nsl'>...&nbsp;</span><span class="c1"># Note that it is important to set both, the tick locations</span><br><span class='nsl'>...&nbsp;</span><span class="c1"># (`~matplotlib.axes.Axes.set_xticks`) as well as the</span><br><span class='nsl'>...&nbsp;</span><span class="c1"># tick labels (`~matplotlib.axes.Axes.set_xticklabels`),</span><br><span class='nsl'>...&nbsp;</span><span class="c1"># otherwise they would become out of sync. The locations are just</span><br><span class='nsl'>...&nbsp;</span><span class="c1"># the ascending integer numbers, while the ticklabels are the labels to show.</span><br><span class='nsl'>...&nbsp;</span><span class="c1"># Finally we can label the data itself by creating a `~matplotlib.text.Text`</span><br><span class='nsl'>...&nbsp;</span><span class="c1"># within each cell showing the value of that cell.</span><br><span class='nsl'>...&nbsp;</span><br><span class='nsl'>...&nbsp;</span><br><span class='nsl'>...&nbsp;</span><span class="kn">import</span><span class=""> </span><span class="nn">numpy</span><span class=""> </span><span class="k">as</span><span class=""> </span><span class="nn">np</span><br><span class='nsl'>...&nbsp;</span><span class="kn">import</span><span class=""> </span><span class="nn">matplotlib</span><br><span class='nsl'>...&nbsp;</span><span class="kn">import</span><span class=""> </span><span class="nn">matplotlib</span><span class="nn">.</span><span class="nn">pyplot</span><span class=""> </span><span class="k">as</span><span class=""> </span><span class="nn">plt</span><br><span class='nsl'>...&nbsp;</span><span class="c1"># sphinx_gallery_thumbnail_number = 2</span><br><span class='nsl'>...&nbsp;</span><br><span class='nsl'>...&nbsp;</span><span class="">vegetables</span><span class=""> </span><span class="o">=</span><span class=""> </span><span class="">[</span><span class="s2">&#34;</span><span class="s2">cucumber</span><span class="s2">&#34;</span><span class="">,</span><span class=""> </span><span class="s2">&#34;</span><span class="s2">tomato</span><span class="s2">&#34;</span><span class="">,</span><span class=""> </span><span class="s2">&#34;</span><span class="s2">lettuce</span><span class="s2">&#34;</span><span class="">,</span><span class=""> </span><span class="s2">&#34;</span><span class="s2">asparagus</span><span class="s2">&#34;</span><span class="">,</span><br><span class='nsl'>...&nbsp;</span><span class="">              </span><span class="s2">&#34;</span><span class="s2">potato</span><span class="s2">&#34;</span><span class="">,</span><span class=""> </span><span class="s2">&#34;</span><span class="s2">wheat</span><span class="s2">&#34;</span><span class="">,</span><span class=""> </span><span class="s2">&#34;</span><span class="s2">barley</span><span class="s2">&#34;</span><span class="">]</span><br><span class='nsl'>...&nbsp;</span><span class="">farmers</span><span class=""> </span><span class="o">=</span><span class=""> </span><span class="">[</span><span class="s2">&#34;</span><span class="s2">Farmer Joe</span><span class="s2">&#34;</span><span class="">,</span><span class=""> </span><span class="s2">&#34;</span><span class="s2">Upland Bros.</span><span class="s2">&#34;</span><span class="">,</span><span class=""> </span><span class="s2">&#34;</span><span class="s2">Smith Gardening</span><span class="s2">&#34;</span><span class="">,</span><br><span class='nsl'>...&nbsp;</span><span class="">           </span><span class="s2">&#34;</span><span class="s2">Agrifun</span><span class="s2">&#34;</span><span class="">,</span><span class=""> </span><span class="s2">&#34;</span><span class="s2">Organiculture</span><span class="s2">&#34;</span><span class="">,</span><span class=""> </span><span class="s2">&#34;</span><span class="s2">BioGoods Ltd.</span><span class="s2">&#34;</span><span class="">,</span><span class=""> </span><span class="s2">&#34;</span><span class="s2">Cornylee Corp.</span><span class="s2">&#34;</span><span class="">]</span><br><span class='nsl'>...&nbsp;</span><br><span class='nsl'>...&nbsp;</span><span class="">harvest</span><span class=""> </span><span class="o">=</span><span class=""> </span><span class="">np</span><span class="o">.</span><span class="">array</span><span class="">(</span><span class="">[</span><span class="">[</span><span class="mf">0.8</span><span class="">,</span><span class=""> </span><span class="mf">2.4</span><span class="">,</span><span class=""> </span><span class="mf">2.5</span><span class="">,</span><span class=""> </span><span class="mf">3.9</span><span class="">,</span><span class=""> </span><span class="mf">0.0</span><span class="">,</span><span class=""> </span><span class="mf">4.0</span><span class="">,</span><span class=""> </span><span class="mf">0.0</span><span class="">]</span><span class="">,</span><br><span class='nsl'>...&nbsp;</span><span class="">                    </span><span class="">[</span><span class="mf">2.4</span><span class="">,</span><span class=""> </span><span class="mf">0.0</span><span class="">,</span><span class=""> </span><span class="mf">4.0</span><span class="">,</span><span class=""> </span><span class="mf">1.0</span><span class="">,</span><span class=""> </span><span class="mf">2.7</span><span class="">,</span><span class=""> </span><span class="mf">0.0</span><span class="">,</span><span class=""> </span><span class="mf">0.0</span><span class="">]</span><span class="">,</span><br><span class='nsl'>...&nbsp;</span><span class="">                    </span><span class="">[</span><span class="mf">1.1</span><span class="">,</span><span class=""> </span><span class="mf">2.4</span><span class="">,</span><span class=""> </span><span class="mf">0.8</span><span class="">,</span><span class=""> </span><span class="mf">4.3</span><span class="">,</span><span class=""> </span><span class="mf">1.9</span><span class="">,</span><span class=""> </span><span class="mf">4.4</span><span class="">,</span><span class=""> </span><span class="mf">0.0</span><span class="">]</span><span class="">,</span><br><span class='nsl'>...&nbsp;</span><span class="">                    </span><span class="">[</span><span class="mf">0.6</span><span class="">,</span><span class=""> </span><span class="mf">0.0</span><span class="">,</span><span class=""> </span><span class="mf">0.3</span><span class="">,</span><span class=""> </span><span class="mf">0.0</span><span class="">,</span><span class=""> </span><span class="mf">3.1</span><span class="">,</span><span class=""> </span><span class="mf">0.0</span><span class="">,</span><span class=""> </span><span class="mf">0.0</span><span class="">]</span><span class="">,</span><br><span class='nsl'>...&nbsp;</span><span class="">                    </span><span class="">[</span><span class="mf">0.7</span><span class="">,</span><span class=""> </span><span class="mf">1.7</span><span class="">,</span><span class=""> </span><span class="mf">0.6</span><span class="">,</span><span class=""> </span><span class="mf">2.6</span><span class="">,</span><span class=""> </span><span class="mf">2.2</span><span class="">,</span><span class=""> </span><span class="mf">6.2</span><span class="">,</span><span class=""> </span><span class="mf">0.0</span><span class="">]</span><span class="">,</span><br><span class='nsl'>...&nbsp;</span><span class="">                    </span><span class="">[</span><span class="mf">1.3</span><span class="">,</span><span class=""> </span><span class="mf">1.2</span><span class="">,</span><span class=""> </span><span class="mf">0.0</span><span class="">,</span><span class=""> </span><span class="mf">0.0</span><span class="">,</span><span class=""> </span><span class="mf">0.0</span><span class="">,</span><span class=""> </span><span class="mf">3.2</span><span class="">,</span><span class=""> </span><span class="mf">5.1</span><span class="">]</span><span class="">,</span><br><span class='nsl'>...&nbsp;</span><span class="">                    </span><span class="">[</span><span class="mf">0.1</span><span class="">,</span><span class=""> </span><span class="mf">2.0</span><span class="">,</span><span class=""> </span><span class="mf">0.0</span><span class="">,</span><span class=""> </span><span class="mf">1.4</span><span class="">,</span><span class=""> </span><span class="mf">0.0</span><span class="">,</span><span class=""> </span><span class="mf">1.9</span><span class="">,</span><span class=""> </span><span class="mf">6.3</span><span class="">]</span><span class="">]</span><span class="">)</span><br><span class='nsl'>...&nbsp;</span><br><span class='nsl'>...&nbsp;</span><br><span class='nsl'>...&nbsp;</span><span class="">fig</span><span class="">,</span><span class=""> </span><span class="">ax</span><span class=""> </span><span class="o">=</span><span class=""> </span><span class="">plt</span><span class="o">.</span><span class="">subplots</span><span class="">(</span><span class="">)</span><br><span class='nsl'>...&nbsp;</span><span class="">im</span><span class=""> </span><span class="o">=</span><span class=""> </span><span class="">ax</span><span class="o">.</span><span class="">imshow</span><span class="">(</span><span class="">harvest</span><span class="">)</span><br><span class='nsl'>...&nbsp;</span><br><span class='nsl'>...&nbsp;</span><span class="c1"># Show all ticks and label them with the respective list entries</span><br><span class='nsl'>...&nbsp;</span><span class="">ax</span><span class="o">.</span><span class="">set_xticks</span><span class="">(</span><span class="">np</span><span class="o">.</span><span class="">arange</span><span class="">(</span><span class="nb">len</span><span class="">(</span><span class="">farmers</span><span class="">)</span><span class="">)</span><span class="">,</span><span class=""> </span><span class="">labels</span><span class="o">=</span><span class="">farmers</span><span class="">)</span><br><span class='nsl'>...&nbsp;</span><span class="">ax</span><span class="o">.</span><span class="">set_yticks</span><span class="">(</span><span class="">np</span><span class="o">.</span><span class="">arange</span><span class="">(</span><span class="nb">len</span><span class="">(</span><span class="">vegetables</span><span class="">)</span><span class="">)</span><span class="">,</span><span class=""> </span><span class="">labels</span><span class="o">=</span><span class="">vegetables</span><span class="">)</span><br><span class='nsl'>...&nbsp;</span><br><span class='nsl'>...&nbsp;</span><span class="c1"># Rotate the tick labels and set their alignment.</span><br><span class='nsl'>...&nbsp;</span><span class="">plt</span><span class="o">.</span><span class="">setp</span><span class="">(</span><span class="">ax</span><span class="o">.</span><span class="">get_xticklabels</span><span class="">(</span><span class="">)</span><span class="">,</span><span class=""> </span><span class="">rotation</span><span class="o">=</span><span class="mi">45</span><span class="">,</span><span class=""> </span><span class="">ha</span><span class="o">=</span><span class="s2">&#34;</span><span class="s2">right</span><span class="s2">&#34;</span><span class="">,</span><br><span class='nsl'>...&nbsp;</span><span class="">         </span><span class="">rotation_mode</span><span class="o">=</span><span class="s2">&#34;</span><span class="s2">anchor</span><span class="s2">&#34;</span><span class="">)</span><br><span class='nsl'>...&nbsp;</span><br><span class='nsl'>...&nbsp;</span><span class="c1"># Loop over data dimensions and create text annotations.</span><br><span class='nsl'>...&nbsp;</span><span class="k">for</span><span class=""> </span><span class="">i</span><span class=""> </span><span class="ow">in</span><span class=""> </span><span class="nb">range</span><span class="">(</span><span class="nb">len</span><span class="">(</span><span class="">vegetables</span><span class="">)</span><span class="">)</span><span class="">:</span><br><span class='nsl'>...&nbsp;</span><span class="">    </span><span class="k">for</span><span class=""> </span><span class="">j</span><span class=""> </span><span class="ow">in</span><span class=""> </span><span class="nb">range</span><span class="">(</span><span class="nb">len</span><span class="">(</span><span class="">farmers</span><span class="">)</span><span class="">)</span><span class="">:</span><br><span class='nsl'>...&nbsp;</span><span class="">        </span><span class="">text</span><span class=""> </span><span class="o">=</span><span class=""> </span><span class="">ax</span><span class="o">.</span><span class="">text</span><span class="">(</span><span class="">j</span><span class="">,</span><span class=""> </span><span class="">i</span><span class="">,</span><span class=""> </span><span class="">harvest</span><span class="">[</span><span class="">i</span><span class="">,</span><span class=""> </span><span class="">j</span><span class="">]</span><span class="">,</span><br><span class='nsl'>...&nbsp;</span><span class="">                       </span><span class="">ha</span><span class="o">=</span><span class="s2">&#34;</span><span class="s2">center</span><span class="s2">&#34;</span><span class="">,</span><span class=""> </span><span class="">va</span><span class="o">=</span><span class="s2">&#34;</span><span class="s2">center</span><span class="s2">&#34;</span><span class="">,</span><span class=""> </span><span class="">color</span><span class="o">=</span><span class="s2">&#34;</span><span class="s2">w</span><span class="s2">&#34;</span><span class="">)</span><br><span class='nsl'>...&nbsp;</span><br><span class='nsl'>...&nbsp;</span><span class="">ax</span><span class="o">.</span><span class="">set_title</span><span class="">(</span><span class="s2">&#34;</span><span class="s2">Harvest of local farmers (in tons/year)</span><span class="s2">&#34;</span><span class="">)</span><br><span class='nsl'>...&nbsp;</span><span class="">fig</span><span class="o">.</span><span class="">tight_layout</span><span class="">(</span><span class="">)</span><br><span class='nsl'>...&nbsp;</span><span class="">plt</span><span class="o">.</span><span class="">show</span><span class="">(</span><span class="">)</span><br><span class='nsl'>...&nbsp;</span><br><span class='nsl'>...&nbsp;</span><br><span class='nsl'>...&nbsp;</span><span class="c1">#############################################################################</span><br><span class='nsl'>...&nbsp;</span><span class="c1"># Using the helper function code style</span><br><span class='nsl'>...&nbsp;</span><span class="c1"># ------------------------------------</span><br><span class='nsl'>...&nbsp;</span><span class="c1">#</span><br><span class='nsl'>...&nbsp;</span><span class="c1"># As discussed in the :ref:`Coding styles &lt;coding_styles&gt;`</span><br><span class='nsl'>...&nbsp;</span><span class="c1"># one might want to reuse such code to create some kind of heatmap</span><br><span class='nsl'>...&nbsp;</span><span class="c1"># for different input data and/or on different axes.</span><br><span class='nsl'>...&nbsp;</span><span class="c1"># We create a function that takes the data and the row and column labels as</span><br><span class='nsl'>...&nbsp;</span><span class="c1"># input, and allows arguments that are used to customize the plot</span><br><span class='nsl'>...&nbsp;</span><span class="c1">#</span><br><span class='nsl'>...&nbsp;</span><span class="c1"># Here, in addition to the above we also want to create a colorbar and</span><br><span class='nsl'>...&nbsp;</span><span class="c1"># position the labels above of the heatmap instead of below it.</span><br><span class='nsl'>...&nbsp;</span><span class="c1"># The annotations shall get different colors depending on a threshold</span><br><span class='nsl'>...&nbsp;</span><span class="c1"># for better contrast against the pixel color.</span><br><span class='nsl'>...&nbsp;</span><span class="c1"># Finally, we turn the surrounding axes spines off and create</span><br><span class='nsl'>...&nbsp;</span><span class="c1"># a grid of white lines to separate the cells.</span><br><span class='nsl'>...&nbsp;</span><br><span class='nsl'>...&nbsp;</span><br><span class='nsl'>...&nbsp;</span><span class="k">def</span><span class=""> </span><span class="nf">heatmap</span><span class="">(</span><span class="">data</span><span class="">,</span><span class=""> </span><span class="">row_labels</span><span class="">,</span><span class=""> </span><span class="">col_labels</span><span class="">,</span><span class=""> </span><span class="">ax</span><span class="o">=</span><span class="kc">None</span><span class="">,</span><br><span class='nsl'>...&nbsp;</span><span class="">            </span><span class="">cbar_kw</span><span class="o">=</span><span class="">{</span><span class="">}</span><span class="">,</span><span class=""> </span><span class="">cbarlabel</span><span class="o">=</span><span class="s2">&#34;</span><span class="s2">&#34;</span><span class="">,</span><span class=""> </span><span class="o">*</span><span class="o">*</span><span class="">kwargs</span><span class="">)</span><span class="">:</span><br><span class='nsl'>...&nbsp;</span><span class="">    </span><span class="sd">&#34;&#34;&#34;
    Create a heatmap from a numpy array and two lists of labels.

    Parameters
    ----------
    data
        A 2D numpy array of shape (M, N).
    row_labels
        A list or array of length M with the labels for the rows.
    col_labels
        A list or array of length N with the labels for the columns.
    ax
        A `matplotlib.axes.Axes` instance to which the heatmap is plotted.  If
        not provided, use current axes or create a new one.  Optional.
    cbar_kw
        A dictionary with arguments to `matplotlib.Figure.colorbar`.  Optional.
    cbarlabel
        The label for the colorbar.  Optional.
    **kwargs
        All other arguments are forwarded to `imshow`.
    &#34;&#34;&#34;</span><br><span class='nsl'>...&nbsp;</span><br><span class='nsl'>...&nbsp;</span><span class="">    </span><span class="k">if</span><span class=""> </span><span class="ow">not</span><span class=""> </span><span class="">ax</span><span class="">:</span><br><span class='nsl'>...&nbsp;</span><span class="">        </span><span class="">ax</span><span class=""> </span><span class="o">=</span><span class=""> </span><span class="">plt</span><span class="o">.</span><span class="">gca</span><span class="">(</span><span class="">)</span><br><span class='nsl'>...&nbsp;</span><br><span class='nsl'>...&nbsp;</span><span class="">    </span><span class="c1"># Plot the heatmap</span><br><span class='nsl'>...&nbsp;</span><span class="">    </span><span class="">im</span><span class=""> </span><span class="o">=</span><span class=""> </span><span class="">ax</span><span class="o">.</span><span class="">imshow</span><span class="">(</span><span class="">data</span><span class="">,</span><span class=""> </span><span class="o">*</span><span class="o">*</span><span class="">kwargs</span><span class="">)</span><br><span class='nsl'>...&nbsp;</span><br><span class='nsl'>...&nbsp;</span><span class="">    </span><span class="c1"># Create colorbar</span><br><span class='nsl'>...&nbsp;</span><span class="">    </span><span class="">cbar</span><span class=""> </span><span class="o">=</span><span class=""> </span><span class="">ax</span><span class="o">.</span><span class="">figure</span><span class="o">.</span><span class="">colorbar</span><span class="">(</span><span class="">im</span><span class="">,</span><span class=""> </span><span class="">ax</span><span class="o">=</span><span class="">ax</span><span class="">,</span><span class=""> </span><span class="o">*</span><span class="o">*</span><span class="">cbar_kw</span><span class="">)</span><br><span class='nsl'>...&nbsp;</span><span class="">    </span><span class="">cbar</span><span class="o">.</span><span class="">ax</span><span class="o">.</span><span class="">set_ylabel</span><span class="">(</span><span class="">cbarlabel</span><span class="">,</span><span class=""> </span><span class="">rotation</span><span class="o">=</span><span class="o">-</span><span class="mi">90</span><span class="">,</span><span class=""> </span><span class="">va</span><span class="o">=</span><span class="s2">&#34;</span><span class="s2">bottom</span><span class="s2">&#34;</span><span class="">)</span><br><span class='nsl'>...&nbsp;</span><br><span class='nsl'>...&nbsp;</span><span class="">    </span><span class="c1"># Show all ticks and label them with the respective list entries.</span><br><span class='nsl'>...&nbsp;</span><span class="">    </span><span class="">ax</span><span class="o">.</span><span class="">set_xticks</span><span class="">(</span><span class="">np</span><span class="o">.</span><span class="">arange</span><span class="">(</span><span class="">data</span><span class="o">.</span><span class="">shape</span><span class="">[</span><span class="mi">1</span><span class="">]</span><span class="">)</span><span class="">,</span><span class=""> </span><span class="">labels</span><span class="o">=</span><span class="">col_labels</span><span class="">)</span><br><span class='nsl'>...&nbsp;</span><span class="">    </span><span class="">ax</span><span class="o">.</span><span class="">set_yticks</span><span class="">(</span><span class="">np</span><span class="o">.</span><span class="">arange</span><span class="">(</span><span class="">data</span><span class="o">.</span><span class="">shape</span><span class="">[</span><span class="mi">0</span><span class="">]</span><span class="">)</span><span class="">,</span><span class=""> </span><span class="">labels</span><span class="o">=</span><span class="">row_labels</span><span class="">)</span><br><span class='nsl'>...&nbsp;</span><br><span class='nsl'>...&nbsp;</span><span class="">    </span><span class="c1"># Let the horizontal axes labeling appear on top.</span><br><span class='nsl'>...&nbsp;</span><span class="">    </span><span class="">ax</span><span class="o">.</span><span class="">tick_params</span><span class="">(</span><span class="">top</span><span class="o">=</span><span class="kc">True</span><span class="">,</span><span class=""> </span><span class="">bottom</span><span class="o">=</span><span class="kc">False</span><span class="">,</span><br><span class='nsl'>...&nbsp;</span><span class="">                   </span><span class="">labeltop</span><span class="o">=</span><span class="kc">True</span><span class="">,</span><span class=""> </span><span class="">labelbottom</span><span class="o">=</span><span class="kc">False</span><span class="">)</span><br><span class='nsl'>...&nbsp;</span><br><span class='nsl'>...&nbsp;</span><span class="">    </span><span class="c1"># Rotate the tick labels and set their alignment.</span><br><span class='nsl'>...&nbsp;</span><span class="">    </span><span class="">plt</span><span class="o">.</span><span class="">setp</span><span class="">(</span><span class="">ax</span><span class="o">.</span><span class="">get_xticklabels</span><span class="">(</span><span class="">)</span><span class="">,</span><span class=""> </span><span class="">rotation</span><span class="o">=</span><span class="o">-</span><span class="mi">30</span><span class="">,</span><span class=""> </span><span class="">ha</span><span class="o">=</span><span class="s2">&#34;</span><span class="s2">right</span><span class="s2">&#34;</span><span class="">,</span><br><span class='nsl'>...&nbsp;</span><span class="">             </span><span class="">rotation_mode</span><span class="o">=</span><span class="s2">&#34;</span><span class="s2">anchor</span><span class="s2">&#34;</span><span class="">)</span><br><span class='nsl'>...&nbsp;</span><br><span class='nsl'>...&nbsp;</span><span class="">    </span><span class="c1"># Turn spines off and create white grid.</span><br><span class='nsl'>...&nbsp;</span><span class="">    </span><span class="">ax</span><span class="o">.</span><span class="">spines</span><span class="">[</span><span class="">:</span><span class="">]</span><span class="o">.</span><span class="">set_visible</span><span class="">(</span><span class="kc">False</span><span class="">)</span><br><span class='nsl'>...&nbsp;</span><br><span class='nsl'>...&nbsp;</span><span class="">    </span><span class="">ax</span><span class="o">.</span><span class="">set_xticks</span><span class="">(</span><span class="">np</span><span class="o">.</span><span class="">arange</span><span class="">(</span><span class="">data</span><span class="o">.</span><span class="">shape</span><span class="">[</span><span class="mi">1</span><span class="">]</span><span class="o">+</span><span class="mi">1</span><span class="">)</span><span class="o">-</span><span class="mf">.5</span><span class="">,</span><span class=""> </span><span class="">minor</span><span class="o">=</span><span class="kc">True</span><span class="">)</span><br><span class='nsl'>...&nbsp;</span><span class="">    </span><span class="">ax</span><span class="o">.</span><span class="">set_yticks</span><span class="">(</span><span class="">np</span><span class="o">.</span><span class="">arange</span><span class="">(</span><span class="">data</span><span class="o">.</span><span class="">shape</span><span class="">[</span><span class="mi">0</span><span class="">]</span><span class="o">+</span><span class="mi">1</span><span class="">)</span><span class="o">-</span><span class="mf">.5</span><span class="">,</span><span class=""> </span><span class="">minor</span><span class="o">=</span><span class="kc">True</span><span class="">)</span><br><span class='nsl'>...&nbsp;</span><span class="">    </span><span class="">ax</span><span class="o">.</span><span class="">grid</span><span class="">(</span><span class="">which</span><span class="o">=</span><span class="s2">&#34;</span><span class="s2">minor</span><span class="s2">&#34;</span><span class="">,</span><span class=""> </span><span class="">color</span><span class="o">=</span><span class="s2">&#34;</span><span class="s2">w</span><span class="s2">&#34;</span><span class="">,</span><span class=""> </span><span class="">linestyle</span><span class="o">=</span><span class="s1">&#39;</span><span class="s1">-</span><span class="s1">&#39;</span><span class="">,</span><span class=""> </span><span class="">linewidth</span><span class="o">=</span><span class="mi">3</span><span class="">)</span><br><span class='nsl'>...&nbsp;</span><span class="">    </span><span class="">ax</span><span class="o">.</span><span class="">tick_params</span><span class="">(</span><span class="">which</span><span class="o">=</span><span class="s2">&#34;</span><span class="s2">minor</span><span class="s2">&#34;</span><span class="">,</span><span class=""> </span><span class="">bottom</span><span class="o">=</span><span class="kc">False</span><span class="">,</span><span class=""> </span><span class="">left</span><span class="o">=</span><span class="kc">False</span><span class="">)</span><br><span class='nsl'>...&nbsp;</span><br><span class='nsl'>...&nbsp;</span><span class="">    </span><span class="k">return</span><span class=""> </span><span class="">im</span><span class="">,</span><span class=""> </span><span class="">cbar</span><br><span class='nsl'>...&nbsp;</span><br><span class='nsl'>...&nbsp;</span><br><span class='nsl'>...&nbsp;</span><span class="k">def</span><span class=""> </span><span class="nf">annotate_heatmap</span><span class="">(</span><span class="">im</span><span class="">,</span><span class=""> </span><span class="">data</span><span class="o">=</span><span class="kc">None</span><span class="">,</span><span class=""> </span><span class="">valfmt</span><span class="o">=</span><span class="s2">&#34;</span><span class="si">{x:.2f}</span><span class="s2">&#34;</span><span class="">,</span><br><span class='nsl'>...&nbsp;</span><span class="">                     </span><span class="">textcolors</span><span class="o">=</span><span class="">(</span><span class="s2">&#34;</span><span class="s2">black</span><span class="s2">&#34;</span><span class="">,</span><span class=""> </span><span class="s2">&#34;</span><span class="s2">white</span><span class="s2">&#34;</span><span class="">)</span><span class="">,</span><br><span class='nsl'>...&nbsp;</span><span class="">                     </span><span class="">threshold</span><span class="o">=</span><span class="kc">None</span><span class="">,</span><span class=""> </span><span class="o">*</span><span class="o">*</span><span class="">textkw</span><span class="">)</span><span class="">:</span><br><span class='nsl'>...&nbsp;</span><span class="">    </span><span class="sd">&#34;&#34;&#34;
    A function to annotate a heatmap.

    Parameters
    ----------
    im
        The AxesImage to be labeled.
    data
        Data used to annotate.  If None, the image&#39;s data is used.  Optional.
    valfmt
        The format of the annotations inside the heatmap.  This should either
        use the string format method, e.g. &#34;$ {x:.2f}&#34;, or be a
        `matplotlib.ticker.Formatter`.  Optional.
    textcolors
        A pair of colors.  The first is used for values below a threshold,
        the second for those above.  Optional.
    threshold
        Value in data units according to which the colors from textcolors are
        applied.  If None (the default) uses the middle of the colormap as
        separation.  Optional.
    **kwargs
        All other arguments are forwarded to each call to `text` used to create
        the text labels.
    &#34;&#34;&#34;</span><br><span class='nsl'>...&nbsp;</span><br><span class='nsl'>...&nbsp;</span><span class="">    </span><span class="k">if</span><span class=""> </span><span class="ow">not</span><span class=""> </span><span class="nb">isinstance</span><span class="">(</span><span class="">data</span><span class="">,</span><span class=""> </span><span class="">(</span><span class="nb">list</span><span class="">,</span><span class=""> </span><span class="">np</span><span class="o">.</span><span class="">ndarray</span><span class="">)</span><span class="">)</span><span class="">:</span><br><span class='nsl'>...&nbsp;</span><span class="">        </span><span class="">data</span><span class=""> </span><span class="o">=</span><span class=""> </span><span class="">im</span><span class="o">.</span><span class="">get_array</span><span class="">(</span><span class="">)</span><br><span class='nsl'>...&nbsp;</span><br><span class='nsl'>...&nbsp;</span><span class="">    </span><span class="c1"># Normalize the threshold to the images color range.</span><br><span class='nsl'>...&nbsp;</span><span class="">    </span><span class="k">if</span><span class=""> </span><span class="">threshold</span><span class=""> </span><span class="ow">is</span><span class=""> </span><span class="ow">not</span><span class=""> </span><span class="kc">None</span><span class="">:</span><br><span class='nsl'>...&nbsp;</span><span class="">        </span><span class="">threshold</span><span class=""> </span><span class="o">=</span><span class=""> </span><span class="">im</span><span class="o">.</span><span class="">norm</span><span class="">(</span><span class="">threshold</span><span class="">)</span><br><span class='nsl'>...&nbsp;</span><span class="">    </span><span class="k">else</span><span class="">:</span><br><span class='nsl'>...&nbsp;</span><span class="">        </span><span class="">threshold</span><span class=""> </span><span class="o">=</span><span class=""> </span><span class="">im</span><span class="o">.</span><span class="">norm</span><span class="">(</span><span class="">data</span><span class="o">.</span><span class="">max</span><span class="">(</span><span class="">)</span><span class="">)</span><span class="o">/</span><span class="mf">2.</span><br><span class='nsl'>...&nbsp;</span><br><span class='nsl'>...&nbsp;</span><span class="">    </span><span class="c1"># Set default alignment to center, but allow it to be</span><br><span class='nsl'>...&nbsp;</span><span class="">    </span><span class="c1"># overwritten by textkw.</span><br><span class='nsl'>...&nbsp;</span><span class="">    </span><span class="">kw</span><span class=""> </span><span class="o">=</span><span class=""> </span><span class="nb">dict</span><span class="">(</span><span class="">horizontalalignment</span><span class="o">=</span><span class="s2">&#34;</span><span class="s2">center</span><span class="s2">&#34;</span><span class="">,</span><br><span class='nsl'>...&nbsp;</span><span class="">              </span><span class="">verticalalignment</span><span class="o">=</span><span class="s2">&#34;</span><span class="s2">center</span><span class="s2">&#34;</span><span class="">)</span><br><span class='nsl'>...&nbsp;</span><span class="">    </span><span class="">kw</span><span class="o">.</span><span class="">update</span><span class="">(</span><span class="">textkw</span><span class="">)</span><br><span class='nsl'>...&nbsp;</span><br><span class='nsl'>...&nbsp;</span><span class="">    </span><span class="c1"># Get the formatter in case a string is supplied</span><br><span class='nsl'>...&nbsp;</span><span class="">    </span><span class="k">if</span><span class=""> </span><span class="nb">isinstance</span><span class="">(</span><span class="">valfmt</span><span class="">,</span><span class=""> </span><span class="nb">str</span><span class="">)</span><span class="">:</span><br><span class='nsl'>...&nbsp;</span><span class="">        </span><span class="">valfmt</span><span class=""> </span><span class="o">=</span><span class=""> </span><span class="">matplotlib</span><span class="o">.</span><span class="">ticker</span><span class="o">.</span><span class="">StrMethodFormatter</span><span class="">(</span><span class="">valfmt</span><span class="">)</span><br><span class='nsl'>...&nbsp;</span><br><span class='nsl'>...&nbsp;</span><span class="">    </span><span class="c1"># Loop over the data and create a `Text` for each &#34;pixel&#34;.</span><br><span class='nsl'>...&nbsp;</span><span class="">    </span><span class="c1"># Change the text&#39;s color depending on the data.</span><br><span class='nsl'>...&nbsp;</span><span class="">    </span><span class="">texts</span><span class=""> </span><span class="o">=</span><span class=""> </span><span class="">[</span><span class="">]</span><br><span class='nsl'>...&nbsp;</span><span class="">    </span><span class="k">for</span><span class=""> </span><span class="">i</span><span class=""> </span><span class="ow">in</span><span class=""> </span><span class="nb">range</span><span class="">(</span><span class="">data</span><span class="o">.</span><span class="">shape</span><span class="">[</span><span class="mi">0</span><span class="">]</span><span class="">)</span><span class="">:</span><br><span class='nsl'>...&nbsp;</span><span class="">        </span><span class="k">for</span><span class=""> </span><span class="">j</span><span class=""> </span><span class="ow">in</span><span class=""> </span><span class="nb">range</span><span class="">(</span><span class="">data</span><span class="o">.</span><span class="">shape</span><span class="">[</span><span class="mi">1</span><span class="">]</span><span class="">)</span><span class="">:</span><br><span class='nsl'>...&nbsp;</span><span class="">            </span><span class="">kw</span><span class="o">.</span><span class="">update</span><span class="">(</span><span class="">color</span><span class="o">=</span><span class="">textcolors</span><span class="">[</span><span class="nb">int</span><span class="">(</span><span class="">im</span><span class="o">.</span><span class="">norm</span><span class="">(</span><span class="">data</span><span class="">[</span><span class="">i</span><span class="">,</span><span class=""> </span><span class="">j</span><span class="">]</span><span class="">)</span><span class=""> </span><span class="o">&gt;</span><span class=""> </span><span class="">threshold</span><span class="">)</span><span class="">]</span><span class="">)</span><br><span class='nsl'>...&nbsp;</span><span class="">            </span><span class="">text</span><span class=""> </span><span class="o">=</span><span class=""> </span><span class="">im</span><span class="o">.</span><span class="">axes</span><span class="o">.</span><span class="">text</span><span class="">(</span><span class="">j</span><span class="">,</span><span class=""> </span><span class="">i</span><span class="">,</span><span class=""> </span><span class="">valfmt</span><span class="">(</span><span class="">data</span><span class="">[</span><span class="">i</span><span class="">,</span><span class=""> </span><span class="">j</span><span class="">]</span><span class="">,</span><span class=""> </span><span class="kc">None</span><span class="">)</span><span class="">,</span><span class=""> </span><span class="o">*</span><span class="o">*</span><span class="">kw</span><span class="">)</span><br><span class='nsl'>...&nbsp;</span><span class="">            </span><span class="">texts</span><span class="o">.</span><span class="">append</span><span class="">(</span><span class="">text</span><span class="">)</span><br><span class='nsl'>...&nbsp;</span><br><span class='nsl'>...&nbsp;</span><span class="">    </span><span class="k">return</span><span class=""> </span><span class="">texts</span><br><span class='nsl'>...&nbsp;</span><br><span class='nsl'>...&nbsp;</span><br><span class='nsl'>...&nbsp;</span><span class="c1">##########################################################################</span><br><span class='nsl'>...&nbsp;</span><span class="c1"># The above now allows us to keep the actual plot creation pretty compact.</span><br><span class='nsl'>...&nbsp;</span><span class="c1">#</span><br><span class='nsl'>...&nbsp;</span><br><span class='nsl'>...&nbsp;</span><span class="">fig</span><span class="">,</span><span class=""> </span><span class="">ax</span><span class=""> </span><span class="o">=</span><span class=""> </span><span class="">plt</span><span class="o">.</span><span class="">subplots</span><span class="">(</span><span class="">)</span><br><span class='nsl'>...&nbsp;</span><br><span class='nsl'>...&nbsp;</span><span class="">im</span><span class="">,</span><span class=""> </span><span class="">cbar</span><span class=""> </span><span class="o">=</span><span class=""> </span><span class="">heatmap</span><span class="">(</span><span class="">harvest</span><span class="">,</span><span class=""> </span><span class="">vegetables</span><span class="">,</span><span class=""> </span><span class="">farmers</span><span class="">,</span><span class=""> </span><span class="">ax</span><span class="o">=</span><span class="">ax</span><span class="">,</span><br><span class='nsl'>...&nbsp;</span><span class="">                   </span><span class="">cmap</span><span class="o">=</span><span class="s2">&#34;</span><span class="s2">YlGn</span><span class="s2">&#34;</span><span class="">,</span><span class=""> </span><span class="">cbarlabel</span><span class="o">=</span><span class="s2">&#34;</span><span class="s2">harvest [t/year]</span><span class="s2">&#34;</span><span class="">)</span><br><span class='nsl'>...&nbsp;</span><span class="">texts</span><span class=""> </span><span class="o">=</span><span class=""> </span><span class="">annotate_heatmap</span><span class="">(</span><span class="">im</span><span class="">,</span><span class=""> </span><span class="">valfmt</span><span class="o">=</span><span class="s2">&#34;</span><span class="si">{x:.1f}</span><span class="s2"> t</span><span class="s2">&#34;</span><span class="">)</span><br><span class='nsl'>...&nbsp;</span><br><span class='nsl'>...&nbsp;</span><span class="">fig</span><span class="o">.</span><span class="">tight_layout</span><span class="">(</span><span class="">)</span><br><span class='nsl'>...&nbsp;</span><span class="">plt</span><span class="o">.</span><span class="">show</span><span class="">(</span><span class="">)</span><br><span class='nsl'>...&nbsp;</span><br><span class='nsl'>...&nbsp;</span><br><span class='nsl'>...&nbsp;</span><span class="c1">#############################################################################</span><br><span class='nsl'>...&nbsp;</span><span class="c1"># Some more complex heatmap examples</span><br><span class='nsl'>...&nbsp;</span><span class="c1"># ----------------------------------</span><br><span class='nsl'>...&nbsp;</span><span class="c1">#</span><br><span class='nsl'>...&nbsp;</span><span class="c1"># In the following we show the versatility of the previously created</span><br><span class='nsl'>...&nbsp;</span><span class="c1"># functions by applying it in different cases and using different arguments.</span><br><span class='nsl'>...&nbsp;</span><span class="c1">#</span><br><span class='nsl'>...&nbsp;</span><br><span class='nsl'>...&nbsp;</span><span class="">np</span><span class="o">.</span><span class="">random</span><span class="o">.</span><span class="">seed</span><span class="">(</span><span class="mi">19680801</span><span class="">)</span><br><span class='nsl'>...&nbsp;</span><br><span class='nsl'>...&nbsp;</span><span class="">fig</span><span class="">,</span><span class=""> </span><span class="">(</span><span class="">(</span><span class="">ax</span><span class="">,</span><span class=""> </span><span class="">ax2</span><span class="">)</span><span class="">,</span><span class=""> </span><span class="">(</span><span class="">ax3</span><span class="">,</span><span class=""> </span><span class="">ax4</span><span class="">)</span><span class="">)</span><span class=""> </span><span class="o">=</span><span class=""> </span><span class="">plt</span><span class="o">.</span><span class="">subplots</span><span class="">(</span><span class="mi">2</span><span class="">,</span><span class=""> </span><span class="mi">2</span><span class="">,</span><span class=""> </span><span class="">figsize</span><span class="o">=</span><span class="">(</span><span class="mi">8</span><span class="">,</span><span class=""> </span><span class="mi">6</span><span class="">)</span><span class="">)</span><br><span class='nsl'>...&nbsp;</span><br><span class='nsl'>...&nbsp;</span><span class="c1"># Replicate the above example with a different font size and colormap.</span><br><span class='nsl'>...&nbsp;</span><br><span class='nsl'>...&nbsp;</span><span class="">im</span><span class="">,</span><span class=""> </span><span class="">_</span><span class=""> </span><span class="o">=</span><span class=""> </span><span class="">heatmap</span><span class="">(</span><span class="">harvest</span><span class="">,</span><span class=""> </span><span class="">vegetables</span><span class="">,</span><span class=""> </span><span class="">farmers</span><span class="">,</span><span class=""> </span><span class="">ax</span><span class="o">=</span><span class="">ax</span><span class="">,</span><br><span class='nsl'>...&nbsp;</span><span class="">                </span><span class="">cmap</span><span class="o">=</span><span class="s2">&#34;</span><span class="s2">Wistia</span><span class="s2">&#34;</span><span class="">,</span><span class=""> </span><span class="">cbarlabel</span><span class="o">=</span><span class="s2">&#34;</span><span class="s2">harvest [t/year]</span><span class="s2">&#34;</span><span class="">)</span><br><span class='nsl'>...&nbsp;</span><span class="">annotate_heatmap</span><span class="">(</span><span class="">im</span><span class="">,</span><span class=""> </span><span class="">valfmt</span><span class="o">=</span><span class="s2">&#34;</span><span class="si">{x:.1f}</span><span class="s2">&#34;</span><span class="">,</span><span class=""> </span><span class="">size</span><span class="o">=</span><span class="mi">7</span><span class="">)</span><br><span class='nsl'>...&nbsp;</span><br><span class='nsl'>...&nbsp;</span><span class="c1"># Create some new data, give further arguments to imshow (vmin),</span><br><span class='nsl'>...&nbsp;</span><span class="c1"># use an integer format on the annotations and provide some colors.</span><br><span class='nsl'>...&nbsp;</span><br><span class='nsl'>...&nbsp;</span><span class="">data</span><span class=""> </span><span class="o">=</span><span class=""> </span><span class="">np</span><span class="o">.</span><span class="">random</span><span class="o">.</span><span class="">randint</span><span class="">(</span><span class="mi">2</span><span class="">,</span><span class=""> </span><span class="mi">100</span><span class="">,</span><span class=""> </span><span class="">size</span><span class="o">=</span><span class="">(</span><span class="mi">7</span><span class="">,</span><span class=""> </span><span class="mi">7</span><span class="">)</span><span class="">)</span><br><span class='nsl'>...&nbsp;</span><span class="">y</span><span class=""> </span><span class="o">=</span><span class=""> </span><span class="">[</span><span class="s2">&#34;</span><span class="s2">Book </span><span class="si">{}</span><span class="s2">&#34;</span><span class="o">.</span><span class="">format</span><span class="">(</span><span class="">i</span><span class="">)</span><span class=""> </span><span class="k">for</span><span class=""> </span><span class="">i</span><span class=""> </span><span class="ow">in</span><span class=""> </span><span class="nb">range</span><span class="">(</span><span class="mi">1</span><span class="">,</span><span class=""> </span><span class="mi">8</span><span class="">)</span><span class="">]</span><br><span class='nsl'>...&nbsp;</span><span class="">x</span><span class=""> </span><span class="o">=</span><span class=""> </span><span class="">[</span><span class="s2">&#34;</span><span class="s2">Store </span><span class="si">{}</span><span class="s2">&#34;</span><span class="o">.</span><span class="">format</span><span class="">(</span><span class="">i</span><span class="">)</span><span class=""> </span><span class="k">for</span><span class=""> </span><span class="">i</span><span class=""> </span><span class="ow">in</span><span class=""> </span><span class="nb">list</span><span class="">(</span><span class="s2">&#34;</span><span class="s2">ABCDEFG</span><span class="s2">&#34;</span><span class="">)</span><span class="">]</span><br><span class='nsl'>...&nbsp;</span><span class="">im</span><span class="">,</span><span class=""> </span><span class="">_</span><span class=""> </span><span class="o">=</span><span class=""> </span><span class="">heatmap</span><span class="">(</span><span class="">data</span><span class="">,</span><span class=""> </span><span class="">y</span><span class="">,</span><span class=""> </span><span class="">x</span><span class="">,</span><span class=""> </span><span class="">ax</span><span class="o">=</span><span class="">ax2</span><span class="">,</span><span class=""> </span><span class="">vmin</span><span class="o">=</span><span class="mi">0</span><span class="">,</span><br><span class='nsl'>...&nbsp;</span><span class="">                </span><span class="">cmap</span><span class="o">=</span><span class="s2">&#34;</span><span class="s2">magma_r</span><span class="s2">&#34;</span><span class="">,</span><span class=""> </span><span class="">cbarlabel</span><span class="o">=</span><span class="s2">&#34;</span><span class="s2">weekly sold copies</span><span class="s2">&#34;</span><span class="">)</span><br><span class='nsl'>...&nbsp;</span><span class="">annotate_heatmap</span><span class="">(</span><span class="">im</span><span class="">,</span><span class=""> </span><span class="">valfmt</span><span class="o">=</span><span class="s2">&#34;</span><span class="si">{x:d}</span><span class="s2">&#34;</span><span class="">,</span><span class=""> </span><span class="">size</span><span class="o">=</span><span class="mi">7</span><span class="">,</span><span class=""> </span><span class="">threshold</span><span class="o">=</span><span class="mi">20</span><span class="">,</span><br><span class='nsl'>...&nbsp;</span><span class="">                 </span><span class="">textcolors</span><span class="o">=</span><span class="">(</span><span class="s2">&#34;</span><span class="s2">red</span><span class="s2">&#34;</span><span class="">,</span><span class=""> </span><span class="s2">&#34;</span><span class="s2">white</span><span class="s2">&#34;</span><span class="">)</span><span class="">)</span><br><span class='nsl'>...&nbsp;</span><br><span class='nsl'>...&nbsp;</span><span class="c1"># Sometimes even the data itself is categorical. Here we use a</span><br><span class='nsl'>...&nbsp;</span><span class="c1"># `matplotlib.colors.BoundaryNorm` to get the data into classes</span><br><span class='nsl'>...&nbsp;</span><span class="c1"># and use this to colorize the plot, but also to obtain the class</span><br><span class='nsl'>...&nbsp;</span><span class="c1"># labels from an array of classes.</span><br><span class='nsl'>...&nbsp;</span><br><span class='nsl'>...&nbsp;</span><span class="">data</span><span class=""> </span><span class="o">=</span><span class=""> </span><span class="">np</span><span class="o">.</span><span class="">random</span><span class="o">.</span><span class="">randn</span><span class="">(</span><span class="mi">6</span><span class="">,</span><span class=""> </span><span class="mi">6</span><span class="">)</span><br><span class='nsl'>...&nbsp;</span><span class="">y</span><span class=""> </span><span class="o">=</span><span class=""> </span><span class="">[</span><span class="s2">&#34;</span><span class="s2">Prod. </span><span class="si">{}</span><span class="s2">&#34;</span><span class="o">.</span><span class="">format</span><span class="">(</span><span class="">i</span><span class="">)</span><span class=""> </span><span class="k">for</span><span class=""> </span><span class="">i</span><span class=""> </span><span class="ow">in</span><span class=""> </span><span class="nb">range</span><span class="">(</span><span class="mi">10</span><span class="">,</span><span class=""> </span><span class="mi">70</span><span class="">,</span><span class=""> </span><span class="mi">10</span><span class="">)</span><span class="">]</span><br><span class='nsl'>...&nbsp;</span><span class="">x</span><span class=""> </span><span class="o">=</span><span class=""> </span><span class="">[</span><span class="s2">&#34;</span><span class="s2">Cycle </span><span class="si">{}</span><span class="s2">&#34;</span><span class="o">.</span><span class="">format</span><span class="">(</span><span class="">i</span><span class="">)</span><span class=""> </span><span class="k">for</span><span class=""> </span><span class="">i</span><span class=""> </span><span class="ow">in</span><span class=""> </span><span class="nb">range</span><span class="">(</span><span class="mi">1</span><span class="">,</span><span class=""> </span><span class="mi">7</span><span class="">)</span><span class="">]</span><br><span class='nsl'>...&nbsp;</span><br><span class='nsl'>...&nbsp;</span><span class="">qrates</span><span class=""> </span><span class="o">=</span><span class=""> </span><span class="nb">list</span><span class="">(</span><span class="s2">&#34;</span><span class="s2">ABCDEFG</span><span class="s2">&#34;</span><span class="">)</span><br><span class='nsl'>...&nbsp;</span><span class="">norm</span><span class=""> </span><span class="o">=</span><span class=""> </span><span class="">matplotlib</span><span class="o">.</span><span class="">colors</span><span class="o">.</span><span class="">BoundaryNorm</span><span class="">(</span><span class="">np</span><span class="o">.</span><span class="">linspace</span><span class="">(</span><span class="o">-</span><span class="mf">3.5</span><span class="">,</span><span class=""> </span><span class="mf">3.5</span><span class="">,</span><span class=""> </span><span class="mi">8</span><span class="">)</span><span class="">,</span><span class=""> </span><span class="mi">7</span><span class="">)</span><br><span class='nsl'>...&nbsp;</span><span class="">fmt</span><span class=""> </span><span class="o">=</span><span class=""> </span><span class="">matplotlib</span><span class="o">.</span><span class="">ticker</span><span class="o">.</span><span class="">FuncFormatter</span><span class="">(</span><span class="k">lambda</span><span class=""> </span><span class="">x</span><span class="">,</span><span class=""> </span><span class="">pos</span><span class="">:</span><span class=""> </span><span class="">qrates</span><span class="">[</span><span class="">:</span><span class="">:</span><span class="o">-</span><span class="mi">1</span><span class="">]</span><span class="">[</span><span class="">norm</span><span class="">(</span><span class="">x</span><span class="">)</span><span class="">]</span><span class="">)</span><br><span class='nsl'>...&nbsp;</span><br><span class='nsl'>...&nbsp;</span><span class="">im</span><span class="">,</span><span class=""> </span><span class="">_</span><span class=""> </span><span class="o">=</span><span class=""> </span><span class="">heatmap</span><span class="">(</span><span class="">data</span><span class="">,</span><span class=""> </span><span class="">y</span><span class="">,</span><span class=""> </span><span class="">x</span><span class="">,</span><span class=""> </span><span class="">ax</span><span class="o">=</span><span class="">ax3</span><span class="">,</span><br><span class='nsl'>...&nbsp;</span><span class="">                </span><span class="">cmap</span><span class="o">=</span><span class="">plt</span><span class="o">.</span><span class="">get_cmap</span><span class="">(</span><span class="s2">&#34;</span><span class="s2">PiYG</span><span class="s2">&#34;</span><span class="">,</span><span class=""> </span><span class="mi">7</span><span class="">)</span><span class="">,</span><span class=""> </span><span class="">norm</span><span class="o">=</span><span class="">norm</span><span class="">,</span><br><span class='nsl'>...&nbsp;</span><span class="">                </span><span class="">cbar_kw</span><span class="o">=</span><span class="nb">dict</span><span class="">(</span><span class="">ticks</span><span class="o">=</span><span class="">np</span><span class="o">.</span><span class="">arange</span><span class="">(</span><span class="o">-</span><span class="mi">3</span><span class="">,</span><span class=""> </span><span class="mi">4</span><span class="">)</span><span class="">,</span><span class=""> </span><span class="nb">format</span><span class="o">=</span><span class="">fmt</span><span class="">)</span><span class="">,</span><br><span class='nsl'>...&nbsp;</span><span class="">                </span><span class="">cbarlabel</span><span class="o">=</span><span class="s2">&#34;</span><span class="s2">Quality Rating</span><span class="s2">&#34;</span><span class="">)</span><br><span class='nsl'>...&nbsp;</span><br><span class='nsl'>...&nbsp;</span><span class="">annotate_heatmap</span><span class="">(</span><span class="">im</span><span class="">,</span><span class=""> </span><span class="">valfmt</span><span class="o">=</span><span class="">fmt</span><span class="">,</span><span class=""> </span><span class="">size</span><span class="o">=</span><span class="mi">9</span><span class="">,</span><span class=""> </span><span class="">fontweight</span><span class="o">=</span><span class="s2">&#34;</span><span class="s2">bold</span><span class="s2">&#34;</span><span class="">,</span><span class=""> </span><span class="">threshold</span><span class="o">=</span><span class="o">-</span><span class="mi">1</span><span class="">,</span><br><span class='nsl'>...&nbsp;</span><span class="">                 </span><span class="">textcolors</span><span class="o">=</span><span class="">(</span><span class="s2">&#34;</span><span class="s2">red</span><span class="s2">&#34;</span><span class="">,</span><span class=""> </span><span class="s2">&#34;</span><span class="s2">black</span><span class="s2">&#34;</span><span class="">)</span><span class="">)</span><br><span class='nsl'>...&nbsp;</span><br><span class='nsl'>...&nbsp;</span><span class="c1"># We can nicely plot a correlation matrix. Since this is bound by -1 and 1,</span><br><span class='nsl'>...&nbsp;</span><span class="c1"># we use those as vmin and vmax. We may also remove leading zeros and hide</span><br><span class='nsl'>...&nbsp;</span><span class="c1"># the diagonal elements (which are all 1) by using a</span><br><span class='nsl'>...&nbsp;</span><span class="c1"># `matplotlib.ticker.FuncFormatter`.</span><br><span class='nsl'>...&nbsp;</span><br><span class='nsl'>...&nbsp;</span><span class="">corr_matrix</span><span class=""> </span><span class="o">=</span><span class=""> </span><span class="">np</span><span class="o">.</span><span class="">corrcoef</span><span class="">(</span><span class="">harvest</span><span class="">)</span><br><span class='nsl'>...&nbsp;</span><span class="">im</span><span class="">,</span><span class=""> </span><span class="">_</span><span class=""> </span><span class="o">=</span><span class=""> </span><span class="">heatmap</span><span class="">(</span><span class="">corr_matrix</span><span class="">,</span><span class=""> </span><span class="">vegetables</span><span class="">,</span><span class=""> </span><span class="">vegetables</span><span class="">,</span><span class=""> </span><span class="">ax</span><span class="o">=</span><span class="">ax4</span><span class="">,</span><br><span class='nsl'>...&nbsp;</span><span class="">                </span><span class="">cmap</span><span class="o">=</span><span class="s2">&#34;</span><span class="s2">PuOr</span><span class="s2">&#34;</span><span class="">,</span><span class=""> </span><span class="">vmin</span><span class="o">=</span><span class="o">-</span><span class="mi">1</span><span class="">,</span><span class=""> </span><span class="">vmax</span><span class="o">=</span><span class="mi">1</span><span class="">,</span><br><span class='nsl'>...&nbsp;</span><span class="">                </span><span class="">cbarlabel</span><span class="o">=</span><span class="s2">&#34;</span><span class="s2">correlation coeff.</span><span class="s2">&#34;</span><span class="">)</span><br><span class='nsl'>...&nbsp;</span><br><span class='nsl'>...&nbsp;</span><br><span class='nsl'>...&nbsp;</span><span class="k">def</span><span class=""> </span><span class="nf">func</span><span class="">(</span><span class="">x</span><span class="">,</span><span class=""> </span><span class="">pos</span><span class="">)</span><span class="">:</span><br><span class='nsl'>...&nbsp;</span><span class="">    </span><span class="k">return</span><span class=""> </span><span class="s2">&#34;</span><span class="si">{:.2f}</span><span class="s2">&#34;</span><span class="o">.</span><span class="">format</span><span class="">(</span><span class="">x</span><span class="">)</span><span class="o">.</span><span class="">replace</span><span class="">(</span><span class="s2">&#34;</span><span class="s2">0.</span><span class="s2">&#34;</span><span class="">,</span><span class=""> </span><span class="s2">&#34;</span><span class="s2">.</span><span class="s2">&#34;</span><span class="">)</span><span class="o">.</span><span class="">replace</span><span class="">(</span><span class="s2">&#34;</span><span class="s2">1.00</span><span class="s2">&#34;</span><span class="">,</span><span class=""> </span><span class="s2">&#34;</span><span class="s2">&#34;</span><span class="">)</span><br><span class='nsl'>...&nbsp;</span><br><span class='nsl'>...&nbsp;</span><span class="">annotate_heatmap</span><span class="">(</span><span class="">im</span><span class="">,</span><span class=""> </span><span class="">valfmt</span><span class="o">=</span><span class="">matplotlib</span><span class="o">.</span><span class="">ticker</span><span class="o">.</span><span class="">FuncFormatter</span><span class="">(</span><span class="">func</span><span class="">)</span><span class="">,</span><span class=""> </span><span class="">size</span><span class="o">=</span><span class="mi">7</span><span class="">)</span><br><span class='nsl'>...&nbsp;</span><br><span class='nsl'>...&nbsp;</span><br><span class='nsl'>...&nbsp;</span><span class="">plt</span><span class="o">.</span><span class="">tight_layout</span><span class="">(</span><span class="">)</span><br><span class='nsl'>...&nbsp;</span><span class="">plt</span><span class="o">.</span><span class="">show</span><span class="">(</span><span class="">)</span><br><span class='nsl'>...&nbsp;</span><br><span class='nsl'>...&nbsp;</span><br><span class='nsl'>...&nbsp;</span><span class="c1">#############################################################################</span><br><span class='nsl'>...&nbsp;</span><span class="c1">#</span><br><span class='nsl'>...&nbsp;</span><span class="c1"># .. admonition:: References</span><br><span class='nsl'>...&nbsp;</span><span class="c1">#</span><br><span class='nsl'>...&nbsp;</span><span class="c1">#    The use of the following functions, methods, classes and modules is shown</span><br><span class='nsl'>...&nbsp;</span><span class="c1">#    in this example:</span><br><span class='nsl'>...&nbsp;</span><span class="c1">#</span><br><span class='nsl'>...&nbsp;</span><span class="c1">#    - `matplotlib.axes.Axes.imshow` / `matplotlib.pyplot.imshow`</span><br><span class='nsl'>...&nbsp;</span><span class="c1">#    - `matplotlib.figure.Figure.colorbar` / `matplotlib.pyplot.colorbar`</span><br><span class='nsl'>...&nbsp;</span>
</pre>
       
           <div><img src="/p/matplotlib/3.5.1/img/ex-image_annotated_heatmap.py-0.png"/></div>
       
           <div><img src="/p/matplotlib/3.5.1/img/ex-image_annotated_heatmap.py-1.png"/></div>
       
           <div><img src="/p/matplotlib/3.5.1/img/ex-image_annotated_heatmap.py-2.png"/></div>
       




</div>
</body>
</html>