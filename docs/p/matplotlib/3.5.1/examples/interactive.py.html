<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <link rel="icon" href="/favicon.ico" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
    <link rel="stylesheet"
          href="https://use.fontawesome.com/releases/v5.8.1/css/all.css"
          integrity="sha384-50oBUHEmvpQ+1lW4y57PTFmhCaXp0ML5d60M1M7uH2+nqUivzIebhndOJK28anvf"
          crossorigin="anonymous">
    
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@exampledev/new.css@1.1.2/new.min.css">
    <script type="text/x-mathjax-config">
      // this should process only math inside  span with tex2jax_process class
      MathJax.Hub.Config({
          extensions: ["tex2jax.js"],
          jax: ["input/TeX", "output/HTML-CSS"],
          tex2jax: {
          inlineMath: [ ['$','$'], ["\\(","\\)"] ],
          displayMath: [ ['$$','$$'], ["\\[","\\]"] ],
          processEscapes: true
          },
          "HTML-CSS": { fonts: ["TeX"] }
      });
    </script>
    <script async
        src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/MathJax.js">
    </script>
    <link rel="stylesheet" href="/papyri.css">
    <link rel="stylesheet" href="/pygments.css">
<style>

    header > brand {
        /*border-right: 1px solid #ccc;
          border-left: 1px solid #ccc;*/
        margin-left: 15px;
        padding: 0px;
        display: inline-block; 
        width: 67px;
    }

    brand > a {
        text-decoration: None;

    }
    brand >a> img {
            display: inline-block;
    margin: 0;
    padding: 0;
    position: relative;
    bottom: -10px;

   }
    .container {
       max-width: 800px;
       padding-left: 210px;
       padding-top: 30px;
    }
</style>
</head><body class="tex2jax_ignore">
    <header>
        <brand><a href='/'><img src='/favicon.ico'/></a></brand>
        <nav> / <a href='/' >p</a>  &nbsp;/&nbsp; 
                <div class="dropdown">
                <a href=matplotlib>matplotlib</a>&nbsp;/&nbsp;
                    <div class="dropdown-content">
<a href="/p/dask/2021.10.0/api/dask.html.html">dask</a>
<a href="/p/IPython/8.2.0/api/IPython.html.html">IPython</a>
<a href="/p/skimage/0.17.2/api/skimage.html.html">skimage</a>
<a href="/p/pandas/1.4.1/api/pandas.html.html">pandas</a>
<a href="/p/papyri/0.0.8/api/papyri.html.html">papyri</a>
<a href="/p/distributed/2021.10.0/api/distributed.html.html">distributed</a>
<a href="/p/astropy/5.0/api/astropy.html.html">astropy</a>
<a href="/p/matplotlib/3.5.1/api/matplotlib.html.html">matplotlib</a>
<a href="/p/networkx/2.7.2rc1.dev0/api/networkx.html.html">networkx</a>
<a href="/p/numpy/1.22.3/api/numpy.html.html">numpy</a>
<a href="/p/scipy/1.8.0/api/scipy.html.html">scipy</a>
                     </div>
                </div>
                <div class="dropdown">
                <a href='/p/matplotlib/3.5.1/api/matplotlib.html'>3.5.1</a>&nbsp;/&nbsp;
                    <div class="dropdown-content">
<a href="/p/matplotlib/3.5.1/api/matplotlib.html">3.5.1</a>
                    </div>
                </div>

                <div class="dropdown">
                    <a href='/p/matplotlib/3.5.1/api/matplotlib.html'>Examples</a>&nbsp;/&nbsp;
                    <div class="dropdown-content">
                        <a href="/p/matplotlib/3.5.1/api/matplotlib.html">API</a>
                        <a href="/p/matplotlib/3.5.1/gallery">Gallery</a>
                        <a href="/p/matplotlib/3.5.1/examples">Examples</a>
                        <a href="/p/matplotlib/3.5.1/docs">Narrative</a>
                     </div>
                </div>

                    <div class="dropdown">
                            <a class="dropbtn" href='.html'>matplotlib</a>                    </div><!--end dropdown-->
</nav>
    </header>
<div class='container'>
    <div class="sidenav">
        <img src="/p/matplotlib/3.5.1/img/matplotlib_logo.png"/>
    <a href="#">matplotlib</a>
    <a href="#">3.5.1</a>
    <hr/>
    <hr/>
    </div><!--end sidenav-->



<pre class='highlight None'><span class='nsl'>&gt;&gt;&gt; </span><span class="ch">#!/usr/bin/env python</span><br><span class='nsl'>...&nbsp;</span><br><span class='nsl'>...&nbsp;</span><span class="sd">&#34;&#34;&#34;Multithreaded interactive interpreter with GTK and Matplotlib support.

WARNING:
As of 2010/06/25, this is not working, at least on Linux.
I have disabled it as a runnable script. - EF


Usage:

  pyint-gtk.py -&gt; starts shell with gtk thread running separately

  pyint-gtk.py -pylab [filename] -&gt; initializes matplotlib, optionally running
  the named file.  The shell starts after the file is executed.

Threading code taken from:
http://aspn.activestate.com/ASPN/Cookbook/Python/Recipe/65109, by Brian
McErlean and John Finlay.

Matplotlib support taken from interactive.py in the matplotlib distribution.

Also borrows liberally from code.py in the Python standard library.&#34;&#34;&#34;</span><br><span class='nsl'>...&nbsp;</span><br><span class='nsl'>...&nbsp;</span><span class="kn">from</span><span class=""> </span><span class="nn">__future__</span><span class=""> </span><span class="kn">import</span><span class=""> </span><span class="">print_function</span><br><span class='nsl'>...&nbsp;</span><br><span class='nsl'>...&nbsp;</span><span class="">__author__</span><span class=""> </span><span class="o">=</span><span class=""> </span><span class="s2">&#34;</span><span class="s2">Fernando Perez &lt;Fernando.Perez@colorado.edu&gt;</span><span class="s2">&#34;</span><br><span class='nsl'>...&nbsp;</span><br><span class='nsl'>...&nbsp;</span><span class="kn">import</span><span class=""> </span><span class="nn">sys</span><br><span class='nsl'>...&nbsp;</span><span class="kn">import</span><span class=""> </span><span class="nn">code</span><br><span class='nsl'>...&nbsp;</span><span class="kn">import</span><span class=""> </span><span class="nn">threading</span><br><span class='nsl'>...&nbsp;</span><br><span class='nsl'>...&nbsp;</span><span class="kn">import</span><span class=""> </span><span class="nn">gobject</span><br><span class='nsl'>...&nbsp;</span><span class="kn">import</span><span class=""> </span><span class="nn">gtk</span><br><span class='nsl'>...&nbsp;</span><br><span class='nsl'>...&nbsp;</span><span class="k">try</span><span class="">:</span><br><span class='nsl'>...&nbsp;</span><span class="">    </span><span class="kn">import</span><span class=""> </span><span class="nn">readline</span><br><span class='nsl'>...&nbsp;</span><span class="k">except</span><span class=""> </span><span class="ne">ImportError</span><span class="">:</span><br><span class='nsl'>...&nbsp;</span><span class="">    </span><span class="">has_readline</span><span class=""> </span><span class="o">=</span><span class=""> </span><span class="kc">False</span><br><span class='nsl'>...&nbsp;</span><span class="k">else</span><span class="">:</span><br><span class='nsl'>...&nbsp;</span><span class="">    </span><span class="">has_readline</span><span class=""> </span><span class="o">=</span><span class=""> </span><span class="kc">True</span><br><span class='nsl'>...&nbsp;</span><br><span class='nsl'>...&nbsp;</span><span class="k">class</span><span class=""> </span><span class="nc">MTConsole</span><span class="">(</span><span class="">code</span><span class="o">.</span><span class="">InteractiveConsole</span><span class="">)</span><span class="">:</span><br><span class='nsl'>...&nbsp;</span><span class="">    </span><span class="sd">&#34;&#34;&#34;Simple multi-threaded shell&#34;&#34;&#34;</span><br><span class='nsl'>...&nbsp;</span><br><span class='nsl'>...&nbsp;</span><span class="">    </span><span class="k">def</span><span class=""> </span><span class="fm">__init__</span><span class="">(</span><span class="bp">self</span><span class="">,</span><span class="">on_kill</span><span class="o">=</span><span class="kc">None</span><span class="">,</span><span class="o">*</span><span class="">args</span><span class="">,</span><span class="o">*</span><span class="o">*</span><span class="">kw</span><span class="">)</span><span class="">:</span><br><span class='nsl'>...&nbsp;</span><span class="">        </span><span class="">code</span><span class="o">.</span><span class="">InteractiveConsole</span><span class="o">.</span><span class="fm">__init__</span><span class="">(</span><span class="bp">self</span><span class="">,</span><span class="o">*</span><span class="">args</span><span class="">,</span><span class="o">*</span><span class="o">*</span><span class="">kw</span><span class="">)</span><br><span class='nsl'>...&nbsp;</span><span class="">        </span><span class="bp">self</span><span class="o">.</span><span class="">code_to_run</span><span class=""> </span><span class="o">=</span><span class=""> </span><span class="kc">None</span><br><span class='nsl'>...&nbsp;</span><span class="">        </span><span class="bp">self</span><span class="o">.</span><span class="">ready</span><span class=""> </span><span class="o">=</span><span class=""> </span><span class="">threading</span><span class="o">.</span><span class="">Condition</span><span class="">(</span><span class="">)</span><br><span class='nsl'>...&nbsp;</span><span class="">        </span><span class="bp">self</span><span class="o">.</span><span class="">_kill</span><span class=""> </span><span class="o">=</span><span class=""> </span><span class="kc">False</span><br><span class='nsl'>...&nbsp;</span><span class="">        </span><span class="k">if</span><span class=""> </span><span class="">on_kill</span><span class=""> </span><span class="ow">is</span><span class=""> </span><span class="kc">None</span><span class="">:</span><br><span class='nsl'>...&nbsp;</span><span class="">            </span><span class="">on_kill</span><span class=""> </span><span class="o">=</span><span class=""> </span><span class="">[</span><span class="">]</span><br><span class='nsl'>...&nbsp;</span><span class="">        </span><span class="c1"># Check that all things to kill are callable:</span><br><span class='nsl'>...&nbsp;</span><span class="">        </span><span class="k">for</span><span class=""> </span><span class="">_</span><span class=""> </span><span class="ow">in</span><span class=""> </span><span class="">on_kill</span><span class="">:</span><br><span class='nsl'>...&nbsp;</span><span class="">            </span><span class="k">if</span><span class=""> </span><span class="ow">not</span><span class=""> </span><span class="">callable</span><span class="">(</span><span class="">_</span><span class="">)</span><span class="">:</span><br><span class='nsl'>...&nbsp;</span><span class="">                </span><span class="k">raise</span><span class=""> </span><span class="ne">TypeError</span><span class="">,</span><span class="s1">&#39;</span><span class="s1">on_kill must be a list of callables</span><span class="s1">&#39;</span><br><span class='nsl'>...&nbsp;</span><span class="">        </span><span class="bp">self</span><span class="o">.</span><span class="">on_kill</span><span class=""> </span><span class="o">=</span><span class=""> </span><span class="">on_kill</span><br><span class='nsl'>...&nbsp;</span><span class="">        </span><span class="c1"># Set up tab-completer</span><br><span class='nsl'>...&nbsp;</span><span class="">        </span><span class="k">if</span><span class=""> </span><span class="">has_readline</span><span class="">:</span><br><span class='nsl'>...&nbsp;</span><span class="">            </span><span class="kn">import</span><span class=""> </span><span class="nn">rlcompleter</span><br><span class='nsl'>...&nbsp;</span><span class="">            </span><span class="k">try</span><span class="">:</span><span class="">  </span><span class="c1"># this form only works with python 2.3</span><br><span class='nsl'>...&nbsp;</span><span class="">                </span><span class="bp">self</span><span class="o">.</span><span class="">completer</span><span class=""> </span><span class="o">=</span><span class=""> </span><span class="">rlcompleter</span><span class="o">.</span><span class="">Completer</span><span class="">(</span><span class="bp">self</span><span class="o">.</span><span class="">locals</span><span class="">)</span><br><span class='nsl'>...&nbsp;</span><span class="">            </span><span class="k">except</span><span class="">:</span><span class=""> </span><span class="c1"># simpler for py2.2</span><br><span class='nsl'>...&nbsp;</span><span class="">                </span><span class="bp">self</span><span class="o">.</span><span class="">completer</span><span class=""> </span><span class="o">=</span><span class=""> </span><span class="">rlcompleter</span><span class="o">.</span><span class="">Completer</span><span class="">(</span><span class="">)</span><br><span class='nsl'>...&nbsp;</span><br><span class='nsl'>...&nbsp;</span><span class="">            </span><span class="">readline</span><span class="o">.</span><span class="">set_completer</span><span class="">(</span><span class="bp">self</span><span class="o">.</span><span class="">completer</span><span class="o">.</span><span class="">complete</span><span class="">)</span><br><span class='nsl'>...&nbsp;</span><span class="">            </span><span class="c1"># Use tab for completions</span><br><span class='nsl'>...&nbsp;</span><span class="">            </span><span class="">readline</span><span class="o">.</span><span class="">parse_and_bind</span><span class="">(</span><span class="s1">&#39;</span><span class="s1">tab: complete</span><span class="s1">&#39;</span><span class="">)</span><br><span class='nsl'>...&nbsp;</span><span class="">            </span><span class="c1"># This forces readline to automatically print the above list when tab</span><br><span class='nsl'>...&nbsp;</span><span class="">            </span><span class="c1"># completion is set to &#39;complete&#39;.</span><br><span class='nsl'>...&nbsp;</span><span class="">            </span><span class="">readline</span><span class="o">.</span><span class="">parse_and_bind</span><span class="">(</span><span class="s1">&#39;</span><span class="s1">set show-all-if-ambiguous on</span><span class="s1">&#39;</span><span class="">)</span><br><span class='nsl'>...&nbsp;</span><span class="">            </span><span class="c1"># Bindings for incremental searches in the history. These searches</span><br><span class='nsl'>...&nbsp;</span><span class="">            </span><span class="c1"># use the string typed so far on the command line and search</span><br><span class='nsl'>...&nbsp;</span><span class="">            </span><span class="c1"># anything in the previous input history containing them.</span><br><span class='nsl'>...&nbsp;</span><span class="">            </span><span class="">readline</span><span class="o">.</span><span class="">parse_and_bind</span><span class="">(</span><span class="s1">&#39;</span><span class="s1">&#34;</span><span class="s1">\</span><span class="s1">C-r</span><span class="s1">&#34;</span><span class="s1">: reverse-search-history</span><span class="s1">&#39;</span><span class="">)</span><br><span class='nsl'>...&nbsp;</span><span class="">            </span><span class="">readline</span><span class="o">.</span><span class="">parse_and_bind</span><span class="">(</span><span class="s1">&#39;</span><span class="s1">&#34;</span><span class="s1">\</span><span class="s1">C-s</span><span class="s1">&#34;</span><span class="s1">: forward-search-history</span><span class="s1">&#39;</span><span class="">)</span><br><span class='nsl'>...&nbsp;</span><br><span class='nsl'>...&nbsp;</span><span class="">    </span><span class="k">def</span><span class=""> </span><span class="nf">runsource</span><span class="">(</span><span class="bp">self</span><span class="">,</span><span class=""> </span><span class="">source</span><span class="">,</span><span class=""> </span><span class="">filename</span><span class="o">=</span><span class="s2">&#34;</span><span class="s2">&lt;input&gt;</span><span class="s2">&#34;</span><span class="">,</span><span class=""> </span><span class="">symbol</span><span class="o">=</span><span class="s2">&#34;</span><span class="s2">single</span><span class="s2">&#34;</span><span class="">)</span><span class="">:</span><br><span class='nsl'>...&nbsp;</span><span class="">        </span><span class="sd">&#34;&#34;&#34;Compile and run some source in the interpreter.

        Arguments are as for compile_command().

        One several things can happen:

        1) The input is incorrect; compile_command() raised an
        exception (SyntaxError or OverflowError).  A syntax traceback
        will be printed by calling the showsyntaxerror() method.

        2) The input is incomplete, and more input is required;
        compile_command() returned None.  Nothing happens.

        3) The input is complete; compile_command() returned a code
        object.  The code is executed by calling self.runcode() (which
        also handles run-time exceptions, except for SystemExit).

        The return value is True in case 2, False in the other cases (unless
        an exception is raised).  The return value can be used to
        decide whether to use sys.ps1 or sys.ps2 to prompt the next
        line.
        &#34;&#34;&#34;</span><br><span class='nsl'>...&nbsp;</span><span class="">        </span><span class="k">try</span><span class="">:</span><br><span class='nsl'>...&nbsp;</span><span class="">            </span><span class="">code</span><span class=""> </span><span class="o">=</span><span class=""> </span><span class="bp">self</span><span class="o">.</span><span class="">compile</span><span class="">(</span><span class="">source</span><span class="">,</span><span class=""> </span><span class="">filename</span><span class="">,</span><span class=""> </span><span class="">symbol</span><span class="">)</span><br><span class='nsl'>...&nbsp;</span><span class="">        </span><span class="k">except</span><span class=""> </span><span class="">(</span><span class="ne">OverflowError</span><span class="">,</span><span class=""> </span><span class="ne">SyntaxError</span><span class="">,</span><span class=""> </span><span class="ne">ValueError</span><span class="">)</span><span class="">:</span><br><span class='nsl'>...&nbsp;</span><span class="">            </span><span class="c1"># Case 1</span><br><span class='nsl'>...&nbsp;</span><span class="">            </span><span class="bp">self</span><span class="o">.</span><span class="">showsyntaxerror</span><span class="">(</span><span class="">filename</span><span class="">)</span><br><span class='nsl'>...&nbsp;</span><span class="">            </span><span class="k">return</span><span class=""> </span><span class="kc">False</span><br><span class='nsl'>...&nbsp;</span><br><span class='nsl'>...&nbsp;</span><span class="">        </span><span class="k">if</span><span class=""> </span><span class="">code</span><span class=""> </span><span class="ow">is</span><span class=""> </span><span class="kc">None</span><span class="">:</span><br><span class='nsl'>...&nbsp;</span><span class="">            </span><span class="c1"># Case 2</span><br><span class='nsl'>...&nbsp;</span><span class="">            </span><span class="k">return</span><span class=""> </span><span class="kc">True</span><br><span class='nsl'>...&nbsp;</span><br><span class='nsl'>...&nbsp;</span><span class="">        </span><span class="c1"># Case 3</span><br><span class='nsl'>...&nbsp;</span><span class="">        </span><span class="c1"># Store code in self, so the execution thread can handle it</span><br><span class='nsl'>...&nbsp;</span><span class="">        </span><span class="bp">self</span><span class="o">.</span><span class="">ready</span><span class="o">.</span><span class="">acquire</span><span class="">(</span><span class="">)</span><br><span class='nsl'>...&nbsp;</span><span class="">        </span><span class="bp">self</span><span class="o">.</span><span class="">code_to_run</span><span class=""> </span><span class="o">=</span><span class=""> </span><span class="">code</span><br><span class='nsl'>...&nbsp;</span><span class="">        </span><span class="bp">self</span><span class="o">.</span><span class="">ready</span><span class="o">.</span><span class="">wait</span><span class="">(</span><span class="">)</span><span class="">  </span><span class="c1"># Wait until processed in timeout interval</span><br><span class='nsl'>...&nbsp;</span><span class="">        </span><span class="bp">self</span><span class="o">.</span><span class="">ready</span><span class="o">.</span><span class="">release</span><span class="">(</span><span class="">)</span><br><span class='nsl'>...&nbsp;</span><br><span class='nsl'>...&nbsp;</span><span class="">        </span><span class="k">return</span><span class=""> </span><span class="kc">False</span><br><span class='nsl'>...&nbsp;</span><br><span class='nsl'>...&nbsp;</span><span class="">    </span><span class="k">def</span><span class=""> </span><span class="nf">runcode</span><span class="">(</span><span class="bp">self</span><span class="">)</span><span class="">:</span><br><span class='nsl'>...&nbsp;</span><span class="">        </span><span class="sd">&#34;&#34;&#34;Execute a code object.

        When an exception occurs, self.showtraceback() is called to display a
        traceback.&#34;&#34;&#34;</span><br><span class='nsl'>...&nbsp;</span><br><span class='nsl'>...&nbsp;</span><span class="">        </span><span class="bp">self</span><span class="o">.</span><span class="">ready</span><span class="o">.</span><span class="">acquire</span><span class="">(</span><span class="">)</span><br><span class='nsl'>...&nbsp;</span><span class="">        </span><span class="k">if</span><span class=""> </span><span class="bp">self</span><span class="o">.</span><span class="">_kill</span><span class="">:</span><br><span class='nsl'>...&nbsp;</span><span class="">            </span><span class="nb">print</span><span class="">(</span><span class="s1">&#39;</span><span class="s1">Closing threads...</span><span class="s1">&#39;</span><span class="">)</span><br><span class='nsl'>...&nbsp;</span><span class="">            </span><span class="">sys</span><span class="o">.</span><span class="">stdout</span><span class="o">.</span><span class="">flush</span><span class="">(</span><span class="">)</span><br><span class='nsl'>...&nbsp;</span><span class="">            </span><span class="k">for</span><span class=""> </span><span class="">tokill</span><span class=""> </span><span class="ow">in</span><span class=""> </span><span class="bp">self</span><span class="o">.</span><span class="">on_kill</span><span class="">:</span><br><span class='nsl'>...&nbsp;</span><span class="">                </span><span class="">tokill</span><span class="">(</span><span class="">)</span><br><span class='nsl'>...&nbsp;</span><span class="">            </span><span class="nb">print</span><span class="">(</span><span class="s1">&#39;</span><span class="s1">Done.</span><span class="s1">&#39;</span><span class="">)</span><br><span class='nsl'>...&nbsp;</span><br><span class='nsl'>...&nbsp;</span><span class="">        </span><span class="k">if</span><span class=""> </span><span class="bp">self</span><span class="o">.</span><span class="">code_to_run</span><span class=""> </span><span class="ow">is</span><span class=""> </span><span class="ow">not</span><span class=""> </span><span class="kc">None</span><span class="">:</span><br><span class='nsl'>...&nbsp;</span><span class="">            </span><span class="bp">self</span><span class="o">.</span><span class="">ready</span><span class="o">.</span><span class="">notify</span><span class="">(</span><span class="">)</span><br><span class='nsl'>...&nbsp;</span><span class="">            </span><span class="">code</span><span class="o">.</span><span class="">InteractiveConsole</span><span class="o">.</span><span class="">runcode</span><span class="">(</span><span class="bp">self</span><span class="">,</span><span class="bp">self</span><span class="o">.</span><span class="">code_to_run</span><span class="">)</span><br><span class='nsl'>...&nbsp;</span><br><span class='nsl'>...&nbsp;</span><span class="">        </span><span class="bp">self</span><span class="o">.</span><span class="">code_to_run</span><span class=""> </span><span class="o">=</span><span class=""> </span><span class="kc">None</span><br><span class='nsl'>...&nbsp;</span><span class="">        </span><span class="bp">self</span><span class="o">.</span><span class="">ready</span><span class="o">.</span><span class="">release</span><span class="">(</span><span class="">)</span><br><span class='nsl'>...&nbsp;</span><span class="">        </span><span class="k">return</span><span class=""> </span><span class="kc">True</span><br><span class='nsl'>...&nbsp;</span><br><span class='nsl'>...&nbsp;</span><span class="">    </span><span class="k">def</span><span class=""> </span><span class="nf">kill</span><span class=""> </span><span class="">(</span><span class="bp">self</span><span class="">)</span><span class="">:</span><br><span class='nsl'>...&nbsp;</span><span class="">        </span><span class="sd">&#34;&#34;&#34;Kill the thread, returning when it has been shut down.&#34;&#34;&#34;</span><br><span class='nsl'>...&nbsp;</span><span class="">        </span><span class="bp">self</span><span class="o">.</span><span class="">ready</span><span class="o">.</span><span class="">acquire</span><span class="">(</span><span class="">)</span><br><span class='nsl'>...&nbsp;</span><span class="">        </span><span class="bp">self</span><span class="o">.</span><span class="">_kill</span><span class=""> </span><span class="o">=</span><span class=""> </span><span class="kc">True</span><br><span class='nsl'>...&nbsp;</span><span class="">        </span><span class="bp">self</span><span class="o">.</span><span class="">ready</span><span class="o">.</span><span class="">release</span><span class="">(</span><span class="">)</span><br><span class='nsl'>...&nbsp;</span><br><span class='nsl'>...&nbsp;</span><span class="k">class</span><span class=""> </span><span class="nc">GTKInterpreter</span><span class="">(</span><span class="">threading</span><span class="o">.</span><span class="">Thread</span><span class="">)</span><span class="">:</span><br><span class='nsl'>...&nbsp;</span><span class="">    </span><span class="sd">&#34;&#34;&#34;Run gtk.main in the main thread and a python interpreter in a
    separate thread.
    Python commands can be passed to the thread where they will be executed.
    This is implemented by periodically checking for passed code using a
    GTK timeout callback.
    &#34;&#34;&#34;</span><br><span class='nsl'>...&nbsp;</span><span class="">    </span><span class="">TIMEOUT</span><span class=""> </span><span class="o">=</span><span class=""> </span><span class="mi">100</span><span class=""> </span><span class="c1"># Millisecond interval between timeouts.</span><br><span class='nsl'>...&nbsp;</span><br><span class='nsl'>...&nbsp;</span><span class="">    </span><span class="k">def</span><span class=""> </span><span class="fm">__init__</span><span class="">(</span><span class="bp">self</span><span class="">,</span><span class="">banner</span><span class="o">=</span><span class="kc">None</span><span class="">)</span><span class="">:</span><br><span class='nsl'>...&nbsp;</span><span class="">        </span><span class="">threading</span><span class="o">.</span><span class="">Thread</span><span class="o">.</span><span class="fm">__init__</span><span class="">(</span><span class="bp">self</span><span class="">)</span><br><span class='nsl'>...&nbsp;</span><span class="">        </span><span class="bp">self</span><span class="o">.</span><span class="">banner</span><span class=""> </span><span class="o">=</span><span class=""> </span><span class="">banner</span><br><span class='nsl'>...&nbsp;</span><span class="">        </span><span class="bp">self</span><span class="o">.</span><span class="">shell</span><span class=""> </span><span class="o">=</span><span class=""> </span><span class="">MTConsole</span><span class="">(</span><span class="">on_kill</span><span class="o">=</span><span class="">[</span><span class="">gtk</span><span class="o">.</span><span class="">main_quit</span><span class="">]</span><span class="">)</span><br><span class='nsl'>...&nbsp;</span><br><span class='nsl'>...&nbsp;</span><span class="">    </span><span class="k">def</span><span class=""> </span><span class="nf">run</span><span class="">(</span><span class="bp">self</span><span class="">)</span><span class="">:</span><br><span class='nsl'>...&nbsp;</span><span class="">        </span><span class="bp">self</span><span class="o">.</span><span class="">pre_interact</span><span class="">(</span><span class="">)</span><br><span class='nsl'>...&nbsp;</span><span class="">        </span><span class="bp">self</span><span class="o">.</span><span class="">shell</span><span class="o">.</span><span class="">interact</span><span class="">(</span><span class="bp">self</span><span class="o">.</span><span class="">banner</span><span class="">)</span><br><span class='nsl'>...&nbsp;</span><span class="">        </span><span class="bp">self</span><span class="o">.</span><span class="">shell</span><span class="o">.</span><span class="">kill</span><span class="">(</span><span class="">)</span><br><span class='nsl'>...&nbsp;</span><br><span class='nsl'>...&nbsp;</span><span class="">    </span><span class="k">def</span><span class=""> </span><span class="nf">mainloop</span><span class="">(</span><span class="bp">self</span><span class="">)</span><span class="">:</span><br><span class='nsl'>...&nbsp;</span><span class="">        </span><span class="bp">self</span><span class="o">.</span><span class="">start</span><span class="">(</span><span class="">)</span><br><span class='nsl'>...&nbsp;</span><span class="">        </span><span class="">gobject</span><span class="o">.</span><span class="">timeout_add</span><span class="">(</span><span class="bp">self</span><span class="o">.</span><span class="">TIMEOUT</span><span class="">,</span><span class=""> </span><span class="bp">self</span><span class="o">.</span><span class="">shell</span><span class="o">.</span><span class="">runcode</span><span class="">)</span><br><span class='nsl'>...&nbsp;</span><span class="">        </span><span class="k">try</span><span class="">:</span><br><span class='nsl'>...&nbsp;</span><span class="">            </span><span class="k">if</span><span class=""> </span><span class="">gtk</span><span class="o">.</span><span class="">gtk_version</span><span class="">[</span><span class="mi">0</span><span class="">]</span><span class=""> </span><span class="o">&gt;</span><span class="o">=</span><span class=""> </span><span class="mi">2</span><span class="">:</span><br><span class='nsl'>...&nbsp;</span><span class="">                </span><span class="">gtk</span><span class="o">.</span><span class="">gdk</span><span class="o">.</span><span class="">threads_init</span><span class="">(</span><span class="">)</span><br><span class='nsl'>...&nbsp;</span><span class="">        </span><span class="k">except</span><span class=""> </span><span class="ne">AttributeError</span><span class="">:</span><br><span class='nsl'>...&nbsp;</span><span class="">            </span><span class="k">pass</span><br><span class='nsl'>...&nbsp;</span><span class="">        </span><span class="">gtk</span><span class="o">.</span><span class="">main</span><span class="">(</span><span class="">)</span><br><span class='nsl'>...&nbsp;</span><span class="">        </span><span class="bp">self</span><span class="o">.</span><span class="">join</span><span class="">(</span><span class="">)</span><br><span class='nsl'>...&nbsp;</span><br><span class='nsl'>...&nbsp;</span><span class="">    </span><span class="k">def</span><span class=""> </span><span class="nf">pre_interact</span><span class="">(</span><span class="bp">self</span><span class="">)</span><span class="">:</span><br><span class='nsl'>...&nbsp;</span><span class="">        </span><span class="sd">&#34;&#34;&#34;This method should be overridden by subclasses.

        It gets called right before interact(), but after the thread starts.
        Typically used to push initialization code into the interpreter&#34;&#34;&#34;</span><br><span class='nsl'>...&nbsp;</span><br><span class='nsl'>...&nbsp;</span><span class="">        </span><span class="k">pass</span><br><span class='nsl'>...&nbsp;</span><br><span class='nsl'>...&nbsp;</span><span class="k">class</span><span class=""> </span><span class="nc">MatplotLibInterpreter</span><span class="">(</span><span class="">GTKInterpreter</span><span class="">)</span><span class="">:</span><br><span class='nsl'>...&nbsp;</span><span class="">    </span><span class="sd">&#34;&#34;&#34;Threaded interpreter with matplotlib support.

    Note that this explicitly sets GTKAgg as the backend, since it has
    specific GTK hooks in it.&#34;&#34;&#34;</span><br><span class='nsl'>...&nbsp;</span><br><span class='nsl'>...&nbsp;</span><span class="">    </span><span class="k">def</span><span class=""> </span><span class="fm">__init__</span><span class="">(</span><span class="bp">self</span><span class="">,</span><span class="">banner</span><span class="o">=</span><span class="kc">None</span><span class="">)</span><span class="">:</span><br><span class='nsl'>...&nbsp;</span><span class="">        </span><span class="">banner</span><span class=""> </span><span class="o">=</span><span class=""> </span><span class="s2">&#34;&#34;&#34;</span><span class="se">\n</span><span class="s2">Welcome to matplotlib, a MATLAB-like python environment.</span><br><span class='nsl'>...&nbsp;</span><span class="s2">    help(matlab)   -&gt; help on matlab compatible commands from matplotlib.</span><br><span class='nsl'>...&nbsp;</span><span class="s2">    help(plotting) -&gt; help on plotting commands.</span><br><span class='nsl'>...&nbsp;</span><span class="s2">    </span><span class="s2">&#34;&#34;&#34;</span><br><span class='nsl'>...&nbsp;</span><span class="">        </span><span class="">GTKInterpreter</span><span class="o">.</span><span class="fm">__init__</span><span class="">(</span><span class="bp">self</span><span class="">,</span><span class="">banner</span><span class="">)</span><br><span class='nsl'>...&nbsp;</span><br><span class='nsl'>...&nbsp;</span><span class="">    </span><span class="k">def</span><span class=""> </span><span class="nf">pre_interact</span><span class="">(</span><span class="bp">self</span><span class="">)</span><span class="">:</span><br><span class='nsl'>...&nbsp;</span><span class="">        </span><span class="sd">&#34;&#34;&#34;Initialize matplotlib before user interaction begins&#34;&#34;&#34;</span><br><span class='nsl'>...&nbsp;</span><br><span class='nsl'>...&nbsp;</span><span class="">        </span><span class="">push</span><span class=""> </span><span class="o">=</span><span class=""> </span><span class="bp">self</span><span class="o">.</span><span class="">shell</span><span class="o">.</span><span class="">push</span><br><span class='nsl'>...&nbsp;</span><span class="">        </span><span class="c1"># Code to execute in user&#39;s namespace</span><br><span class='nsl'>...&nbsp;</span><span class="">        </span><span class="">lines</span><span class=""> </span><span class="o">=</span><span class=""> </span><span class="">[</span><span class="s2">&#34;</span><span class="s2">import matplotlib</span><span class="s2">&#34;</span><span class="">,</span><br><span class='nsl'>...&nbsp;</span><span class="">                 </span><span class="s2">&#34;</span><span class="s2">matplotlib.use(</span><span class="s2">&#39;</span><span class="s2">GTKAgg</span><span class="s2">&#39;</span><span class="s2">)</span><span class="s2">&#34;</span><span class="">,</span><br><span class='nsl'>...&nbsp;</span><span class="">                 </span><span class="s2">&#34;</span><span class="s2">matplotlib.interactive(1)</span><span class="s2">&#34;</span><span class="">,</span><br><span class='nsl'>...&nbsp;</span><span class="">                 </span><span class="s2">&#34;</span><span class="s2">import matplotlib.pylab as pylab</span><span class="s2">&#34;</span><span class="">,</span><br><span class='nsl'>...&nbsp;</span><span class="">                 </span><span class="s2">&#34;</span><span class="s2">from matplotlib.pylab import *</span><span class="se">\n</span><span class="s2">&#34;</span><span class="">]</span><br><span class='nsl'>...&nbsp;</span><br><span class='nsl'>...&nbsp;</span><span class="">        </span><span class="nb">map</span><span class="">(</span><span class="">push</span><span class="">,</span><span class="">lines</span><span class="">)</span><br><span class='nsl'>...&nbsp;</span><br><span class='nsl'>...&nbsp;</span><span class="">        </span><span class="c1"># Execute file if given.</span><br><span class='nsl'>...&nbsp;</span><span class="">        </span><span class="k">if</span><span class=""> </span><span class="nb">len</span><span class="">(</span><span class="">sys</span><span class="o">.</span><span class="">argv</span><span class="">)</span><span class="o">&gt;</span><span class="mi">1</span><span class="">:</span><br><span class='nsl'>...&nbsp;</span><span class="">            </span><span class="kn">import</span><span class=""> </span><a class="foo nn" href="/p/matplotlib/3.5.1/api/matplotlib.html">matplotlib</a><br><span class='nsl'>...&nbsp;</span><span class="">            </span><a class="foo " href="/p/matplotlib/3.5.1/api/matplotlib.html">matplotlib</a><span class="o">.</span><span class="">interactive</span><span class="">(</span><span class="mi">0</span><span class="">)</span><span class=""> </span><span class="c1"># turn off interaction</span><br><span class='nsl'>...&nbsp;</span><span class="">            </span><span class="">fname</span><span class=""> </span><span class="o">=</span><span class=""> </span><span class="">sys</span><span class="o">.</span><span class="">argv</span><span class="">[</span><span class="mi">1</span><span class="">]</span><br><span class='nsl'>...&nbsp;</span><span class="">            </span><span class="k">try</span><span class="">:</span><br><span class='nsl'>...&nbsp;</span><span class="">                </span><span class="">inFile</span><span class=""> </span><span class="o">=</span><span class=""> </span><span class="">file</span><span class="">(</span><span class="">fname</span><span class="">,</span><span class=""> </span><span class="s1">&#39;</span><span class="s1">r</span><span class="s1">&#39;</span><span class="">)</span><br><span class='nsl'>...&nbsp;</span><span class="">            </span><span class="k">except</span><span class=""> </span><span class="ne">IOError</span><span class="">:</span><br><span class='nsl'>...&nbsp;</span><span class="">                </span><span class="nb">print</span><span class="">(</span><span class="s1">&#39;</span><span class="s1">*** ERROR *** Could not read file &lt;</span><span class="si">%s</span><span class="s1">&gt;</span><span class="s1">&#39;</span><span class=""> </span><span class="o">%</span><span class=""> </span><span class="">fname</span><span class="">)</span><br><span class='nsl'>...&nbsp;</span><span class="">            </span><span class="k">else</span><span class="">:</span><br><span class='nsl'>...&nbsp;</span><span class="">                </span><span class="nb">print</span><span class="">(</span><span class="s1">&#39;</span><span class="s1">*** Executing file &lt;</span><span class="si">%s</span><span class="s1">&gt;:</span><span class="s1">&#39;</span><span class=""> </span><span class="o">%</span><span class=""> </span><span class="">fname</span><span class="">)</span><br><span class='nsl'>...&nbsp;</span><span class="">                </span><span class="k">for</span><span class=""> </span><span class="">line</span><span class=""> </span><span class="ow">in</span><span class=""> </span><span class="">inFile</span><span class="">:</span><br><span class='nsl'>...&nbsp;</span><span class="">                    </span><span class="k">if</span><span class=""> </span><span class="">line</span><span class="o">.</span><span class="">lstrip</span><span class="">(</span><span class="">)</span><span class="o">.</span><span class="">find</span><span class="">(</span><span class="s1">&#39;</span><span class="s1">show()</span><span class="s1">&#39;</span><span class="">)</span><span class="o">==</span><span class="mi">0</span><span class="">:</span><span class=""> </span><span class="k">continue</span><br><span class='nsl'>...&nbsp;</span><span class="">                    </span><span class="nb">print</span><span class="">(</span><span class="s1">&#39;</span><span class="s1">&gt;&gt;</span><span class="s1">&#39;</span><span class="">,</span><span class=""> </span><span class="">line</span><span class="">)</span><br><span class='nsl'>...&nbsp;</span><span class="">                    </span><span class="">push</span><span class="">(</span><span class="">line</span><span class="">)</span><br><span class='nsl'>...&nbsp;</span><span class="">                </span><span class="">inFile</span><span class="o">.</span><span class="">close</span><span class="">(</span><span class="">)</span><br><span class='nsl'>...&nbsp;</span><span class="">            </span><a class="foo " href="/p/matplotlib/3.5.1/api/matplotlib.html">matplotlib</a><span class="o">.</span><span class="">interactive</span><span class="">(</span><span class="mi">1</span><span class="">)</span><span class="">   </span><span class="c1"># turn on interaction</span><br><span class='nsl'>...&nbsp;</span><br><span class='nsl'>...&nbsp;</span><span class="k">if</span><span class=""> </span><span class="vm">__name__</span><span class=""> </span><span class="o">==</span><span class=""> </span><span class="s1">&#39;</span><span class="s1">__main__</span><span class="s1">&#39;</span><span class="">:</span><br><span class='nsl'>...&nbsp;</span><span class="">    </span><span class="nb">print</span><span class="">(</span><span class="s2">&#34;</span><span class="s2">This demo is not presently functional, so running</span><span class="s2">&#34;</span><span class="">)</span><br><span class='nsl'>...&nbsp;</span><span class="">    </span><span class="nb">print</span><span class="">(</span><span class="s2">&#34;</span><span class="s2">it as a script has been disabled.</span><span class="s2">&#34;</span><span class="">)</span><br><span class='nsl'>...&nbsp;</span><span class="">    </span><span class="">sys</span><span class="o">.</span><span class="">exit</span><span class="">(</span><span class="">)</span><br><span class='nsl'>...&nbsp;</span><span class="">    </span><span class="c1"># Quick sys.argv hack to extract the option and leave filenames in sys.argv.</span><br><span class='nsl'>...&nbsp;</span><span class="">    </span><span class="c1"># For real option handling, use optparse or getopt.</span><br><span class='nsl'>...&nbsp;</span><span class="">    </span><span class="k">if</span><span class=""> </span><span class="nb">len</span><span class="">(</span><span class="">sys</span><span class="o">.</span><span class="">argv</span><span class="">)</span><span class=""> </span><span class="o">&gt;</span><span class=""> </span><span class="mi">1</span><span class=""> </span><span class="ow">and</span><span class=""> </span><span class="">sys</span><span class="o">.</span><span class="">argv</span><span class="">[</span><span class="mi">1</span><span class="">]</span><span class="o">==</span><span class="s1">&#39;</span><span class="s1">-pylab</span><span class="s1">&#39;</span><span class="">:</span><br><span class='nsl'>...&nbsp;</span><span class="">        </span><span class="">sys</span><span class="o">.</span><span class="">argv</span><span class=""> </span><span class="o">=</span><span class=""> </span><span class="">[</span><span class="">sys</span><span class="o">.</span><span class="">argv</span><span class="">[</span><span class="mi">0</span><span class="">]</span><span class="">]</span><span class="o">+</span><span class="">sys</span><span class="o">.</span><span class="">argv</span><span class="">[</span><span class="mi">2</span><span class="">:</span><span class="">]</span><br><span class='nsl'>...&nbsp;</span><span class="">        </span><span class="">MatplotLibInterpreter</span><span class="">(</span><span class="">)</span><span class="o">.</span><span class="">mainloop</span><span class="">(</span><span class="">)</span><br><span class='nsl'>...&nbsp;</span><span class="">    </span><span class="k">else</span><span class="">:</span><br><span class='nsl'>...&nbsp;</span><span class="">        </span><span class="">GTKInterpreter</span><span class="">(</span><span class="">)</span><span class="o">.</span><span class="">mainloop</span><span class="">(</span><span class="">)</span><br><span class='nsl'>...&nbsp;</span>
</pre>
       




</div>
</body>
</html>